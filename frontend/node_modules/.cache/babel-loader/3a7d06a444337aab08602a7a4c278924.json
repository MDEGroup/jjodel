{"ast":null,"code":"import _objectSpread from\"C:/d/Programming/web/jodel-mde/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _toConsumableArray from\"C:/d/Programming/web/jodel-mde/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"C:/d/Programming/web/jodel-mde/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React from'react';import{DUser,LUser,LViewElement}from'../../../../joiner';import{connect}from'react-redux';import{useStateIfMounted}from'use-state-if-mounted';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function SubViewsDataComponent(props){var view=props.view;var project=props.project;var readOnly=props.readonly;var _useStateIfMounted=useStateIfMounted(''),_useStateIfMounted2=_slicedToArray(_useStateIfMounted,2),hoverID=_useStateIfMounted2[0],setHoverID=_useStateIfMounted2[1];var _useStateIfMounted3=useStateIfMounted(project.views.filter(function(v){return v&&v.id!==view.id&&!view.subViews.map(function(v){return v.id;}).includes(v.id);})),_useStateIfMounted4=_slicedToArray(_useStateIfMounted3,2),possibleSubViews=_useStateIfMounted4[0],setPossibleSubViews=_useStateIfMounted4[1];var _useStateIfMounted5=useStateIfMounted(possibleSubViews[0]?possibleSubViews[0].id:''),_useStateIfMounted6=_slicedToArray(_useStateIfMounted5,2),subViewID=_useStateIfMounted6[0],setSubViewID=_useStateIfMounted6[1];var add=function add(e){if(!subViewID)return;view.setSubViewScore(subViewID,1.5);var _possibleSubViews=project.views.filter(function(v){return v&&v.id!==subViewID&&v.id!==view.id&&!view.subViews.map(function(v){return v.id;}).includes(v.id);});setPossibleSubViews(_possibleSubViews);setSubViewID(_possibleSubViews[0]?_possibleSubViews[0].id:'');};var remove=function remove(e,subView){e.preventDefault();e.stopPropagation();view.setSubViewScore(subViewID,null);setPossibleSubViews([].concat(_toConsumableArray(possibleSubViews),[subView]));};return/*#__PURE__*/_jsxs(\"section\",{className:'p-3',children:[/*#__PURE__*/_jsxs(\"div\",{className:'d-flex w-100 mb-2',children:[/*#__PURE__*/_jsx(\"select\",{className:'my-auto select ',value:subViewID,onChange:function onChange(e){return setSubViewID(e.target.value);},children:possibleSubViews.map(function(v,index){return/*#__PURE__*/_jsx(\"option\",{value:v.id,children:v.name},index);})}),/*#__PURE__*/_jsx(\"button\",{className:'btn btn-primary ms-auto',onClick:add,disabled:!subViewID||readOnly,children:/*#__PURE__*/_jsx(\"i\",{className:'p-1 bi bi-plus'})})]}),view.subViews.map(function(subView,index){return/*#__PURE__*/_jsxs(\"div\",{className:'d-flex p-1 mt-1 border round mx-1',tabIndex:-1,onMouseEnter:function onMouseEnter(e){return setHoverID(subView.id);},onMouseLeave:function onMouseLeave(e){return setHoverID('');},onClick:function onClick(e){return props.setSelectedView(subView);},style:{cursor:'pointer',background:hoverID===subView.id?'#E0E0E0':'transparent'},children:[/*#__PURE__*/_jsx(\"label\",{style:{cursor:'pointer'},className:'my-auto',children:subView.name}),/*#__PURE__*/_jsx(\"button\",{className:'btn btn-danger ms-auto',disabled:readOnly,onClick:function onClick(e){return remove(e,subView);},children:/*#__PURE__*/_jsx(\"i\",{className:'p-1 bi bi-trash3-fill'})})]},index);})]},view.id);}function mapStateToProps(state,ownProps){var ret={};ret.view=LViewElement.fromPointer(ownProps.viewID);var user=LUser.fromPointer(DUser.current);ret.project=user.project;return ret;}function mapDispatchToProps(dispatch){var ret={};return ret;}export var SubViewsDataConnected=connect(mapStateToProps,mapDispatchToProps)(SubViewsDataComponent);export var SubViewsData=function SubViewsData(props){var children=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];return/*#__PURE__*/_jsx(SubViewsDataConnected,_objectSpread({},_objectSpread(_objectSpread({},props),{},{children:children})));};export default SubViewsData;","map":{"version":3,"names":["React","DUser","LUser","LViewElement","connect","useStateIfMounted","jsx","_jsx","jsxs","_jsxs","SubViewsDataComponent","props","view","project","readOnly","readonly","_useStateIfMounted","_useStateIfMounted2","_slicedToArray","hoverID","setHoverID","_useStateIfMounted3","views","filter","v","id","subViews","map","includes","_useStateIfMounted4","possibleSubViews","setPossibleSubViews","_useStateIfMounted5","_useStateIfMounted6","subViewID","setSubViewID","add","e","setSubViewScore","_possibleSubViews","remove","subView","preventDefault","stopPropagation","concat","_toConsumableArray","className","children","value","onChange","target","index","name","onClick","disabled","tabIndex","onMouseEnter","onMouseLeave","setSelectedView","style","cursor","background","mapStateToProps","state","ownProps","ret","fromPointer","viewID","user","current","mapDispatchToProps","dispatch","SubViewsDataConnected","SubViewsData","arguments","length","undefined","_objectSpread"],"sources":["C:/d/Programming/web/jodel-mde/src/components/rightbar/viewsEditor/data/SubViewsData.tsx"],"sourcesContent":["import React, {Dispatch, MouseEvent, ReactElement, useEffect} from 'react';\r\nimport {\r\n    DState,\r\n    DUser,\r\n    DViewElement,\r\n    LProject,\r\n    LUser,\r\n    LViewElement,\r\n    Pointer, SetFieldAction,\r\n    SetRootFieldAction,\r\n    U\r\n} from '../../../../joiner';\r\nimport {connect} from 'react-redux';\r\nimport {useStateIfMounted} from 'use-state-if-mounted';\r\nimport {FakeStateProps} from '../../../../joiner/types';\r\n\r\nfunction SubViewsDataComponent(props: AllProps) {\r\n    const view = props.view;\r\n    const project = props.project;\r\n\r\n    const readOnly = props.readonly;\r\n    const [hoverID, setHoverID] = useStateIfMounted('');\r\n    const [possibleSubViews, setPossibleSubViews] = useStateIfMounted(project.views.filter(v => v && v.id !== view.id && !view.subViews.map(v => v.id).includes(v.id)));\r\n    const [subViewID, setSubViewID] = useStateIfMounted((possibleSubViews[0]) ? possibleSubViews[0].id : '');\r\n\r\n    const add = (e: MouseEvent) => {\r\n        if(!subViewID) return;\r\n        view.setSubViewScore(subViewID, 1.5);\r\n        const _possibleSubViews = project.views.filter(v => v && v.id !== subViewID && v.id !== view.id && !view.subViews.map(v => v.id).includes(v.id));\r\n        setPossibleSubViews(_possibleSubViews);\r\n        setSubViewID((_possibleSubViews[0]) ? _possibleSubViews[0].id : '');\r\n    }\r\n\r\n\r\n    const remove = (e: MouseEvent, subView: LViewElement) => {\r\n        e.preventDefault(); e.stopPropagation();\r\n        view.setSubViewScore(subViewID, null);\r\n        setPossibleSubViews([...possibleSubViews, subView]);\r\n    }\r\n\r\n    return(<section key={view.id} className={'p-3'}>\r\n        <div className={'d-flex w-100 mb-2'}>\r\n            <select className={'my-auto select '} value={subViewID} onChange={e => setSubViewID(e.target.value)}>\r\n                {possibleSubViews.map((v, index) => {\r\n                    return(<option key={index} value={v.id}>{v.name}</option>)\r\n                })}\r\n            </select>\r\n            <button className={'btn btn-primary ms-auto'} onClick={add} disabled={!subViewID || readOnly}>\r\n                <i className={'p-1 bi bi-plus'}></i>\r\n            </button>\r\n        </div>\r\n        {view.subViews.map((subView, index) => {\r\n            return <div key={index} className={'d-flex p-1 mt-1 border round mx-1'} tabIndex={-1}\r\n                        onMouseEnter={e => setHoverID(subView.id)} onMouseLeave={e => setHoverID('')}\r\n                        onClick={e => props.setSelectedView(subView)}\r\n                        style={{cursor: 'pointer', background: hoverID === subView.id ? '#E0E0E0' : 'transparent'}}>\r\n                <label style={{cursor: 'pointer'}} className={'my-auto'}>{subView.name}</label>\r\n                <button className={'btn btn-danger ms-auto'} disabled={readOnly}\r\n                        onClick={e => remove(e, subView)}>\r\n                    <i className={'p-1 bi bi-trash3-fill'}></i>\r\n                </button>\r\n            </div>\r\n        })}\r\n    </section>);\r\n}\r\n\r\ninterface OwnProps {\r\n    viewID: Pointer<DViewElement, 1, 1, LViewElement>;\r\n    readonly: boolean;\r\n    setSelectedView: React.Dispatch<React.SetStateAction<LViewElement | undefined>>;// (val: LViewElement | undefined) => {}\r\n}\r\ninterface StateProps {\r\n    view: LViewElement;\r\n    project: LProject;\r\n}\r\ninterface DispatchProps { }\r\ntype AllProps = OwnProps & StateProps & DispatchProps;\r\n\r\nfunction mapStateToProps(state: DState, ownProps: OwnProps): StateProps {\r\n    const ret: StateProps = {} as FakeStateProps;\r\n    ret.view = LViewElement.fromPointer(ownProps.viewID);\r\n    const user = LUser.fromPointer(DUser.current);\r\n    ret.project = user.project as LProject;\r\n    return ret;\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch<any>): DispatchProps {\r\n    const ret: DispatchProps = {};\r\n    return ret;\r\n}\r\n\r\nexport const SubViewsDataConnected = connect<StateProps, DispatchProps, OwnProps, DState>(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(SubViewsDataComponent);\r\n\r\nexport const SubViewsData = (props: OwnProps, children: (string | React.Component)[] = []): ReactElement => {\r\n    return <SubViewsDataConnected {...{...props, children}} />;\r\n}\r\nexport default SubViewsData;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}