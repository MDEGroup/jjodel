{"ast":null,"code":"var _jsxFileName = \"C:\\\\d\\\\Programming\\\\web\\\\jodel-mde\\\\src\\\\components\\\\forEndUser\\\\SplashMessage.tsx\",\n  _dec,\n  _class,\n  _class2;\nimport React from 'react';\nimport { U, RuntimeAccessible, RuntimeAccessibleClass } from '../../joiner';\nimport './splash-message.scss';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nclass MessageType {}\nMessageType.s = 's';\nMessageType.l = 'l';\nMessageType.i = 'i';\nMessageType.w = 'w';\nMessageType.e = 'e';\nMessageType.ex = 'ex';\nclass MessageData {\n  // unix timestamp start\n  // unix timestamp end\n\n  constructor(msg, lastingTime) {\n    let requireInteraction = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n    let type = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : MessageType.l;\n    this.msg = void 0;\n    this.type = void 0;\n    this.id = void 0;\n    this.publishingTime = void 0;\n    this.lastingTime = void 0;\n    this.requireInteraction = void 0;\n    this.msg = msg;\n    this.type = type;\n    this.requireInteraction = requireInteraction;\n    if (this.requireInteraction) lastingTime = Number.POSITIVE_INFINITY;else if (lastingTime === undefined) {\n      // todo: how to get text from ReactNode?\n      let msgStr = (msg === null || msg === void 0 ? void 0 : msg.innerText) || msg;\n      lastingTime = typeof msgStr == \"string\" ? msgStr.length * 3 / 30 : 4000;\n    } else if (lastingTime < 0) lastingTime = Number.POSITIVE_INFINITY;\n    this.publishingTime = new Date().getTime();\n    this.lastingTime = lastingTime * 1000 + MessageData.animationTime;\n    this.id = MessageData.idMax++;\n  }\n}\nMessageData.animationTime = 1000;\nMessageData.idMax = 1;\nclass MessageVisualizerState {\n  constructor() {\n    this.msg = void 0;\n    this.msg = [];\n  }\n}\nexport class MessageVisualizer extends React.Component {\n  constructor() {\n    super({});\n    this.requireInteraction = false;\n    this.state = new MessageVisualizerState();\n    MessageVisualizer.component = this;\n  }\n  render() {\n    if (!this.state.msg.length) return undefined;\n    this.requireInteraction = false;\n    let msgs = this.state.msg.map((m, i) => this.renderMessage(m, i));\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"splash-message-container\" + (this.requireInteraction && \" blocking\"),\n      children: msgs\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 16\n    }, this);\n  }\n  renderMessage(msg, i) {\n    if (!msg) return undefined;\n    if (msg.requireInteraction) this.requireInteraction = true;\n    let wrapper = /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"splash-message \" + msg.type,\n      onClick: e => this.onClick(e, i),\n      children: this.state.msg\n    }, msg.id, false, {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 23\n    }, this);\n    return wrapper;\n  }\n  onClick(e, i) {\n    if (e.button === 2) {\n      // MouseRightButton\n      this.setState({\n        msg: []\n      });\n      return;\n    }\n    const msg = [...this.state.msg];\n    msg.splice(i, 1);\n    this.setState({\n      msg\n    });\n  }\n}\nMessageVisualizer.component = void 0;\nexport let Message = (_dec = RuntimeAccessible('Message'), _dec(_class = (_class2 = class Message extends RuntimeAccessibleClass {\n  // requireInteraction = true makes a black background and non-clickthrough\n  static show(msg, time) {\n    let type = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : MessageType.i;\n    let requireInteraction = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;\n    const msgo = new MessageData(msg, time, requireInteraction, type);\n    MessageVisualizer.component.setState({\n      msg: [...MessageVisualizer.component.state.msg, msgo]\n    });\n    if (msgo.lastingTime < Number.POSITIVE_INFINITY) setTimeout(() => Message.hide(msg), msgo.lastingTime);\n  }\n  static hide(msg) {\n    if (!msg) {\n      MessageVisualizer.component.setState({\n        msg: []\n      });\n      return;\n    }\n    let msgs = [...MessageVisualizer.component.state.msg];\n    U.arrayRemoveAll(msgs, msg);\n    if (msgs.length === MessageVisualizer.component.state.msg.length) return;\n    MessageVisualizer.component.setState({\n      msg: msgs\n    });\n  }\n}, _class2.cname = \"Message\", _class2)) || _class);","map":{"version":3,"names":["React","U","RuntimeAccessible","RuntimeAccessibleClass","jsxDEV","_jsxDEV","MessageType","s","l","i","w","e","ex","MessageData","constructor","msg","lastingTime","requireInteraction","arguments","length","undefined","type","id","publishingTime","Number","POSITIVE_INFINITY","msgStr","innerText","Date","getTime","animationTime","idMax","MessageVisualizerState","MessageVisualizer","Component","state","component","render","msgs","map","m","renderMessage","className","children","fileName","_jsxFileName","lineNumber","columnNumber","wrapper","onClick","button","setState","splice","Message","_dec","_class","_class2","show","time","msgo","setTimeout","hide","arrayRemoveAll","cname"],"sources":["C:/d/Programming/web/jodel-mde/src/components/forEndUser/SplashMessage.tsx"],"sourcesContent":["import React, {Dispatch, isValidElement, KeyboardEvent, ReactElement, ReactNode} from 'react';\r\nimport {connect} from 'react-redux';\r\nimport {DState} from '../../redux/store';\r\nimport {\r\n    Defaults,\r\n    DPointerTargetable,\r\n    DV,\r\n    GObject,\r\n    Keystrokes,\r\n    Log,\r\n    LPointerTargetable,\r\n    Overlap,\r\n    Pointer, store,\r\n    U, LoggerCategoryState, RuntimeAccessible, RuntimeAccessibleClass\r\n} from '../../joiner';\r\nimport './splash-message.scss';\r\nclass MessageType{\r\n    public static s = 's';\r\n    public static l = 'l';\r\n    public static i = 'i';\r\n    public static w = 'w';\r\n    public static e = 'e';\r\n    public static ex = 'ex';\r\n}\r\n\r\nclass MessageData{\r\n    public static animationTime: number = 1000;\r\n    public static idMax: number = 1;\r\n    msg: ReactNode;\r\n    type: MessageType;\r\n    id: number;\r\n    publishingTime: number; // unix timestamp start\r\n    lastingTime: number; // unix timestamp end\r\n    requireInteraction: boolean;\r\n\r\n    constructor(msg: ReactNode, lastingTime?: number, requireInteraction: boolean = false, type: MessageType = MessageType.l) {\r\n        this.msg = msg;\r\n        this.type = type;\r\n        this.requireInteraction = requireInteraction;\r\n        if (this.requireInteraction) lastingTime = Number.POSITIVE_INFINITY;\r\n        else if (lastingTime === undefined){\r\n            // todo: how to get text from ReactNode?\r\n            let msgStr = (msg as any)?.innerText || msg;\r\n            lastingTime = typeof msgStr == \"string\" ? msgStr.length * 3/30 : 4000;\r\n        } else if (lastingTime < 0) lastingTime = Number.POSITIVE_INFINITY;\r\n\r\n        this.publishingTime = new Date().getTime();\r\n        this.lastingTime = lastingTime*1000 + MessageData.animationTime;\r\n        this.id = MessageData.idMax++;\r\n    }\r\n}\r\n\r\nclass MessageVisualizerState{\r\n    msg: MessageData[];\r\n    constructor() { this.msg = []; }\r\n}\r\nexport class MessageVisualizer extends React.Component<{}, MessageVisualizerState> {\r\n    public static component: MessageVisualizer;\r\n    private requireInteraction: boolean = false;\r\n\r\n    constructor(){\r\n        super({});\r\n        this.state = new MessageVisualizerState();\r\n        MessageVisualizer.component = this;\r\n    }\r\n    render(){\r\n        if (!this.state.msg.length) return undefined;\r\n        this.requireInteraction = false;\r\n        let msgs = this.state.msg.map( (m, i) => this.renderMessage(m, i));\r\n        return <div className={\"splash-message-container\"+ (this.requireInteraction && \" blocking\")}>{msgs}</div>\r\n    }\r\n    private renderMessage(msg: MessageData, i: number){\r\n        if (!msg) return undefined;\r\n        if (msg.requireInteraction) this.requireInteraction = true;\r\n        let wrapper = <div key={msg.id} className={\"splash-message \" + msg.type} onClick={(e)=>this.onClick(e, i)}>{this.state.msg}</div>\r\n        return wrapper;\r\n    }\r\n\r\n    private onClick(e: React.MouseEvent<HTMLDivElement>, i: number) {\r\n        if (e.button === 2){ // MouseRightButton\r\n            this.setState({msg:[]});\r\n            return;\r\n        }\r\n        const msg = [...this.state.msg];\r\n        msg.splice(i, 1);\r\n        this.setState({msg})\r\n    }\r\n}\r\n\r\n@RuntimeAccessible('Message')\r\nexport class Message extends RuntimeAccessibleClass {\r\n    static cname: string = \"Message\";\r\n\r\n    // requireInteraction = true makes a black background and non-clickthrough\r\n    public static show(msg: ReactNode, time: number, type: MessageType = MessageType.i, requireInteraction: boolean = false): void{\r\n        const msgo = new MessageData(msg, time, requireInteraction, type);\r\n        MessageVisualizer.component.setState({msg:[...MessageVisualizer.component.state.msg, msgo]});\r\n        if (msgo.lastingTime < Number.POSITIVE_INFINITY) setTimeout( ()=>Message.hide(msg), msgo.lastingTime);\r\n    }\r\n\r\n    public static hide(msg?: ReactNode): void {\r\n        if (!msg) {\r\n            MessageVisualizer.component.setState({msg: []});\r\n            return;\r\n        }\r\n        let msgs = [...MessageVisualizer.component.state.msg];\r\n        U.arrayRemoveAll(msgs, msg);\r\n        if (msgs.length === MessageVisualizer.component.state.msg.length) return;\r\n        MessageVisualizer.component.setState({msg:msgs});\r\n    }\r\n}\r\n"],"mappings":";;;;AAAA,OAAOA,KAAK,MAA0E,OAAO;AAG7F,SAUIC,CAAC,EAAuBC,iBAAiB,EAAEC,sBAAsB,QAC9D,cAAc;AACrB,OAAO,uBAAuB;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAC/B,MAAMC,WAAW;AAAXA,WAAW,CACCC,CAAC,GAAG,GAAG;AADnBD,WAAW,CAECE,CAAC,GAAG,GAAG;AAFnBF,WAAW,CAGCG,CAAC,GAAG,GAAG;AAHnBH,WAAW,CAICI,CAAC,GAAG,GAAG;AAJnBJ,WAAW,CAKCK,CAAC,GAAG,GAAG;AALnBL,WAAW,CAMCM,EAAE,GAAG,IAAI;AAG3B,MAAMC,WAAW;EAMW;EACH;;EAGrBC,WAAWA,CAACC,GAAc,EAAEC,WAAoB,EAA0E;IAAA,IAAxEC,kBAA2B,GAAAC,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAE,SAAA,GAAAF,SAAA,MAAG,KAAK;IAAA,IAAEG,IAAiB,GAAAH,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAE,SAAA,GAAAF,SAAA,MAAGZ,WAAW,CAACE,CAAC;IAAA,KAPxHO,GAAG;IAAA,KACHM,IAAI;IAAA,KACJC,EAAE;IAAA,KACFC,cAAc;IAAA,KACdP,WAAW;IAAA,KACXC,kBAAkB;IAGd,IAAI,CAACF,GAAG,GAAGA,GAAG;IACd,IAAI,CAACM,IAAI,GAAGA,IAAI;IAChB,IAAI,CAACJ,kBAAkB,GAAGA,kBAAkB;IAC5C,IAAI,IAAI,CAACA,kBAAkB,EAAED,WAAW,GAAGQ,MAAM,CAACC,iBAAiB,CAAC,KAC/D,IAAIT,WAAW,KAAKI,SAAS,EAAC;MAC/B;MACA,IAAIM,MAAM,GAAG,CAACX,GAAG,aAAHA,GAAG,uBAAHA,GAAG,CAAUY,SAAS,KAAIZ,GAAG;MAC3CC,WAAW,GAAG,OAAOU,MAAM,IAAI,QAAQ,GAAGA,MAAM,CAACP,MAAM,GAAG,CAAC,GAAC,EAAE,GAAG,IAAI;IACzE,CAAC,MAAM,IAAIH,WAAW,GAAG,CAAC,EAAEA,WAAW,GAAGQ,MAAM,CAACC,iBAAiB;IAElE,IAAI,CAACF,cAAc,GAAG,IAAIK,IAAI,CAAC,CAAC,CAACC,OAAO,CAAC,CAAC;IAC1C,IAAI,CAACb,WAAW,GAAGA,WAAW,GAAC,IAAI,GAAGH,WAAW,CAACiB,aAAa;IAC/D,IAAI,CAACR,EAAE,GAAGT,WAAW,CAACkB,KAAK,EAAE;EACjC;AACJ;AAzBMlB,WAAW,CACCiB,aAAa,GAAW,IAAI;AADxCjB,WAAW,CAECkB,KAAK,GAAW,CAAC;AAyBnC,MAAMC,sBAAsB;EAExBlB,WAAWA,CAAA,EAAG;IAAA,KADdC,GAAG;IACa,IAAI,CAACA,GAAG,GAAG,EAAE;EAAE;AACnC;AACA,OAAO,MAAMkB,iBAAiB,SAASjC,KAAK,CAACkC,SAAS,CAA6B;EAI/EpB,WAAWA,CAAA,EAAE;IACT,KAAK,CAAC,CAAC,CAAC,CAAC;IAAC,KAHNG,kBAAkB,GAAY,KAAK;IAIvC,IAAI,CAACkB,KAAK,GAAG,IAAIH,sBAAsB,CAAC,CAAC;IACzCC,iBAAiB,CAACG,SAAS,GAAG,IAAI;EACtC;EACAC,MAAMA,CAAA,EAAE;IACJ,IAAI,CAAC,IAAI,CAACF,KAAK,CAACpB,GAAG,CAACI,MAAM,EAAE,OAAOC,SAAS;IAC5C,IAAI,CAACH,kBAAkB,GAAG,KAAK;IAC/B,IAAIqB,IAAI,GAAG,IAAI,CAACH,KAAK,CAACpB,GAAG,CAACwB,GAAG,CAAE,CAACC,CAAC,EAAE/B,CAAC,KAAK,IAAI,CAACgC,aAAa,CAACD,CAAC,EAAE/B,CAAC,CAAC,CAAC;IAClE,oBAAOJ,OAAA;MAAKqC,SAAS,EAAE,0BAA0B,IAAG,IAAI,CAACzB,kBAAkB,IAAI,WAAW,CAAE;MAAA0B,QAAA,EAAEL;IAAI;MAAAM,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAM,CAAC;EAC7G;EACQN,aAAaA,CAAC1B,GAAgB,EAAEN,CAAS,EAAC;IAC9C,IAAI,CAACM,GAAG,EAAE,OAAOK,SAAS;IAC1B,IAAIL,GAAG,CAACE,kBAAkB,EAAE,IAAI,CAACA,kBAAkB,GAAG,IAAI;IAC1D,IAAI+B,OAAO,gBAAG3C,OAAA;MAAkBqC,SAAS,EAAE,iBAAiB,GAAG3B,GAAG,CAACM,IAAK;MAAC4B,OAAO,EAAGtC,CAAC,IAAG,IAAI,CAACsC,OAAO,CAACtC,CAAC,EAAEF,CAAC,CAAE;MAAAkC,QAAA,EAAE,IAAI,CAACR,KAAK,CAACpB;IAAG,GAAlGA,GAAG,CAACO,EAAE;MAAAsB,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAkG,CAAC;IACjI,OAAOC,OAAO;EAClB;EAEQC,OAAOA,CAACtC,CAAmC,EAAEF,CAAS,EAAE;IAC5D,IAAIE,CAAC,CAACuC,MAAM,KAAK,CAAC,EAAC;MAAE;MACjB,IAAI,CAACC,QAAQ,CAAC;QAACpC,GAAG,EAAC;MAAE,CAAC,CAAC;MACvB;IACJ;IACA,MAAMA,GAAG,GAAG,CAAC,GAAG,IAAI,CAACoB,KAAK,CAACpB,GAAG,CAAC;IAC/BA,GAAG,CAACqC,MAAM,CAAC3C,CAAC,EAAE,CAAC,CAAC;IAChB,IAAI,CAAC0C,QAAQ,CAAC;MAACpC;IAAG,CAAC,CAAC;EACxB;AACJ;AA/BakB,iBAAiB,CACZG,SAAS;AAgC3B,WACaiB,OAAO,IAAAC,IAAA,GADnBpD,iBAAiB,CAAC,SAAS,CAAC,EAAAoD,IAAA,CAAAC,MAAA,IAAAC,OAAA,GAA7B,MACaH,OAAO,SAASlD,sBAAsB,CAAC;EAGhD;EACA,OAAcsD,IAAIA,CAAC1C,GAAc,EAAE2C,IAAY,EAA+E;IAAA,IAA7ErC,IAAiB,GAAAH,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAE,SAAA,GAAAF,SAAA,MAAGZ,WAAW,CAACG,CAAC;IAAA,IAAEQ,kBAA2B,GAAAC,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAE,SAAA,GAAAF,SAAA,MAAG,KAAK;IACnH,MAAMyC,IAAI,GAAG,IAAI9C,WAAW,CAACE,GAAG,EAAE2C,IAAI,EAAEzC,kBAAkB,EAAEI,IAAI,CAAC;IACjEY,iBAAiB,CAACG,SAAS,CAACe,QAAQ,CAAC;MAACpC,GAAG,EAAC,CAAC,GAAGkB,iBAAiB,CAACG,SAAS,CAACD,KAAK,CAACpB,GAAG,EAAE4C,IAAI;IAAC,CAAC,CAAC;IAC5F,IAAIA,IAAI,CAAC3C,WAAW,GAAGQ,MAAM,CAACC,iBAAiB,EAAEmC,UAAU,CAAE,MAAIP,OAAO,CAACQ,IAAI,CAAC9C,GAAG,CAAC,EAAE4C,IAAI,CAAC3C,WAAW,CAAC;EACzG;EAEA,OAAc6C,IAAIA,CAAC9C,GAAe,EAAQ;IACtC,IAAI,CAACA,GAAG,EAAE;MACNkB,iBAAiB,CAACG,SAAS,CAACe,QAAQ,CAAC;QAACpC,GAAG,EAAE;MAAE,CAAC,CAAC;MAC/C;IACJ;IACA,IAAIuB,IAAI,GAAG,CAAC,GAAGL,iBAAiB,CAACG,SAAS,CAACD,KAAK,CAACpB,GAAG,CAAC;IACrDd,CAAC,CAAC6D,cAAc,CAACxB,IAAI,EAAEvB,GAAG,CAAC;IAC3B,IAAIuB,IAAI,CAACnB,MAAM,KAAKc,iBAAiB,CAACG,SAAS,CAACD,KAAK,CAACpB,GAAG,CAACI,MAAM,EAAE;IAClEc,iBAAiB,CAACG,SAAS,CAACe,QAAQ,CAAC;MAACpC,GAAG,EAACuB;IAAI,CAAC,CAAC;EACpD;AACJ,CAAC,EAAAkB,OAAA,CAnBUO,KAAK,GAAW,SAAS,EAAAP,OAAA,MAAAD,MAAA"},"metadata":{},"sourceType":"module"}