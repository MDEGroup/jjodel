{"ast":null,"code":"var _jsxFileName = \"C:\\\\0Programmi\\\\Dev\\\\projects\\\\frontend\\\\jjodel\\\\src\\\\components\\\\forEndUser\\\\Input.tsx\",\n  _s = $RefreshSig$();\nimport React, { useRef } from 'react';\nimport { connect } from 'react-redux';\nimport { Defaults, Keystrokes, LPointerTargetable, MultiSelect, store, U, UX } from '../../joiner';\nimport { useStateIfMounted } from 'use-state-if-mounted';\nimport './inputselect.scss';\nimport { Tooltip } from './Tooltip';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport function getSelectOptions_raw(data, field) {\n  if (!data) return [];\n  // console.log(\"select options\", {data, field, children, options});\n  let returns;\n  let primitives;\n  let classes;\n  let enumerators;\n  let objects;\n  let m2classname;\n  let hasPrimitives = false;\n  let hasReturnTypes = false;\n  let cname = data.className;\n  if (!field) switch (cname) {\n    case 'DAttribute':\n    case 'DReference':\n    case 'DOperation':\n    case 'DParameter':\n      field = 'type';\n      break;\n    case 'DValue':\n      field = 'values';\n      break;\n    case 'DClass':\n      field = 'extends';\n      break;\n  }\n  /*\r\n      let newmode = true;\r\n      if (newmode){\r\n          switch(field){\r\n              case 'extends': case 'type': return data.validTargetOptions;\r\n          }\r\n          return [];\r\n      }*/\n  switch (field) {\n    case 'type':\n      let model = data.model;\n      switch (cname) {\n        default:\n          break;\n        case 'DAttribute':\n          enumerators = model.enums;\n          hasPrimitives = true;\n          break;\n        case 'DReference':\n          classes = model.classes;\n          break;\n        case 'DOperation':\n          classes = model.classes;\n          enumerators = model.enums;\n          hasPrimitives = hasReturnTypes = true;\n          break;\n        case 'DParameter':\n          classes = model.classes;\n          enumerators = model.enums;\n          hasPrimitives = true;\n          break;\n      }\n      break;\n    case 'value':\n    case 'values':\n      if (cname !== 'DValue') break;\n      objects = data.validTargets;\n    /*\r\n    let m2: LReference | LAttribute | undefined = (data as LValue).instanceof;\r\n    if (!m2) {\r\n        objects = (data as LValue).model.allSubObjects;\r\n        break;\r\n    }\r\n    let dm2 = m2.__raw;\r\n    if (dm2.className === \"DAttribute\") break;\r\n    let type: LClass = m2.type as LClass;\r\n    if (!type) break;\r\n    m2classname = type.name;\r\n    let m1modelid = data.model.id;\r\n    objects = (type.allInstances || []).filter( o => o.model.id === m1modelid);*/\n  }\n  let state;\n  // todo: all this stuff might be better moved in mapstatetoprops, or the select list won't update properly.\n  if (hasPrimitives) {\n    if (!state) state = store.getState();\n    primitives = LPointerTargetable.fromPointer(state.primitiveTypes);\n  }\n  if (hasReturnTypes) {\n    if (!state) state = store.getState();\n    returns = LPointerTargetable.fromPointer(state.returnTypes);\n  }\n\n  // console.log(\"select options\", {data, field, returns, primitives, classes, enumerators});\n\n  let ret = [];\n  if (returns && returns.length) ret.push({\n    label: 'Defaults',\n    options: returns.map((r, i) => ({\n      value: r.id,\n      label: r.name\n    }))\n  });\n  if (primitives && primitives.length) ret.push({\n    label: 'Primitives',\n    options: primitives.map((r, i) => ({\n      value: r.id,\n      label: r.name\n    }))\n  });\n  if (enumerators && enumerators.length) ret.push({\n    label: 'Enumerators',\n    options: enumerators.map((r, i) => ({\n      value: r.id,\n      label: r.name\n    }))\n  });\n  if (classes && classes.length) ret.push({\n    label: 'Classes',\n    options: classes.map((r, i) => ({\n      value: r.id,\n      label: r.name\n    }))\n  });\n  if (objects && objects.length) ret.push({\n    label: m2classname ? 'Instances of ' + m2classname : \"All objects\",\n    options: [{\n      value: undefined,\n      label: '_empty_'\n    }, ...objects.map((r, i) => ({\n      value: r.id,\n      label: r.name\n    }))]\n  });\n  return ret;\n}\nexport function getSelectOptions(data, field, options, children) {\n  if (options) return options;\n  // children is auto-filled to empty array even if it is not set explicitly in jsx\n  if (Array.isArray(children) && children.length > 0) return children;\n  let ret;\n  let newmode = true;\n  if (newmode) {\n    switch (field) {\n      case 'extends':\n      case 'type':\n        ret = data.validTargetJSX;\n        break;\n    }\n    return [];\n  }\n  if (ret) return ret;\n  ret = getSelectOptions_raw(data, field); // old to remove?\n  return selectOptionsToJSX(ret);\n}\nfunction selectOptionsToJSX(ret) {\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: ret.map(optgrp => /*#__PURE__*/_jsxDEV(\"optgroup\", {\n      label: optgrp.label,\n      children: optgrp.options.map((e, i) => /*#__PURE__*/_jsxDEV(\"option\", {\n        value: e.value,\n        children: e.label\n      }, i, false, {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 46\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 31\n    }, this)).filter(e => !!e)\n  }, void 0, false);\n}\nexport function InputComponent(props) {\n  _s();\n  var _data;\n  const data = props.data;\n  const getter = props.getter;\n  const setter = props.setter;\n  const field = props.field;\n  const oldValue = getter ? getter(data, field) : data ? data[field] : undefined; // !== undefined); ? data[field] : 'undefined'\n  let [value, setValue] = useStateIfMounted(oldValue);\n  const [isTouched, setIsTouched] = useStateIfMounted(false);\n  const inputRef = useRef(null);\n  if (props.tag === 'select') value = oldValue; // select does not use state.\n  let serializeValue = function (val) {\n    let maxDepth = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;\n    let currDepth = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n    if (Array.isArray(val)) {\n      if (props.isMultiSelect && currDepth < maxDepth) {\n        // return val.map(e => serializeValue(e, maxDepth, currDepth + 1)) as PrimitiveType[];\n        return val.map(e => (e === null || e === void 0 ? void 0 : e.id) || e);\n      }\n      if (currDepth < maxDepth) return serializeValue(val[0], maxDepth, currDepth + 1);else return undefined;\n    }\n    return (val === null || val === void 0 ? void 0 : val.id) || val;\n  };\n  function valueDidChange(v1, v2) {\n    return serializeValue(v1) !== serializeValue(v2);\n    /*\r\n    let rawv1 = v1?.__raw || v1;\r\n    let rawv2 = v2?.__raw || v2;\r\n    if (rawv1 !== v1 || rawv2 !== v2) { return v1?.clonedCounter !== v2?.clonedCounter; }\r\n    return v1 !== v2;*/\n  }\n\n  // I check if the value that I have in my local state is being edited by other <Input />\n  if (props.tag !== 'select' && !isTouched && valueDidChange(value, oldValue)) {\n    setValue(serializeValue(oldValue));\n    setIsTouched(false);\n  }\n  if (!(data && field || getter && setter)) return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: \"Either props.data & field or both getter & setter are required.\"\n  }, void 0, false);\n  let readOnly;\n  if (props.readonly !== undefined) readOnly = props.readonly;\n  // else if (props.disabled !== undefined) readOnly = props.disabled;\n  else readOnly = props.debugmodee !== 'true' && Defaults.check(data === null || data === void 0 ? void 0 : data.id);\n  let type = props.type ? props.type : 'text';\n  let subtype = type;\n  switch (type) {\n    case 'toggle':\n      type = 'checkbox';\n      subtype = 'switch';\n      break;\n    case 'checkbox3':\n    case 'switch':\n      type = 'checkbox';\n      break;\n    case 'slider':\n      type = 'range';\n      break;\n  }\n  let label = props.jsxLabel || props.label;\n  let postlabel = props.postlabel;\n  let tooltip = (props.tooltip === true ? data === null || data === void 0 ? void 0 : (_data = data['__info_of__' + field]) === null || _data === void 0 ? void 0 : _data.txt : props.tooltip) || '';\n  let css = ''; //'my-auto input ';\n  //css += (jsxLabel) ? 'ms-1' : (label) ? 'ms-auto' : '';\n  css += props.hidden ? ' hidden-input' : '';\n  let autosize = props.autosize === undefined ? false : props.autosize; // props.type==='text'\n  css += autosize ? ' autosize-input' : '';\n  const isBoolean = ['checkbox', 'radio'].includes(type);\n  const onChange = evt => {\n    var _onChange, _ref;\n    (_onChange = (_ref = props).onChange) === null || _onChange === void 0 ? void 0 : _onChange.call(_ref, evt);\n    if (readOnly) return;\n    if (isBoolean) {\n      let target = evt.target.checked;\n      if (subtype === 'checkbox3' && !value) {\n        target = undefined;\n      }\n      if (setter) setter(target, data, field);else data[field] = target;\n      setValue(target);\n      return;\n    }\n    if (props.tag === \"select\") {\n      confirmValue(evt);\n    } else {\n      //console.log(\"setValue\", {value, nv: getValueFromEvent(evt), evt, ev: evt.target.value});\n      setValue(getValueFromEvent(evt));\n      setIsTouched(true); // I'm editing the element in my local state.\n      // the actual set is done in onBlur\n    }\n  };\n  const onKeyDown = evt => {\n    var _onKeyDown, _ref2;\n    (_onKeyDown = (_ref2 = props).onKeyDown) === null || _onKeyDown === void 0 ? void 0 : _onKeyDown.call(_ref2, evt);\n    if (props.tag === 'select') return;\n    if (evt.key === Keystrokes.enter) confirmValue(evt);\n    if (evt.key === Keystrokes.escape) {\n      const oldValue = getter ? getter(data, field) : data[field];\n      writeHtmlValueFromEvent(evt, oldValue);\n      setValue(serializeValue(oldValue));\n      setIsTouched(false);\n      evt.target.blur();\n      // to optimize: probably can remove a large part of this function because this should trigger blur event as well. or move \"change\" event contents here\n      // optimize 2: memoize the whole component, so it won't update unless the displayed value changed. this would also fix cursor going to input end when pressing enter.\n    }\n  };\n  const getValueFromEvent = evt => {\n    switch (props.tag) {\n      case \"textarea\":\n      case \"input\":\n      case \"select\":\n      case \"\":\n      case null:\n      case undefined:\n        return evt.target.value;\n      default:\n        return evt.target.innerText;\n    }\n  };\n  const writeHtmlValueFromEvent = (evt, value) => {\n    value = serializeValue(value);\n    switch (props.tag) {\n      case \"textarea\":\n      case \"input\":\n      case \"select\":\n      case \"\":\n      case null:\n      case undefined:\n        return evt.target.value = value;\n      default:\n        return evt.target.innerText = value;\n    }\n  };\n  const onBlur = evt => {\n    var _onBlur, _ref3;\n    (_onBlur = (_ref3 = props).onBlur) === null || _onBlur === void 0 ? void 0 : _onBlur.call(_ref3, evt);\n    if (props.tag === 'select') return;\n    confirmValue(evt);\n  };\n  const confirmValue = (evt, val) => {\n    if (readOnly || isBoolean) return;\n    const newValue = val || evt && getValueFromEvent(evt);\n    const oldValue = getter ? getter(data, field) : data[field];\n    console.log(\"onChange confirm\", {\n      evt,\n      newValue,\n      oldValue,\n      field,\n      changed: valueDidChange(newValue, oldValue),\n      readOnly,\n      isBoolean,\n      setter,\n      nnv: serializeValue(newValue)\n    });\n    if (valueDidChange(newValue, oldValue)) {\n      if (setter) setter(newValue, data, field);else data[field] = serializeValue(newValue);\n    }\n    // I terminate my editing, so I communicate it to other <Input /> that render the same field.\n    setIsTouched(false);\n  };\n  const otherprops = {\n    ...props\n  };\n  delete otherprops.data;\n  delete otherprops.field;\n  delete otherprops.getter;\n  delete otherprops.setter;\n  delete otherprops.label;\n  delete otherprops.postlabel;\n  delete otherprops.jsxLabel;\n  delete otherprops.tooltip;\n  delete otherprops.hidden;\n  delete otherprops.inputStyle;\n  delete otherprops.children;\n  delete otherprops.autosize; // because react complains is bool in dom attribute or unknown attrib name\n\n  let checked = undefined;\n  if (isBoolean) checked = typeof value === \"boolean\" ? value : typeof value === \"string\" ? U.fromBoolString(value) : !!value;\n  let cursor;\n  if (tooltip) cursor = 'help';else if (readOnly) cursor = 'not-allowed';else if (isBoolean) cursor = 'pointer';else cursor = 'auto';\n  let inputProps = {\n    ...otherprops,\n    className: [props.inputClassName || '', css].join(' '),\n    style: props.inputStyle || {},\n    spellCheck: props.spellCkeck || false,\n    readOnly,\n    disabled: readOnly,\n    type,\n    value: serializeValue(value),\n    checked,\n    onChange,\n    onBlur,\n    onKeyDown\n  }; // key:`${field}.${data?.id}`\n  if (!inputProps.style.cursor && cursor === 'not-allowed') {\n    inputProps.style.cursor = cursor;\n  }\n  switch (subtype) {\n    case 'checkbox3':\n    case 'switch':\n    case 'slider':\n      inputProps.className += ' ' + subtype + (oldValue === undefined ? 'undetermined' : '');\n      break;\n    default:\n      break;\n  }\n  let input;\n  let rootprops = {\n    className: otherprops.className || '',\n    style: otherprops.style || {}\n  };\n  switch (typeof rootprops.ref) {\n    default:\n      rootprops.ref = inputRef;\n      break;\n    case \"object\":\n      let oldref = rootprops.ref;\n      rootprops.ref = v => {\n        oldref.current = inputRef.current = v;\n      };\n      break;\n    case \"function\":\n      let oldreff = rootprops.ref;\n      rootprops.ref = v => {\n        oldreff(v);\n        inputRef.current = v;\n      };\n      break;\n  }\n  if (props.autosize) rootprops['data-value'] = inputProps.value;\n  if (tooltip) {\n    rootprops.onMouseEnter = () => {\n      var _rootprops$ref;\n      return Tooltip.show(tooltip, 'b', ((_rootprops$ref = rootprops.ref) === null || _rootprops$ref === void 0 ? void 0 : _rootprops$ref.current) || rootprops.ref);\n    };\n    rootprops.onMouseLeave = () => Tooltip.hide();\n  }\n  /*let rootkeys = new Set(...Object.keys(rootprops));\r\n  //  merge events: might want to distinguish which events are merged between root and input and which not.\r\n  //  onChange surely needs merge. onMouseHover might not to let it trigger on label too.\r\n  for (let k of rootkeys) {\r\n      if (!(k[0] === 'o' && k[1] === 'n' && k[2] && k[2].toUpperCase() === k[2])) continue;\r\n      if (inputProps[k]) inputProps[k] = function(...a:any) { inputProps[k](arguments); rootprops[k](arguments); }\r\n      else inputProps[k] = rootprops[k];\r\n      delete rootprops[k];\r\n  }*/\n\n  let wrap = true;\n  if (autosize) rootprops.className = (rootprops.className || '') + ' autosize-input-container';else if (!label && !postlabel && !props.isMultiSelect) {\n    if (rootprops.className) inputProps.className = rootprops.className + ' ' + inputProps.className;\n    if (rootprops.style) U.objectMergeInPlace(inputProps.style, rootprops.style);\n    inputProps = {\n      ...rootprops,\n      ...inputProps\n    };\n    wrap = false;\n  }\n  switch (props.tag) {\n    case \"textarea\":\n      input = /*#__PURE__*/_jsxDEV(\"textarea\", {\n        ...inputProps,\n        children: inputProps.value\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 330,\n        columnNumber: 34\n      }, this);\n      break;\n    case \"select\":\n      if (props.isMultiSelect) {\n        let options = props.options || getSelectOptions_raw(data, field);\n        let multiOptions = options;\n        console.log('setting multiselect pre', {\n          multiOptions,\n          value,\n          ivalue: inputProps.value,\n          options,\n          data,\n          df: data[field],\n          field\n        });\n        let valuesMap = U.objectFromArrayValues(inputProps.value || []);\n        delete valuesMap[undefined];\n        inputProps.value = [];\n        for (let optgrp of multiOptions) for (let opt of optgrp.options) if (valuesMap[opt.value]) inputProps.value.push(opt);\n        // rootprops.className = (rootprops.className || '') + ' clearfix';\n        let old = {\n          ...rootprops\n        };\n        rootprops.onMouseMove = e => {\n          var _old$onMouseMove;\n          UX.stopEvt(e);\n          (_old$onMouseMove = old.onMouseMove) === null || _old$onMouseMove === void 0 ? void 0 : _old$onMouseMove.call(old);\n          console.log('multiselect onmove');\n        };\n        /*rootprops.onMouseDown = (e:any) => { UX.stopEvt(e); old.onMouseDown?.(); console.log('multiselect onMouseDown'); };\r\n        rootprops.onMouseUp = (e:any) => { UX.stopEvt(e); old.onMouseUp?.(); console.log('multiselect onMouseUp'); };\r\n        rootprops.onClick = (e:any) => { UX.stopEvt(e); old.onClick?.(); console.log('multiselect onClick'); };\r\n        rootprops.onMouseLeave = (e:any) => { UX.stopEvt(e); old.onMouseLeave?.(); console.log('multiselect onMouseLeave'); };*/\n        // @ts-ignore\n        input = /*#__PURE__*/_jsxDEV(MultiSelect, {\n          ...inputProps,\n          isMulti: true,\n          options: options,\n          onChange: v0 => {\n            let v = v0.map(v => v.value);\n            confirmValue(undefined, v);\n            console.log('setting multiselect onchange', {\n              v,\n              v0,\n              value,\n              ivalue: inputProps.value,\n              options\n            });\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 348,\n          columnNumber: 25\n        }, this);\n      } else {\n        let options = getSelectOptions(data, field, props.options, props.children);\n        input = /*#__PURE__*/_jsxDEV(\"select\", {\n          ...inputProps,\n          children: options\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 358,\n          columnNumber: 25\n        }, this);\n      }\n      break;\n    case null:\n    case undefined:\n    case \"\":\n    case \"input\":\n      input = /*#__PURE__*/_jsxDEV(\"input\", {\n        ...inputProps\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 361,\n        columnNumber: 67\n      }, this);\n      break;\n    default:\n      inputProps.contentEditable = inputProps.contentEditable !== false;\n      input = /*#__PURE__*/React.createElement(props.tag, inputProps, props.children);\n      break;\n  }\n  if (!wrap) return input;\n  if (typeof label === \"string\") label = /*#__PURE__*/_jsxDEV(\"span\", {\n    children: label\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 368,\n    columnNumber: 44\n  }, this);\n  if (typeof postlabel === \"string\") postlabel = /*#__PURE__*/_jsxDEV(\"span\", {\n    children: postlabel\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 369,\n    columnNumber: 52\n  }, this);\n  const openSelect = e => {\n    /*\r\n    tried to make label click open the select but does not work easily in js, a solution was here but with css padding.\r\n    https://stackoverflow.com/questions/15249958/once-i-click-on-label-select-button-should-get-open\r\n    */\n    if (props.tag !== \"select\") return;\n    let t = e.target;\n    let select = t.tagName === 'select' ? t : t.querySelector('select');\n    console.log(\"click select root\", {\n      t,\n      select\n    });\n    select === null || select === void 0 ? void 0 : select.click();\n  };\n  return /*#__PURE__*/_jsxDEV(\"label\", {\n    className: 'input-container',\n    ...rootprops,\n    children: [label || undefined, input, postlabel || undefined]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 382,\n    columnNumber: 12\n  }, this);\n  /*\r\n  return(<label className={'p-1'} {...otherprops}\r\n                style={rootStyle}>\r\n        {label && <span className={'my-auto'} onMouseEnter={e => setShowTooltip(true)}\r\n                      onMouseLeave={e => setShowTooltip(false)}>{label}\r\n      </span>}\r\n        {jsxLabel && <span onMouseEnter={e => setShowTooltip(true)}\r\n                         onMouseLeave={e => setShowTooltip(false)} style={{width: '100%'}}>{jsxLabel}\r\n      </span>}\r\n        {(tooltip && showTooltip) && <div className={'my-tooltip'}>\r\n          <b className={'text-center text-capitalize'}>{field}</b>\r\n          <br />\r\n          <label>{tooltip}</label>\r\n      </div>}\r\n        {autosize ? <div className={(autosize ? 'autosize-input-container' : '') + (props.asLabel ? ' labelstyle' : '')}\r\n                       data-value={value}>{input}\r\n      </div> : input}\r\n  </label>);\r\n  */\n}\n_s(InputComponent, \"nlzZzFhpjnEHW6d8jEzTV191MA8=\", false, function () {\n  return [useStateIfMounted, useStateIfMounted];\n});\n_c = InputComponent;\nexport function InputMapStateToProps(state, ownProps) {\n  var _ownProps$data;\n  const ret = {};\n  const pointer = typeof ownProps.data === 'string' ? ownProps.data : (_ownProps$data = ownProps.data) === null || _ownProps$data === void 0 ? void 0 : _ownProps$data.id;\n  ret.debugmodee = state.debug ? 'true' : 'false';\n  if (pointer) ret.data = LPointerTargetable.fromPointer(pointer);\n  return ret;\n}\n_c2 = InputMapStateToProps;\nfunction mapDispatchToProps(dispatch) {\n  const ret = {};\n  return ret;\n}\nexport const InputConnected =\n// @ts-ignore\nconnect(InputMapStateToProps, mapDispatchToProps)(InputComponent);\n\n// export function Input(props: InputOwnProps, children: (string | React.Component)[] = []): ReactElement { return 'input' as any; }\nexport function Input(props) {\n  // @ts-ignore\n  return /*#__PURE__*/_jsxDEV(InputConnected, {\n    ...props,\n    children: props.children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 474,\n    columnNumber: 12\n  }, this);\n}\n\n// export function TextArea(props: InputOwnProps, children: (string | React.Component)[] = []): ReactElement { return 'textarea' as any; }\n_c3 = Input;\nexport function TextArea(props, c) {\n  // @ts-ignore\n  return /*#__PURE__*/_jsxDEV(InputConnected, {\n    ...props,\n    tag: \"textarea\",\n    children: props.children || c\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 480,\n    columnNumber: 12\n  }, this);\n}\n//export function Select(props: SelectOwnProps, children: (string | React.Component)[] = []): ReactElement { return 'select' as any; }\n_c4 = TextArea;\nexport function Select(props, c) {\n  // @ts-ignore\n  return /*#__PURE__*/_jsxDEV(InputConnected, {\n    ...props,\n    tag: \"select\",\n    children: props.children || c\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 485,\n    columnNumber: 12\n  }, this);\n}\n_c5 = Select;\nexport const Edit = Input;\n\n// @ts-ignore\nInputComponent.cname = 'InputComponent';\n// @ts-ignore\nInputConnected.cname = 'InputConnected';\nInput.cname = 'Input';\nTextArea.cname = 'TextArea';\nSelect.cname = 'Select';\nEdit.cname = 'Edit';\nvar _c, _c2, _c3, _c4, _c5;\n$RefreshReg$(_c, \"InputComponent\");\n$RefreshReg$(_c2, \"InputMapStateToProps\");\n$RefreshReg$(_c3, \"Input\");\n$RefreshReg$(_c4, \"TextArea\");\n$RefreshReg$(_c5, \"Select\");","map":{"version":3,"names":["React","useRef","connect","Defaults","Keystrokes","LPointerTargetable","MultiSelect","store","U","UX","useStateIfMounted","Tooltip","jsxDEV","_jsxDEV","Fragment","_Fragment","getSelectOptions_raw","data","field","returns","primitives","classes","enumerators","objects","m2classname","hasPrimitives","hasReturnTypes","cname","className","model","enums","validTargets","state","getState","fromPointer","primitiveTypes","returnTypes","ret","length","push","label","options","map","r","i","value","id","name","undefined","getSelectOptions","children","Array","isArray","newmode","validTargetJSX","selectOptionsToJSX","optgrp","e","fileName","_jsxFileName","lineNumber","columnNumber","filter","InputComponent","props","_s","_data","getter","setter","oldValue","setValue","isTouched","setIsTouched","inputRef","tag","serializeValue","val","maxDepth","arguments","currDepth","isMultiSelect","valueDidChange","v1","v2","readOnly","readonly","debugmodee","check","type","subtype","jsxLabel","postlabel","tooltip","txt","css","hidden","autosize","isBoolean","includes","onChange","evt","_onChange","_ref","call","target","checked","confirmValue","getValueFromEvent","onKeyDown","_onKeyDown","_ref2","key","enter","escape","writeHtmlValueFromEvent","blur","innerText","onBlur","_onBlur","_ref3","newValue","console","log","changed","nnv","otherprops","inputStyle","fromBoolString","cursor","inputProps","inputClassName","join","style","spellCheck","spellCkeck","disabled","input","rootprops","ref","oldref","v","current","oldreff","onMouseEnter","_rootprops$ref","show","onMouseLeave","hide","wrap","objectMergeInPlace","multiOptions","ivalue","df","valuesMap","objectFromArrayValues","opt","old","onMouseMove","_old$onMouseMove","stopEvt","isMulti","v0","contentEditable","createElement","openSelect","t","select","tagName","querySelector","click","_c","InputMapStateToProps","ownProps","_ownProps$data","pointer","debug","_c2","mapDispatchToProps","dispatch","InputConnected","Input","_c3","TextArea","c","_c4","Select","_c5","Edit","$RefreshReg$"],"sources":["C:/0Programmi/Dev/projects/frontend/jjodel/src/components/forEndUser/Input.tsx"],"sourcesContent":["import React, {Dispatch, KeyboardEvent, LegacyRef, ReactElement, ReactNode, useRef} from 'react';\r\nimport {connect} from 'react-redux';\r\nimport {DState} from '../../redux/store';\r\nimport {\r\n    Any,\r\n    Defaults,\r\n    DObject,\r\n    DPointerTargetable,\r\n    GObject,\r\n    Keystrokes, LAttribute,\r\n    LClass, LEnumerator, LEnumLiteral, LModel, LObject,\r\n    LPointerTargetable, LReference, LValue, MultiSelect, MultiSelectOptGroup,\r\n    MultiSelectOption,\r\n    Overlap,\r\n    Pointer, PrimitiveType, Selectors,\r\n    store,\r\n    U,\r\n    UX\r\n} from '../../joiner';\r\nimport {useStateIfMounted} from 'use-state-if-mounted';\r\nimport './inputselect.scss';\r\nimport { Tooltip } from './Tooltip';\r\n\r\n\r\nexport function getSelectOptions_raw(data: LPointerTargetable, field: string): MultiSelectOptGroup[] {\r\n    if (!data) return [];\r\n    // console.log(\"select options\", {data, field, children, options});\r\n    let returns: LClass[] | undefined;\r\n    let primitives: LClass[] | undefined;\r\n    let classes: LClass[] | undefined;\r\n    let enumerators: LEnumerator[] | undefined;\r\n    let objects: (LObject | LEnumLiteral)[] | undefined;\r\n    let m2classname: string | undefined;\r\n    let hasPrimitives: boolean = false;\r\n    let hasReturnTypes: boolean = false;\r\n    let cname = data.className;\r\n    if (!field) switch(cname) {\r\n        case 'DAttribute':  case 'DReference': case 'DOperation': case 'DParameter': field = 'type'; break;\r\n        case 'DValue': field = 'values'; break;\r\n        case 'DClass': field = 'extends'; break;\r\n    }\r\n/*\r\n    let newmode = true;\r\n    if (newmode){\r\n        switch(field){\r\n            case 'extends': case 'type': return data.validTargetOptions;\r\n        }\r\n        return [];\r\n    }*/\r\n    switch(field) {\r\n        case 'type':\r\n            let model = data.model;\r\n            switch (cname) {\r\n                default: break;\r\n                case 'DAttribute': enumerators = model.enums; hasPrimitives = true; break;\r\n                case 'DReference': classes = model.classes; break;\r\n                case 'DOperation': classes = model.classes; enumerators = model.enums; hasPrimitives = hasReturnTypes = true; break;\r\n                case 'DParameter': classes = model.classes; enumerators = model.enums; hasPrimitives = true; break;\r\n            }\r\n            break;\r\n        case 'value': case 'values':\r\n            if (cname !== 'DValue') break;\r\n            objects = (data as LValue).validTargets;\r\n            /*\r\n            let m2: LReference | LAttribute | undefined = (data as LValue).instanceof;\r\n            if (!m2) {\r\n                objects = (data as LValue).model.allSubObjects;\r\n                break;\r\n            }\r\n            let dm2 = m2.__raw;\r\n            if (dm2.className === \"DAttribute\") break;\r\n            let type: LClass = m2.type as LClass;\r\n            if (!type) break;\r\n            m2classname = type.name;\r\n            let m1modelid = data.model.id;\r\n            objects = (type.allInstances || []).filter( o => o.model.id === m1modelid);*/\r\n    }\r\n    let state: DState | undefined;\r\n    // todo: all this stuff might be better moved in mapstatetoprops, or the select list won't update properly.\r\n    if (hasPrimitives) {\r\n        if (!state) state = store.getState();\r\n        primitives = LPointerTargetable.fromPointer(state.primitiveTypes);\r\n    }\r\n    if (hasReturnTypes) {\r\n        if (!state) state = store.getState();\r\n        returns = LPointerTargetable.fromPointer(state.returnTypes);\r\n    }\r\n\r\n    // console.log(\"select options\", {data, field, returns, primitives, classes, enumerators});\r\n\r\n    let ret:MultiSelectOptGroup[] = [];\r\n    if (returns && returns.length) ret.push({label: 'Defaults', options: returns.map((r, i)=>({value: r.id, label:r.name}))});\r\n    if (primitives && primitives.length) ret.push({label: 'Primitives', options: primitives.map((r, i)=>({value: r.id, label:r.name}))});\r\n    if (enumerators && enumerators.length) ret.push({label: 'Enumerators', options: enumerators.map((r, i)=>({value: r.id, label:r.name}))});\r\n    if (classes && classes.length) ret.push({label: 'Classes', options: classes.map((r, i)=>({value: r.id, label:r.name}))});\r\n    if (objects && objects.length) ret.push({label: m2classname ? 'Instances of ' + m2classname : \"All objects\", options:\r\n            [{value: undefined as any, label: '_empty_'}, ...objects.map((r, i)=>({value: r.id, label:r.name}))]});\r\n    return ret;\r\n}\r\nexport function getSelectOptions(data: LPointerTargetable, field: string, options: ReactNode, children?: ReactNode): ReactNode {\r\n    if (options) return options;\r\n    // children is auto-filled to empty array even if it is not set explicitly in jsx\r\n    if (Array.isArray(children) && children.length > 0) return children;\r\n    let ret: ReactNode | undefined;\r\n    let newmode = true;\r\n    if (newmode){\r\n        switch(field){\r\n            case 'extends': case 'type': ret = (data as any).validTargetJSX; break;\r\n        }\r\n        return [];\r\n    }\r\n    if (ret) return ret;\r\n    ret = getSelectOptions_raw(data, field); // old to remove?\r\n    return selectOptionsToJSX(ret);\r\n}\r\nfunction selectOptionsToJSX(ret: MultiSelectOptGroup[]): ReactNode{\r\n    return(\r\n        <>{\r\n            ret.map(optgrp => <optgroup label={optgrp.label}>{\r\n                optgrp.options.map((e, i) => <option key={i} value={e.value}>{e.label}</option>)\r\n            }</optgroup>).filter(e=>!!e)\r\n        }</>);\r\n}\r\n\r\nexport function InputComponent(props: AllProps) {\r\n    const data = props.data;\r\n    const getter = props.getter;\r\n    const setter = props.setter;\r\n    const field: string = props.field as string;\r\n    const oldValue: PrimitiveType | PrimitiveType[] | LPointerTargetable = (getter) ? getter(data, field) : (data ? data[field] : undefined); // !== undefined); ? data[field] : 'undefined'\r\n    let [value, setValue] = useStateIfMounted<PrimitiveType | PrimitiveType[] | LPointerTargetable>(oldValue);\r\n\r\n    const [isTouched, setIsTouched] = useStateIfMounted(false);\r\n    const inputRef = useRef<Element | null>(null);\r\n    if (props.tag === 'select') value = oldValue; // select does not use state.\r\n    let serializeValue = (val: LPointerTargetable | PrimitiveType | PrimitiveType[], maxDepth=1, currDepth = 0): string | PrimitiveType | PrimitiveType[] => {\r\n        if (Array.isArray(val)) {\r\n            if (props.isMultiSelect && currDepth < maxDepth) {\r\n                // return val.map(e => serializeValue(e, maxDepth, currDepth + 1)) as PrimitiveType[];\r\n                return val.map(e => (e as any)?.id||e) as PrimitiveType[];\r\n            }\r\n            if (currDepth < maxDepth) return serializeValue(val[0], maxDepth, currDepth + 1);\r\n            else return undefined;\r\n        }\r\n        return (val as LPointerTargetable)?.id || (val as any);\r\n    };\r\n\r\n    function valueDidChange(v1: any, v2: any): boolean {\r\n        return serializeValue(v1) !== serializeValue(v2);\r\n        /*\r\n        let rawv1 = v1?.__raw || v1;\r\n        let rawv2 = v2?.__raw || v2;\r\n        if (rawv1 !== v1 || rawv2 !== v2) { return v1?.clonedCounter !== v2?.clonedCounter; }\r\n        return v1 !== v2;*/\r\n    }\r\n\r\n    // I check if the value that I have in my local state is being edited by other <Input />\r\n    if (props.tag !== 'select' && !isTouched && valueDidChange(value, oldValue)){\r\n        setValue(serializeValue(oldValue));\r\n        setIsTouched(false);\r\n    }\r\n\r\n\r\n    if (!((data && field) || (getter && setter))) return(<>Either props.data & field or both getter & setter are required.</>);\r\n    let readOnly: boolean;\r\n    if (props.readonly !== undefined) readOnly = props.readonly;\r\n    // else if (props.disabled !== undefined) readOnly = props.disabled;\r\n    else readOnly = props.debugmodee !== 'true' && Defaults.check(data?.id)\r\n\r\n    let type = (props.type) ? props.type : 'text';\r\n    let subtype: string = type;\r\n    switch (type) {\r\n        case 'toggle': type = 'checkbox'; subtype = 'switch'; break;\r\n        case 'checkbox3': case 'switch': type = 'checkbox'; break;\r\n        case 'slider': type = 'range'; break;\r\n    }\r\n    let label: ReactNode | undefined = props.jsxLabel || props.label;\r\n    let postlabel: ReactNode | undefined = props.postlabel;\r\n    let tooltip: ReactNode|string|undefined = ((props.tooltip === true) ? data?.['__info_of__' + field]?.txt : props.tooltip) || '';\r\n\r\n    let css = '';//'my-auto input ';\r\n    //css += (jsxLabel) ? 'ms-1' : (label) ? 'ms-auto' : '';\r\n    css += (props.hidden) ? ' hidden-input' : '';\r\n    let autosize: boolean = props.autosize === undefined ? false : props.autosize; // props.type==='text'\r\n    css += autosize ? ' autosize-input' : '';\r\n    const isBoolean = (['checkbox', 'radio'].includes(type));\r\n\r\n\r\n    const onChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\r\n        (props as any).onChange?.(evt);\r\n        if (readOnly) return;\r\n        if (isBoolean) {\r\n            let target = evt.target.checked;\r\n            if (subtype === 'checkbox3' && !value) { target = undefined as any; }\r\n            if (setter) setter(target, data, field);\r\n            else data[field] = target;\r\n            setValue(target);\r\n            return;\r\n        }\r\n        if (props.tag === \"select\") {\r\n            confirmValue(evt as any);\r\n        } else {\r\n            //console.log(\"setValue\", {value, nv: getValueFromEvent(evt), evt, ev: evt.target.value});\r\n            setValue(getValueFromEvent(evt));\r\n            setIsTouched(true);     // I'm editing the element in my local state.\r\n            // the actual set is done in onBlur\r\n        }\r\n    }\r\n    const onKeyDown = (evt: React.KeyboardEvent<HTMLInputElement>) => {\r\n        (props as any).onKeyDown?.(evt);\r\n        if (props.tag === 'select') return;\r\n        if (evt.key === Keystrokes.enter) confirmValue(evt as any);\r\n        if (evt.key === Keystrokes.escape) {\r\n            const oldValue = getter ? getter(data, field) : data[field];\r\n            writeHtmlValueFromEvent(evt as any, oldValue);\r\n            setValue(serializeValue(oldValue));\r\n            setIsTouched(false);\r\n            (evt.target as HTMLInputElement).blur();\r\n            // to optimize: probably can remove a large part of this function because this should trigger blur event as well. or move \"change\" event contents here\r\n            // optimize 2: memoize the whole component, so it won't update unless the displayed value changed. this would also fix cursor going to input end when pressing enter.\r\n        }\r\n    }\r\n    const getValueFromEvent = (evt: { target: HTMLInputElement | HTMLSelectElement | HTMLTextAreaElement }) => {\r\n        switch (props.tag){\r\n            case \"textarea\": case \"input\": case \"select\": case \"\": case null: case undefined: return evt.target.value;\r\n            default: return evt.target.innerText;\r\n        }\r\n    }\r\n    const writeHtmlValueFromEvent = (evt: { target: HTMLInputElement | HTMLSelectElement | HTMLTextAreaElement }, value: any) => {\r\n        value = serializeValue(value);\r\n        switch (props.tag){\r\n            case \"textarea\": case \"input\": case \"select\": case \"\": case null: case undefined: return evt.target.value = value;\r\n            default: return evt.target.innerText = value;\r\n        }\r\n    }\r\n\r\n    const onBlur = (evt: { target: HTMLInputElement | HTMLSelectElement | HTMLTextAreaElement }) => {\r\n        (props as any).onBlur?.(evt);\r\n        if (props.tag === 'select') return;\r\n        confirmValue(evt);\r\n    }\r\n    const confirmValue = (evt: { target: HTMLInputElement | HTMLSelectElement | HTMLTextAreaElement }|undefined, val?: PrimitiveType|PrimitiveType[]) => {\r\n        if (readOnly || isBoolean) return;\r\n        const newValue = val || (evt && getValueFromEvent(evt));\r\n        const oldValue = getter ? getter(data, field) : data[field];\r\n        console.log(\"onChange confirm\", {evt, newValue, oldValue, field, changed: valueDidChange(newValue, oldValue), readOnly, isBoolean, setter, nnv:serializeValue(newValue)});\r\n        if (valueDidChange(newValue, oldValue)){\r\n            if (setter) setter(newValue as any, data, field);\r\n            else data[field] = serializeValue(newValue);\r\n        }\r\n        // I terminate my editing, so I communicate it to other <Input /> that render the same field.\r\n        setIsTouched(false);\r\n    }\r\n\r\n    const otherprops: GObject = {...props};\r\n    delete otherprops.data;\r\n    delete otherprops.field;\r\n    delete otherprops.getter;\r\n    delete otherprops.setter;\r\n    delete otherprops.label;\r\n    delete otherprops.postlabel;\r\n    delete otherprops.jsxLabel;\r\n    delete otherprops.tooltip;\r\n    delete otherprops.hidden;\r\n    delete otherprops.inputStyle;\r\n    delete otherprops.children;\r\n    delete otherprops.autosize; // because react complains is bool in dom attribute or unknown attrib name\r\n\r\n    let checked: boolean | undefined = undefined;\r\n    if (isBoolean) checked = typeof value === \"boolean\" ? value : (typeof value === \"string\" ? U.fromBoolString(value) : !!value);\r\n\r\n    let cursor: string;\r\n    if (tooltip) cursor = 'help';\r\n    else if (readOnly) cursor = 'not-allowed';\r\n    else if (isBoolean) cursor = 'pointer';\r\n    else cursor = 'auto';\r\n\r\n    let inputProps: GObject = {...otherprops,\r\n        className: [props.inputClassName||'', css].join(' '),\r\n        style: (props.inputStyle || {}),\r\n        spellCheck: (props as any).spellCkeck || false, readOnly, disabled: readOnly, type,\r\n        value: serializeValue(value),\r\n        checked,\r\n        onChange, onBlur, onKeyDown} // key:`${field}.${data?.id}`\r\n    if (!inputProps.style.cursor && cursor === 'not-allowed') { inputProps.style.cursor = cursor; }\r\n    switch(subtype){\r\n        case 'checkbox3': case 'switch': case 'slider': inputProps.className += ' ' + subtype + (oldValue===undefined?'undetermined':''); break;\r\n        default: break;\r\n    }\r\n\r\n    let input: ReactNode;\r\n    let rootprops: GObject = {className: otherprops.className||'', style: otherprops.style||{}};\r\n    switch (typeof rootprops.ref) {\r\n        default: rootprops.ref = inputRef; break;\r\n        case \"object\":\r\n            let oldref = rootprops.ref;\r\n            rootprops.ref = (v: Element | null) => { oldref.current = inputRef.current = v; }\r\n            break;\r\n        case \"function\":\r\n            let oldreff = rootprops.ref;\r\n            rootprops.ref = (v: Element | null) => { oldreff(v); inputRef.current = v; }\r\n            break;\r\n    }\r\n    if (props.autosize) rootprops['data-value'] = inputProps.value;\r\n\r\n    if (tooltip) {\r\n        rootprops.onMouseEnter = () => Tooltip.show(tooltip, 'b', (rootprops.ref?.current) || rootprops.ref);\r\n        rootprops.onMouseLeave = () => Tooltip.hide();\r\n    }\r\n    /*let rootkeys = new Set(...Object.keys(rootprops));\r\n    //  merge events: might want to distinguish which events are merged between root and input and which not.\r\n    //  onChange surely needs merge. onMouseHover might not to let it trigger on label too.\r\n    for (let k of rootkeys) {\r\n        if (!(k[0] === 'o' && k[1] === 'n' && k[2] && k[2].toUpperCase() === k[2])) continue;\r\n        if (inputProps[k]) inputProps[k] = function(...a:any) { inputProps[k](arguments); rootprops[k](arguments); }\r\n        else inputProps[k] = rootprops[k];\r\n        delete rootprops[k];\r\n    }*/\r\n\r\n    let wrap = true;\r\n    if (autosize) rootprops.className = (rootprops.className || '') + ' autosize-input-container';\r\n    else if (!label && !postlabel && !props.isMultiSelect) {\r\n        if (rootprops.className) inputProps.className = rootprops.className + ' ' + inputProps.className;\r\n        if (rootprops.style) U.objectMergeInPlace(inputProps.style, rootprops.style);\r\n        inputProps = {...rootprops, ...inputProps};\r\n        wrap = false;\r\n    }\r\n\r\n    switch (props.tag){\r\n        case \"textarea\": input = <textarea {...inputProps}>{inputProps.value}</textarea>; break;\r\n        case \"select\":\r\n            if (props.isMultiSelect){\r\n                let options = props.options as any || getSelectOptions_raw(data, field);\r\n                let multiOptions = options as MultiSelectOptGroup[];\r\n                console.log('setting multiselect pre', {multiOptions, value, ivalue: inputProps.value, options, data, df:data[field], field});\r\n                let valuesMap = U.objectFromArrayValues((inputProps.value||[]));\r\n                delete valuesMap[undefined as any];\r\n                inputProps.value = [];\r\n                for (let optgrp of multiOptions) for (let opt of optgrp.options) if (valuesMap[opt.value]) inputProps.value.push(opt);\r\n                // rootprops.className = (rootprops.className || '') + ' clearfix';\r\n                let old = {...rootprops};\r\n                rootprops.onMouseMove = (e:any) => { UX.stopEvt(e); old.onMouseMove?.(); console.log('multiselect onmove'); };\r\n                /*rootprops.onMouseDown = (e:any) => { UX.stopEvt(e); old.onMouseDown?.(); console.log('multiselect onMouseDown'); };\r\n                rootprops.onMouseUp = (e:any) => { UX.stopEvt(e); old.onMouseUp?.(); console.log('multiselect onMouseUp'); };\r\n                rootprops.onClick = (e:any) => { UX.stopEvt(e); old.onClick?.(); console.log('multiselect onClick'); };\r\n                rootprops.onMouseLeave = (e:any) => { UX.stopEvt(e); old.onMouseLeave?.(); console.log('multiselect onMouseLeave'); };*/\r\n                // @ts-ignore\r\n                input = <MultiSelect {...inputProps} isMulti={true} options={options}\r\n                    onChange={((v0: MultiSelectOption[]) => {\r\n                        let v = v0.map(v => v.value);\r\n                        confirmValue(undefined, v);\r\n                        console.log('setting multiselect onchange', {v, v0, value, ivalue: inputProps.value, options});\r\n                    }) as any}\r\n                />;\r\n            }\r\n            else {\r\n                let options = getSelectOptions(data, field, props.options, props.children);\r\n                input = <select {...inputProps}>{options}</select>;\r\n            }\r\n            break;\r\n        case null: case undefined: case \"\": case \"input\": input = <input {...inputProps} />; break;\r\n        default:\r\n            inputProps.contentEditable = inputProps.contentEditable !== false;\r\n            input = React.createElement(props.tag, inputProps, props.children); break;\r\n    }\r\n    if (!wrap) return input;\r\n\r\n    if (typeof label === \"string\") label = <span>{label}</span>;\r\n    if (typeof postlabel === \"string\") postlabel = <span>{postlabel}</span>;\r\n\r\n    const openSelect = (e: any)=>{\r\n        /*\r\n        tried to make label click open the select but does not work easily in js, a solution was here but with css padding.\r\n        https://stackoverflow.com/questions/15249958/once-i-click-on-label-select-button-should-get-open\r\n        */\r\n        if (props.tag !== \"select\") return;\r\n        let t: HTMLElement = (e.target) as any;\r\n        let select = (t.tagName === 'select') ? t : t.querySelector('select');\r\n        console.log(\"click select root\", {t, select});\r\n        select?.click();\r\n    }\r\n    return <label className={'input-container'} {...rootprops} /*onClick={openSelect}*/>\r\n        {label || undefined}{input}{postlabel || undefined}</label>;\r\n    /*\r\n    return(<label className={'p-1'} {...otherprops}\r\n                  style={rootStyle}>\r\n\r\n        {label && <span className={'my-auto'} onMouseEnter={e => setShowTooltip(true)}\r\n                        onMouseLeave={e => setShowTooltip(false)}>{label}\r\n        </span>}\r\n\r\n        {jsxLabel && <span onMouseEnter={e => setShowTooltip(true)}\r\n                           onMouseLeave={e => setShowTooltip(false)} style={{width: '100%'}}>{jsxLabel}\r\n        </span>}\r\n\r\n        {(tooltip && showTooltip) && <div className={'my-tooltip'}>\r\n            <b className={'text-center text-capitalize'}>{field}</b>\r\n            <br />\r\n            <label>{tooltip}</label>\r\n        </div>}\r\n\r\n        {autosize ? <div className={(autosize ? 'autosize-input-container' : '') + (props.asLabel ? ' labelstyle' : '')}\r\n                         data-value={value}>{input}\r\n        </div> : input}\r\n    </label>);\r\n    */\r\n}\r\n\r\nexport interface InputOwnProps {\r\n    data?: LPointerTargetable | DPointerTargetable | Pointer<DPointerTargetable, 1, 1, LPointerTargetable>;\r\n    field?: string;\r\n    // DANGER: use the data provided in parameters instead of using js closure, as the proxy accessed from using closure won't be updated in rerenders.\r\n    getter?: (data: any/*LPointerTargetable*/, field: string) => string | boolean | undefined;\r\n    setter?: (value: string|boolean, data: any, field: string) => void;\r\n    label?: string | ReactNode;\r\n    postlabel?: string | ReactNode;\r\n    jsxLabel?: ReactNode; // @deprecated, use label\r\n    type?: 'checkbox'|'color'|'date'|'datetime-local'|'email'|'file'|'image'|'month'|'number'|'password'\r\n        |'radio'|'range'|'tel'|'text'|'time'|'url'|'week'\r\n        |'checkbox3'|'toggle'|'switch'|'slider';\r\n    className?: string;\r\n    style?: GObject;\r\n    readonly?: boolean;\r\n    tooltip?: boolean | ReactNode;\r\n    hidden?: boolean;\r\n    autosize?: boolean;\r\n    inputClassName?: string;\r\n    inputStyle?: GObject;\r\n    key?: React.Key | null;\r\n    placeholder?: string;\r\n    tag?: string;\r\n    children?: ReactNode;\r\n}\r\n\r\nexport interface SelectOwnProps extends Omit<InputOwnProps, 'setter'> {\r\n    options?: JSX.Element;\r\n    setter?: (value: string/*|PrimitiveType[]*/, data: any, field: string) => void; // parent select has value: string | boolean\r\n    isMultiSelect?: boolean;\r\n}\r\ninterface RealOwnProps extends Omit<SelectOwnProps, 'setter'>{\r\n    setter: InputOwnProps['setter'];\r\n}\r\n\r\ninterface StateProps {\r\n    debugmodee: string;\r\n    data: LPointerTargetable & GObject;\r\n    // selected: Dictionary<Pointer<DUser>, LModelElement | null>;\r\n}\r\ninterface DispatchProps { }\r\ntype AllProps = Overlap<RealOwnProps, Overlap<StateProps, DispatchProps>>;\r\n\r\n\r\nexport function InputMapStateToProps(state: DState, ownProps: RealOwnProps): StateProps {\r\n    const ret: StateProps = {} as any;\r\n    const pointer: Pointer | undefined = typeof ownProps.data === 'string' ? ownProps.data : ownProps.data?.id;\r\n    ret.debugmodee = state.debug ? 'true' : 'false';\r\n    if (pointer) ret.data = LPointerTargetable.fromPointer(pointer);\r\n    return ret;\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch<any>): DispatchProps {\r\n    const ret: DispatchProps = {};\r\n    return ret;\r\n}\r\n\r\nexport const InputConnected =\r\n    // @ts-ignore\r\n    connect<StateProps, DispatchProps, RealOwnProps, DState>(InputMapStateToProps, mapDispatchToProps)(InputComponent);\r\n\r\n\r\n// export function Input(props: InputOwnProps, children: (string | React.Component)[] = []): ReactElement { return 'input' as any; }\r\nexport function Input(props: InputOwnProps): ReactElement {\r\n    // @ts-ignore\r\n    return <InputConnected {...props as any}>{props.children}</InputConnected>;\r\n}\r\n\r\n// export function TextArea(props: InputOwnProps, children: (string | React.Component)[] = []): ReactElement { return 'textarea' as any; }\r\nexport function TextArea(props: InputOwnProps, c: any): ReactElement {\r\n    // @ts-ignore\r\n    return <InputConnected {...{...props, tag:\"textarea\"} as any}>{props.children||c}</InputConnected>;\r\n}\r\n//export function Select(props: SelectOwnProps, children: (string | React.Component)[] = []): ReactElement { return 'select' as any; }\r\nexport function Select(props: SelectOwnProps, c: any): ReactElement {\r\n    // @ts-ignore\r\n    return <InputConnected {...{...props, tag:\"select\"} as any}>{props.children||c}</InputConnected>;\r\n}\r\nexport const Edit = Input;\r\n\r\n// @ts-ignore\r\nInputComponent.cname = 'InputComponent';\r\n// @ts-ignore\r\nInputConnected.cname = 'InputConnected';\r\nInput.cname = 'Input';\r\nTextArea.cname = 'TextArea';\r\nSelect.cname = 'Select';\r\nEdit.cname = 'Edit';\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}