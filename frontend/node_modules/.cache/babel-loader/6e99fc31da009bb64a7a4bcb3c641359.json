{"ast":null,"code":"import React from'react';import'./App.scss';import'./styles/view.scss';import'./styles/style.scss';import{DUser,LUser,SetRootFieldAction,statehistory,stateInitializer}from\"./joiner\";import{connect}from\"react-redux\";import Loader from\"./components/loader/Loader\";import Dashboard from\"./pages/Dashboard\";import EditorPage from\"./pages/Editor\";import AuthPage from\"./pages/Auth\";import{useEffectOnce}from\"usehooks-ts\";import{HashRouter,Route,Routes}from'react-router-dom';import PathChecker from\"./components/pathChecker/PathChecker\";import{AuthApi}from\"./api/persistance\";import AllProjectsPage from\"./pages/AllProjects\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var userHasInteracted=false;function endPendingActions(){if(!userHasInteracted)firstInteraction();}function firstInteraction(){statehistory.globalcanundostate=true;}function App(props){var debug=props.debug;var isLoading=props.isLoading;var tooltip=props.tooltip;var user=props.user;useEffectOnce(function(){SetRootFieldAction.new('isLoading',true);stateInitializer().then(function(){return SetRootFieldAction.new('isLoading',false);});/* Offline by default */if(!DUser.current)AuthApi.offline();});return/*#__PURE__*/_jsxs(_Fragment,{children:[isLoading&&/*#__PURE__*/_jsx(Loader,{}),/*#__PURE__*/_jsxs(HashRouter,{children:[/*#__PURE__*/_jsx(PathChecker,{}),/*#__PURE__*/_jsxs(Routes,{children:[DUser.current&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Route,{path:'project',element:/*#__PURE__*/_jsx(EditorPage,{})}),/*#__PURE__*/_jsx(Route,{path:'allProjects',element:/*#__PURE__*/_jsx(AllProjectsPage,{})}),/*#__PURE__*/_jsx(Route,{path:'*',element:/*#__PURE__*/_jsx(Dashboard,{})})]}),/*#__PURE__*/_jsx(Route,{path:'*',element:/*#__PURE__*/_jsx(AuthPage,{})})]})]})]});/*\r\n    if (user) {\r\n        return(<div className={'d-flex flex-column h-100 p-1 REACT-ROOT' + (props.debug ? ' debug' : '')}\r\n                    onClick={e => statehistory.globalcanundostate = true}>\r\n            {isLoading && <Loader />}\r\n            {tooltip && <ToolTip />}\r\n            <Navbar />\r\n            <Helper />\r\n            {(project) ? (project.type === 'collaborative' && !DUser.offlineMode) ? <CollaborativeAttacher project={project} /> : <Editor /> : <Dashboard />}\r\n        </div>);\r\n    } else {\r\n        return(<>\r\n            {isLoading && <Loader />}\r\n            <Auth />\r\n        </>);\r\n    }\r\n    */}function mapStateToProps(state,ownProps){var ret={};ret.debug=state.debug;ret.isLoading=state.isLoading;ret.user=LUser.fromPointer(DUser.current);// needed here as props, because apparently functional components are memoized by default.\nret.offlineMode=DUser.offlineMode;ret.tooltip=state.tooltip;console.log(\"app re mapstate\",{u:DUser.current,o:DUser.offlineMode});return ret;}function mapDispatchToProps(dispatch){var ret={};return ret;}export var AppConnected=connect(mapStateToProps,mapDispatchToProps)(App);export default AppConnected;/* SPLASH SCREEN\r\nreturn(<div className={'w-100 h-100 text-center bg-smoke'}>\r\n    <img style={{height: '60%', width: '80%'}} className={'mt-3 rounded shadow'} src={SplashImage}></img>\r\n    <Oval height={80} width={80} wrapperStyle={{justifyContent: 'center'}} wrapperClass={'mt-3'}\r\n          color={'#475e6c'} secondaryColor={'#ff8811'} />\r\n</div>);\r\n*/","map":{"version":3,"names":["React","DUser","LUser","SetRootFieldAction","statehistory","stateInitializer","connect","Loader","Dashboard","EditorPage","AuthPage","useEffectOnce","HashRouter","Route","Routes","PathChecker","AuthApi","AllProjectsPage","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","userHasInteracted","endPendingActions","firstInteraction","globalcanundostate","App","props","debug","isLoading","tooltip","user","new","then","current","offline","children","path","element","mapStateToProps","state","ownProps","ret","fromPointer","offlineMode","console","log","u","o","mapDispatchToProps","dispatch","AppConnected"],"sources":["C:/d/Programming/web/jodel-mde/src/App.tsx"],"sourcesContent":["import React, {Dispatch, useState} from 'react';\r\nimport './App.scss';\r\nimport './styles/view.scss';\r\nimport './styles/style.scss';\r\nimport {DState, DUser, LUser, SetRootFieldAction, statehistory, stateInitializer, U} from \"./joiner\";\r\nimport {connect} from \"react-redux\";\r\nimport Loader from \"./components/loader/Loader\";\r\nimport {FakeStateProps} from \"./joiner/types\";\r\nimport Dashboard from \"./pages/Dashboard\";\r\nimport EditorPage from \"./pages/Editor\";\r\nimport AuthPage from \"./pages/Auth\";\r\nimport {useEffectOnce} from \"usehooks-ts\";\r\nimport {HashRouter, Route, Routes} from 'react-router-dom';\r\nimport PathChecker from \"./components/pathChecker/PathChecker\";\r\nimport {AuthApi} from \"./api/persistance\";\r\nimport AllProjectsPage from \"./pages/AllProjects\";\r\n\r\nlet userHasInteracted = false;\r\nfunction endPendingActions() {\r\n    if (!userHasInteracted) firstInteraction();\r\n}\r\nfunction firstInteraction(){\r\n    statehistory.globalcanundostate = true;\r\n}\r\n\r\nfunction App(props: AllProps): JSX.Element {\r\n    const debug = props.debug;\r\n    const isLoading = props.isLoading;\r\n    const tooltip = props.tooltip;\r\n    let user: LUser = props.user;\r\n\r\n    useEffectOnce(() => {\r\n        SetRootFieldAction.new('isLoading', true);\r\n        stateInitializer().then(() => SetRootFieldAction.new('isLoading', false));\r\n        /* Offline by default */\r\n        if(!DUser.current) AuthApi.offline();\r\n    });\r\n\r\n    return(<>\r\n        {isLoading && <Loader />}\r\n        <HashRouter>\r\n            <PathChecker />\r\n            <Routes>\r\n                {DUser.current && <>\r\n                    <Route path={'project'} element={<EditorPage />} />\r\n                    <Route path={'allProjects'} element={<AllProjectsPage />} />\r\n                    <Route path={'*'} element={<Dashboard />} />\r\n                </>}\r\n                <Route path={'*'} element={<AuthPage />} />\r\n                {/*<Route path={'*'} element={<Loader />} />*/}\r\n            </Routes>\r\n        </HashRouter>\r\n    </>);\r\n\r\n    /*\r\n    if (user) {\r\n        return(<div className={'d-flex flex-column h-100 p-1 REACT-ROOT' + (props.debug ? ' debug' : '')}\r\n                    onClick={e => statehistory.globalcanundostate = true}>\r\n            {isLoading && <Loader />}\r\n            {tooltip && <ToolTip />}\r\n            <Navbar />\r\n            <Helper />\r\n            {(project) ? (project.type === 'collaborative' && !DUser.offlineMode) ? <CollaborativeAttacher project={project} /> : <Editor /> : <Dashboard />}\r\n        </div>);\r\n    } else {\r\n        return(<>\r\n            {isLoading && <Loader />}\r\n            <Auth />\r\n        </>);\r\n    }\r\n    */\r\n}\r\n\r\ninterface OwnProps {room?: string}\r\ninterface StateProps {\r\n    offlineMode: boolean,\r\n    debug: boolean,\r\n    isLoading: boolean\r\n    tooltip: string,\r\n    user: LUser\r\n}\r\ninterface DispatchProps {}\r\ntype AllProps = OwnProps & StateProps & DispatchProps;\r\n\r\n\r\nfunction mapStateToProps(state: DState, ownProps: OwnProps): StateProps {\r\n    const ret: StateProps = {} as FakeStateProps;\r\n    ret.debug = state.debug;\r\n    ret.isLoading = state.isLoading;\r\n    ret.user = LUser.fromPointer(DUser.current);\r\n    // needed here as props, because apparently functional components are memoized by default.\r\n    ret.offlineMode = DUser.offlineMode;\r\n    ret.tooltip = state.tooltip;\r\n    console.log(\"app re mapstate\", {u:DUser.current, o:DUser.offlineMode});\r\n    return ret;\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch<any>): DispatchProps {\r\n    const ret: DispatchProps = {};\r\n    return ret;\r\n}\r\n\r\nexport const AppConnected = connect<StateProps, DispatchProps, OwnProps, DState>(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(App);\r\n\r\nexport default AppConnected;\r\n\r\n\r\n/* SPLASH SCREEN\r\nreturn(<div className={'w-100 h-100 text-center bg-smoke'}>\r\n    <img style={{height: '60%', width: '80%'}} className={'mt-3 rounded shadow'} src={SplashImage}></img>\r\n    <Oval height={80} width={80} wrapperStyle={{justifyContent: 'center'}} wrapperClass={'mt-3'}\r\n          color={'#475e6c'} secondaryColor={'#ff8811'} />\r\n</div>);\r\n*/\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}