{"ast":null,"code":"import _assertThisInitialized from\"C:/d/Programming/web/jodel-mde/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _wrapNativeSuper from\"C:/d/Programming/web/jodel-mde/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/wrapNativeSuper\";import _construct from\"C:/d/Programming/web/jodel-mde/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/construct\";import _objectSpread from\"C:/d/Programming/web/jodel-mde/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _createForOfIteratorHelper from\"C:/d/Programming/web/jodel-mde/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper\";import _toConsumableArray from\"C:/d/Programming/web/jodel-mde/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _inherits from\"C:/d/Programming/web/jodel-mde/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"C:/d/Programming/web/jodel-mde/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import _classCallCheck from\"C:/d/Programming/web/jodel-mde/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"C:/d/Programming/web/jodel-mde/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";var _dec,_class,_class2,_dec2,_class3,_class4,_dec3,_class5,_dec4,_class6,_class7,_dec5,_class8,_class9,_dec6,_class10,_class11,_dec7,_class12,_dec8,_class13,_dec9,_class14,_dec10,_class15,_dec11,_class17,_class18,_dec12,_class19,_class20,_dec13,_class21,_class22,_dec14,_class23,_class24,_dec15,_class25;import{Mixin}from\"ts-mixer\";import{EdgeBendingMode,EdgeGapMode}from\"./types\";import{Action,BEGIN,CreateElementAction,Defaults,DeleteElementAction,END,GraphPoint,GraphSize,LGraph,LModel,Log,LViewPoint,SetFieldAction,SetRootFieldAction,ShortAttribETypes,statehistory,store,TRANSACTION,U}from\"./index\";var windoww=window;// qui dichiarazioni di tipi che non sono importabili con \"import type\", ma che devono essere davvero importate a run-time (eg. per fare un \"extend\", chiamare un costruttore o usare un metodo statico)\nconsole.warn('ts loading classes');// annotation @RuntimeAccessible\n// import {store} from \"../redux/createStore\";\nvar AbstractMixedClass=/*#__PURE__*/function(){function AbstractMixedClass(){_classCallCheck(this,AbstractMixedClass);}_createClass(AbstractMixedClass,null,[{key:\"init_constructor\",value:// superclass!: Dictionary<DocString<'parent class name', Class>>;\n// static [key: string]: any;\nfunction init_constructor(){}}]);return AbstractMixedClass;}();AbstractMixedClass.logic=void 0;AbstractMixedClass.structure=void 0;AbstractMixedClass.singleton=void 0;export var RuntimeAccessibleClass=/*#__PURE__*/function(_AbstractMixedClass){_inherits(RuntimeAccessibleClass,_AbstractMixedClass);var _super=_createSuper(RuntimeAccessibleClass);function RuntimeAccessibleClass(){var _this2;_classCallCheck(this,RuntimeAccessibleClass);_this2=_super.call(this);// RuntimeAccessibleClass.init_constructor(this, ...a);\n// this.className = this.constructor.name;\n// nb: per i mixin questo settaggio viene sovrascritto. perch√® il mixin crea le 2 classi ereditate separatamente con i loro costruttori e le incrocia. quindi devo settarlo dall'annotazione @ tramite prototype\n// RuntimeAccessibleClass.allRuntimeClasses.push(this.className);\n_this2.className=void 0;return _this2;}_createClass(RuntimeAccessibleClass,[{key:\"getAllPrototypeSuperClasses\",value:function getAllPrototypeSuperClasses(){var currentlevel=this;var ret=[];while(true){if(!currentlevel)break;ret.push(currentlevel);// @ts-ignore\ncurrentlevel=currentlevel.__proto__;}console.log('constructor chain:',ret);return ret;}/*initBase(){\r\n        let superclasses = this.getAllPrototypeSuperClasses();\r\n        for (let sc of superclasses) {\r\n            if (!sc.hasOwnProperty('init0')) continue;\r\n            console.log('initbase calling ', {thiss: this, sc, init0: sc.init0, args:sc.constructorArguments});\r\n            sc.init0.apply(this, ...(sc.constructorArguments || []));\r\n        }\r\n    }*/ // protected abstract init(...constructorParameters: any): void;\n// NB: per colpa della limitazione #3 di ts-mixer,\n// DEVO chiamare init su ogni oggetto per settargli il corretto this.className, altrimenti prende quello dell'ultima superclasse\n/*protected init0(...constructorParameters: any): void {\r\n        let a = this;\r\n        let finalObject = this;\r\n        console.log('creation of___ ', {thiss: this, finalObject});\r\n        if (finalObject.constructor.name === \"DVoidVertex\" || finalObject.constructor.name === \"DGraphElement\") {\r\n            let breakp = true; }\r\n\r\n        (window as any)[finalObject.constructor.name] =\r\n            RuntimeAccessibleClass.classes[finalObject.constructor.name] = finalObject.constructor as any;\r\n        // @ts-ignore\r\n        // delete this.className;\r\n        this.className = (finalObject as any).__proto__.className;\r\n    }*/}],[{key:\"set_extend\",value://static extendTree: TreeModel.Node<typeof RuntimeAccessibleClass>// Tree<string, typeof RuntimeAccessibleClass>;\n// static name: never; // it breaks with minification, don't use it\nfunction set_extend(superclass,subclass){if(!superclass.hasOwnProperty(\"subclasses\"))superclass.subclasses=[subclass];else if(superclass.subclasses.indexOf(subclass)===-1)superclass.subclasses.push(subclass);if(!subclass.hasOwnProperty(\"_extends\"))subclass._extends=[superclass];else if(subclass._extends.indexOf(superclass)===-1)subclass._extends.push(superclass);}},{key:\"extendPrototypes\",value:function extendPrototypes(){Array.prototype.contains=function(o){return this.indexOf(o)!==-1;};Array.prototype.joinOriginal=Array.prototype.join;// @ts-ignore\nArray.prototype.first=function(){return this[0];};// @ts-ignore\neval(\"Array.prototype.last = function(){ return this[this.length-1]; }\");// without eval it still gives typescript error even with tsignore\n// @ts-ignore\nArray.prototype.separator=function(){for(var _len=arguments.length,separators=new Array(_len),_key=0;_key<_len;_key++){separators[_key]=arguments[_key];}if(Array.isArray(separators[0]))separators=separators[0];// case .join([1,2,3])  --> .join(1, 2, 3)\n// console.log(\"separators debug\", this, separators, this[0], typeof this[0]);\n// if (typeof this[0] !== \"object\") return (this as any).joinOriginal(separators);\n// if JSX\n// it handles empty cells like it handles '', but this is how native .join() handles them too: [emptyx5, \"a\", emptyx1, \"b\"].join(\",\") ->  ,,,,,a,,b\nvar ret/*:JSX.Element[]*/=[];for(var i=0;i<this.length;i++){if(i===0){ret.push(this[i]);continue;}ret.push.apply(ret,_toConsumableArray(separators));ret.push(this[i]);}return ret;};}},{key:\"fixStatics\",value:function fixStatics(){this.extendPrototypes();for(var _i=0,_Object$values=Object.values(RuntimeAccessibleClass.annotatedClasses);_i<_Object$values.length;_i++){var classs=_Object$values[_i];var gclass=classs;for(var statickey in gclass.s){gclass[statickey]=gclass.s[statickey];}}}// static allRuntimeClasses: string[] = [];\n},{key:\"getAllNames\",value:function getAllNames(){var annotated=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;return Object.keys(annotated?RuntimeAccessibleClass.annotatedClasses:RuntimeAccessibleClass.classes);}},{key:\"getAllClasses\",value:function getAllClasses(){var annotated=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;return Object.values(annotated?RuntimeAccessibleClass.annotatedClasses:RuntimeAccessibleClass.classes);}},{key:\"getAllClassesDictionary\",value:function getAllClassesDictionary(){var annotated=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;return annotated?RuntimeAccessibleClass.annotatedClasses:RuntimeAccessibleClass.classes;}},{key:\"wrapAll\",value:function wrapAll(data,baseObjInLookup){var path=arguments.length>2&&arguments[2]!==undefined?arguments[2]:'';var canThrow=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;var state=arguments.length>4?arguments[4]:undefined;var filter=arguments.length>5&&arguments[5]!==undefined?arguments[5]:true;if(!Array.isArray(data))return[];if(!data.length)return[];if(!state)state=windoww.store.getState();if(!filter)return data.map(function(d){return _DPointerTargetable.wrap(d,baseObjInLookup,path,canThrow,state);});var ret=[];var _iterator=_createForOfIteratorHelper(data),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var o=_step.value;if(o)ret.push(_DPointerTargetable.wrap(o,baseObjInLookup,path,canThrow,state));}}catch(err){_iterator.e(err);}finally{_iterator.f();}return ret;}},{key:\"wrap\",value:function wrap(data,baseObjInLookup){var path=arguments.length>2&&arguments[2]!==undefined?arguments[2]:'';var canThrow=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;var state=arguments.length>4?arguments[4]:undefined;if(!data||data.__isProxy)return data;if(typeof data==='string'){data=_DPointerTargetable.from(data,state);if(!data){windoww.Log.e(canThrow,'Cannot wrap:',{data:data,baseObjInLookup:baseObjInLookup,path:path});return undefined;}}if(Array.isArray(data)){console.error('use WrapAll instead for arrays',{data:data,baseObjInLookup:baseObjInLookup,path:path,canThrow:canThrow});if(canThrow)throw new Error(\"use WrapAll instead for arrays\");else return undefined;}if(!data)return data;// console.log('ProxyWrapping:', {data, baseObjInLookup, path});\nreturn new Proxy(data,new windoww.TargetableProxyHandler(data,baseObjInLookup,path));}/*\r\n        static mapWrap2<D extends DPointerTargetable, L extends LPointerTargetable>(map: RuntimeAccessibleClass, container: D, baseObjInLookup?: DPointerTargetable, path: string = ''): L{\r\n            if (!map || (map as any).__isProxy) return map as any;\r\n            if (typeof container === 'string') {\r\n                container = store.getState().idlookup[container] as unknown as D;\r\n                if (!container) { return Log.exx('Cannot wrap map:', {map, container, baseObjInLookup, path}); }\r\n            }\r\n            // console.log('ProxyWrapping:', {data, baseObjInLookup, path});\r\n            return new Proxy(map, new MapProxyHandler(map, baseObjInLookup, path));\r\n        }\r\n\r\n    */},{key:\"mapWrap\",value:function mapWrap(data,baseObjInLookup,path){var subMapKeys=arguments.length>3&&arguments[3]!==undefined?arguments[3]:[];if(!data||data.__isProxy)return data;// console.error('GETMAP', {data, logicContext, path});\nreturn new Proxy(data,new windoww.MapProxyHandler(data,baseObjInLookup,path));}},{key:\"init_constructor\",value:function init_constructor(thiss){// this.className = this.constructor.name;\n// let finalObject = this;\n// if (finalObject.constructor.name === \"DVoidVertex\" || finalObject.constructor.name === \"DGraphElement\") { let breakp = true; }\n// this.init0(...arguments);\n// thiss.className = this.name;\n}},{key:\"get\",value:function get(dclassname,mode){// believe it or not there are actually 3 different versions generated, with different static method contexts, it's a mess.\nreturn this.classes[dclassname];/*\r\n        switch(mode) {\r\n            case \"annotated version\":\r\n                /* it is like this in console\r\n                () {\r\n                    var _obj$initBase;\r\n                    for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\r\n                ...* /\r\n                return RuntimeAccessibleClass.annotatedClasses[dclassname] as any;\r\n            case \"local definition version\":\r\n            default: // same as window.classname\r\n            case \"module export version\":\r\n                /* it was like this in console, it is not anymore after reworking cname\r\n                // don't know how to get it now, but default version should be always the correct one,\r\n                    class DClassifier extends _joiner__WEBPACK_IMPORTED_MODULE_0__[\"DPointerTargetable\"]\r\n                which is even wrong as i asked for DPointerTargetable and not DClassifier. * /\r\n            return null as any;\r\n        }*/}},{key:\"extends\",value:function _extends(className,superClassName){var _RuntimeAccessibleCla;var returnIfEqual=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;if(!className||!superClassName)return false;var superclass=typeof superClassName===\"string\"?RuntimeAccessibleClass.get(superClassName):superClassName;var thisclass=typeof className===\"string\"?RuntimeAccessibleClass.get(className):className;if(!superclass||!thisclass)return false;//console.trace(\"extends.1:\", {thisclass, superclass});\n// console.log(\"extends.2:\", {iof:(thisclass instanceof superclass),\n//     tree: !!(RuntimeAccessibleClass.extendTree.first((node) => node.model === superclass)?.first((node) => node.model === thisclass))});\nif(superclass===thisclass)return returnIfEqual;// for (let aaa in RuntimeAccessibleClass.extendTree.find(superClassName)) { }\nreturn thisclass instanceof superclass||((_RuntimeAccessibleCla=RuntimeAccessibleClass.extendMatrix[superclass.cname])===null||_RuntimeAccessibleCla===void 0?void 0:_RuntimeAccessibleCla[thisclass.cname]);// !!(RuntimeAccessibleClass.extendTree.first((node) => node.model === superclass)?.first((node) => node.model === thisclass))\n// || true;\n}},{key:\"makeOCLConstructor\",value:function makeOCLConstructor(data,state,oldState){var _rootModel;var rootModel=data;while(rootModel&&rootModel.className!==\"DModel\"){rootModel=_DPointerTargetable.fromPointer(rootModel.father,state);}var mid=(_rootModel=rootModel)===null||_rootModel===void 0?void 0:_rootModel.id;// NB: for EBoolean etc, primitive type meteclasses don't have a model;\nif(!RuntimeAccessibleClass.OCL_Constructors[mid]){RuntimeAccessibleClass.OCL_Constructors[mid]=_objectSpread({},RuntimeAccessibleClass.classes);}var OclConstructor=data;var namefixed;if(oldState&&oldState.idlookup[data.id]){var oldname=oldState.idlookup[data.id].name;namefixed=U.replaceAll(U.replaceAll(oldname,'-','_'),' ','_');delete RuntimeAccessibleClass.OCL_Constructors[mid][oldname];delete RuntimeAccessibleClass.OCL_Constructors[mid][namefixed];}namefixed=U.replaceAll(U.replaceAll(data.name,'-','_'),' ','_');RuntimeAccessibleClass.OCL_Constructors[mid][data.name]=OclConstructor;RuntimeAccessibleClass.OCL_Constructors[mid][namefixed]=OclConstructor;return data;}},{key:\"getOCLClasses\",value:function getOCLClasses(model_id){// return { ...(RuntimeAccessibleClass.OCL_Constructors[model_id] || {}), ...RuntimeAccessibleClass.classes}\nreturn RuntimeAccessibleClass.OCL_Constructors[model_id]||RuntimeAccessibleClass.classes;}}]);return RuntimeAccessibleClass;}(AbstractMixedClass);RuntimeAccessibleClass.subclasses=[];RuntimeAccessibleClass._extends=[];RuntimeAccessibleClass.extendMatrix=void 0;RuntimeAccessibleClass.cname=void 0;RuntimeAccessibleClass.OCL_Constructors={};RuntimeAccessibleClass.classes={};RuntimeAccessibleClass.annotatedClasses={};export function Obsolete(constructor){return constructor;}export function Leaf(constructor){return constructor;}export function Node(constructor){return constructor;}export function Abstract(constructor){return constructor;}export function Instantiable(constructor,instanceConstructor){return constructor;}// for m2 cklasses that have m1 instances\n// export function RuntimeAccessible<T extends any>(cname: string): ((constructor: T & GObject) => T) {\nexport function RuntimeAccessible(cname){return function(ctor){return RuntimeAccessible_inner(ctor,cname);};}function RuntimeAccessible_inner(constructor,cname){// console.log('DecoratorTest', {constructor, arguments});\nconstructor.cname=cname;if(!constructor.hasOwnProperty(\"subclasses\"))constructor.subclasses=[];// @ts-ignore\nRuntimeAccessibleClass.classes[constructor.cname]=constructor;// console.log(\"setting runtime accessible\", {key: constructor.cname, constructor, pre: predebug, post: {...RuntimeAccessibleClass.classes}});\nif(!windoww[constructor.cname])windoww[constructor.cname]=constructor;constructor.prototype.className=constructor.cname;//constructor.prototype.$$typeof = constructor.cname;\n//constructor.prototype.typeName = constructor.cname;\nconstructor.staticClassName=constructor.cname;// @ts-ignore\n// console.log('runtimeaccessible annotation:', {thiss:this, constructor});\n//    const classnameFixedConstructor = constructor; //  function (...args) { let obj = new constructor(...args); obj.init?.(); obj.init0?.(); return obj; }\n// @ts-ignore\nvar outerthis=this;// @ts-ignore\nvar classnameFixedConstructorDoNotRenameWithoutSearchStrings=function classnameFixedConstructorDoNotRenameWithoutSearchStrings(){var _obj$initBase;for(var _len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++){args[_key2]=arguments[_key2];}// @ts-ignore\n// console.log('runtimeaccessible annotation inner:', {thiss:this, outerthis, constructor});\n// @ts-ignore\nvar obj=_construct(constructor,args);obj.classNameFromAnnotation=constructor.cname;obj.className=constructor.cname;//obj.prototype.$$typeof = constructor.name;\n// obj.prototype.typeName = constructor.name;\n// obj.init?.();\n// obj.init0?.();\n(_obj$initBase=obj.initBase)===null||_obj$initBase===void 0?void 0:_obj$initBase.call(obj);// @ts-ignore\n// console.log('runtimeaccessible annotation inner end:', {thiss:this, outerthis, constructor, obj});\nreturn obj;};RuntimeAccessibleClass.annotatedClasses[constructor.cname]=classnameFixedConstructorDoNotRenameWithoutSearchStrings;for(var key in constructor){classnameFixedConstructorDoNotRenameWithoutSearchStrings[key]=constructor[key];}// constructor.constructor = classnameFixedConstructorDoNotRenameWithoutSearchStrings; return constructor;\n// @ts-ignore\n// for (let staticKey of constructor as GObject) { classnameFixedConstructorDoNotRenameWithoutSearchStrings[staticKey] = constructor[staticKey]; }\nclassnameFixedConstructorDoNotRenameWithoutSearchStrings.prototype=constructor.prototype;classnameFixedConstructorDoNotRenameWithoutSearchStrings.prototype.constructor=constructor.prototype.constructor;// required for inheriting static methods\nclassnameFixedConstructorDoNotRenameWithoutSearchStrings.__proto__=constructor.__proto__;classnameFixedConstructorDoNotRenameWithoutSearchStrings.s=constructor;// return classnameFixedConstructorDoNotRenameWithoutSearchStrings as any;\nreturn constructor;}window.RuntimeAccessibleClass=RuntimeAccessibleClass;// todo: problema: per creare un PointerTargetable ho bisogno dell'userid, e devo generarlo prima che venga generato l'initialState... dovrebbe venir servito con la pagina dal server. o passato come navigation props dalla pagina di login\n// export type DtoW<DX extends GObject, WX = Omit<DtoW0<DX>, 'id'>> = WX;\nexport var CoordinateMode;(function(CoordinateMode){CoordinateMode[\"absolute\"]=\"absolute\";CoordinateMode[\"relativePercent\"]=\"relative%\";CoordinateMode[\"relativeOffset\"]=\"relativeOffset\";CoordinateMode[\"relativeOffsetStart\"]=\"relativeOffsetStart\";CoordinateMode[\"relativeOffsetEnd\"]=\"relativeOffsetEnd\";})(CoordinateMode||(CoordinateMode={}));export var EdgeHead;(function(EdgeHead){EdgeHead[\"composition\"]=\"Composition\";EdgeHead[\"aggregation\"]=\"Aggregation\";EdgeHead[\"reference\"]=\"Association\";EdgeHead[\"extend\"]=\"Extension\";})(EdgeHead||(EdgeHead={}));var canFireActions=true;export var Constructors=(_dec=RuntimeAccessible('Constructors'),_dec(_class=(_class2=/*#__PURE__*/function(){// private callbacks: Function[];\n// set only if requested by setWithSideEffect\n/*\r\n    problem: if isPersistent is set to false, but the object is later made persistent with an action, you lose all the callback effects afecting other elements (as setting opposite relations like instances-typeof or losing pointedBy's)\r\n    solution 1: store in the D-object a function executing the callbacks called by CreateNewElement action, then delete that field before persisting.\r\n    continued: instead of setting the pointedBy's this way (and increasing clonedcounter for nothing) erase all PointedBy mentionings here, and make all pointer values assigned separately with a SetAction,' +\r\n    '         if new2 is used that set manually a d-field, set it to undefined in the in the .end() part, then trigger the setaction with correct value.\r\n    continued: sort actions by path, but always make sure CreateElement are first in the sort regardless of path. make also sure 2 actions with the same path keep the order they are launched/created (oldest first)\r\n    */function Constructors(t,father){var persist=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;var fatherType=arguments.length>3?arguments[3]:undefined;var id=arguments.length>4?arguments[4]:undefined;var isUser=arguments.length>5&&arguments[5]!==undefined?arguments[5]:false;_classCallCheck(this,Constructors);this.thiss=void 0;this.persist=void 0;this.nonPersistentCallbacks=void 0;this.fatherType=void 0;this.state=void 0;persist=persist&&canFireActions;this.thiss=t;this.setID(id,isUser);// the same thing is done in reducer/createelementaction, but if the object is destructured before then, it will lose the constructor and reducer will fail to assign classname\nt.className=t.className||t.constructor.cname||t.constructor.name;_DPointerTargetable.pendingCreation[t.id]=t;this.persist=persist;t._persistCallbacks=[];t._derivedSubElements=[];this.nonPersistentCallbacks=[];if(this.thiss.hasOwnProperty(\"father\")){this.fatherType=fatherType;this.setPtr(\"father\",father);}}_createClass(Constructors,[{key:\"setID\",value:function setID(id){var isUser=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;this.thiss.id=id||Constructors.makeID(isUser);}// cannot use Lobjects as they will set PointedBy in persistent state, also might access an incomplete version of the object crashing\n},{key:\"setPtr\",value:function setPtr(property,value,checkPointerValidity){this.thiss[property]=value;if(!value)return;if(Array.isArray(value)){var _iterator2=_createForOfIteratorHelper(value),_step2;try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var v=_step2.value;if(!value)continue;if(typeof v===\"object\")v=v.id;if(!v||checkPointerValidity&&!Pointers.isPointer(v,checkPointerValidity))continue;this.thiss._persistCallbacks.push(SetFieldAction.create(v,\"pointedBy\",PointedBy.fromID(this.thiss.id,property),'+='));}}catch(err){_iterator2.e(err);}finally{_iterator2.f();}}else{if(typeof value===\"object\")value=value.id;value&&this.thiss._persistCallbacks.push(SetFieldAction.create(value,\"pointedBy\",PointedBy.fromID(this.thiss.id,property),'+='));}// todo: in delete if the element was not persistent, just do nothing.\n}},{key:\"setExternalRootProperty\",value:function setExternalRootProperty(path,val,accessModifier,isPointer){this.thiss._persistCallbacks.push(SetRootFieldAction.create(path,val,accessModifier,isPointer));return this;}},{key:\"setExternalPtr\",value:function setExternalPtr(target,property){var accessModifier=arguments.length>2&&arguments[2]!==undefined?arguments[2]:\"\";var val=arguments.length>3?arguments[3]:undefined;if(!target)return this;if(typeof target===\"object\")target=target.id;if(!val)val=this.thiss.id;this.thiss._persistCallbacks.push(SetFieldAction.create(target,property,val,accessModifier,true));return this;// PointedBy is set by reducer directly in this case.\n// this.thiss._persistCallbacks.push(SetFieldAction.create(this.thiss.id, \"pointedBy\", PointedBy.fromID(target, property as any), '+='));\n}},{key:\"setWithSideEffect\",value:function setWithSideEffect(property,val){var _this3=this;if(!val)return this;if(!this.state)this.state=store.getState();if(typeof val===\"object\")val=val.id;this.thiss._persistCallbacks.push(function(){LPointerTargetable.from(_this3.thiss,_this3.state)[property]=val;});return this;}//static pause(): void { canFireActions = false; }\n//static resume(): void { canFireActions = true; }\n},{key:\"end\",value:// start(thiss: any): this { this.thiss = thiss; return this; }\nfunction end(simpledatacallback){if(simpledatacallback)simpledatacallback(this.thiss,this);// callback for setting primitive types, not pointers not context-dependant values (name being potentially invalid / chosen according to parent)\nif(this.nonPersistentCallbacks.length){var _iterator3=_createForOfIteratorHelper(this.nonPersistentCallbacks),_step3;try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var cb=_step3.value;cb();}}catch(err){_iterator3.e(err);}finally{_iterator3.f();}}if(!this.persist)return this.thiss;Constructors.persist(this.thiss);/// todo: warning: there is a transaction at .persist method, do not use BEGIN+END/TRANSACTION inside\nreturn this.thiss;}},{key:\"DState\",value:function(_DState){function DState(){return _DState.apply(this,arguments);}DState.toString=function(){return _DState.toString();};return DState;}(function(){var thiss=this.thiss;thiss.debug=!!localStorage.getItem('debug');return this;})},{key:\"DModelElement\",value:function DModelElement(){return this;}},{key:\"DClassifier\",value:function DClassifier(){return this;}},{key:\"DParameter\",value:function(_DParameter){function DParameter(_x){return _DParameter.apply(this,arguments);}DParameter.toString=function(){return _DParameter.toString();};return DParameter;}(function(defaultValue){var thiss=this.thiss;thiss.defaultValue=defaultValue;this.setExternalPtr(thiss.father,\"parameters\",\"+=\");return this;})},{key:\"DStructuralFeature\",value:function DStructuralFeature(){if(this.thiss.className==='DOperation')return this;// if (!this.persist) return this;\nvar thiss=this.thiss;var _DClass=windoww.DClass;var _DValue=windoww.DValue;var targets=[_DClass.from(thiss.father,this.state)];var alreadyParsed={};/*\r\n        todo: build a Tree<DClass> of all superclasses tree nested by level.\r\n            only then instantiate DValues by depth level, if same level from right to left (last extend on right takes priority) and erase this stuff below.*/ // let superClassesByLevel: Dictionary<Pointer, DClass> = ;\nwhile(targets.length){// gather superclasses in map \"alreadyParsed\"\nvar nextTargets=[];var _iterator4=_createForOfIteratorHelper(targets),_step4;try{for(_iterator4.s();!(_step4=_iterator4.n()).done;){var target=_step4.value;if(!target){Log.w(\"Invalid father pointer in DStructuralFeature\",{feature:thiss,father:target,superclasses:alreadyParsed});continue;}if(alreadyParsed[target.id])continue;alreadyParsed[target.id]=target;var _iterator5=_createForOfIteratorHelper(target.extendedBy),_step5;try{for(_iterator5.s();!(_step5=_iterator5.n()).done;){var ext=_step5.value;nextTargets.push(_DClass.from(ext));}}catch(err){_iterator5.e(err);}finally{_iterator5.f();}}}catch(err){_iterator4.e(err);}finally{_iterator4.f();}targets=nextTargets;}//(thiss as DPointerTargetable)._persistCallbacks.push(()=>{\n// When a feature is added in m2, i loop instanced m1 objects to add that feature as a DValue.\nfor(var pointer in alreadyParsed){var _iterator6=_createForOfIteratorHelper(alreadyParsed[pointer].instances),_step6;try{for(_iterator6.s();!(_step6=_iterator6.n()).done;){var instanceObjPtr=_step6.value;// this._derivedSubElements.push(_DValue.new(thiss.name, thiss.id, undefined, instanceObjPtr));\nthiss._derivedSubElements.push(_DValue.new3({name:undefined,instanceof:thiss.id,father:instanceObjPtr},undefined,false));}//}\n}catch(err){_iterator6.e(err);}finally{_iterator6.f();}}return this;}},{key:\"DReference\",value:function(_DReference){function DReference(){return _DReference.apply(this,arguments);}DReference.toString=function(){return _DReference.toString();};return DReference;}(function(){var thiss=this.thiss;this.setExternalPtr(thiss.father,\"references\",\"+=\");return this;})},{key:\"DAttribute\",value:function(_DAttribute){function DAttribute(){return _DAttribute.apply(this,arguments);}DAttribute.toString=function(){return _DAttribute.toString();};return DAttribute;}(function(){var thiss=this.thiss;this.setExternalPtr(thiss.father,\"attributes\",\"+=\");return this;})},{key:\"DDataType\",value:function DDataType(){return this;}},{key:\"DObject\",value:function(_DObject){function DObject(_x2){return _DObject.apply(this,arguments);}DObject.toString=function(){return _DObject.toString();};return DObject;}(function(instanceoff){var thiss=this.thiss;if(thiss.father){if(this.fatherType.cname===\"DModel\"){this.setExternalPtr(thiss.father,\"objects\",\"+=\");}else{// object containing object is not in any direct child collection. access through values\nthis.setExternalPtr(thiss.father,\"values\",\"+=\");}}instanceoff&&this.setWithSideEffect(\"instanceof\",instanceoff);return this;})},{key:\"DValue\",value:function(_DValue2){function DValue(_x3,_x4,_x5){return _DValue2.apply(this,arguments);}DValue.toString=function(){return _DValue2.toString();};return DValue;}(function(instanceoff,val,isMirage){var thiss=this.thiss;thiss.edges=[];// thiss.values = val || [];\nthiss.instanceof=instanceoff;thiss.isMirage=isMirage||false;if(val===undefined)val=[];else if(!Array.isArray(val))val=[val];thiss.values=[];// because reducer calculating newly added pointedby must find something to start comparison\nthis.setPtr(\"values\",val,this.state);// update father's collections (pointedby's here are set automatically)\nif(instanceoff){this.setPtr(\"instanceof\",instanceoff);this.setExternalPtr(instanceoff,\"instances\",\"+=\");}this.setExternalPtr(thiss.father,\"features\",\"+=\");return this;})},{key:\"DAnnotation\",value:function(_DAnnotation){function DAnnotation(_x6,_x7){return _DAnnotation.apply(this,arguments);}DAnnotation.toString=function(){return _DAnnotation.toString();};return DAnnotation;}(function(source,details){var thiss=this.thiss;thiss.source=source||'';thiss.details=details||[];this.setExternalPtr(thiss.father,\"annotations\",\"+=\");if(details){var _iterator7=_createForOfIteratorHelper(details),_step7;try{for(_iterator7.s();!(_step7=_iterator7.n()).done;){var det=_step7.value;thiss._persistCallbacks.push(SetFieldAction.create(det,\"pointedBy\",PointedBy.fromID(thiss.id,\"details\"),'+='));}}catch(err){_iterator7.e(err);}finally{_iterator7.f();}}return this;})},{key:\"DPointerTargetable\",value:function DPointerTargetable(){var thiss=this.thiss;thiss.className=thiss.constructor.cname;// this.className = thiss.className;\nreturn this;}},{key:\"DUser\",value:function DUser(username){var _this=this.thiss;_this.username=username;statehistory[_this.id]={undoable:[],redoable:[]};// todo: make it able to combine last 2 changes with a keystroke.\n//  reapeat N times to combine N actions.\n//  let it \"redo\" multiple times, it's like recording a macro.\nif(this.persist){// no pointedBy\n}return this;}},{key:\"DNamedElement\",value:function(_DNamedElement){function DNamedElement(_x8){return _DNamedElement.apply(this,arguments);}DNamedElement.toString=function(){return _DNamedElement.toString();};return DNamedElement;}(function(name){var thiss=this.thiss;thiss.name=name!==undefined?name||'':thiss.constructor.name.substring(1)+\" 1\";return this;})},{key:\"DTypedElement\",value:function(_DTypedElement){function DTypedElement(_x9){return _DTypedElement.apply(this,arguments);}DTypedElement.toString=function(){return _DTypedElement.toString();};return DTypedElement;}(function(type){var thiss=this.thiss;this.setPtr(\"type\",type);return this;})},{key:\"DPackage\",value:function(_DPackage){function DPackage(_x10,_x11){return _DPackage.apply(this,arguments);}DPackage.toString=function(){return _DPackage.toString();};return DPackage;}(function(uri,prefix){var thiss=this.thiss;thiss.uri=uri||'';// || 'org.jodel-react.username';\nthiss.prefix=prefix||'';if(thiss.father){if(this.fatherType.cname===\"DModel\"){this.setExternalPtr(thiss.father,\"packages\",\"+=\");}else{this.setExternalPtr(thiss.father,\"subpackages\",\"+=\");}}return this;})},{key:\"DModel\",value:function(_DModel){function DModel(_x12,_x13){return _DModel.apply(this,arguments);}DModel.toString=function(){return _DModel.toString();};return DModel;}(function(instanceoff,isMetamodel){var thiss=this.thiss;thiss.packages=[];// packages;\nthiss.isMetamodel=isMetamodel||false;this.setPtr(\"instanceof\",instanceoff||null);instanceoff&&this.setExternalPtr(instanceoff,\"instances\",\"+=\");// todo: check all D.new calls to make sure there are not actions in callbacks in new2() versions that will go outside the Transaction of persist(),, better move ptrs as .new() parameters\n// or make it so new2 splits pointer and non-pointer declarations (or just allow non-ptrs and ptrs must be DSomething.new() explicit parameters)\nthiss._persistCallbacks.push(SetRootFieldAction.create(isMetamodel?\"m2models\":\"m1models\",thiss.id,\"+=\",true));return this;})},{key:\"DOperation\",value:function(_DOperation){function DOperation(){return _DOperation.apply(this,arguments);}DOperation.toString=function(){return _DOperation.toString();};return DOperation;}(function(){var exceptions=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];var implementation=arguments.length>1?arguments[1]:undefined;var thiss=this.thiss;// thiss.parameters = parameters;\nthiss.implementation=implementation||'return \"default placeholder function called\";';this.setPtr(\"exceptions\",exceptions);this.setExternalPtr(thiss.father,\"operations\",\"+=\");return this;})},{key:\"DClass\",value:function(_DClass2){function DClass(){return _DClass2.apply(this,arguments);}DClass.toString=function(){return _DClass2.toString();};return DClass;}(function(){var isInterface=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var isAbstract=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var isPrimitive=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var partial=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;var partialdefaultname=arguments.length>4&&arguments[4]!==undefined?arguments[4]:'';var thiss=this.thiss;thiss.interface=isInterface;thiss.abstract=isAbstract;thiss.isPrimitive=isPrimitive;thiss.partial=partial;thiss.partialdefaultname=partialdefaultname;this.setExternalPtr(thiss.father,\"classifiers\",\"+=\");this.setExternalRootProperty('ClassNameChanged.'+thiss.id,thiss.name,'',false);// thiss.isClass = !isPrimitive;\n// thiss.isEnum = false;\nreturn this;})},{key:\"DEnumLiteral\",value:function(_DEnumLiteral){function DEnumLiteral(_x14){return _DEnumLiteral.apply(this,arguments);}DEnumLiteral.toString=function(){return _DEnumLiteral.toString();};return DEnumLiteral;}(function(value){// vv4\nvar thiss=this.thiss;thiss.value=value;// undef is ok, handled in getter as automatic ordinal index\nthiss.literal=thiss.name;this.setExternalPtr(thiss.father,\"literals\",\"+=\");return this;})},{key:\"DEnumerator\",value:function(_DEnumerator){function DEnumerator(){return _DEnumerator.apply(this,arguments);}DEnumerator.toString=function(){return _DEnumerator.toString();};return DEnumerator;}(function(){var literals=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];var thiss=this.thiss;this.setExternalPtr(thiss.father,\"classifiers\",\"+=\");this.setPtr(\"literals\",literals);// thiss.literals = literals;\n// thiss.isClass = false;\n// thiss.isEnum = true;\nreturn this;})},{key:\"DEdgePoint\",value:function DEdgePoint(){return this;}},{key:\"DEdge\",value:function DEdge(){var thiss=this.thiss;return this;}},{key:\"DVertex\",value:function DVertex(){return this;}},{key:\"DVoidEdge\",value:function(_DVoidEdge){function DVoidEdge(_x15,_x16,_x17,_x18){return _DVoidEdge.apply(this,arguments);}DVoidEdge.toString=function(){return _DVoidEdge.toString();};return DVoidEdge;}(function(start,end,longestLabel,labels){var thiss=this.thiss;var startid=windoww.LGraphElement.getNodeId(start);var endid=windoww.LGraphElement.getNodeId(end);Log.ex(!startid||!endid,\"cannot create an edge without start or ending nodes\",{start:start,end:end,startid:startid,endid:endid});thiss.anchorStart='0';thiss.anchorEnd='0';// thiss.startFollow = false;\n// thiss.endFollow = false;\nthiss.midnodes=[];thiss.midPoints=[];// the logic part which instructs to generate the midnodes\n// if (!thiss.model && isDModelElementPointer(startid)) thiss.model = startid;\n// thiss.labels = undefined;\nvar ll=function ll(e,s,allNodes,allSegments){return(/*defining the edge label (e.start.model as any)?.name + \" ~ \" + (e.end.model as any)?.name */\" (\"+s.length.toFixed(1)+\")\");};// complex edge label func example: (thiss.longestLabel = ll)\nthiss.longestLabel=longestLabel;this.setPtr(\"start\",startid);this.setPtr(\"end\",endid);this.setExternalPtr(startid,\"edgesOut\",\"+=\");this.setExternalPtr(endid,\"edgesIn\",\"+=\");var gthis=thiss;delete gthis.x;delete gthis.y;delete gthis.w;delete gthis.h;delete gthis.edgesIn;delete gthis.edgesOut;delete gthis.anchors;delete gthis.__isDVoidEdge;delete gthis.__isDEdge;return this;})},{key:\"DExtEdge\",value:function DExtEdge(){return this;}},{key:\"DRefEdge\",value:function DRefEdge(){return this;}},{key:\"DGraphElement\",value:function(_DGraphElement){function DGraphElement(_x19,_x20){return _DGraphElement.apply(this,arguments);}DGraphElement.toString=function(){return _DGraphElement.toString();};return DGraphElement;}(function(model,parentgraphID){var htmlindex=arguments.length>2&&arguments[2]!==undefined?arguments[2]:1;var thiss=this.thiss;thiss.subElements=[];thiss.favoriteNode=false;thiss.zIndex=htmlindex;thiss.isSelected={};thiss.edgesIn=[];thiss.edgesOut=[];// thiss.state = {id: thiss.id+\".state\", className: thiss.className};\n// 5-way anchors thiss.anchors = {'0':{x:0.5, y:0.5}, '1':{x:0.5, y:0}, '2':{x:1, y:0.5}, '3':{x:0.5, y:1}, '4':{x:0, y:0.5}} as any;\nthiss.anchors={'0':{x:0.5,y:0.5},'t':{x:0.5,y:0},'tr':{x:1,y:0},'r':{x:1,y:0.5},'br':{x:1,y:1},'b':{x:0.5,y:1},'bl':{x:0,y:1},'l':{x:0,y:0.5},'tl':{x:0,y:0}};for(var k in thiss.anchors){var _a=thiss.anchors[k];if(!_a.name)_a.name=k;if(!_a.w)_a.w=15;if(!_a.h)_a.h=15;}this.setPtr(\"model\",model);this.setPtr(\"graph\",parentgraphID);this.setExternalPtr(thiss.father,\"subElements\",\"+=\");Log.eDev(thiss.father&&_DPointerTargetable.fromPointer(thiss.father).subElements.indexOf(thiss.id)!==-1,\"subelemnts+= addition have duplicates\",{adding:thiss,d:thiss.father&&_DPointerTargetable.fromPointer(thiss.father).subElements.indexOf(thiss.id)});return this;})},{key:\"DViewElement\",value:function(_DViewElement){function DViewElement(_x21,_x22,_x23,_x24){return _DViewElement.apply(this,arguments);}DViewElement.toString=function(){return _DViewElement.toString();};return DViewElement;}(function(name,jsxString,vp,defaultVSize){var _user$project,_this4=this;var usageDeclarations=arguments.length>4&&arguments[4]!==undefined?arguments[4]:'';var constants=arguments.length>5&&arguments[5]!==undefined?arguments[5]:'';var preRenderFunc=arguments.length>6&&arguments[6]!==undefined?arguments[6]:'';var appliableToClasses=arguments.length>7&&arguments[7]!==undefined?arguments[7]:[];var oclCondition=arguments.length>8&&arguments[8]!==undefined?arguments[8]:'';var priority=arguments.length>9?arguments[9]:undefined;var thiss=this.thiss;var vid=thiss.id;var tv=transientProperties.view[vid];if(!tv)transientProperties.view[vid]=tv={};thiss.name=name;thiss.appliableToClasses=appliableToClasses;thiss.appliableTo='Any';thiss.jsxString=jsxString;thiss.usageDeclarations=usageDeclarations;thiss.constants=undefined;// '{}';\nthiss.preRenderFunc='';// '() => {return{}}';\nthiss.onDragEnd=thiss.onDragStart=thiss.whileDragging=thiss.onResizeEnd=thiss.onResizeStart=thiss.whileResizing='';thiss.onRotationEnd=thiss.onRotationStart=thiss.whileRotating='';thiss.onDataUpdate='';thiss.events={};// thiss.__transient = new DViewTransientProperties();\nthiss.subViews={};thiss.oclCondition=oclCondition||'';thiss.jsCondition='';thiss.oclUpdateCondition='';thiss.OCL_NEEDS_RECALCULATION=true;thiss.explicitApplicationPriority=undefined;//priority as any as number;\nthiss.isExclusiveView=true;thiss.size={};thiss.storeSize=false;thiss.lazySizeUpdate=true;thiss.isValidation=false;//thiss.constraints = [];\nthiss.palette={'color-':U.hexToPalette(),//['#ffffff', '#ff0000', '#00ff00', '#0000ff','#aaaaaa', '#ffaaaa', '#aaffaa', '#aaaaff'],\n'background-':U.hexToPalette()// ['#000000', '#33333', '#777777']};\n};thiss.css='';thiss.compiled_css='';thiss.css_MUST_RECOMPILE=true;thiss.cssIsGlobal=false;// thiss.palette = {};\n// thiss.useSizeFrom = EuseSizeFrom.node;\n// thiss.adaptHeight = false;\n// thiss.adaptWidth = false;\nthiss.draggable=true;thiss.resizable=true;//thiss.display = 'flex' as any;\nthiss.defaultVSize=defaultVSize||new GraphSize(0,0,140.6818084716797,32.52840805053711);thiss.adaptWidth=false;thiss.adaptHeight=true;//'fit-content';\nthiss.edgeStartOffset=new GraphPoint(50,50);thiss.edgeEndOffset=new GraphPoint(50,50);thiss.edgeStartOffset_isPercentage=true;thiss.edgeEndOffset_isPercentage=true;thiss.edgeStartStopAtBoundaries=true;thiss.edgeEndStopAtBoundaries=true;thiss.bendingMode=EdgeBendingMode.Bezier_quadratic;thiss.edgeGapMode=EdgeGapMode.center;thiss.edgePointCoordMode=CoordinateMode.relativeOffset;thiss.usageDeclarations=undefined;/// edge only\nthiss.edgeHeadSize=new GraphPoint(20,20);thiss.edgeTailSize=new GraphPoint(20,20);if(thiss.className!=='DViewElement')return this;var user=LUser.fromPointer(_DUser.current);// const project = user?.project; if(!project) return this;\nif(!vp)vp=(user===null||user===void 0?void 0:(_user$project=user.project)===null||_user$project===void 0?void 0:_user$project.activeViewpoint.id)||Defaults.viewpoints[0];if(vp!=='skip'){var dvp=_DPointerTargetable.fromPointer(vp);// let subviews = {...dvp.subViews}; subviews[thiss.id] = 1.5;\n// this.setExternalPtr(vp, 'subViews', '', subviews);\nvar subviews={};subviews[thiss.id]=1.5;this.setExternalPtr(vp,'subViews','+=',subviews);this.setPtr('viewpoint',vp);}var trview=transientProperties.view[thiss.id]={};// trview.?? = ???\nTRANSACTION(function(){// add relation to vp\nvar _iterator8=_createForOfIteratorHelper(windoww.DViewElement.RecompileKeys),_step8;try{for(_iterator8.s();!(_step8=_iterator8.n()).done;){var key=_step8.value;_this4.setExternalRootProperty('VIEWS_RECOMPILE_'+key,thiss.id,'+=',false);}// is pointer, but no need to set pointedby\n}catch(err){_iterator8.e(err);}finally{_iterator8.f();}});// this.setExternalPtr(project.id, 'views', '+=');\n// this.setExternalPtr(project.id, 'stackViews', '+=');\nreturn this;})},{key:\"DViewPoint\",value:function(_DViewPoint){function DViewPoint(){return _DViewPoint.apply(this,arguments);}DViewPoint.toString=function(){return _DViewPoint.toString();};return DViewPoint;}(function(){var thiss=this.thiss;var user=LUser.fromPointer(_DUser.current);var project=user===null||user===void 0?void 0:user.project;if(!project)return this;this.setExternalPtr(project.id,'viewpoints','+=');// thiss._persistCallbacks.push( SetFieldAction.create(project.id, 'stackViews', [], '', false) );\nreturn this;})},{key:\"DProject\",value:function DProject(type,name,state,m2,m1,id){var _this=U.wrapper(this.thiss);_this.metamodels=m2;_this.models=m1;_this.type=type;_this.name=name;_this.state=state;if(id)_this.id=id;this.setExternalPtr(_DUser.current,'projects','+=');return this;}},{key:\"DGraph\",value:function(_DGraph){function DGraph(){return _DGraph.apply(this,arguments);}DGraph.toString=function(){return _DGraph.toString();};return DGraph;}(function(){var thiss=this.thiss;thiss.graph=thiss.id;// no setPtr because i want to avoid circular pointedby reference\nthiss.zoom=new GraphPoint(1,1);thiss.offset=new GraphPoint(0,0);// GraphSize.apply(this, [0, 0, 0 ,0]);\nthiss._subMaps={zoom:true,graphSize:true};var user=LUser.fromPointer(_DUser.current);if(thiss.className==='DGraph'){// to exclude GraphVertex\nuser.project&&this.setExternalPtr(user.project.id,'graphs',\"+=\");thiss.x=0;thiss.y=0;thiss.w=0;thiss.h=0;}else{// todo: set to default graphvertex size, so it can skip a rerender\nthiss.x=0;thiss.y=0;//thiss.w = packageDefaultSize.w;\n//thiss.h = packageDefaultSize.h;\n}return this;})},{key:\"DVoidVertex\",value:function(_DVoidVertex){function DVoidVertex(_x25){return _DVoidVertex.apply(this,arguments);}DVoidVertex.toString=function(){return _DVoidVertex.toString();};return DVoidVertex;}(function(defaultVSize){var thiss=this.thiss;/*[]{}<>\r\n?'^~\r\n&&||\\+\r\n6nb*/var defaultVSizeObj;var defaultVSizeFunc;thiss.isResized=false;var lvertex=LPointerTargetable.fromD(thiss);if(typeof defaultVSize!==\"function\"){defaultVSizeObj=defaultVSize;}else{defaultVSizeFunc=defaultVSize;try{defaultVSizeObj=defaultVSizeFunc(lvertex.father,lvertex);}catch(e){Log.e(\"Error in user DefaultVSize function:\",{e:e,defaultVSizeFunc:defaultVSizeFunc,txt:defaultVSizeFunc.toString()});}}if(defaultVSizeObj){if(defaultVSizeObj.x!==undefined)thiss.x=defaultVSizeObj.x;if(defaultVSizeObj.y!==undefined)thiss.y=defaultVSizeObj.y;if(defaultVSizeObj.w!==undefined)thiss.w=defaultVSizeObj.w;if(defaultVSizeObj.h!==undefined)thiss.h=defaultVSizeObj.h;if(defaultVSizeObj.index>=0&&thiss.className===\"DEdgePoint\"){var updateEPindex=function updateEPindex(){var _defaultVSizeObj;var lep=lvertex;var le=lep.father;var de=le.__raw;var subelements=_toConsumableArray(de.subElements);U.arrayRemoveAll(subelements,thiss.id);subelements.splice((_defaultVSizeObj=defaultVSizeObj)===null||_defaultVSizeObj===void 0?void 0:_defaultVSizeObj.index,0,thiss.id);// console.log(\"setting subelements\", {oldsubelements, subelements, de, le, thiss});\nle.subElements=subelements;// todo: this might break \"pointedBy\" x984\n};// updateEPindex();\n// it's already wrapped in a callback\n// but needs a second one because after node is created, id is auto-appended to this collection\n// and i need to rewrite that append by inserting my own customized index position\nconsole.log(\"setting subelements 0\",{updateEPindex:updateEPindex});setTimeout(updateEPindex,0);// NB: do not use this.callbacks.push because the body of this func is executed after Constructors.end() so end() can never find and execute it.\n}}return this;})}],[{key:\"makeID\",value:function makeID(){var isUser=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;return\"Pointer\"+new Date().getTime()+\"_\"+(isUser?_DUser.current:'USER')+\"_\"+_DPointerTargetable.maxID++;}},{key:\"persist\",value:function persist(d,fromCreateAction){if(Constructors.paused)return;TRANSACTION(function(){if(!Array.isArray(d))d=[d];// first create \"this\"\nvar _iterator9=_createForOfIteratorHelper(d),_step9;try{for(_iterator9.s();!(_step9=_iterator9.n()).done;){var _e=_step9.value;var subElements=_e._derivedSubElements;var callbacks=_e._persistCallbacks;delete _e._derivedSubElements;delete _e._persistCallbacks;// then create subelements (object -> values) and fire their actions.\nif(!fromCreateAction)CreateElementAction.new(_e,false);var _iterator10=_createForOfIteratorHelper(subElements),_step10;try{for(_iterator10.s();!(_step10=_iterator10.n()).done;){var _c=_step10.value;Constructors.persist([_c]);}// finally fire the actions for \"this\"\n}catch(err){_iterator10.e(err);}finally{_iterator10.f();}var _iterator11=_createForOfIteratorHelper(callbacks),_step11;try{for(_iterator11.s();!(_step11=_iterator11.n()).done;){var _c2=_step11.value;_c2.fire?_c2.fire():_c2();}}catch(err){_iterator11.e(err);}finally{_iterator11.f();}}}catch(err){_iterator9.e(err);}finally{_iterator9.f();}});}},{key:\"DGraph_makeID\",value:function DGraph_makeID(modelid){if(!modelid)modelid=\"shapeless\";return modelid+'^graph'+Constructors.DGraph_maxID++;}}]);return Constructors;}(),_class2.paused=false,_class2.DGraph_maxID=0,_class2))||_class);// export const Constructors = new _Constructors();\nvar _DPointerTargetable=(_dec2=RuntimeAccessible(\"DPointerTargetable\"),_dec2(_class3=(_class4=/*#__PURE__*/function(_RuntimeAccessibleCla2){_inherits(_DPointerTargetable,_RuntimeAccessibleCla2);var _super2=_createSuper(_DPointerTargetable);function _DPointerTargetable(fakearg_detectwrongcalls){var _this5;_classCallCheck(this,_DPointerTargetable);_this5=_super2.call(this);_this5.clonedCounter=void 0;_this5._storePath=void 0;_this5._subMaps=void 0;_this5.id=void 0;_this5.pointedBy=[];_this5.className=void 0;_this5._state={};_this5._persistCallbacks=void 0;_this5._derivedSubElements=void 0;if(!fakearg_detectwrongcalls)throw new Error(\"cannot build D-objects using new keyword, use the static D-Class.new method instead\");return _this5;}_createClass(_DPointerTargetable,null,[{key:\"defaultname\",value://\n// pointedBy: DocString<'path in store'>[] = []; // NB: potrebbe contenere puntatori invalidi.\n// se viene cancellato un intero oggetto A che contiene una lista di puntatori, gli oggetti che puntano ad A rimuovono A dai loro \"poitnedBy\",\n// ma gli oggetti puntati da A tramite sotto-oggetti o attributi (subviews...) non vengono aggiornati in \"pointedby\"\nfunction defaultname(startingPrefix,father,metaptr){var lfather;// startingPrefix = \"model_\", father = ((name: string) => !dmodelnames.includes(name))\nif(father){if(typeof father===\"string\"||father.className){// Pointer or D\nlfather=LPointerTargetable.wrap(father);if(!lfather)return typeof startingPrefix===\"string\"?startingPrefix:\"unnamed_elem\";// can happen during parse when father ptr exist but it's not in store yet. not a prob\nif(typeof startingPrefix!==\"string\"){var _meta=LPointerTargetable.from(metaptr);startingPrefix=startingPrefix(_meta);}var childrenNames=lfather.children.map(function(c){return c===null||c===void 0?void 0:c.name;});return U.increaseEndingNumber(startingPrefix+'0',false,false,function(newname){return childrenNames.indexOf(newname)>=0;});}else{var condition=father;return U.increaseEndingNumber(startingPrefix+'0',false,false,condition);}}return startingPrefix+\"1\";}},{key:\"new\",value:function _new(){//father?: Pointer, persist: boolean = false, fatherType?: Constructor, ...a:any): DPointerTargetable {\nLog.exx(\"cannot instantiate abstract class DPointerTargetable\");return null;// return new Constructors(new DPointerTargetable('dwc'), father, persist, fatherType).DPointerTargetable().end();\n}},{key:\"fromL\",value:function fromL(data){return data.__raw;}},{key:\"fromPointer\",value:function fromPointer(ptr,s){s=s||store.getState();if(!ptr){return ptr;}if(Array.isArray(ptr)){return ptr.map(function(p){return _DPointerTargetable.fromPointer(p,s);});}if(typeof ptr!==\"string\"){console.error(\"wrong parameter in DPointerTargetable.fromPointers()\",ptr);throw new Error(\"wrong parameter in DPointerTargetable.fromPointers()\");}if(s&&s.idlookup[ptr])return s.idlookup[ptr];return _DPointerTargetable.pendingCreation[ptr]||s.idlookup[ptr];// return ((s || store.getState()).idlookup[ptr as string] || DPointerTargetable.pendingCreation[ptr as string]) as any;\n}},{key:\"from\",value:function from(ptr,s){if(!ptr)return ptr;if(Array.isArray(ptr))return _DPointerTargetable.fromArr(ptr,true,s);if(ptr.__isProxy)return ptr.__raw;if(typeof ptr===\"string\"){if(s&&s.idlookup[ptr])return s.idlookup[ptr];return _DPointerTargetable.pendingCreation[ptr]||store.getState().idlookup[ptr];}else if(ptr.className)return ptr;else return undefined;}},{key:\"fromArr\",value:function fromArr(arr){var filter=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;var s=arguments.length>2?arguments[2]:undefined;var ret=[];s=s||store.getState();var _iterator12=_createForOfIteratorHelper(arr),_step12;try{for(_iterator12.s();!(_step12=_iterator12.n()).done;){var _a2=_step12.value;var _d=_DPointerTargetable.from(_a2,s);if(!filter||_d)ret.push(_d);}}catch(err){_iterator12.e(err);}finally{_iterator12.f();}return ret;}//static from0(a: any, ...aa: any): any { return null; }\n},{key:\"writeable\",value:function writeable(l){return l;}// deleted when it becomes persistent\n// deleted when it becomes persistent\n// persist(): void { Constructors.persist(this); }// deleted when it becomes persistent\n}]);return _DPointerTargetable;}(RuntimeAccessibleClass),_class4.defaultComponent=void 0,_class4.maxID=0,_class4.logic=void 0,_class4.subclasses=[],_class4._extends=[],_class4.pendingCreation={},_class4))||_class3);export{_DPointerTargetable as DPointerTargetable};RuntimeAccessibleClass.set_extend(RuntimeAccessibleClass,_DPointerTargetable);/*\r\nlet d0: LClassifier = null as any;\r\nlet ptrr: Pointer<DPackage, 1, 'N', LPackage> = null as any;\r\nlet ptr1: Pointer<DPackage, 1, 1, LPackage> = null as any;\r\nlet dd = DPointerTargetable.from(d0.id);\r\n*/ /*\r\ntype Pack1<D extends DPointerTargetable, L extends LPointerTargetable = DtoL<D>, P extends Pointer<D, 0, 1, L> = Pointer<D, 0, 1, L>, R = {D:D, L:L, P:P} > = P|D|L\r\ntype PackArr<D extends DPointerTargetable, L extends LPointerTargetable = DtoL<D>, P extends Pointer<D, 0, 1, L> = Pointer<D, 0, 1, L> , ARR = Pack1<D>> = (ARR)[];\r\ntype Pack<D extends DPointerTargetable, L extends LPointerTargetable = DtoL<D>, P extends Pointer<D, 0, 1, L> = Pointer<D, 0, 1, L> , ARR = Pack1<D>> = ARR | (ARR)[];*/export var Pointers=(_dec3=RuntimeAccessible('Pointers'),_dec3(_class5=/*#__PURE__*/function(){function Pointers(){_classCallCheck(this,Pointers);}_createClass(Pointers,[{key:\"fromm\",value:function fromm(val){return!val?null:val.id;}},{key:\"from0\",value:function from0(data){return null;}}],[{key:\"filterValid\",value:function filterValid(p){var pointerval=_DPointerTargetable.from(p);if(Array.isArray(pointerval))return pointerval.filter(function(p){return!!p;}).map(function(p){return p.id;});if(!pointerval)return null;return pointerval.id;}},{key:\"fromArr\",value:function fromArr(val){if(!val)val=[];if(!Array.isArray(val)){val=[val];}if(!val.length){return[];}if(val[0].id){val=val.filter(function(v){return!!v;}).map(function(v){return v.id;});}return val.filter(function(v){return!!v;});}},{key:\"from00\",value:function from00(data){// RET | RET[] {\nif(Array.isArray(data))return data.filter(function(d){return!!d;}).map(function(d){return typeof d===\"string\"?d:d.id;});else return data?data.id:null;}// stavolta fai infer so D|l.id\n},{key:\"from\",value:// | {Dn0:any};\n// function from<PTR extends Pointer<DPointerTargetable, 1, 1, LPointerTargetable>>(data:unknown | unknown[]): PTR | PTR[] | GObject {\nfunction from(data){if(!data)return null;if(Array.isArray(data))return data.filter(function(d){return!!d;}).map(function(d){return typeof d===\"string\"?d:d===null||d===void 0?void 0:d.id;});return typeof data===\"string\"?data:data===null||data===void 0?void 0:data.id;}},{key:\"isPointer\",value:function isPointer(val,state){var doArrayCheck=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;// might cause endless loop if there are subarrays in a containment loop.\nif(doArrayCheck&&Array.isArray(val))return val.some(function(v){return Pointers.isPointer(val,state,true);});if(state)return _DPointerTargetable.from(val,state);return typeof val===\"string\"?val.includes(\"Pointer\"):false;}}]);return Pointers;}())||_class5);/*\r\nexport type Pack1<L extends LPointerTargetable | undefined | null,\r\n    // L extends LPointerTargetable | undefined | null = LL extends LPointerTargetable[] ? LPointerTargetable : null | undefined,\r\n    D extends (L extends LPointerTargetable ? LtoD<L> : undefined | null) = (L extends LPointerTargetable ? LtoD<L> : undefined | null)> =\r\n    L extends LPointerTargetable ? ( D extends DPointerTargetable ? D | L /*| LtoW<L>* / | Pointer<D, 1, 1, L> : L) : undefined;\r\nexport type PackArr<LL extends orArr<LPointerTargetable> | undefined | null,\r\n    L extends LPointerTargetable | undefined | null = LL extends undefined | null ? undefined : unArr<LL>> = Pack1<L>[];\r\nexport type Pack<\r\n    LL extends orArr<LPointerTargetable> | undefined | null,\r\n    L extends unArr<LL> = unArr<LL>,\r\n    // L extends (LL extends orArr<LPointerTargetable> ? LPointerTargetable : undefined | null) = (LL extends orArr<LPointerTargetable> ? unArr<LL> : undefined)\r\n    >\r\n    = LL extends undefined ? undefined : Pack1<L> | PackArr<L>;\r\n*/ /*\r\nlet n: any = null;\r\nlet aa: DClass = n;\r\nlet ptrr = Pointers.from(aa.parent);\r\naa.parent = ptrr;*/export var PendingPointedByPaths=(_dec4=RuntimeAccessible('PendingPointedByPaths'),_dec4(_class6=(_class7=/*#__PURE__*/function(){function PendingPointedByPaths(from,// todo 6: how about actions that do not include index but just += -= [] ?\nto){_classCallCheck(this,PendingPointedByPaths);this.from=from;this.to=to;this.solveAttempts=1;this.stackTrace=void 0;this.action=void 0;this.stackTrace=U.getStackTrace();}_createClass(PendingPointedByPaths,[{key:\"attemptResolve\",value:function attemptResolve(state){if(this.canBeResolved(state))return this.resolve();return null;}},{key:\"resolve\",value:function resolve(){U.arrayRemoveAll(PendingPointedByPaths.all,this);return Action.parse(SetRootFieldAction.create(\"idlookup.\"+this.to+'.pointedBy',PointedBy.new(this.action.path),'+=',false));}},{key:\"saveForLater\",value:function saveForLater(){PendingPointedByPaths.all.push(this);}},{key:\"canBeResolved\",value:function canBeResolved(state){this.solveAttempts++;Log.exDev(this.solveAttempts>=PendingPointedByPaths.maxSolveAttempts,\"pending PointedBy action is not revolved for too long, some pointer was wrongly set up.\",this.stackTrace,this,state);return!!state.idlookup[this.to];}}],[{key:\"new\",value:// static pendingMoreThanTwice: ParsedAction[] = [];\n// tmp fields, not sure what i need\n// todo: remove\nfunction _new(action,oldState){var ptr=action.value;var target=oldState.idlookup[ptr];var pendingPointedBy=new PendingPointedByPaths(action.path,ptr);pendingPointedBy.action=action;return pendingPointedBy;}},{key:\"attemptimplementationdelete\",value:function attemptimplementationdelete(pb){var state=store.getState();var objectChain=U.followPath(state,pb.source);}},{key:\"getSolveableActions\",value:function getSolveableActions(oldState){var allClone=_toConsumableArray(this.all);// necessary because the array will remove some elements during iteration as they are solved.\nreturn allClone.map(function(p){return p.attemptResolve(oldState);}).filter(function(p){return!!p;});}}]);return PendingPointedByPaths;}(),_class7.all=[],_class7.maxSolveAttempts=2099999,_class7))||_class6);export var PointedBy=(_dec5=RuntimeAccessible('PointedBy'),_dec5(_class8=(_class9=/*#__PURE__*/function(){function PointedBy(source){_classCallCheck(this,PointedBy);this.source=void 0;this.source=source;}// don't use modifiers here,\n_createClass(PointedBy,null,[{key:\"getPath\",value:// elemento da cui parte il puntatore\n// field: keyof DPointerTargetable;\n// il bersaglio non c'√® qui, perch√® √® l'oggetto che contiene questo dentro l'array pointedBy\n/*private constructor(source: DPointerTargetable, field: any) {\r\n        this.source = source;\r\n        this.field = field;\r\n    }*/function getPath(p){return p.source.substring(0,p.source.lastIndexOf(\".\"));}},{key:\"getLastKey\",value:function getLastKey(p){return p.source.substring(p.source.lastIndexOf(\".\"));}},{key:\"getPathArr\",value:function getPathArr(p){return p.source.split('.');}},{key:\"fromID\",value:function fromID(ptr,field,NoAccessModifiersHere){return PointedBy.new(\"idlookup.\"+ptr+\".\"+field);}},{key:\"new\",value:function _new(source){var modifier=arguments.length>1&&arguments[1]!==undefined?arguments[1]:undefined;var action=arguments.length>2?arguments[2]:undefined;// let source: DocString<\"full path in store including key\"> = action.path;\n// if (source.includes(\"true\")) { console.error(this, action); throw new Error(\"mixed a bool\"); }\nif(modifier)source=source.substring(0,source.length-((modifier===null||modifier===void 0?void 0:modifier.length)||0));return new PointedBy(source);}// static new0<D extends DPointerTargetable> (source: D, field: keyof D): PointedBy { return new PointedBy(source, field); }\n},{key:\"remove\",value:function remove(oldValue,action,state){var casee=arguments.length>3&&arguments[3]!==undefined?arguments[3]:undefined;var oldState=arguments.length>4?arguments[4]:undefined;if(!oldValue)return state;var oldtarget=state.idlookup[oldValue];if(!oldtarget)return state;var index=-1;var actionpath=action.path.substring(0,action.path.length-((casee===null||casee===void 0?void 0:casee.length)||0));for(var i=0;i<oldtarget.pointedBy.length;i++){if(oldtarget.pointedBy[i].source===actionpath){index=i;break;}}if(index<0)return state;if(oldState===state)state=_objectSpread({},state);if((oldState===null||oldState===void 0?void 0:oldState.idlookup)===state.idlookup)state.idlookup=_objectSpread({},state.idlookup);if((oldState===null||oldState===void 0?void 0:oldState.idlookup[oldValue])===state.idlookup[oldValue]){state.idlookup[oldValue]=_objectSpread({},oldtarget);}else{// no need\n}state.idlookup[oldValue].pointedBy.splice(index,1);// in-place edit\n// console.warn('pointedby remove:', {from: oldtarget.pointedBy, to: state.idlookup[oldValue].pointedBy, obj: state.idlookup[oldValue], index, oldValue, actionpath});\nreturn state;}// important! must be called only in reducer\n},{key:\"add\",value:function add(newtargetptr,action,state){var casee=arguments.length>3&&arguments[3]!==undefined?arguments[3]:undefined;var oldState=arguments.length>4?arguments[4]:undefined;if(!newtargetptr)return state;// todo: if can't be done because newtarget doesn't exist, build an action from this and set it pending.\nvar newtarget=state.idlookup[newtargetptr];if(!newtarget){PendingPointedByPaths.new(action,state).saveForLater();// {from: action.path, field: action.field, to: target});\nreturn state;}/* simpler version but does unnecessary shallow copies\r\n        state = {...state} as DState;\r\n        state.idlookup = {...state.idlookup};\r\n        state.idlookup[newtargetptr] = {...newtarget, pointedBy:  [...newtarget.pointedBy, PointedBy.new(action.path, casee)]} as any;*/if(oldState===state)state=_objectSpread({},state);if((oldState===null||oldState===void 0?void 0:oldState.idlookup)===state.idlookup)state.idlookup=_objectSpread({},state.idlookup);if((oldState===null||oldState===void 0?void 0:oldState.idlookup[newtargetptr])===state.idlookup[newtargetptr]){state.idlookup[newtargetptr]=_objectSpread(_objectSpread({},newtarget),{},{pointedBy:[].concat(_toConsumableArray(newtarget.pointedBy),[PointedBy.new(action.path,casee)])});}else{state.idlookup[newtargetptr].pointedBy=[].concat(_toConsumableArray(newtarget.pointedBy),[PointedBy.new(action.path,casee)]);}// console.warn('pointedby add:', {from: oldtarget.pointedBy, to: state.idlookup[newtargetptr].pointedBy, obj: state.idlookup[newtargetptr]});\nreturn state;}}]);return PointedBy;}(),_class9.list=[\"father\",\"parent\",\"annotations\",\"packages\",\"type\",\"subpackages\",\"classifiers\",\"exceptions\",\"parameters\",\"defaultValue\",\"instances\",\"operations\",\"features\",\"attributes\",\"references\",\"extends\",\"extendedBy\",\"implements\",\"implementedBy\",\"instanceof\",\"edges\",\"target\",\"opposite\",\"parameters\",\"exceptions\",\"literals\",\"values\"],_class9))||_class8);export var LPointerTargetable=(_dec6=RuntimeAccessible('LPointerTargetable'),_dec6(_class10=(_class11=/*#__PURE__*/function(_DPointerTargetable2){_inherits(LPointerTargetable,_DPointerTargetable2);var _super3=_createSuper(LPointerTargetable);function LPointerTargetable(){var _this6;_classCallCheck(this,LPointerTargetable);for(var _len3=arguments.length,args=new Array(_len3),_key3=0;_key3<_len3;_key3++){args[_key3]=arguments[_key3];}_this6=_super3.call.apply(_super3,[this].concat(args));_this6.__raw=void 0;_this6.pointedBy=void 0;_this6.clonedCounter=void 0;_this6.__isProxy=void 0;_this6.__serialize=void 0;_this6.inspect=void 0;_this6.__random=void 0;_this6.__info_of__id={type:\"Pointer&lt;this&gt;\",txt:\"<a href=\\\"https://github.com/DamianoNaraku/jodel-react/wiki/identifiers\\\">\"+\"<span>Unique identifier, and value used to point this object.</span></a>\"};_this6._state=void 0;_this6.__info_of___state={type:\"GObject\",txt:\"<div>A space where the user can store informations for their operations/views.<br/>\\n            Example: The Validation viewpoint uses it to store validation messages.<br/>\\n            WARNING! do not set proxies in the state, set pointers instead.<br/>\\n            <a href='https://github.com/MDEGroup/jjodel/wiki/L%E2%80%90Object-state'>Learn more on the wiki</a></div>\"};return _this6;}// public r!: this;\n_createClass(LPointerTargetable,[{key:\"wrongAccessMessage\",value:function wrongAccessMessage(str){var msg=\"Method \"+str+\" should not be called directly, attempting to do so should trigger get_\"+str+\"(). This is only a signature for type checking.\";Log.ex(msg);throw new Error(msg);}},{key:\"toString\",value:function toString(){throw this.wrongAccessMessage(\"toString\");}},{key:\"get_toString\",value:function get_toString(context){var data=context.data;return function(){return data.name?data.name:data.className.substring(0);};// return () => data.id;\n}},{key:\"cannotSet\",value:function cannotSet(field){return Log.exx('\"'+field+'\" field is read-only',this);}},{key:\"get_id\",value:function get_id(context){return context.data.id;}},{key:\"set_id\",value:function set_id(){return this.cannotSet('id');}},{key:\"_get_default\",value:function _get_default(data,key){// @ts-ignore\nreturn LPointerTargetable.from(data[key]);}},{key:\"get__state\",value:function get__state(c){return this.wrongAccessMessage('obj._state, use obj.state instead.');}},{key:\"set__state\",value:function set__state(val,c){return this.cannotSet('obj._state, use obj.state instead.');}},{key:\"get_state\",value:function get_state(context)/*this['_state']*/{if(!context.data._state)return{};return this.__shallowSolver(context.data._state,true,true);// to solve pointers in state\n// return LPointerTargetable.wrap(context.data._state); // this should work, because data._state have id = this.id+\"._state\"\n}},{key:\"set_state\",value:function set_state(val,c){// todo: put those lobjects -> pointer checks into defaultsetter to improve it\n// 3 options:\n// 1) if state === node, then setting whole state is invalid\n// 2) if state is a proxified obj with id = node.id+\".state\" so actions and proxy getters/setters will act on the subobject properties still invalid setting whole obj.\n// 3) forbid to set the whole state, merge old state with new one, if val === undefined, state is reset.\n// i choose 3)\nvar newState;var oldState=c.data._state?_objectSpread({},c.data._state):{};var changed=false;if(val===undefined){if(!oldState||!Object.keys(oldState).length)return true;newState={};changed=true;}else if(typeof val!==\"object\"){Log.ee(\"state can only be assigned with an object or undefined\");return true;}else{val=this.__sanitizeValue(val);newState=_objectSpread({},oldState);for(var k in val){if(val[k]===undefined){if(oldState[k]===undefined)continue;delete newState[k];changed=true;continue;}if(oldState[k]===val[k])continue;newState[k]=val[k];changed=true;}}if(!changed)return true;SetFieldAction.new(c.data,\"_state\",newState,undefined,false);return true;}},{key:\"__sanitizeValue\",value:function __sanitizeValue(val){var _this7=this;var canEditVal=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;var canEditValDeep=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;if(val===undefined){return val;}if(val.__isProxy||val.id&&val.className)return val.id;// if (typeof val === \"string\") { return val; } else\nif(typeof val!==\"object\"){return val;}else if(Array.isArray(val)){return val.map(function(v){return _this7.__sanitizeValue(v,canEditValDeep,canEditValDeep);});}// case val is object not array, not proxy, not D. just a POJO\nvar ret=canEditVal?val:_objectSpread({},val);for(var k in val){if(Array.isArray(val[k]))ret[k]=val[k].map(function(v){return v&&(v.__isProxy||v.id&&v.className)?v.id:v;});else if(val[k]&&(val[k].__isProxy||val[k].id&&val[k].className))ret[k]=val[k].id;}return ret;}// protected _defaultCollectionGetter(c: Context, k: keyof Context[\"data\"]): LPointerTargetable[] { return LPointerTargetable.fromPointer((c.data as any)[k]); }\n},{key:\"__defaultGetter\",value:function __defaultGetter(c,k){// console.log(\"default Getter\");\nvar v=c.data[k];return this.__shallowSolver(v,true,false);}},{key:\"__shallowSolver\",value:function __shallowSolver(val,solveArrayValues,solveObjectKeys){if(!val||!solveArrayValues&&!solveObjectKeys)return val;var state=store.getState();if(solveArrayValues&&Array.isArray(val)){if(val.length===0)return[];else if(Pointers.isPointer(val[0]))return LPointerTargetable.fromArr(val,state);return val;}if(solveObjectKeys&&typeof val===\"object\"){var _ret=_objectSpread({},val);for(var key in val){var v=val[key];if(!Pointers.isPointer(v,undefined,true))continue;_ret[key]=Array.isArray(v)?LPointerTargetable.fromPointer(v,state):LPointerTargetable.fromArr(v,state);}return _ret;}return val&&Pointers.isPointer(val,undefined)?LPointerTargetable.fromPointer(val,state):val;}},{key:\"__defaultSetter\",value:function __defaultSetter(v0,c,k){// todo: get the those lobjects -> pointer checks from set_state\nvar v=this.__sanitizeValue(v0,false,false);if(true||k in c.data){var _ref;// check if is pointer\nvar isPointer;if(Array.isArray(v)){if(v.length===0)isPointer=true;// assumed, should not cause harm if it is not.\n// it will delete remove an entry in pointedBy from all oldValue entries in the array that should not be present anyway.\n// like oldVal.map( id => U.arrayRemove(LData.wrap(id).pointedBy, c.data.this_id)\nelse isPointer=Pointers.isPointer(v[0]);}else isPointer=Pointers.isPointer(v);// autofix value\nvar bytes=0;var type=(_ref=this[\"__info_of__\"+k])===null||_ref===void 0?void 0:_ref.type;if(type)type=U.multiReplaceAll(type,[\"array\",\"Array\",\"<\",\">\",\"[]\"],[]);switch(type){case ShortAttribETypes.EDate:break;default:break;case ShortAttribETypes.EBoolean:v=!!v;break;case ShortAttribETypes.EByte:bytes=8;break;case ShortAttribETypes.EShort:bytes=16;break;case ShortAttribETypes.EInt:bytes=32;break;case ShortAttribETypes.ELong:bytes=64;break;case ShortAttribETypes.EString:v=\"\"+v;break;case ShortAttribETypes.EChar:v=(\"\"+v)[0];break;case ShortAttribETypes.EVoid:Log.exx(\"cannot set a void-typed value\",{c:c,d:c.data,k:k,v:v});return true;case ShortAttribETypes.EDouble:case ShortAttribETypes.EFloat:v=+v;break;}if(bytes){v=Math.round(+v);var max=v<<bytes;// left shift is the same as multiplying by a power of 2, but binary and more efficient.\nvar min=-max+1;if(v>max)v=max;else if(v<min)v=min;}console.log(\"default Setter[\"+k+\"] = \"+v,{type:type,v:v,v0:v0,oldv:c.data[k],isPointer:isPointer});SetFieldAction.new(c.data,k,v,'',isPointer);return true;}return true;}},{key:\"get__extends\",value:function get__extends(superClassName,context){return RuntimeAccessibleClass.extends(context.data.className,superClassName);}/*\r\n    public get_pointedBy(superClassName: string, context: LogicContext<DPointerTargetable>): LPointerTargetable[] {\r\n        let state: GObject = windoww.store.getState();\r\n        function getForemostObjectInPath(path: DocString<'storePath'>): undefined | LPointerTargetable {\r\n            let lastPointableObject: undefined | DPointerTargetable;\r\n            let pathArray = path.split('.');\r\n            for (let key of pathArray) {\r\n                let currentObj: GObject = state[key];\r\n                if (!currentObj) break;\r\n                if (currentObj && currentObj.id && state.idlookup[currentObj.id]) lastPointableObject = state.idlookup[currentObj.id];\r\n            }\r\n            return lastPointableObject && DPointerTargetable.wrap(lastPointableObject);\r\n        }\r\n        return (context.data.pointedBy || []).map(getForemostObjectInPath).filter( lobj => !!lobj) as LPointerTargetable[];\r\n    }*/},{key:\"set_pointedBy\",value:function set_pointedBy(val,context){windoww.Log.exx('pointedBy field should never be directly edited.',{context:context,val:val});return false;}},{key:\"dependencies\",value:// static from0(a: any, ...aa: any): any { return null; }\n/* OLD DELETE\r\n    public delete(): void { throw this.wrongAccessMessage(\"delete\"); }\r\n    public _delete(context: Context): void { new DeleteElementAction(context.data); }\r\n    protected get_delete(context: Context): () => void {\r\n        return () => {\r\n            alert(\"Delete in LPOINTER\")\r\n            this._delete(context);\r\n        }\r\n    }\r\n    */function dependencies(){return[];}},{key:\"get_dependencies\",value:function get_dependencies(context){var data=context.proxyObject;var dependencies=[];var ret=function ret(){var _iterator13=_createForOfIteratorHelper(data.pointedBy),_step13;try{for(_iterator13.s();!(_step13=_iterator13.n()).done;){var pointedBy=_step13.value;var raw=pointedBy.source.split('.');var root=raw[0];var obj=raw[1]||'';var _field=raw[2]||'';// Delete chars from end that are not in [azAZ].\nvar regex=/[^a-zA-Z]+$/;root=root.replace(regex,'');_field=_field.replace(regex,'');// damiano: this is likely to cause a bug for sure somewhere when a key ends with \"s\" but is not an array. keep in mind when naming variables.\nvar op=_field&&_field.endsWith('s')?'-=':'';if(!_field&&root.endsWith('s'))op='-=';var dependency={root:root,obj:obj,field:_field,op:op};if(!dependencies.includes(dependency))dependencies.push(dependency);}}catch(err){_iterator13.e(err);}finally{_iterator13.f();}return dependencies;};return ret;}},{key:\"delete\",value:function _delete(){}},{key:\"get_delete\",value:function get_delete(context){var data=context.proxyObject;var dependencies=data.dependencies();var _iterator14=_createForOfIteratorHelper(data.children),_step14;try{for(_iterator14.s();!(_step14=_iterator14.n()).done;){var _child$node;var child=_step14.value;child.delete();(_child$node=child.node)===null||_child$node===void 0?void 0:_child$node.delete();}}catch(err){_iterator14.e(err);}finally{_iterator14.f();}var ret=function ret(){BEGIN();var _iterator15=_createForOfIteratorHelper(dependencies),_step15;try{for(_iterator15.s();!(_step15=_iterator15.n()).done;){var dependency=_step15.value;var root=dependency.root;var obj=dependency.obj;var _field2=dependency.field;var op=dependency.op;var val=op==='-='?data.id:'';if(root==='idlookup'&&obj&&_field2){console.log('Delete',\"SetFieldAction.new('\".concat(obj,\"', '\").concat(_field2,\"', '\").concat(val,\"', '\").concat(op,\"');\"));SetFieldAction.new(obj,_field2,val,op,false);}else{console.log('Delete',\"SetRootFieldAction.new('\".concat(root,\"', '\").concat(val,\"', '\").concat(op,\"');\"));SetRootFieldAction.new(root,val,op,false);}}}catch(err){_iterator15.e(err);}finally{_iterator15.f();}if(data.nodes)data.nodes.map(function(node){return node.delete();});SetRootFieldAction.new('idlookup',data.id,'-=',false);DeleteElementAction.new(data.id);END();};return ret;}}],[{key:\"fromD\",value:function fromD(data){// return null as any;\nif(Array.isArray(data))return LPointerTargetable.wrapAll(data);return LPointerTargetable.wrap(data);}},{key:\"fromPointer\",value:function fromPointer(ptr,state){// return null as any;\nif(Array.isArray(ptr))return LPointerTargetable.wrapAll(ptr,undefined,'',false,state);return LPointerTargetable.wrap(ptr);}},{key:\"fromArr\",value:// because otherwise it complains about inheriting from DPointerTargetable.fromArr\nfunction fromArr(ptr,state){return LPointerTargetable.from(ptr,state);}},{key:\"from\",value:function from(ptr,s){// return null as any;\nif(Array.isArray(ptr))return LPointerTargetable.wrapAll(ptr);return LPointerTargetable.wrap(ptr);}}]);return LPointerTargetable;}(_DPointerTargetable),_class11.subclasses=[],_class11._extends=[],_class11.structure=void 0,_class11.singleton=void 0,_class11))||_class10);RuntimeAccessibleClass.set_extend(RuntimeAccessibleClass,LPointerTargetable);export var D=(_dec7=RuntimeAccessible('D'),_dec7(_class12=/*#__PURE__*/function(_DPointerTargetable3){_inherits(D,_DPointerTargetable3);var _super4=_createSuper(D);function D(){_classCallCheck(this,D);return _super4.apply(this,arguments);}return D;}(_DPointerTargetable))||_class12);export var L=(_dec8=RuntimeAccessible('L'),_dec8(_class13=/*#__PURE__*/function(_LPointerTargetable){_inherits(L,_LPointerTargetable);var _super5=_createSuper(L);function L(){_classCallCheck(this,L);return _super5.apply(this,arguments);}return L;}(LPointerTargetable))||_class13);export var P=(_dec9=RuntimeAccessible('P'),_dec9(_class14=/*#__PURE__*/function(_Pointers){_inherits(P,_Pointers);var _super6=_createSuper(P);function P(){_classCallCheck(this,P);return _super6.apply(this,arguments);}return P;}(Pointers))||_class14);/*\r\nlet pttr: Pointer<DClassifier, 0, 1, LClassifier> = null as any;\r\nlet ptrany: Pointer<DClassifier, 0|1, 1|'N'>[] = null as any;\r\nlet ptrarr: Pointer<DClassifier>[] = null as any;\r\nlet ptrarr2: Pointer<DClassifier, 1, 'N'> = null as any;\r\nlet d: DClassifier = null as any;\r\nlet darr: DClassifier[] = null as any;\r\n\r\ntype VoidPtr = null | undefined | '';\r\nfunction dfrom<\r\n    PARAM extends orArr<AnyPointer | VoidPtr>,//orArr<WPointerTargetable | LPointerTargetable | DPointerTargetable | AnyPointer>,\r\n\r\n\r\n    DDD extends (PARAM extends Pointer<infer DD> ? DD : 'undefined_D'),\r\n    LOW extends (PARAM extends Pointer<any, infer LO> ? LO : 'undefined_low'),\r\n    LOW0 extends (PARAM extends Pointer<any, 0, any, any> ? 0 : never),\r\n    LOW1 extends (PARAM extends Pointer<any, 1, any, any> ? 1 : never),\r\n    LOW2 extends (VoidPtr extends PARAM ? 0 | 'first' : (PARAM extends VoidPtr ? 0 | 1 | 'second': 1|'third')),\r\n    UPP extends (PARAM extends Pointer<any, number, infer UP> ? UP : 'undefined_upp'),\r\n    LLL extends (PARAM extends Pointer<any, number, any, infer LL> ? LL : 'undefined_L'),\r\n\r\n\r\n\r\n    ISVOID extends PARAM extends VoidPtr  ? 'isvoid' : never,\r\n    ISARR extends PARAM extends [] ? true : false,\r\n    ISPTR extends (PARAM extends AnyPointer | VoidPtr ? 'ptr' : never),\r\n    ISPTRARR extends (PARAM extends (AnyPointer | VoidPtr)[] | Pointer<DPointerTargetable, 1|0, 'N', LPointerTargetable> ? 'ptr_arr' : never),\r\n    ISD extends (PARAM extends DPointerTargetable ? 'd' : never),\r\n    ISDARR extends (PARAM extends DPointerTargetable[] ? 'd_arr' : never),\r\n    ISL extends (PARAM extends LPointerTargetable ? 'l' : never),\r\n    ISLARR extends (PARAM extends LPointerTargetable[] ? 'l_arr' : never),\r\n    ISW extends (PARAM extends WPointerTargetable ? 'w' : never),\r\n    ISWARR extends (PARAM extends WPointerTargetable[] ? 'w_arr' : never),\r\n    // INFER = {LOW:LOW, UPP:UPP, DDD:DDD, LLL:LLL, LOW2:LOW2},\r\n    INFER = { LOW2:LOW2},\r\n    RET = ISVOID | ISPTR | ISPTRARR | ISD | ISDARR | ISL | ISLARR | ISW | ISWARR | INFER\r\n    >\r\n(ptr: PARAM): RET { return null as any; }\r\nlet Lptr = dfrom(pttr as Pointer<DClassifier, 0, 1, LClassifier> );\r\nlet Lptrany = dfrom(ptrany);\r\nlet Lptrarr = dfrom(ptrarr);\r\nlet Lptrarr2 = dfrom(ptrarr2);\r\nlet Ld = dfrom(d);\r\nlet Ldarr = dfrom(darr);*/export var WPointerTargetable=(_dec10=RuntimeAccessible('WPointerTargetable'),_dec10(_class15=/*#__PURE__*/function(_DPointerTargetable4){_inherits(WPointerTargetable,_DPointerTargetable4);var _super7=_createSuper(WPointerTargetable);function WPointerTargetable(){var _this8;_classCallCheck(this,WPointerTargetable);for(var _len4=arguments.length,args=new Array(_len4),_key4=0;_key4<_len4;_key4++){args[_key4]=arguments[_key4];}_this8=_super7.call.apply(_super7,[this].concat(args));_this8.id=void 0;_this8._storePath=void 0;_this8._subMaps=void 0;_this8.pointedBy=void 0;return _this8;}_createClass(WPointerTargetable,null,[{key:\"fromD\",value:// todo: WfromD, WfromL, WfromPointer, Wfrom\nfunction fromD(data){return LPointerTargetable.fromD(data);}}]);return WPointerTargetable;}(_DPointerTargetable))||_class15);RuntimeAccessibleClass.set_extend(_DPointerTargetable,LPointerTargetable);RuntimeAccessibleClass.set_extend(_DPointerTargetable,WPointerTargetable);function fffff(t){return null;}var a=null;var bbb=LPointerTargetable.from(a);var bb2=fffff(a);var _DUser=(_dec11=RuntimeAccessible('DUser'),Leaf(_class17=_dec11(_class17=(_class18=/*#__PURE__*/function(_DPointerTargetable5){_inherits(_DUser,_DPointerTargetable5);var _super8=_createSuper(_DUser);function _DUser(){var _this9;_classCallCheck(this,_DUser);for(var _len5=arguments.length,args=new Array(_len5),_key5=0;_key5<_len5;_key5++){args[_key5]=arguments[_key5];}_this9=_super8.call.apply(_super8,[this].concat(args));_this9.id=void 0;_this9.username=void 0;_this9.token=void 0;_this9.projects=[];_this9.project='';_this9.__isUser=true;return _this9;}// static current: Pointer<DUser> = 'Pointer_AnonymousUser';\n_createClass(_DUser,null,[{key:\"new\",value:// necessary to trick duck typing to think this is NOT the superclass of anything that extends PointerTargetable.\n/*public static new(id?: DUser[\"id\"], triggerActions: boolean = true): DUser {\r\n        return new Constructors(new DUser('dwc'), undefined, false, undefined, id, true).DPointerTargetable().DUser().end(); }*/function _new(username,id){var persist=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;return new Constructors(new _DUser('dwc'),undefined,persist,undefined,id).DPointerTargetable().DUser(username).end();}}]);return _DUser;}(_DPointerTargetable),_class18.offlineMode=!!localStorage.getItem(\"offlineMode\"),_class18.isStateMachine=false,_class18.current='',_class18.subclasses=[],_class18._extends=[],_class18))||_class17)||_class17);export{_DUser as DUser};export var LUser=(_dec12=RuntimeAccessible('LUser'),_dec12(_class19=(_class20=/*#__PURE__*/function(_LPointerTargetable2){_inherits(LUser,_LPointerTargetable2);var _super9=_createSuper(LUser);function LUser(){var _this10;_classCallCheck(this,LUser);for(var _len6=arguments.length,args=new Array(_len6),_key6=0;_key6<_len6;_key6++){args[_key6]=arguments[_key6];}_this10=_super9.call.apply(_super9,[this].concat(args));_this10.__raw=void 0;_this10.id=void 0;_this10.username=void 0;_this10.projects=void 0;_this10.project=void 0;_this10.__isUser=void 0;return _this10;}_createClass(LUser,[{key:\"get_projects\",value:function get_projects(context){return LProject.fromPointer(context.data.projects);}},{key:\"set_projects\",value:function set_projects(val,context){var data=context.data;SetFieldAction.new(data.id,'projects',Pointers.from(val),'',true);return true;}},{key:\"get_project\",value:function get_project(context){var project=context.data.project;if(project)return LProject.fromPointer(project);return null;}},{key:\"set_project\",value:function set_project(val,context){var data=context.data;if(val===null)SetFieldAction.new(data.id,'project','','',false);else SetFieldAction.new(data.id,'project',Pointers.from(val),'',true);return true;}}]);return LUser;}(LPointerTargetable),_class20.subclasses=[],_class20._extends=[],_class20))||_class19);RuntimeAccessibleClass.set_extend(_DPointerTargetable,_DUser);RuntimeAccessibleClass.set_extend(LPointerTargetable,LUser);var _DProject=(_dec13=RuntimeAccessible('DProject'),Leaf(_class21=_dec13(_class21=(_class22=/*#__PURE__*/function(_DPointerTargetable6){_inherits(_DProject,_DPointerTargetable6);var _super10=_createSuper(_DProject);function _DProject(){var _this11;_classCallCheck(this,_DProject);for(var _len7=arguments.length,args=new Array(_len7),_key7=0;_key7<_len7;_key7++){args[_key7]=arguments[_key7];}_this11=_super10.call.apply(_super10,[this].concat(args));_this11.id=void 0;_this11.type='collaborative';_this11.name=void 0;_this11.author=_DUser.current;_this11.collaborators=[];_this11.onlineUsers=0;_this11.metamodels=[];_this11.models=[];_this11.graphs=[];_this11.viewpoints=[];_this11.activeViewpoint=Defaults.viewpoints[0];_this11.state='';return _this11;}// views: Pointer<DViewElement, 0, 'N'> = []; // can be retrieved from viewpoints.subviews\n// stackViews: Pointer<DViewPoint, 0, 'N'> = []; // ??\n// collaborators dict user: priority\n_createClass(_DProject,null,[{key:\"new\",value:function _new(type,name,state,m2,m1,id){return new Constructors(new _DProject('dwc'),undefined,true,undefined).DPointerTargetable().DProject(type,name,state||'',m2||[],m1||[],id).end();}}]);return _DProject;}(_DPointerTargetable),_class22.subclasses=[],_class22._extends=[],_class22))||_class21)||_class21);export{_DProject as DProject};export var LProject=(_dec14=RuntimeAccessible('LProject'),_dec14(_class23=(_class24=/*#__PURE__*/function(_LPointerTargetable3){_inherits(LProject,_LPointerTargetable3);var _super11=_createSuper(LProject);function LProject(){var _this12;_classCallCheck(this,LProject);for(var _len8=arguments.length,args=new Array(_len8),_key8=0;_key8<_len8;_key8++){args[_key8]=arguments[_key8];}_this12=_super11.call.apply(_super11,[this].concat(args));_this12.id=void 0;_this12.type=void 0;_this12.author=void 0;_this12.collaborators=void 0;_this12.onlineUsers=void 0;_this12.name=void 0;_this12.metamodels=void 0;_this12.models=void 0;_this12.graphs=void 0;_this12.viewpoints=void 0;_this12.activeViewpoint=void 0;_this12.state=void 0;_this12.packages=void 0;_this12.classes=void 0;_this12.attributes=void 0;_this12.references=void 0;_this12.operations=void 0;_this12.parameters=void 0;_this12.enumerators=void 0;_this12.literals=void 0;_this12.objects=void 0;_this12.values=void 0;_this12.allNodes=void 0;_this12.graphVertexes=void 0;_this12.voidVertexes=void 0;_this12.vertexes=void 0;_this12.fields=void 0;_this12.edges=void 0;_this12.edgePoints=void 0;_this12.children=void 0;_this12.views=void 0;return _this12;}// stackViews!: LViewElement[];\n// stringify state\n/* DATA */ /* NODES */ /* UTILS */_createClass(LProject,[{key:\"get_name\",value:// derived from viewpoints.subView\n/* Functions */function get_name(context){return context.data.name;}},{key:\"set_name\",value:function set_name(val,context){var data=context.data;SetFieldAction.new(data.id,'name',val,'',false);return true;}},{key:\"get_author\",value:function get_author(context){return LUser.fromPointer(context.data.author);}},{key:\"set_author\",value:function set_author(val,context){var data=context.data;SetFieldAction.new(data.id,'author',Pointers.from(val),'',true);return true;}},{key:\"get_state\",value:function get_state(context){return context.data.state;}},{key:\"set_state\",value:function set_state(val,context){var data=context.data;SetFieldAction.new(data.id,'state',val,'',false);return true;}},{key:\"get_collaborators\",value:function get_collaborators(context){return LUser.fromPointer(context.data.collaborators);}},{key:\"set_collaborators\",value:function set_collaborators(val,context){var data=context.data;SetFieldAction.new(data.id,'collaborators',Pointers.from(val),'',true);return true;}},{key:\"get_onlineUsers\",value:function get_onlineUsers(context){return context.data.onlineUsers;}},{key:\"set_onlineUsers\",value:function set_onlineUsers(val,context){var data=context.data;SetFieldAction.new(data.id,'onlineUsers',val,'',false);return true;}},{key:\"get_metamodels\",value:function get_metamodels(context){return LModel.fromPointer(context.data.metamodels);}},{key:\"set_metamodels\",value:function set_metamodels(val,context){var data=context.data;SetFieldAction.new(data.id,'metamodels',Pointers.from(val),'',true);return true;}},{key:\"get_models\",value:function get_models(context){return LModel.fromPointer(context.data.models);}},{key:\"set_models\",value:function set_models(val,context){var data=context.data;SetFieldAction.new(data.id,'models',Pointers.from(val),'',true);return true;}},{key:\"get_graphs\",value:function get_graphs(context){return LGraph.fromPointer(context.data.graphs);}},{key:\"set_graphs\",value:function set_graphs(val,context){var data=context.data;SetFieldAction.new(data.id,'graphs',Pointers.from(val),'',true);return true;}},{key:\"get_views\",value:function get_views(c){// return LViewElement.fromPointer([...c.data.views, ...Defaults.views]);\nvar duplicateRemover={};var varr=this.get_viewpoints(c).flatMap(function(vp){return vp.subViews;});var _iterator16=_createForOfIteratorHelper(varr),_step16;try{for(_iterator16.s();!(_step16=_iterator16.n()).done;){var v=_step16.value;duplicateRemover[v.id]=v;}}catch(err){_iterator16.e(err);}finally{_iterator16.f();}return Object.values(duplicateRemover);}},{key:\"set_views\",value:function set_views(val,context){return Log.exx(\"cannot set project.views, set them as subviews of a project viewpoint.\");/*\r\n        const data = context.data;\r\n        let ptrs = Pointers.from(val);\r\n        let defaultViewsMap: Dictionary<Pointer, boolean> = U.objectFromArrayValues(Defaults.views);\r\n        ptrs = ptrs.filter(ptr => !defaultViewsMap[ptr]);\r\n        SetFieldAction.new(data.id, 'views', ptrs, '', true);\r\n        return true;*/}/*\r\n        protected get_stackViews(context: Context): this['stackViews'] {\r\n            return LViewElement.fromPointer(context.data.stackViews || []);\r\n        }\r\n        protected set_stackViews(val: PackArr<this['stackViews']>, context: Context): boolean {\r\n            const data = context.data;\r\n            SetFieldAction.new(data.id, 'stackViews', Pointers.from(val), '', true);\r\n            return true;\r\n        }*/},{key:\"get_viewpoints\",value:function get_viewpoints(context){return LViewPoint.fromPointer([].concat(_toConsumableArray(Defaults.viewpoints),_toConsumableArray(context.data.viewpoints)));}},{key:\"set_viewpoints\",value:function set_viewpoints(val,context){var data=context.data;SetFieldAction.new(data.id,'viewpoints',Pointers.from(val),'',true);return true;}},{key:\"get_activeViewpoint\",value:function get_activeViewpoint(context){return LViewPoint.fromPointer(context.data.activeViewpoint||Defaults.viewpoints[0]);}},{key:\"set_activeViewpoint\",value:function set_activeViewpoint(val,context){var data=context.data;SetFieldAction.new(data.id,'activeViewpoint',Pointers.from(val),'',true);return true;}/* DATA Getter */},{key:\"get_packages\",value:function get_packages(context){var data=context.proxyObject;return data.metamodels.flatMap(function(m){return m.allSubPackages;});}},{key:\"get_classes\",value:function get_classes(context){var data=context.proxyObject;return data.packages.flatMap(function(p){return p.classes;});}},{key:\"get_attributes\",value:function get_attributes(context){var data=context.proxyObject;return data.classes.flatMap(function(c){return c.attributes;});}},{key:\"get_references\",value:function get_references(context){var data=context.proxyObject;return data.classes.flatMap(function(c){return c.references;});}},{key:\"get_operations\",value:function get_operations(context){var data=context.proxyObject;return data.classes.flatMap(function(c){return c.operations;});}},{key:\"get_parameters\",value:function get_parameters(context){var data=context.proxyObject;return data.operations.flatMap(function(o){return o.parameters;});}},{key:\"get_enumerators\",value:function get_enumerators(context){var data=context.proxyObject;return data.packages.flatMap(function(p){return p.enumerators;});}},{key:\"get_literals\",value:function get_literals(context){var data=context.proxyObject;return data.enumerators.flatMap(function(e){return e.literals;});}},{key:\"get_objects\",value:function get_objects(context){var data=context.proxyObject;return data.models.flatMap(function(m){return m.allSubObjects;});}},{key:\"get_values\",value:function get_values(context){var data=context.proxyObject;return data.models.flatMap(function(m){return m.allSubValues;});}/* NODES Getter */},{key:\"get_allNodes\",value:function get_allNodes(context){var data=context.proxyObject;var nodes=[];// nodes.push(...(data.metamodels.flatMap(m => m.node).filter(n => n !== undefined) as NodeTypes[]));\nnodes.push.apply(nodes,_toConsumableArray(data.packages.flatMap(function(m){return m.node;}).filter(function(n){return n!==undefined;})));nodes.push.apply(nodes,_toConsumableArray(data.classes.flatMap(function(m){return m.node;}).filter(function(n){return n!==undefined;})));nodes.push.apply(nodes,_toConsumableArray(data.attributes.flatMap(function(m){return m.node;}).filter(function(n){return n!==undefined;})));nodes.push.apply(nodes,_toConsumableArray(data.references.flatMap(function(m){return m.node;}).filter(function(n){return n!==undefined;})));nodes.push.apply(nodes,_toConsumableArray(data.operations.flatMap(function(m){return m.node;}).filter(function(n){return n!==undefined;})));nodes.push.apply(nodes,_toConsumableArray(data.parameters.flatMap(function(m){return m.node;}).filter(function(n){return n!==undefined;})));nodes.push.apply(nodes,_toConsumableArray(data.enumerators.flatMap(function(m){return m.node;}).filter(function(n){return n!==undefined;})));nodes.push.apply(nodes,_toConsumableArray(data.literals.flatMap(function(m){return m.node;}).filter(function(n){return n!==undefined;})));// nodes.push(...(data.models.flatMap(m => m.node).filter(n => n !== undefined) as NodeTypes[]));\nnodes.push.apply(nodes,_toConsumableArray(data.objects.flatMap(function(m){return m.node;}).filter(function(n){return n!==undefined;})));nodes.push.apply(nodes,_toConsumableArray(data.values.flatMap(function(m){return m.node;}).filter(function(n){return n!==undefined;})));return nodes;}},{key:\"get_graphVertexes\",value:function get_graphVertexes(context){var data=context.proxyObject;return data.allNodes.filter(function(n){return n.className==='DGraphVertex';});}},{key:\"get_voidVertexes\",value:function get_voidVertexes(context){var data=context.proxyObject;return data.allNodes.filter(function(n){return n.className==='DVoidVertex';});}},{key:\"get_vertexes\",value:function get_vertexes(context){var data=context.proxyObject;return data.allNodes.filter(function(n){return n.className==='DVertex';});}},{key:\"get_fields\",value:function get_fields(context){var data=context.proxyObject;return data.allNodes.filter(function(n){return n.className==='DGraphElement';});}},{key:\"get_edges\",value:function get_edges(context){var data=context.proxyObject;return data.graphs.flatMap(function(g){return g.subElements.filter(function(e){return e.className==='DEdge';});});}},{key:\"get_edgePoints\",value:function get_edgePoints(context){var data=context.proxyObject;return data.edges.flatMap(function(e){return e.subElements;});}/* CUSTOM Functions */},{key:\"get_children\",value:function get_children(context){var data=context.proxyObject;return[].concat(_toConsumableArray(data.metamodels),_toConsumableArray(data.packages),_toConsumableArray(data.classes),_toConsumableArray(data.attributes),_toConsumableArray(data.references),_toConsumableArray(data.operations),_toConsumableArray(data.parameters),_toConsumableArray(data.enumerators),_toConsumableArray(data.literals),_toConsumableArray(data.models),_toConsumableArray(data.objects),_toConsumableArray(data.values),_toConsumableArray(data.views.filter(function(v){return v&&!Defaults.views.includes(v.id);})),_toConsumableArray(data.viewpoints.filter(function(vp){return vp&&!Defaults.viewpoints.includes(vp.id);})),_toConsumableArray(data.allNodes));}/*\r\n        public pushToStackViews(view: Pack<LViewElement>): void {\r\n            throw new Error('cannot be called directly, should trigger getter. this is only for correct signature');\r\n        }\r\n        protected get_pushToStackViews(context: Context): (view: Pack<LViewElement>) => void {\r\n            return (view) => {\r\n                const data = context.data;\r\n                SetFieldAction.new(data.id, 'stackViews', Pointers.from(view), ', true);\r\n            }\r\n        }\r\n    /*\r\n        public popFromStackViews(): void {\r\n            throw new Error('cannot be called directly, should trigger getter. this is only for correct signature');\r\n        }\r\n        protected get_popFromStackViews(context: Context): () => void {\r\n            return () => {\r\n                const data = context.data;\r\n                const view = data.stackViews?.at(-1);\r\n                if(!view) return;\r\n                SetFieldAction.new(data.id, 'stackViews', view as any, '-=', true);\r\n            }\r\n        }\r\n    */},{key:\"delete\",value:function _delete(){throw new Error('cannot be called directly, should trigger getter. this is only for correct signature');}},{key:\"get_delete\",value:function get_delete(context){var data=context.proxyObject;return function(){TRANSACTION(function(){data.children.map(function(c){return c&&c.delete();});SetFieldAction.new(_DUser.current,'projects',data.id,'-=',true);DeleteElementAction.new(data.id);SetRootFieldAction.new('projects',data.id,'-=',true);});};}}]);return LProject;}(LPointerTargetable),_class24.subclasses=[],_class24._extends=[],_class24))||_class23);RuntimeAccessibleClass.set_extend(_DPointerTargetable,_DProject);RuntimeAccessibleClass.set_extend(LPointerTargetable,LProject);export var MyError=(_dec15=RuntimeAccessible('MyError'),_dec15(_class25=/*#__PURE__*/function(_Error){_inherits(MyError,_Error);var _super12=_createSuper(MyError);function MyError(message){var _console;var _this13;_classCallCheck(this,MyError);// 'Error' breaks prototype chain here\n_this13=_super12.call(this,message);var proto=_assertThisInitialized(_this13).__proto__;for(var _len9=arguments.length,otherMsg=new Array(_len9>1?_len9-1:0),_key9=1;_key9<_len9;_key9++){otherMsg[_key9-1]=arguments[_key9];}(_console=console).error.apply(_console,[proto.constructor.cname||proto.constructor.name,message].concat(otherMsg));// restore prototype chain\nvar actualProto=(this instanceof MyError?this.constructor:void 0).prototype;if(Object.setPrototypeOf){Object.setPrototypeOf(_assertThisInitialized(_this13),actualProto);}else{_assertThisInitialized(_this13).__proto__=actualProto;}_assertThisInitialized(_this13).className=_this13.constructor.cname;return _this13;}return MyError;}(/*#__PURE__*/_wrapNativeSuper(Error)))||_class25);// @RuntimeAccessible\nexport var JsType=/*#__PURE__*/function(){function JsType(printableTypeName,check,isExclusiveType){_classCallCheck(this,JsType);this.printableTypeName=printableTypeName;this.check=check;this.isExclusiveType=isExclusiveType;JsType.all.push(this);}_createClass(JsType,[{key:\"toString\",value:function toString(){return this.printableTypeName;}/*\r\n    * example: isObject but not Date, not function...\r\n    * */}],[{key:\"isOnlyType\",value:function isOnlyType(data,type){return!JsType.getTypes(data,type).length;}},{key:\"isAnyOfTypes\",value:function isAnyOfTypes(data){for(var _len10=arguments.length,acceptables=new Array(_len10>1?_len10-1:0),_key10=1;_key10<_len10;_key10++){acceptables[_key10-1]=arguments[_key10];}return!!windoww.Uarr.arrayIntersection(JsType.getTypes(data),acceptables).length;}},{key:\"getTypes\",value:function getTypes(data,stopIfTypeIsNot){var ret=[];var _iterator17=_createForOfIteratorHelper(JsType.all),_step17;try{for(_iterator17.s();!(_step17=_iterator17.n()).done;){var type=_step17.value;if(type.check(data)){ret.push(data);if(stopIfTypeIsNot!==type){return[];}if(type.isExclusiveType)return ret;}}}catch(err){_iterator17.e(err);}finally{_iterator17.f();}return ret;}/// is...\n},{key:\"isObject\",value:function isObject(data){var returnIfNull=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;return data===null?returnIfNull:typeof data===\"object\";}},{key:\"isFunction\",value:function isFunction(data){return typeof data===\"function\";}},{key:\"isLambdaFunction\",value:function isLambdaFunction(data){if(!JsType.isFunction(data))return false;return windoww.U.getFunctionSignatureFromComments(data).isLambda;}},{key:\"isNonLambdaFunction\",value:function isNonLambdaFunction(data){return JsType.isFunction(data)&&!JsType.isNonLambdaFunction(data);}},{key:\"isArray\",value:function isArray(data){return Array.isArray(data);}},{key:\"isSymbol\",value:function isSymbol(data){return typeof data===\"symbol\";}},{key:\"isBoolean\",value:function isBoolean(data){return!!data===data;}},{key:\"isNumber\",value:function isNumber(data){return typeof data===\"number\";}},{key:\"isBigint\",value:function isBigint(data){return typeof data===\"bigint\";}},{key:\"isString\",value:function isString(data){return typeof data===\"string\";}},{key:\"isNull\",value:function isNull(data){return data===null;}},{key:\"isUndefined\",value:function isUndefined(data){return data===undefined;}},{key:\"isDate\",value:function isDate(data){return data instanceof Date;}/// as...\n},{key:\"asObject\",value:function asObject(data,fallbackReturn){return JsType.isObject(data)?data:fallbackReturn;}},{key:\"asFunction\",value:function asFunction(data,fallbackReturn){return JsType.isFunction(data)?data:fallbackReturn;}},{key:\"asLambdaFunction\",value:function asLambdaFunction(data,fallbackReturn){return JsType.isLambdaFunction(data)?data:fallbackReturn;}},{key:\"asNonLambdaFunction\",value:function asNonLambdaFunction(data,fallbackReturn){return JsType.isNonLambdaFunction(data)?data:fallbackReturn;}},{key:\"asArray\",value:function asArray(data,fallbackReturn){return JsType.isArray(data)?data:fallbackReturn;}},{key:\"asSymbol\",value:function asSymbol(data,fallbackReturn){return JsType.isSymbol(data)?data:fallbackReturn;}},{key:\"asBoolean\",value:function asBoolean(data,fallbackReturn){return JsType.isBoolean(data)?data:fallbackReturn;}},{key:\"asNumber\",value:function asNumber(data,fallbackReturn){return JsType.isNumber(data)?data:fallbackReturn;}},{key:\"asBigint\",value:function asBigint(data,fallbackReturn){return JsType.isBigint(data)?data:fallbackReturn;}},{key:\"asString\",value:function asString(data,fallbackReturn){return JsType.isString(data)?data:fallbackReturn;}},{key:\"asNull\",value:function asNull(data,fallbackReturn){return JsType.isNull(data)?data:fallbackReturn;}},{key:\"asUndefined\",value:function asUndefined(data,fallbackReturn){return JsType.isUndefined(data)?data:fallbackReturn;}},{key:\"asDate\",value:function asDate(data,fallbackReturn){return JsType.isDate(data)?data:fallbackReturn;}},{key:\"isPrimitive\",value:function isPrimitive(data){return!JsType.isAnyOfTypes(data,JsType.object,JsType.function,JsType.array);}}]);return JsType;}();JsType.all=[];JsType.object=new JsType(\"object\",JsType.isObject,false);JsType.function=new JsType(\"function\",JsType.isFunction,false);JsType.array=new JsType(\"array\",JsType.isArray,false);JsType.date=new JsType(\"Date\",JsType.isDate,false);JsType.lambdaFunction=new JsType(\"lambda-function\",JsType.isLambdaFunction,true);JsType.nonLambdaFunction=new JsType(\"non-lambda-function\",JsType.isNonLambdaFunction,true);JsType.symbol=new JsType(\"symbol\",JsType.isSymbol,true);JsType.undefined=new JsType(\"undefined\",JsType.isUndefined,true);JsType.null=new JsType(\"null\",JsType.isNull,true);JsType.boolean=new JsType(\"boolean\",JsType.isBoolean,true);JsType.number=new JsType(\"number\",JsType.isNumber,true);JsType.bigint=new JsType(\"bigint\",JsType.isBigint,true);JsType.string=new JsType(\"string\",JsType.isString,true);function invalidSuperClassError(/*callee: Class,*/scname,superclass){return function(){windoww.Log.exDevv('parent super class \"'+scname+'\" is not implementing init_constructor',{scname:scname,superclass:superclass});throw new Error();};}// @ts-ignore\nfunction MixinFakeConstructor(){this.isMixinFakeConstructor=true;}export function MixOnlyFuncs2(c1,c2){return MixOnlyFuncs(c1,c2);}export function MixOnlyFuncs3(c1,c2){return MixOnlyFuncs(c1,c2);}export function MixOnlyFuncs(c1,c2){// strategia: passo dei finti valori che copiano i prototipi delle classi sovrascrivendo i costruttori per evitare che chiami i costruttori delle superclassi\n// ma che comunque erediti campi e funzioni\n// @ts-ignore\nvar c1noconstructor=MixinFakeConstructor;var c2noconstructor=MixinFakeConstructor;c1noconstructor.prototype=c1.prototype;c2noconstructor.prototype=c2.prototype;var disableconstructor=false;if(!disableconstructor){c1noconstructor=c1;c2noconstructor=c2;}var ret=Mixin(c1noconstructor,c2noconstructor);var c1name=(c1.cname||c1.name)==='classnameFixedConstructorDoNotRenameWithoutSearchStrings'?c1.prototype.className:c1.cname||c1.name;var c2name=(c2.cname||c2.name)==='classnameFixedConstructorDoNotRenameWithoutSearchStrings'?c2.prototype.className:c2.cname||c2.name;//ret.prototype['superclass'] = {};\n// ret.prototype['superclass'][c1name] = c1.prototype.init_constructor || invalidSuperClassError(c1name, c1);\n// ret.prototype['superclass'][c2name] = c2.init_constructor || invalidSuperClassError(c2name, c2);\nret.prototype['superclass1']={};ret.prototype['superclass2']={};ret.prototype['superclass1'][c1name]=c1.init_constructor||invalidSuperClassError(c1name,c1);ret.prototype['superclass2'][c2name]=c2.init_constructor||invalidSuperClassError(c2name,c2);return ret;}// console.info('ts loaded classes');\n//*********************************************************************************************\n//*********************************************************************************************\n///////                              type juggling starts here                          ///////\n//*********************************************************************************************\n//*********************************************************************************************\n// export type NotAString<T extends any = 'uselessval'> = Omit<string, 'bold'> & {big: T};\n// export type NotAString<T extends any = 'uselessval'> = Omit<string, 'bold'>;\n// export type NotAString<T extends any = 'uselessval', T2 extends any = any, T3 extends any = any, T4 extends any = any> = string & Omit<string, 'bold'> & {bold: ()=>string};\n// export type NotAString<T> = string;\n// type Pointer<T> = NotAString<T>;\n// to convert Pointers to strings more explicitly then using as any\n// let ptr: Pointer<Object> = null as any;\n/*\r\nclass D extends DPointerTargetable{\r\n    parent!: Pointer<D>;\r\n    dattrib!: boolean;\r\n    juststring!: string;\r\n    nattrib!: number;\r\n    ddattrib!: Date\r\n}\r\n\r\nclass D2 extends D{\r\n    d2!: string;\r\n}\r\nclass D3 extends D{\r\n    d3!: string;\r\n}\r\n\r\n\r\n\r\ntype OverrideTypes<M, N> = { [P in keyof M]: P extends keyof N ? N[P] : M[P] }; // usage:  OverrideTypes<A, { x: number }>;\r\n\r\ninterface LFix {\r\n    parent: L;\r\n}\r\ninterface L { // no instances ever\r\n    parent: L;\r\n    lattrib: boolean;\r\n}\r\ninterface L2 extends L { // no instances ever\r\n    l2: string;\r\n}\r\ninterface L3 extends L{ // no instances ever\r\n    l3: string;\r\n}\r\n\r\nclass P { // singleton\r\n    get_parent(){}\r\n    set_parent(){}\r\n}\r\nclass P2 extends P { // singleton\r\n    get_d2() {}\r\n}\r\nclass P3 extends P { // singleton\r\n    get_d3() {}\r\n}*/ // RegExp extends Animal ? number : string\nfunction buildWrapSignature(){var maxdepth=arguments.length>0&&arguments[0]!==undefined?arguments[0]:100;var arr=windoww[\"DPointerTargetable\"].subclasses;/*\r\n    let dict0 = arr.reduce((a, v) => ({ ...a, [v.name]: v}), {});\r\n    let dict = {}\r\n    for (let name in dict0) { let n = name.substring(1); dict[n] = {\"D\":dict0[\"D\"+n], \"L\":dict0[\"L\"+n]}; dict[\"D\"+n] = dict0[\"L\"+n]; dict[\"L\"+n] = dict0[\"D\"+n]; }\r\n    console.log(\"dict\", dict);\r\n    console.table(dict);\r\n    */function onlyUnique(value,index,self){return self.indexOf(value)===index;}var dep=arr;// .map( (me) => { return {\"name\": me.name, \"me\": me, \"Derror\": (dict[me.name] || me).name, \"Lerror\": (dict[me.name] || me).name, \"subclasses\": [...me.subclasses]}});\nvar depsorted=[];var byLevels=[];var loopdetecter=[arr];while(dep.length&&maxdepth--){var namelist=dep.map(function(e){return e.name;}).filter(onlyUnique);depsorted.push.apply(depsorted,_toConsumableArray(namelist));byLevels.push(_toConsumableArray(namelist));var olddep=dep;dep=dep.flatMap(function(d){return d.subclasses;}).filter(onlyUnique);var _iterator18=_createForOfIteratorHelper(dep),_step18;try{for(_iterator18.s();!(_step18=_iterator18.n()).done;){var _d2=_step18.value;windoww.loopdetecter=loopdetecter;windoww.dep=dep;windoww.olddep=olddep;windoww.byLevels=byLevels;windoww.d=_d2;if(loopdetecter.includes(_d2.subclasses))throw new Error(\"class is not redefining subclasses static array: \"+_d2.name);loopdetecter.push(_d2.subclasses);}}catch(err){_iterator18.e(err);}finally{_iterator18.f();}}console.log(\"byLevels\");console.table(byLevels);console.log(\"depsorted\",depsorted);// console.log(\"map\");\n// console.table(depsorted.map(dn => {let d = window[dn]; return !d ? \"\" :{name:d.name, scount: d.subclasses.length, subclasses:d.subclasses}}));\nvar goalSignature=\"function wrap<DX extends D, LX = DX extends D2 ? L2: (DX extends D3 ? L3: (DX extends D ? L : ERROR))>(data: DX): LX {\";var lparam=\"ERROR\";var epsorted=depsorted.map(function(e){return e.substring(1);}).filter(onlyUnique);console.table(epsorted);var _iterator19=_createForOfIteratorHelper(epsorted),_step19;try{for(_iterator19.s();!(_step19=_iterator19.n()).done;){var _e2=_step19.value;var _D=\"D\"+_e2;var _L=\"L\"+_e2;lparam=\"DX extends \"+_D+\" ? \"+_L+\" : (\"+lparam+\")\";}}catch(err){_iterator19.e(err);}finally{_iterator19.f();}var signature=\"function wrap<DX extends DPointerTargetable, LX = \"+lparam+\">(data: DX): LX {\";return signature;}windoww.buildWrapSignature=buildWrapSignature;// function wrap<DX extends D, LX = DX extends D2 ? L2: (DX extends D3 ? L3: (DX extends D ? L : ERROR))>(data: DX): LX {\n/*\r\n* NO    L -> D    /// l.__raw\r\n* NO    L -> Ptr  /// l.id\r\n*\r\n* NO    D -> Ptr   // d.id\r\n* YES   D -> L     // wrap\r\n*\r\n* NO    Ptr -> D\r\n* NO    Ptr -> L\r\n*\r\n*\r\n*\r\n*\r\n* DpointerTargetable.from( L or pointer )\r\n* LpointerTargetable.from( D or pointer )\r\n*\r\n* MyProxyHandler.wrap = LpointerTargetable.from;\r\n*\r\n* DpointerTargetable.toPointer( d );\r\n*\r\n\r\ntype subtractDL = subtract<D, L>;\r\n* */ //////////////////////////////////////////// best solution so far\n// todo: can't automatically convert D to L (generating the type instead of manual defining L) rules are: LClass <--- Pointer<LClass>, LClass[] <-- Pointer<LClass, 0, 'N'>, subobject = ? should not be there\n/**\r\n i have a documentation type that is actually a string, but it\\'s have a different purpose from the others, and i made a type to keep documentally separated.\r\n let's say it's\r\n type StringOf<P> = string; // regardless of P\r\n\r\n and i use it to define objects\r\n\r\n class C {\r\n           str: StringOf<Date>;\r\n           str2: StringOf<number>;\r\n           purestring: string;\r\n           num: number\r\n         }\r\n now i want to crete a derivate type that excludes all properties of type StringOf from C\r\n\r\n\r\n\r\n type OnlyKeysOfTypeTmp<T, IncludeType> = ({[P in keyof T]: T[P] extends IncludeType ? P : never })[keyof T];\r\n type OnlyKeysOfType<T, IncludeType> = Pick<T, OnlyKeysOfTypeTmp<T, IncludeType>>;\r\n type RemoveKeysOfType<T, ExcludeType> = Exclude2<T, OnlyKeysOfType<T, string>>;\r\n\r\n type D = RemoveKeysOfType<C, StringOf<any>>\r\n due to duck typing, this removes all StringOf attributes, but also \"purestring\" attribute.\r\n how can i remove only StringOf attributes?\r\n\r\n\r\n */ // & L\nexport var EGraphElements;(function(EGraphElements){EGraphElements[\"GraphElement\"]=\"GraphElement\";EGraphElements[\"Field\"]=\"GraphElement\";EGraphElements[\"Vertex\"]=\"Vertex\";EGraphElements[\"todo\"]=\"todo\";})(EGraphElements||(EGraphElements={}));export var EModelElements;(function(EModelElements){EModelElements[\"(m2) Model\"]=\"DModel\";EModelElements[\"(m2) Package\"]=\"DPackage\";EModelElements[\"(m2) Class\"]=\"DClass\";EModelElements[\"(m2) Enum\"]=\"DEnumerator\";EModelElements[\"(m2) Literal\"]=\"DEnumLiteral\";EModelElements[\"(m2) Operation\"]=\"DOperation\";EModelElements[\"(m2) Parameter\"]=\"DParameter\";EModelElements[\"(m2) Attribute\"]=\"DAttribute\";EModelElements[\"(m2) Reference\"]=\"DReference\";EModelElements[\"(m2) Annotation\"]=\"DAnnotation\";EModelElements[\"(abstract m2) Feature\"]=\"DStructuralFeature\";EModelElements[\"(abstract m2) Classifier\"]=\"DClassifier\";EModelElements[\"(m1) Object\"]=\"DObject\";EModelElements[\"(m1) Value\"]=\"DValue\";})(EModelElements||(EModelElements={}));export var ViewEClassMatch=function ViewEClassMatch(){_classCallCheck(this,ViewEClassMatch);};ViewEClassMatch.NOT_EVALUATED_YET=undefined;ViewEClassMatch.MISMATCH=Number.NEGATIVE_INFINITY;ViewEClassMatch.MISMATCH_PRECONDITIONS=Number.NEGATIVE_INFINITY;ViewEClassMatch.MISMATCH_JS=false;ViewEClassMatch.MISMATCH_OCL=false;ViewEClassMatch.IMPLICIT_MATCH=1;ViewEClassMatch.INHERITANCE_MATCH=1.5;ViewEClassMatch.EXACT_MATCH=2;ViewEClassMatch.VP_MISMATCH=Number.NEGATIVE_INFINITY;ViewEClassMatch.VP_Default=1;ViewEClassMatch.VP_Decorative=1;ViewEClassMatch.VP_Explicit=2;export var NodeTransientProperties=// L-version because it is used in oclUpdate function\n// for each parentview, an array of Decorative Views[] sorted by score (including parent view influence).\n// an array of Main Views[] sorted by score (including parent view influence).\n// global for this node (without view-specific usageDeclaration)\n//force1Update!: boolean;\nfunction NodeTransientProperties(){_classCallCheck(this,NodeTransientProperties);this.viewSorted_modelused=void 0;this.viewSorted_pvid_used=void 0;this.viewSorted_nodeused=void 0;this.stackViews=void 0;this.validMainViews=void 0;this.mainView=void 0;this.viewScores={};this.evalContext=void 0;// this.stackViews = []; this.validMainViews = [];\nthis.viewScores={};};export var ViewTransientProperties=// css_MUST_RECOMPILE: boolean;\n// compiled_css: string; maye those are better shared in sessions\n// not used anymore? was like UD+shouldcompoupdate for jsx, a pre-ocl check\nfunction ViewTransientProperties(){_classCallCheck(this,ViewTransientProperties);this.events=void 0;this.oclChanged=void 0;this.jsConditionChanged=void 0;this.oclUpdateCondition_PARSED=void 0;this.oclEngine=void 0;this.jsCondition=void 0;this.JSXFunction=void 0;this.UDFunction=void 0;this.constantsList=void 0;this.UDList=void 0;this.constants=void 0;this.onDataUpdate=void 0;this.onDragStart=void 0;this.onDragEnd=void 0;this.whileDragging=void 0;this.onResizeStart=void 0;this.onResizeEnd=void 0;this.whileResizing=void 0;this.onRotationStart=void 0;this.onRotationEnd=void 0;this.whileRotating=void 0;this.events={};};export var DataTransientProperties=function DataTransientProperties(){_classCallCheck(this,DataTransientProperties);this.nodes=void 0;this.node=void 0;this.nodes={};};// score for all view ocl + sorted views by best match\nexport var transientProperties={node:{},view:{},modelElement:{}};window.transient=window.transientProperties=transientProperties;// transientProperties.nodes[nid].viewScores[vid]?.[pvid as string];\n/*\r\nexport const transientPropertiesByGraphTab: {viewMatchings: Dictionary<Pointer<DGraph>, Dictionary<Pointer<DModelElement>, TransientPropertiesByGraphTab>>} = {\r\n viewMatchings: {}\r\n};*/","map":{"version":3,"names":["Mixin","EdgeBendingMode","EdgeGapMode","Action","BEGIN","CreateElementAction","Defaults","DeleteElementAction","END","GraphPoint","GraphSize","LGraph","LModel","Log","LViewPoint","SetFieldAction","SetRootFieldAction","ShortAttribETypes","statehistory","store","TRANSACTION","U","windoww","window","console","warn","AbstractMixedClass","_classCallCheck","_createClass","key","value","init_constructor","logic","structure","singleton","RuntimeAccessibleClass","_AbstractMixedClass","_inherits","_super","_createSuper","_this2","call","className","getAllPrototypeSuperClasses","currentlevel","ret","push","__proto__","log","set_extend","superclass","subclass","hasOwnProperty","subclasses","indexOf","_extends","extendPrototypes","Array","prototype","contains","o","joinOriginal","join","first","eval","separator","_len","arguments","length","separators","_key","isArray","i","apply","_toConsumableArray","fixStatics","_i","_Object$values","Object","values","annotatedClasses","classs","gclass","statickey","s","getAllNames","annotated","undefined","keys","classes","getAllClasses","getAllClassesDictionary","wrapAll","data","baseObjInLookup","path","canThrow","state","filter","getState","map","d","DPointerTargetable","wrap","_iterator","_createForOfIteratorHelper","_step","n","done","err","e","f","__isProxy","from","error","Error","Proxy","TargetableProxyHandler","mapWrap","subMapKeys","MapProxyHandler","thiss","get","dclassname","mode","superClassName","_RuntimeAccessibleCla","returnIfEqual","thisclass","extendMatrix","cname","makeOCLConstructor","oldState","_rootModel","rootModel","fromPointer","father","mid","id","OCL_Constructors","_objectSpread","OclConstructor","namefixed","idlookup","oldname","name","replaceAll","getOCLClasses","model_id","Obsolete","constructor","Leaf","Node","Abstract","Instantiable","instanceConstructor","RuntimeAccessible","ctor","RuntimeAccessible_inner","staticClassName","outerthis","classnameFixedConstructorDoNotRenameWithoutSearchStrings","_obj$initBase","_len2","args","_key2","obj","_construct","classNameFromAnnotation","initBase","CoordinateMode","EdgeHead","canFireActions","Constructors","_dec","_class","_class2","t","persist","fatherType","isUser","nonPersistentCallbacks","setID","pendingCreation","_persistCallbacks","_derivedSubElements","setPtr","makeID","property","checkPointerValidity","_iterator2","_step2","v","Pointers","isPointer","create","PointedBy","fromID","setExternalRootProperty","val","accessModifier","setExternalPtr","target","setWithSideEffect","_this3","LPointerTargetable","end","simpledatacallback","_iterator3","_step3","cb","_DState","DState","toString","debug","localStorage","getItem","DModelElement","DClassifier","_DParameter","DParameter","_x","defaultValue","DStructuralFeature","_DClass","DClass","_DValue","DValue","targets","alreadyParsed","nextTargets","_iterator4","_step4","w","feature","superclasses","_iterator5","extendedBy","_step5","ext","pointer","_iterator6","instances","_step6","instanceObjPtr","new3","instanceof","_DReference","DReference","_DAttribute","DAttribute","DDataType","_DObject","DObject","_x2","instanceoff","_DValue2","_x3","_x4","_x5","isMirage","edges","_DAnnotation","DAnnotation","_x6","_x7","source","details","_iterator7","_step7","det","DUser","username","_this","undoable","redoable","_DNamedElement","DNamedElement","_x8","substring","_DTypedElement","DTypedElement","_x9","type","_DPackage","DPackage","_x10","_x11","uri","prefix","_DModel","DModel","_x12","_x13","isMetamodel","packages","_DOperation","DOperation","exceptions","implementation","_DClass2","isInterface","isAbstract","isPrimitive","partial","partialdefaultname","interface","abstract","_DEnumLiteral","DEnumLiteral","_x14","literal","_DEnumerator","DEnumerator","literals","DEdgePoint","DEdge","DVertex","_DVoidEdge","DVoidEdge","_x15","_x16","_x17","_x18","start","longestLabel","labels","startid","LGraphElement","getNodeId","endid","ex","anchorStart","anchorEnd","midnodes","midPoints","ll","allNodes","allSegments","toFixed","gthis","x","y","h","edgesIn","edgesOut","anchors","__isDVoidEdge","__isDEdge","DExtEdge","DRefEdge","_DGraphElement","DGraphElement","_x19","_x20","model","parentgraphID","htmlindex","subElements","favoriteNode","zIndex","isSelected","k","a","eDev","adding","_DViewElement","DViewElement","_x21","_x22","_x23","_x24","jsxString","vp","defaultVSize","_user$project","_this4","usageDeclarations","constants","preRenderFunc","appliableToClasses","oclCondition","priority","vid","tv","transientProperties","view","appliableTo","onDragEnd","onDragStart","whileDragging","onResizeEnd","onResizeStart","whileResizing","onRotationEnd","onRotationStart","whileRotating","onDataUpdate","events","subViews","jsCondition","oclUpdateCondition","OCL_NEEDS_RECALCULATION","explicitApplicationPriority","isExclusiveView","size","storeSize","lazySizeUpdate","isValidation","palette","hexToPalette","css","compiled_css","css_MUST_RECOMPILE","cssIsGlobal","draggable","resizable","adaptWidth","adaptHeight","edgeStartOffset","edgeEndOffset","edgeStartOffset_isPercentage","edgeEndOffset_isPercentage","edgeStartStopAtBoundaries","edgeEndStopAtBoundaries","bendingMode","Bezier_quadratic","edgeGapMode","center","edgePointCoordMode","relativeOffset","edgeHeadSize","edgeTailSize","user","LUser","current","project","activeViewpoint","viewpoints","dvp","subviews","trview","_iterator8","RecompileKeys","_step8","_DViewPoint","DViewPoint","DProject","m2","m1","wrapper","metamodels","models","_DGraph","DGraph","graph","zoom","offset","_subMaps","graphSize","_DVoidVertex","DVoidVertex","_x25","defaultVSizeObj","defaultVSizeFunc","isResized","lvertex","fromD","txt","index","updateEPindex","_defaultVSizeObj","lep","le","de","__raw","subelements","arrayRemoveAll","splice","setTimeout","Date","getTime","maxID","fromCreateAction","paused","_iterator9","_step9","callbacks","new","_iterator10","_step10","c","_iterator11","_step11","fire","DGraph_makeID","modelid","DGraph_maxID","_dec2","_class3","_class4","_RuntimeAccessibleCla2","_DPointerTargetable","_super2","fakearg_detectwrongcalls","_this5","clonedCounter","_storePath","pointedBy","_state","defaultname","startingPrefix","metaptr","lfather","meta","childrenNames","children","increaseEndingNumber","newname","condition","_new","exx","fromL","ptr","p","fromArr","arr","_iterator12","_step12","writeable","l","defaultComponent","_dec3","_class5","fromm","from0","filterValid","pointerval","from00","doArrayCheck","some","includes","PendingPointedByPaths","_dec4","_class6","_class7","to","solveAttempts","stackTrace","action","getStackTrace","attemptResolve","canBeResolved","resolve","all","parse","saveForLater","exDev","maxSolveAttempts","pendingPointedBy","attemptimplementationdelete","pb","objectChain","followPath","getSolveableActions","allClone","_dec5","_class8","_class9","getPath","lastIndexOf","getLastKey","getPathArr","split","field","NoAccessModifiersHere","modifier","remove","oldValue","casee","oldtarget","actionpath","add","newtargetptr","newtarget","concat","list","_dec6","_class10","_class11","_DPointerTargetable2","_super3","_this6","_len3","_key3","__serialize","inspect","__random","__info_of__id","__info_of___state","wrongAccessMessage","str","msg","get_toString","context","cannotSet","get_id","set_id","_get_default","get__state","set__state","get_state","__shallowSolver","set_state","newState","changed","ee","__sanitizeValue","_this7","canEditVal","canEditValDeep","__defaultGetter","solveArrayValues","solveObjectKeys","__defaultSetter","v0","_ref","bytes","multiReplaceAll","EDate","EBoolean","EByte","EShort","EInt","ELong","EString","EChar","EVoid","EDouble","EFloat","Math","round","max","min","oldv","get__extends","extends","set_pointedBy","dependencies","get_dependencies","proxyObject","_iterator13","_step13","raw","root","regex","replace","op","endsWith","dependency","_delete","get_delete","_iterator14","_step14","_child$node","child","delete","node","_iterator15","_step15","nodes","D","_dec7","_class12","_DPointerTargetable3","_super4","L","_dec8","_class13","_LPointerTargetable","_super5","P","_dec9","_class14","_Pointers","_super6","WPointerTargetable","_dec10","_class15","_DPointerTargetable4","_super7","_this8","_len4","_key4","fffff","bbb","bb2","_dec11","_class17","_class18","_DPointerTargetable5","_DUser","_super8","_this9","_len5","_key5","token","projects","__isUser","offlineMode","isStateMachine","_dec12","_class19","_class20","_LPointerTargetable2","_super9","_this10","_len6","_key6","get_projects","LProject","set_projects","get_project","set_project","_dec13","_class21","_class22","_DPointerTargetable6","_DProject","_super10","_this11","_len7","_key7","author","collaborators","onlineUsers","graphs","_dec14","_class23","_class24","_LPointerTargetable3","_super11","_this12","_len8","_key8","attributes","references","operations","parameters","enumerators","objects","graphVertexes","voidVertexes","vertexes","fields","edgePoints","views","get_name","set_name","get_author","set_author","get_collaborators","set_collaborators","get_onlineUsers","set_onlineUsers","get_metamodels","set_metamodels","get_models","set_models","get_graphs","set_graphs","get_views","duplicateRemover","varr","get_viewpoints","flatMap","_iterator16","_step16","set_views","set_viewpoints","get_activeViewpoint","set_activeViewpoint","get_packages","m","allSubPackages","get_classes","get_attributes","get_references","get_operations","get_parameters","get_enumerators","get_literals","get_objects","allSubObjects","get_values","allSubValues","get_allNodes","get_graphVertexes","get_voidVertexes","get_vertexes","get_fields","get_edges","g","get_edgePoints","get_children","MyError","_dec15","_class25","_Error","_super12","message","_console","_this13","proto","_assertThisInitialized","_len9","otherMsg","_key9","actualProto","setPrototypeOf","_wrapNativeSuper","JsType","printableTypeName","check","isExclusiveType","isOnlyType","getTypes","isAnyOfTypes","_len10","acceptables","_key10","Uarr","arrayIntersection","stopIfTypeIsNot","_iterator17","_step17","isObject","returnIfNull","isFunction","isLambdaFunction","getFunctionSignatureFromComments","isLambda","isNonLambdaFunction","isSymbol","isBoolean","isNumber","isBigint","isString","isNull","isUndefined","isDate","asObject","fallbackReturn","asFunction","asLambdaFunction","asNonLambdaFunction","asArray","asSymbol","asBoolean","asNumber","asBigint","asString","asNull","asUndefined","asDate","object","function","array","date","lambdaFunction","nonLambdaFunction","symbol","null","boolean","number","bigint","string","invalidSuperClassError","scname","exDevv","MixinFakeConstructor","isMixinFakeConstructor","MixOnlyFuncs2","c1","c2","MixOnlyFuncs","MixOnlyFuncs3","c1noconstructor","c2noconstructor","disableconstructor","c1name","c2name","buildWrapSignature","maxdepth","onlyUnique","self","dep","depsorted","byLevels","loopdetecter","namelist","olddep","_iterator18","_step18","table","goalSignature","lparam","epsorted","_iterator19","_step19","signature","EGraphElements","EModelElements","ViewEClassMatch","NOT_EVALUATED_YET","MISMATCH","Number","NEGATIVE_INFINITY","MISMATCH_PRECONDITIONS","MISMATCH_JS","MISMATCH_OCL","IMPLICIT_MATCH","INHERITANCE_MATCH","EXACT_MATCH","VP_MISMATCH","VP_Default","VP_Decorative","VP_Explicit","NodeTransientProperties","viewSorted_modelused","viewSorted_pvid_used","viewSorted_nodeused","stackViews","validMainViews","mainView","viewScores","evalContext","ViewTransientProperties","oclChanged","jsConditionChanged","oclUpdateCondition_PARSED","oclEngine","JSXFunction","UDFunction","constantsList","UDList","DataTransientProperties","modelElement","transient"],"sources":["C:/d/Programming/web/jodel-mde/src/joiner/classes.ts"],"sourcesContent":["import {Mixin} from \"ts-mixer\";\r\nimport type {\r\n    DEdge,\r\n    DEdgePoint,\r\n    DExtEdge,\r\n    DGraph,\r\n    DGraphElement,\r\n    DGraphVertex,\r\n    DRefEdge,\r\n    DVertex,\r\n    DVoidEdge,\r\n    DVoidVertex,\r\n    LEdge,\r\n    LEdgePoint,\r\n    LExtEdge,\r\n    LGraphElement,\r\n    LGraphVertex,\r\n    LRefEdge,\r\n    LVertex,\r\n    LVoidEdge,\r\n    LVoidVertex,\r\n    WEdge,\r\n    WEdgePoint,\r\n    WExtEdge,\r\n    WGraph,\r\n    WGraphElement,\r\n    WGraphVertex,\r\n    WRefEdge,\r\n    WVertex,\r\n    WVoidEdge,\r\n    WVoidVertex\r\n} from \"../model/dataStructure\";\r\nimport type {Class, Longest} from \"ts-mixer/dist/types/types\";\r\nimport type {\r\n    DAnnotation,\r\n    DAttribute,\r\n    DClass,\r\n    DClassifier,\r\n    DDataType,\r\n    DEnumerator,\r\n    DEnumLiteral,\r\n    DMap,\r\n    DModel,\r\n    DModelElement,\r\n    DNamedElement,\r\n    DObject,\r\n    DOperation,\r\n    DPackage,\r\n    DParameter,\r\n    DReference,\r\n    DStructuralFeature,\r\n    DTypedElement,\r\n    DValue,\r\n    LAnnotation,\r\n    LAttribute,\r\n    LClass,\r\n    LClassifier,\r\n    LDataType,\r\n    LEnumerator,\r\n    LEnumLiteral,\r\n    LMap,\r\n    LModelElement,\r\n    LNamedElement,\r\n    LObject,\r\n    LOperation,\r\n    LPackage,\r\n    LParameter,\r\n    LReference,\r\n    LStructuralFeature,\r\n    LTypedElement,\r\n    LValue,\r\n    WAnnotation,\r\n    WAttribute,\r\n    WClass,\r\n    WClassifier,\r\n    WDataType,\r\n    WEnumerator,\r\n    WEnumLiteral,\r\n    WMap,\r\n    WModel,\r\n    WModelElement,\r\n    WNamedElement,\r\n    WObject,\r\n    WOperation,\r\n    WPackage,\r\n    WParameter,\r\n    WReference,\r\n    WStructuralFeature,\r\n    WTypedElement,\r\n    WValue\r\n} from \"../model/logicWrapper\";\r\nimport type {\r\n    CClass,\r\n    Constructor,\r\n    Dependency,\r\n    Dictionary,\r\n    DocString,\r\n    GObject,\r\n    // Info,\r\n    InitialVertexSize,\r\n    InitialVertexSizeFunc,\r\n    InitialVertexSizeObj,\r\n    orArr,\r\n    Proxyfied,\r\n    unArr\r\n} from \"./types\";\r\nimport {EdgeBendingMode, EdgeGapMode, NodeTypes, PrimitiveType} from \"./types\";\r\nimport type {\r\n    DViewElement,\r\n    DViewTransientProperties,\r\n    LViewTransientProperties,\r\n    WViewElement,\r\n    WViewTransientProperties\r\n} from \"../view/viewElement/view\";\r\nimport type {LogicContext} from \"./proxy\";\r\nimport {\r\n    Action,\r\n    BEGIN,\r\n    CreateElementAction,\r\n    Defaults,\r\n    DeleteElementAction,\r\n    DLog,\r\n    DState,\r\n    DViewPoint,\r\n    EdgeSegment,\r\n    END,\r\n    GraphPoint,\r\n    GraphSize,\r\n    LGraph,\r\n    LLog,\r\n    LModel,\r\n    Log,\r\n    LViewElement,\r\n    LViewPoint,\r\n    ParsedAction,\r\n    SetFieldAction,\r\n    SetRootFieldAction, ShortAttribETypes, statehistory,\r\n    store,\r\n    TRANSACTION,\r\n    U\r\n} from \"./index\";\r\nimport {OclEngine} from \"@stekoe/ocl.js\";\r\nimport {ReactNode} from \"react\";\r\n\r\nvar windoww = window as any;\r\n// qui dichiarazioni di tipi che non sono importabili con \"import type\", ma che devono essere davvero importate a run-time (eg. per fare un \"extend\", chiamare un costruttore o usare un metodo statico)\r\n\r\n\r\nconsole.warn('ts loading classes');\r\n\r\n\r\n// annotation @RuntimeAccessible\r\n// import {store} from \"../redux/createStore\";\r\n\r\nabstract class AbstractMixedClass {\r\n    // superclass!: Dictionary<DocString<'parent class name', Class>>;\r\n    static logic: typeof LPointerTargetable;\r\n    static structure: typeof DPointerTargetable;\r\n    static singleton: LPointerTargetable;\r\n    // static [key: string]: any;\r\n    static init_constructor(...constructorArguments: any): void{}\r\n}\r\n\r\nexport abstract class RuntimeAccessibleClass extends AbstractMixedClass {\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    //static extendTree: TreeModel.Node<typeof RuntimeAccessibleClass>// Tree<string, typeof RuntimeAccessibleClass>;\r\n    static extendMatrix: Dictionary<string, Dictionary<string, boolean>>;\r\n    // static name: never; // it breaks with minification, don't use it\r\n    static cname: string;\r\n    private static OCL_Constructors: Dictionary<Pointer<DModel>, Dictionary<DocString<\"DClass name\">, GObject<\"Fake constructors for ocl \\\"Context\\\"\">>> = {};\r\n\r\n    static set_extend(superclass: typeof RuntimeAccessibleClass, subclass: typeof RuntimeAccessibleClass): void{\r\n        if (!superclass.hasOwnProperty(\"subclasses\")) superclass.subclasses = [subclass];\r\n        else if (superclass.subclasses.indexOf(subclass) === -1) superclass.subclasses.push(subclass);\r\n        if (!subclass.hasOwnProperty(\"_extends\")) subclass._extends = [superclass];\r\n        else if (subclass._extends.indexOf(superclass) === -1) subclass._extends.push(superclass);\r\n    }\r\n\r\n    static extendPrototypes(){\r\n        (Array.prototype as any).contains = function (o:any): boolean{\r\n            return this.indexOf(o) !== -1;\r\n        };\r\n        (Array.prototype as any).joinOriginal = Array.prototype.join;\r\n        // @ts-ignore\r\n        Array.prototype.first = function(){ return this[0]; }\r\n        // @ts-ignore\r\n        eval(\"Array.prototype.last = function(){ return this[this.length-1]; }\");// without eval it still gives typescript error even with tsignore\r\n        // @ts-ignore\r\n        (Array.prototype as any).separator = function(...separators: any[]/*: orArr<(PrimitiveType | null | undefined | JSX.Element)[]>*/): (string|JSX.Element)[]{\r\n            if (Array.isArray(separators[0])) separators = separators[0]; // case .join([1,2,3])  --> .join(1, 2, 3)\r\n            // console.log(\"separators debug\", this, separators, this[0], typeof this[0]);\r\n            // if (typeof this[0] !== \"object\") return (this as any).joinOriginal(separators);\r\n            // if JSX\r\n            // it handles empty cells like it handles '', but this is how native .join() handles them too: [emptyx5, \"a\", emptyx1, \"b\"].join(\",\") ->  ,,,,,a,,b\r\n            let ret/*:JSX.Element[]*/ = [];\r\n            for (let i = 0; i < this.length; i++){\r\n                if (i === 0) {ret.push(this[i]); continue;}\r\n                ret.push(...separators);\r\n                ret.push(this[i]);\r\n            }\r\n            return ret;\r\n        }\r\n    }\r\n    static fixStatics() {\r\n        this.extendPrototypes();\r\n        for (let classs of Object.values(RuntimeAccessibleClass.annotatedClasses)) {\r\n            let gclass = classs as GObject;\r\n            for (let statickey in gclass.s) { gclass[statickey] = gclass.s[statickey]; }\r\n        }\r\n\r\n    }\r\n    // static allRuntimeClasses: string[] = [];\r\n    static classes: Dictionary<string, typeof RuntimeAccessibleClass> = {};\r\n    static annotatedClasses: Dictionary<string, typeof RuntimeAccessibleClass> = {};\r\n\r\n    static getAllNames(annotated = false): string[] {\r\n        return Object.keys(annotated ? RuntimeAccessibleClass.annotatedClasses : RuntimeAccessibleClass.classes); }\r\n    static getAllClasses(annotated = false): typeof RuntimeAccessibleClass[] {\r\n        return Object.values(annotated ? RuntimeAccessibleClass.annotatedClasses : RuntimeAccessibleClass.classes); }\r\n    static getAllClassesDictionary(annotated = false): Dictionary<string, typeof RuntimeAccessibleClass> {\r\n        return annotated ? RuntimeAccessibleClass.annotatedClasses : RuntimeAccessibleClass.classes; }\r\n\r\n    static wrapAll<D extends RuntimeAccessibleClass, L extends LPointerTargetable = LPointerTargetable, CAN_THROW extends boolean = false,\r\n        RET extends CAN_THROW extends true ? L[] : L[] = CAN_THROW extends true ? L[] : L[] >\r\n    (data: D[] | Pointer<DPointerTargetable, 0, 'N'>, baseObjInLookup?: DPointerTargetable, path: string = '', canThrow: CAN_THROW = false as CAN_THROW, state?: DState, filter:boolean=true): CAN_THROW extends true ? L[] : L[] {\r\n        if (!Array.isArray(data)) return [];\r\n        if (!data.length) return [];\r\n        if (!state) state = windoww.store.getState() as DState;\r\n        if (!filter) return data.map( d => DPointerTargetable.wrap(d, baseObjInLookup, path, canThrow, state)) as L[];\r\n        let ret = [];\r\n        for (let o of data) { if (o) ret.push( DPointerTargetable.wrap(o, baseObjInLookup, path, canThrow, state))}\r\n        return ret;\r\n    }\r\n\r\n    static wrap<D extends RuntimeAccessibleClass, L extends LPointerTargetable = LPointerTargetable, CAN_THROW extends boolean = false,\r\n        RET extends CAN_THROW extends true ? L : L | undefined = CAN_THROW extends true ? L : L | undefined>\r\n    (data: D | Pointer | undefined | null, baseObjInLookup?: DPointerTargetable, path: string = '', canThrow: CAN_THROW = false as CAN_THROW, state?: DState): CAN_THROW extends true ? L : L | undefined{\r\n        if (!data || (data as any).__isProxy) return data as any;\r\n        if (typeof data === 'string') {\r\n            data = DPointerTargetable.from(data, state) as D;\r\n            if (!data) {\r\n                windoww.Log.e(canThrow, 'Cannot wrap:', {data, baseObjInLookup, path});\r\n                return undefined as RET;\r\n            }\r\n        }\r\n        if (Array.isArray(data)) {\r\n            console.error('use WrapAll instead for arrays', {data, baseObjInLookup, path, canThrow});\r\n            if (canThrow) throw new Error(\"use WrapAll instead for arrays\");\r\n            else return undefined as any;\r\n        }\r\n        if (!data) return data;\r\n        // console.log('ProxyWrapping:', {data, baseObjInLookup, path});\r\n        return new Proxy(data, new windoww.TargetableProxyHandler(data, baseObjInLookup, path)) as L;\r\n    }\r\n    /*\r\n        static mapWrap2<D extends DPointerTargetable, L extends LPointerTargetable>(map: RuntimeAccessibleClass, container: D, baseObjInLookup?: DPointerTargetable, path: string = ''): L{\r\n            if (!map || (map as any).__isProxy) return map as any;\r\n            if (typeof container === 'string') {\r\n                container = store.getState().idlookup[container] as unknown as D;\r\n                if (!container) { return Log.exx('Cannot wrap map:', {map, container, baseObjInLookup, path}); }\r\n            }\r\n            // console.log('ProxyWrapping:', {data, baseObjInLookup, path});\r\n            return new Proxy(map, new MapProxyHandler(map, baseObjInLookup, path));\r\n        }\r\n\r\n    */\r\n\r\n    static mapWrap(data: Dictionary, baseObjInLookup: DPointerTargetable, path: string, subMapKeys: string[] = []): Proxyfied<Dictionary> {\r\n        if (!data || (data as any).__isProxy) return data as any;\r\n        // console.error('GETMAP', {data, logicContext, path});\r\n        return new Proxy(data, new windoww.MapProxyHandler(data, baseObjInLookup, path));\r\n    }\r\n\r\n    className!: string;\r\n    protected constructor(...a:any) {\r\n        super();\r\n        // RuntimeAccessibleClass.init_constructor(this, ...a);\r\n        // this.className = this.constructor.name;\r\n        // nb: per i mixin questo settaggio viene sovrascritto. perch√® il mixin crea le 2 classi ereditate separatamente con i loro costruttori e le incrocia. quindi devo settarlo dall'annotazione @ tramite prototype\r\n        // RuntimeAccessibleClass.allRuntimeClasses.push(this.className);\r\n    }\r\n\r\n    static init_constructor(thiss: any, ...args: any): void {\r\n\r\n        // this.className = this.constructor.name;\r\n        // let finalObject = this;\r\n        // if (finalObject.constructor.name === \"DVoidVertex\" || finalObject.constructor.name === \"DGraphElement\") { let breakp = true; }\r\n        // this.init0(...arguments);\r\n        // thiss.className = this.name;\r\n    }\r\n\r\n    public static get<T extends typeof RuntimeAccessibleClass = typeof RuntimeAccessibleClass>(dclassname: string, mode?: string )\r\n        : T & {logic?: typeof LPointerTargetable} {\r\n\r\n        // believe it or not there are actually 3 different versions generated, with different static method contexts, it's a mess.\r\n        return this.classes[dclassname] as any;\r\n        /*\r\n        switch(mode) {\r\n            case \"annotated version\":\r\n                /* it is like this in console\r\n                () {\r\n                    var _obj$initBase;\r\n                    for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\r\n                ...* /\r\n                return RuntimeAccessibleClass.annotatedClasses[dclassname] as any;\r\n            case \"local definition version\":\r\n            default: // same as window.classname\r\n            case \"module export version\":\r\n                /* it was like this in console, it is not anymore after reworking cname\r\n                // don't know how to get it now, but default version should be always the correct one,\r\n                    class DClassifier extends _joiner__WEBPACK_IMPORTED_MODULE_0__[\"DPointerTargetable\"]\r\n                which is even wrong as i asked for DPointerTargetable and not DClassifier. * /\r\n            return null as any;\r\n        }*/\r\n    }\r\n\r\n    public static extends(className?: string | typeof RuntimeAccessibleClass, superClassName?: string| typeof RuntimeAccessibleClass, returnIfEqual: boolean = true): boolean {\r\n        if (!className || !superClassName) return false;\r\n        const superclass = typeof superClassName === \"string\" ? RuntimeAccessibleClass.get(superClassName) : superClassName;\r\n        const thisclass = typeof className === \"string\" ? RuntimeAccessibleClass.get(className) : className;\r\n        if (!superclass || !thisclass) return false;\r\n        //console.trace(\"extends.1:\", {thisclass, superclass});\r\n        // console.log(\"extends.2:\", {iof:(thisclass instanceof superclass),\r\n        //     tree: !!(RuntimeAccessibleClass.extendTree.first((node) => node.model === superclass)?.first((node) => node.model === thisclass))});\r\n        if (superclass === thisclass) return returnIfEqual;\r\n        // for (let aaa in RuntimeAccessibleClass.extendTree.find(superClassName)) { }\r\n\r\n        return (thisclass instanceof superclass)\r\n            || RuntimeAccessibleClass.extendMatrix[superclass.cname]?.[thisclass.cname]\r\n        // !!(RuntimeAccessibleClass.extendTree.first((node) => node.model === superclass)?.first((node) => node.model === thisclass))\r\n        // || true;\r\n    }\r\n\r\n    getAllPrototypeSuperClasses(): GObject[] {\r\n        let currentlevel = this;\r\n        let ret: GObject[] = [];\r\n        while (true) {\r\n            if (!currentlevel) break;\r\n            ret.push(currentlevel);\r\n            // @ts-ignore\r\n            currentlevel = currentlevel.__proto__;\r\n        }\r\n        console.log('constructor chain:', ret);\r\n        return ret;\r\n    }\r\n    /*initBase(){\r\n        let superclasses = this.getAllPrototypeSuperClasses();\r\n        for (let sc of superclasses) {\r\n            if (!sc.hasOwnProperty('init0')) continue;\r\n            console.log('initbase calling ', {thiss: this, sc, init0: sc.init0, args:sc.constructorArguments});\r\n            sc.init0.apply(this, ...(sc.constructorArguments || []));\r\n        }\r\n    }*/\r\n    // protected abstract init(...constructorParameters: any): void;\r\n    // NB: per colpa della limitazione #3 di ts-mixer,\r\n    // DEVO chiamare init su ogni oggetto per settargli il corretto this.className, altrimenti prende quello dell'ultima superclasse\r\n    /*protected init0(...constructorParameters: any): void {\r\n        let a = this;\r\n        let finalObject = this;\r\n        console.log('creation of___ ', {thiss: this, finalObject});\r\n        if (finalObject.constructor.name === \"DVoidVertex\" || finalObject.constructor.name === \"DGraphElement\") {\r\n            let breakp = true; }\r\n\r\n        (window as any)[finalObject.constructor.name] =\r\n            RuntimeAccessibleClass.classes[finalObject.constructor.name] = finalObject.constructor as any;\r\n        // @ts-ignore\r\n        // delete this.className;\r\n        this.className = (finalObject as any).__proto__.className;\r\n    }*/\r\n\r\n    static makeOCLConstructor(data: DClass, state: DState, oldState: DState): GObject<\"fake constructor of m2-class for ocl's Context\"> {\r\n        let rootModel: DModel = data as any;\r\n        while (rootModel && rootModel.className !== \"DModel\") rootModel = DPointerTargetable.fromPointer(rootModel.father, state);\r\n        let mid: Pointer<DModel> = rootModel?.id; // NB: for EBoolean etc, primitive type meteclasses don't have a model;\r\n        if (!RuntimeAccessibleClass.OCL_Constructors[mid]) {\r\n            RuntimeAccessibleClass.OCL_Constructors[mid] = {...RuntimeAccessibleClass.classes};\r\n        }\r\n        const OclConstructor: GObject = data;\r\n        let namefixed: string;\r\n\r\n        if (oldState && oldState.idlookup[data.id]) {\r\n            let oldname = (oldState.idlookup[data.id] as DClass).name;\r\n            namefixed = U.replaceAll(U.replaceAll(oldname, '-', '_'), ' ', '_');\r\n            delete RuntimeAccessibleClass.OCL_Constructors[mid][oldname];\r\n            delete RuntimeAccessibleClass.OCL_Constructors[mid][namefixed];\r\n\r\n        }\r\n        namefixed = U.replaceAll(U.replaceAll(data.name, '-', '_'), ' ', '_');\r\n        RuntimeAccessibleClass.OCL_Constructors[mid][data.name] = OclConstructor;\r\n        RuntimeAccessibleClass.OCL_Constructors[mid][namefixed] = OclConstructor;\r\n\r\n        return data;\r\n    }\r\n\r\n    static getOCLClasses(model_id: Pointer<DModel>): GObject {\r\n        // return { ...(RuntimeAccessibleClass.OCL_Constructors[model_id] || {}), ...RuntimeAccessibleClass.classes}\r\n        return RuntimeAccessibleClass.OCL_Constructors[model_id] || RuntimeAccessibleClass.classes;\r\n    }\r\n}\r\nexport function Obsolete<T extends any>( constructor: T & GObject): T { return constructor; }\r\nexport function Leaf<T extends any>( constructor: T & GObject): T { return constructor; }\r\nexport function Node<T extends any>( constructor: T & GObject): T { return constructor; }\r\nexport function Abstract<T extends any>( constructor: T & GObject): T { return constructor; }\r\nexport function Instantiable<T extends any>(constructor: T & GObject, instanceConstructor?: Constructor): T { return constructor; } // for m2 cklasses that have m1 instances\r\n// export function RuntimeAccessible<T extends any>(cname: string): ((constructor: T & GObject) => T) {\r\nexport function RuntimeAccessible(cname: string) {\r\n    return (ctor: any) => RuntimeAccessible_inner(ctor, cname);\r\n}\r\n\r\nfunction RuntimeAccessible_inner<T extends any>(constructor: T & GObject, cname: string): T {\r\n    // console.log('DecoratorTest', {constructor, arguments});\r\n    (constructor as GObject).cname = cname;\r\n    if (!constructor.hasOwnProperty(\"subclasses\")) (constructor as GObject).subclasses = [];\r\n    // @ts-ignore\r\n    RuntimeAccessibleClass.classes[constructor.cname] = constructor as any as typeof RuntimeAccessibleClass;\r\n    // console.log(\"setting runtime accessible\", {key: constructor.cname, constructor, pre: predebug, post: {...RuntimeAccessibleClass.classes}});\r\n    if (!windoww[constructor.cname]) (windoww[constructor.cname] as any) = constructor;\r\n    constructor.prototype.className = constructor.cname;\r\n    //constructor.prototype.$$typeof = constructor.cname;\r\n    //constructor.prototype.typeName = constructor.cname;\r\n    (constructor as any).staticClassName = constructor.cname;\r\n    // @ts-ignore\r\n    // console.log('runtimeaccessible annotation:', {thiss:this, constructor});\r\n    //    const classnameFixedConstructor = constructor; //  function (...args) { let obj = new constructor(...args); obj.init?.(); obj.init0?.(); return obj; }\r\n\r\n    // @ts-ignore\r\n    let outerthis = this;\r\n    // @ts-ignore\r\n    const classnameFixedConstructorDoNotRenameWithoutSearchStrings = function (...args) {\r\n        // @ts-ignore\r\n        // console.log('runtimeaccessible annotation inner:', {thiss:this, outerthis, constructor});\r\n        // @ts-ignore\r\n        let obj = new constructor(...args);\r\n        obj.classNameFromAnnotation = constructor.cname;\r\n        obj.className = constructor.cname;\r\n        //obj.prototype.$$typeof = constructor.name;\r\n        // obj.prototype.typeName = constructor.name;\r\n        // obj.init?.();\r\n        // obj.init0?.();\r\n        obj.initBase?.();\r\n        // @ts-ignore\r\n        // console.log('runtimeaccessible annotation inner end:', {thiss:this, outerthis, constructor, obj});\r\n        return obj; }\r\n    RuntimeAccessibleClass.annotatedClasses[constructor.cname] = classnameFixedConstructorDoNotRenameWithoutSearchStrings as any as typeof RuntimeAccessibleClass;\r\n\r\n    for (let key in constructor) (classnameFixedConstructorDoNotRenameWithoutSearchStrings as GObject)[key] = constructor[key];\r\n    // constructor.constructor = classnameFixedConstructorDoNotRenameWithoutSearchStrings; return constructor;\r\n\r\n    // @ts-ignore\r\n    // for (let staticKey of constructor as GObject) { classnameFixedConstructorDoNotRenameWithoutSearchStrings[staticKey] = constructor[staticKey]; }\r\n    classnameFixedConstructorDoNotRenameWithoutSearchStrings.prototype = constructor.prototype;\r\n    classnameFixedConstructorDoNotRenameWithoutSearchStrings.prototype.constructor = constructor.prototype.constructor;\r\n\r\n    // required for inheriting static methods\r\n    classnameFixedConstructorDoNotRenameWithoutSearchStrings.__proto__ = constructor.__proto__;\r\n    classnameFixedConstructorDoNotRenameWithoutSearchStrings.s = constructor;\r\n    // return classnameFixedConstructorDoNotRenameWithoutSearchStrings as any;\r\n    return constructor;\r\n}\r\n\r\n\r\n(window as any).RuntimeAccessibleClass = RuntimeAccessibleClass;\r\n// todo: problema: per creare un PointerTargetable ho bisogno dell'userid, e devo generarlo prima che venga generato l'initialState... dovrebbe venir servito con la pagina dal server. o passato come navigation props dalla pagina di login\r\n\r\n\r\n\r\nexport type DtoL<DX extends GObject, LX =\r\n    DX extends DEnumerator ? LEnumerator : (DX extends DAttribute ? LAttribute : (DX extends DReference ? LReference : (DX extends DRefEdge ? LRefEdge : (DX extends DExtEdge ? LExtEdge : (DX extends DDataType ? LDataType : (DX extends DClass ? LClass : (DX extends DStructuralFeature ? LStructuralFeature : (DX extends DParameter ? LParameter : (DX extends DOperation ? LOperation : (DX extends DEdge ? LEdge : (DX extends DEdgePoint ? LEdgePoint : (DX extends DGraphVertex ? LGraphVertex : (DX extends DModel ? LModel : (DX extends DValue ? LValue : (DX extends DObject ? LObject : (DX extends DEnumLiteral ? LEnumLiteral : (DX extends DPackage ? LPackage : (DX extends DClassifier ? LClassifier : (DX extends DTypedElement ? LTypedElement : (DX extends DVertex ? LVertex : (DX extends DVoidEdge ? LVoidEdge : (DX extends DVoidVertex ? LVoidVertex : (DX extends DGraph ? LGraph : (DX extends DNamedElement ? LNamedElement : (DX extends DAnnotation ? LAnnotation : (DX extends DGraphElement ? LGraphElement : (DX extends DMap ? LMap : (DX extends DModelElement ? LModelElement : (DX extends DUser ? LUser : (DX extends DPointerTargetable ? LPointerTargetable :\r\n        (DX extends DUser ? LUser : (DX extends DLog ? LLog : (ERROR)))\r\n        ))))))))))))))))))))))))))))))> = LX;\r\nexport type DtoW<DX extends GObject, WX = DX extends DEnumerator ? WEnumerator : (DX extends DAttribute ? WAttribute : (DX extends DReference ? WReference : (DX extends DRefEdge ? WRefEdge : (DX extends DExtEdge ? WExtEdge : (DX extends DDataType ? WDataType : (DX extends DClass ? WClass : (DX extends DStructuralFeature ? WStructuralFeature : (DX extends DParameter ? WParameter : (DX extends DOperation ? WOperation : (DX extends DEdge ? WEdge : (DX extends DEdgePoint ? WEdgePoint : (DX extends DGraphVertex ? WGraphVertex : (DX extends DModel ? WModel : (DX extends DValue ? WValue : (DX extends DObject ? WObject : (DX extends DEnumLiteral ? WEnumLiteral : (DX extends DPackage ? WPackage : (DX extends DClassifier ? WClassifier : (DX extends DTypedElement ? WTypedElement : (DX extends DVertex ? WVertex : (DX extends DVoidEdge ? WVoidEdge : (DX extends DVoidVertex ? WVoidVertex : (DX extends DGraph ? WGraph : (DX extends DNamedElement ? WNamedElement : (DX extends DAnnotation ? WAnnotation : (DX extends DGraphElement ? WGraphElement : (DX extends DMap ? WMap : (DX extends DModelElement ? WModelElement : (DX extends DUser ? WUser : (DX extends DPointerTargetable ? WPointerTargetable : (ERROR)))))))))))))))))))))))))))))))> = WX;\r\n// export type DtoW<DX extends GObject, WX = Omit<DtoW0<DX>, 'id'>> = WX;\r\nexport type LtoD<LX extends LPointerTargetable, DX = LX extends LEnumerator ? DEnumerator : (LX extends LAttribute ? DAttribute : (LX extends LReference ? DReference : (LX extends LRefEdge ? DRefEdge : (LX extends LExtEdge ? DExtEdge : (LX extends LDataType ? DDataType : (LX extends LClass ? DClass : (LX extends LStructuralFeature ? DStructuralFeature : (LX extends LParameter ? DParameter : (LX extends LOperation ? DOperation : (LX extends LEdge ? DEdge : (LX extends LEdgePoint ? DEdgePoint : (LX extends LGraphVertex ? DGraphVertex : (LX extends LModel ? DModel : (LX extends LValue ? DValue : (LX extends LObject ? DObject : (LX extends LEnumLiteral ? DEnumLiteral : (LX extends LPackage ? DPackage : (LX extends LClassifier ? DClassifier : (LX extends LTypedElement ? DTypedElement : (LX extends LVertex ? DVertex : (LX extends LVoidEdge ? DVoidEdge : (LX extends LVoidVertex ? DVoidVertex : (LX extends LGraph ? DGraph : (LX extends LNamedElement ? DNamedElement : (LX extends LAnnotation ? DAnnotation : (LX extends LGraphElement ? DGraphElement : (LX extends LMap ? DMap : (LX extends LModelElement ? DModelElement : (LX extends LUser ? DUser : (LX extends LPointerTargetable ? DPointerTargetable : (ERROR)))))))))))))))))))))))))))))))> = DX;\r\nexport type LtoW<LX extends LPointerTargetable, WX = LX extends LEnumerator ? WEnumerator : (LX extends LAttribute ? WAttribute : (LX extends LReference ? WReference : (LX extends LRefEdge ? WRefEdge : (LX extends LExtEdge ? WExtEdge : (LX extends LDataType ? WDataType : (LX extends LClass ? WClass : (LX extends LStructuralFeature ? WStructuralFeature : (LX extends LParameter ? WParameter : (LX extends LOperation ? WOperation : (LX extends LEdge ? WEdge : (LX extends LEdgePoint ? WEdgePoint : (LX extends LGraphVertex ? WGraphVertex : (LX extends LModel ? WModel : (LX extends LValue ? WValue : (LX extends LObject ? WObject : (LX extends LEnumLiteral ? WEnumLiteral : (LX extends LPackage ? WPackage : (LX extends LClassifier ? WClassifier : (LX extends LTypedElement ? WTypedElement : (LX extends LVertex ? WVertex : (LX extends LVoidEdge ? WVoidEdge : (LX extends LVoidVertex ? WVoidVertex : (LX extends LGraph ? WGraph : (LX extends LNamedElement ? WNamedElement : (LX extends LAnnotation ? WAnnotation : (LX extends LGraphElement ? WGraphElement : (LX extends LMap ? WMap : (LX extends LModelElement ? WModelElement : (LX extends LUser ? WUser : (LX extends LPointerTargetable ? WPointerTargetable : (ERROR)))))))))))))))))))))))))))))))> = WX;\r\nexport type WtoD<IN extends WPointerTargetable, OUT = IN extends WEnumerator ? DEnumerator : (IN extends WAttribute ? DAttribute : (IN extends WReference ? DReference : (IN extends WRefEdge ? DRefEdge : (IN extends WExtEdge ? DExtEdge : (IN extends WDataType ? DDataType : (IN extends WClass ? DClass : (IN extends WStructuralFeature ? DStructuralFeature : (IN extends WParameter ? DParameter : (IN extends WOperation ? DOperation : (IN extends WEdge ? DEdge : (IN extends WEdgePoint ? DEdgePoint : (IN extends WGraphVertex ? DGraphVertex : (IN extends WModel ? DModel : (IN extends WValue ? DValue : (IN extends WObject ? DObject : (IN extends WEnumLiteral ? DEnumLiteral : (IN extends WPackage ? DPackage : (IN extends WClassifier ? DClassifier : (IN extends WTypedElement ? DTypedElement : (IN extends WVertex ? DVertex : (IN extends WVoidEdge ? DVoidEdge : (IN extends WVoidVertex ? DVoidVertex : (IN extends WGraph ? DGraph : (IN extends WNamedElement ? DNamedElement : (IN extends WAnnotation ? DAnnotation : (IN extends WGraphElement ? DGraphElement : (IN extends WMap ? DMap : (IN extends WModelElement ? DModelElement : (IN extends WUser ? DUser : (IN extends WPointerTargetable ? DPointerTargetable : (IN extends WViewElement ? DViewElement : (IN extends WViewTransientProperties ? DViewTransientProperties : (ERROR)))))))))))))))))))))))))))))))))> = OUT;\r\nexport type WtoL<IN extends WPointerTargetable, OUT = IN extends WEnumerator ? LEnumerator : (IN extends WAttribute ? LAttribute : (IN extends WReference ? LReference : (IN extends WRefEdge ? LRefEdge : (IN extends WExtEdge ? LExtEdge : (IN extends WDataType ? LDataType : (IN extends WClass ? LClass : (IN extends WStructuralFeature ? LStructuralFeature : (IN extends WParameter ? LParameter : (IN extends WOperation ? LOperation : (IN extends WEdge ? LEdge : (IN extends WEdgePoint ? LEdgePoint : (IN extends WGraphVertex ? LGraphVertex : (IN extends WModel ? LModel : (IN extends WValue ? LValue : (IN extends WObject ? LObject : (IN extends WEnumLiteral ? LEnumLiteral : (IN extends WPackage ? LPackage : (IN extends WClassifier ? LClassifier : (IN extends WTypedElement ? LTypedElement : (IN extends WVertex ? LVertex : (IN extends WVoidEdge ? LVoidEdge : (IN extends WVoidVertex ? LVoidVertex : (IN extends WGraph ? LGraph : (IN extends WNamedElement ? LNamedElement : (IN extends WAnnotation ? LAnnotation : (IN extends WGraphElement ? LGraphElement : (IN extends WMap ? LMap : (IN extends WModelElement ? LModelElement : (IN extends WUser ? LUser : (IN extends WPointerTargetable ? LPointerTargetable : (IN extends WViewElement ? LViewElement : (IN extends WViewTransientProperties ? LViewTransientProperties : (ERROR)))))))))))))))))))))))))))))))))> = OUT;\r\nexport type labelfunc = (e:LVoidEdge, segment: EdgeSegment, allNodes: LEdge[\"allNodes\"], allSegments: EdgeSegment[]) => PrimitiveType;\r\nexport enum CoordinateMode {\r\n    \"absolute\"              = \"absolute\",\r\n    \"relativePercent\"       = \"relative%\",\r\n    \"relativeOffset\"        = \"relativeOffset\",\r\n    \"relativeOffsetStart\"   = \"relativeOffsetStart\",\r\n    \"relativeOffsetEnd\"     = \"relativeOffsetEnd\",\r\n}\r\n\r\nexport type EPSize = GraphSize & {currentCoordType: CoordinateMode};\r\nexport enum EdgeHead {\r\n    composition = \"Composition\",\r\n    aggregation = \"Aggregation\",\r\n    reference   = \"Association\",\r\n    extend      = \"Extension\"\r\n}\r\n\r\n\r\n\r\nlet canFireActions: boolean = true;\r\n@RuntimeAccessible('Constructors')\r\nexport class Constructors<T extends DPointerTargetable = DPointerTargetable>{\r\n    public static paused: boolean = false;\r\n    private thiss: T;\r\n    private persist: boolean;\r\n    // private callbacks: Function[];\r\n    private nonPersistentCallbacks: Function[];\r\n    fatherType?: typeof RuntimeAccessibleClass;\r\n    private state?: DState; // set only if requested by setWithSideEffect\r\n    /*\r\n    problem: if isPersistent is set to false, but the object is later made persistent with an action, you lose all the callback effects afecting other elements (as setting opposite relations like instances-typeof or losing pointedBy's)\r\n    solution 1: store in the D-object a function executing the callbacks called by CreateNewElement action, then delete that field before persisting.\r\n    continued: instead of setting the pointedBy's this way (and increasing clonedcounter for nothing) erase all PointedBy mentionings here, and make all pointer values assigned separately with a SetAction,' +\r\n    '         if new2 is used that set manually a d-field, set it to undefined in the in the .end() part, then trigger the setaction with correct value.\r\n    continued: sort actions by path, but always make sure CreateElement are first in the sort regardless of path. make also sure 2 actions with the same path keep the order they are launched/created (oldest first)\r\n    */\r\n    constructor(t:T, father?: Pointer, persist: boolean = true, fatherType?: Constructor, id?: string, isUser:boolean = false) {\r\n        persist = persist && canFireActions;\r\n        this.thiss = t;\r\n        this.setID(id, isUser);\r\n        // the same thing is done in reducer/createelementaction, but if the object is destructured before then, it will lose the constructor and reducer will fail to assign classname\r\n        t.className = t.className || (t.constructor as typeof RuntimeAccessibleClass).cname || t.constructor.name;\r\n        DPointerTargetable.pendingCreation[t.id] = t;\r\n        this.persist = persist;\r\n        t._persistCallbacks = [];\r\n        t._derivedSubElements = [];\r\n        this.nonPersistentCallbacks = [];\r\n        if (this.thiss.hasOwnProperty(\"father\")) {\r\n            this.fatherType = fatherType as any;\r\n            this.setPtr(\"father\", father);\r\n        }\r\n    }\r\n\r\n    static makeID(isUser:boolean=false): Pointer { return \"Pointer\" + new Date().getTime() + \"_\" + (isUser ? DUser.current : 'USER') + \"_\" + (DPointerTargetable.maxID++) }\r\n    private setID(id?: string, isUser:boolean = false){\r\n        this.thiss.id = id || Constructors.makeID(isUser);\r\n    }\r\n\r\n    // cannot use Lobjects as they will set PointedBy in persistent state, also might access an incomplete version of the object crashing\r\n    private setPtr(property: string, value: any, checkPointerValidity?: DState) {\r\n        (this.thiss as GObject)[property] = value;\r\n        if (!value) return;\r\n        if (Array.isArray(value)) for (let v of value) {\r\n            if (!value) continue;\r\n            if (typeof v === \"object\") v = v.id;\r\n            if (!v || checkPointerValidity && !Pointers.isPointer(v, checkPointerValidity)) continue;\r\n            this.thiss._persistCallbacks.push(SetFieldAction.create(v, \"pointedBy\", PointedBy.fromID(this.thiss.id, property as any), '+='));\r\n        }\r\n        else {\r\n            if (typeof value === \"object\") value = value.id;\r\n            value && this.thiss._persistCallbacks.push(SetFieldAction.create(value, \"pointedBy\", PointedBy.fromID(this.thiss.id, property as any), '+='));\r\n        }\r\n        // todo: in delete if the element was not persistent, just do nothing.\r\n    }\r\n\r\n    private setExternalRootProperty<D extends DPointerTargetable>(path: string, val: any, accessModifier: \"[]\" | \"+=\" | \"\", isPointer: boolean): this {\r\n        this.thiss._persistCallbacks.push(SetRootFieldAction.create(path, val, accessModifier, isPointer));\r\n        return this;\r\n    }\r\n\r\n    private setExternalPtr<D extends DPointerTargetable>(target: D | Pointer<any>, property: string, accessModifier: \"[]\" | \"+=\" | \"\" = \"\", val?: any): this {\r\n        if (!target) return this;\r\n        if (typeof target === \"object\") target = target.id;\r\n        if (!val) val = this.thiss.id;\r\n        this.thiss._persistCallbacks.push(SetFieldAction.create(target, property, val, accessModifier, true));\r\n        return this;\r\n        // PointedBy is set by reducer directly in this case.\r\n        // this.thiss._persistCallbacks.push(SetFieldAction.create(this.thiss.id, \"pointedBy\", PointedBy.fromID(target, property as any), '+='));\r\n    }\r\n\r\n    private setWithSideEffect<D extends DPointerTargetable>(property: string, val: any): this {\r\n        if (!val) return this;\r\n        if (!this.state) this.state = store.getState();\r\n        if (typeof val === \"object\") val = val.id;\r\n        this.thiss._persistCallbacks.push( () => {\r\n            (LPointerTargetable.from(this.thiss, this.state) as GObject<\"L\">)[property] = val;\r\n        });\r\n        return this;\r\n    }\r\n\r\n    //static pause(): void { canFireActions = false; }\r\n    //static resume(): void { canFireActions = true; }\r\n    static persist(d: DPointerTargetable, fromCreateAction?: boolean): void;\r\n    static persist(d: DPointerTargetable[]): void;\r\n    static persist(d: orArr<DPointerTargetable>, fromCreateAction?: boolean): void {\r\n        if (Constructors.paused) return;\r\n        TRANSACTION(()=> {\r\n            if (!Array.isArray(d)) d = [d];\r\n            // first create \"this\"\r\n            for (let e of d) {\r\n                let subElements = e._derivedSubElements;\r\n                let callbacks = e._persistCallbacks;\r\n                delete (e as Partial<DPointerTargetable>)._derivedSubElements;\r\n                delete (e as Partial<DPointerTargetable>)._persistCallbacks;\r\n                // then create subelements (object -> values) and fire their actions.\r\n                if (!fromCreateAction) CreateElementAction.new(e, false);\r\n                for (let c of subElements) Constructors.persist([c]);\r\n                // finally fire the actions for \"this\"\r\n                for (let c of callbacks) (c as Action).fire ? (c as Action).fire() : (c as () => void)();\r\n            }\r\n        })\r\n    }\r\n    // start(thiss: any): this { this.thiss = thiss; return this; }\r\n    end(simpledatacallback?: (d:T, c: this) => void): T {\r\n        if (simpledatacallback) simpledatacallback(this.thiss, this); // callback for setting primitive types, not pointers not context-dependant values (name being potentially invalid / chosen according to parent)\r\n        if (this.nonPersistentCallbacks.length) {\r\n            for (let cb of this.nonPersistentCallbacks) cb();\r\n        }\r\n        if (!this.persist) return this.thiss;\r\n        Constructors.persist(this.thiss);\r\n        /// todo: warning: there is a transaction at .persist method, do not use BEGIN+END/TRANSACTION inside\r\n\r\n        return this.thiss; }\r\n\r\n\r\n    DState(): this {\r\n        let thiss: DState = this.thiss as any;\r\n        thiss.debug = !!localStorage.getItem('debug');\r\n        return this;\r\n    }\r\n\r\n    DModelElement(): this { return this; }\r\n    DClassifier(): this { return this; }\r\n    DParameter(defaultValue?: any): this {\r\n        let thiss: DParameter = this.thiss as any;\r\n        thiss.defaultValue = defaultValue;\r\n        this.setExternalPtr(thiss.father, \"parameters\", \"+=\");\r\n        return this; }\r\n    DStructuralFeature(): this {\r\n        if (this.thiss.className === 'DOperation') return this;\r\n        // if (!this.persist) return this;\r\n        let thiss: DAttribute|DReference = this.thiss as any;\r\n        const _DClass: typeof DClass = windoww.DClass;\r\n        const _DValue: typeof DValue = windoww.DValue;\r\n\r\n\r\n        let targets: DClass[] = [(_DClass as typeof DPointerTargetable).from(thiss.father, this.state)];\r\n        let alreadyParsed: Dictionary<Pointer, DClass> = {};\r\n        /*\r\n        todo: build a Tree<DClass> of all superclasses tree nested by level.\r\n            only then instantiate DValues by depth level, if same level from right to left (last extend on right takes priority) and erase this stuff below.*/\r\n        // let superClassesByLevel: Dictionary<Pointer, DClass> = ;\r\n        while(targets.length) { // gather superclasses in map \"alreadyParsed\"\r\n            let nextTargets = [];\r\n            for (let target of targets) {\r\n                if (!target) { Log.w(\"Invalid father pointer in DStructuralFeature\", {feature: thiss, father:target, superclasses: alreadyParsed}); continue; }\r\n                if (alreadyParsed[target.id]) continue;\r\n                alreadyParsed[target.id] = target;\r\n                for(let ext of target.extendedBy) nextTargets.push((_DClass as typeof DPointerTargetable).from(ext));\r\n            }\r\n            targets = nextTargets;\r\n        }\r\n        //(thiss as DPointerTargetable)._persistCallbacks.push(()=>{\r\n        // When a feature is added in m2, i loop instanced m1 objects to add that feature as a DValue.\r\n        for (let pointer in alreadyParsed) {\r\n            for (let instanceObjPtr of alreadyParsed[pointer].instances) {\r\n                // this._derivedSubElements.push(_DValue.new(thiss.name, thiss.id, undefined, instanceObjPtr));\r\n                thiss._derivedSubElements.push(_DValue.new3({name: undefined, instanceof: thiss.id, father: instanceObjPtr}, undefined, false));\r\n            }\r\n            //}\r\n        }\r\n\r\n\r\n        return this;\r\n    }\r\n    DReference(): this {\r\n        let thiss: DReference = this.thiss as any;\r\n        this.setExternalPtr(thiss.father, \"references\", \"+=\");\r\n        return this; }\r\n\r\n    DAttribute(): this {\r\n        let thiss: DAttribute = this.thiss as any;\r\n        this.setExternalPtr(thiss.father, \"attributes\", \"+=\");\r\n        return this; }\r\n\r\n    DDataType(): this { return this; }\r\n\r\n    DObject(instanceoff?: DObject[\"instanceof\"]): this {\r\n        let thiss: DObject = this.thiss as any;\r\n        if (thiss.father) {\r\n            if (this.fatherType!.cname === \"DModel\") {\r\n                this.setExternalPtr(thiss.father, \"objects\", \"+=\");\r\n            }\r\n            else {\r\n                // object containing object is not in any direct child collection. access through values\r\n                this.setExternalPtr(thiss.father, \"values\", \"+=\");\r\n            }\r\n        }\r\n        instanceoff && this.setWithSideEffect( \"instanceof\", instanceoff);\r\n        return this; }\r\n\r\n    DValue(instanceoff?: DValue[\"instanceof\"], val?: DValue[\"values\"], isMirage?: DValue[\"isMirage\"]): this {\r\n        let thiss: DValue = this.thiss as any; thiss.edges = [];\r\n        // thiss.values = val || [];\r\n        thiss.instanceof = instanceoff;\r\n        thiss.isMirage = isMirage || false;\r\n        if (val === undefined) val = [];\r\n        else if(!Array.isArray(val)) val = [val];\r\n        thiss.values = [];// because reducer calculating newly added pointedby must find something to start comparison\r\n        this.setPtr(\"values\", val, this.state);\r\n\r\n        // update father's collections (pointedby's here are set automatically)\r\n        if (instanceoff) {\r\n            this.setPtr(\"instanceof\", instanceoff);\r\n            this.setExternalPtr(instanceoff, \"instances\", \"+=\");\r\n        }\r\n        this.setExternalPtr(thiss.father, \"features\", \"+=\");\r\n        return this; }\r\n\r\n    DAnnotation(source?: DAnnotation[\"source\"], details?: DAnnotation[\"details\"]): this {\r\n        const thiss: DAnnotation = this.thiss as any;\r\n        thiss.source = source || '';\r\n        thiss.details = details || [];\r\n        this.setExternalPtr(thiss.father, \"annotations\", \"+=\");\r\n\r\n        if (details) for (let det of details)\r\n            thiss._persistCallbacks.push(SetFieldAction.create(det, \"pointedBy\", PointedBy.fromID(thiss.id, \"details\"), '+='));\r\n\r\n        return this; }\r\n\r\n    DPointerTargetable(): this {\r\n        const thiss: DPointerTargetable = this.thiss as any;\r\n        thiss.className = (thiss.constructor as typeof RuntimeAccessibleClass).cname;\r\n        // this.className = thiss.className;\r\n        return this; }\r\n\r\n    DUser(username: string): this {\r\n        const _this: DUser = this.thiss as unknown as DUser;\r\n        _this.username = username;\r\n        statehistory[_this.id] = {undoable:[], redoable:[]};\r\n        // todo: make it able to combine last 2 changes with a keystroke.\r\n        //  reapeat N times to combine N actions.\r\n        //  let it \"redo\" multiple times, it's like recording a macro.\r\n\r\n        if (this.persist) {\r\n            // no pointedBy\r\n        }\r\n        return this; }\r\n\r\n    DNamedElement(name?: DNamedElement[\"name\"]): this {\r\n        const thiss: DNamedElement = this.thiss as any;\r\n        thiss.name = (name !== undefined) ? name || '' : thiss.constructor.name.substring(1) + \" 1\";\r\n        return this; }\r\n\r\n    DTypedElement(type?: DTypedElement[\"type\"]): this {\r\n        const thiss: DTypedElement = this.thiss as any;\r\n        this.setPtr(\"type\", type);\r\n        return this; }\r\n\r\n    DPackage(uri?: DPackage[\"uri\"], prefix?: DPackage[\"prefix\"]): this {\r\n        const thiss: DPackage = this.thiss as any;\r\n        thiss.uri = uri || '';// || 'org.jodel-react.username';\r\n        thiss.prefix = prefix || '';\r\n        if (thiss.father) {\r\n            if (this.fatherType!.cname === \"DModel\") {\r\n                this.setExternalPtr(thiss.father, \"packages\", \"+=\");\r\n            }\r\n            else {\r\n                this.setExternalPtr(thiss.father, \"subpackages\", \"+=\");\r\n            }\r\n        }\r\n        return this; }\r\n\r\n    DModel(instanceoff?: DModel[\"instanceof\"], isMetamodel?: DModel[\"isMetamodel\"]): this {\r\n        const thiss: DModel = this.thiss as any;\r\n        thiss.packages = []; // packages;\r\n        thiss.isMetamodel = isMetamodel || false;\r\n        this.setPtr(\"instanceof\", instanceoff || null);\r\n        instanceoff && this.setExternalPtr(instanceoff, \"instances\", \"+=\");\r\n        // todo: check all D.new calls to make sure there are not actions in callbacks in new2() versions that will go outside the Transaction of persist(),, better move ptrs as .new() parameters\r\n        // or make it so new2 splits pointer and non-pointer declarations (or just allow non-ptrs and ptrs must be DSomething.new() explicit parameters)\r\n        thiss._persistCallbacks.push(SetRootFieldAction.create(isMetamodel ? \"m2models\" : \"m1models\", thiss.id, \"+=\", true));\r\n        return this;\r\n    }\r\n\r\n    DOperation(exceptions: DOperation[\"exceptions\"] = [], implementation?: string/*, parameters: DOperation[\"parameters\"] = []*/): this {\r\n        const thiss: DOperation = this.thiss as any;\r\n        // thiss.parameters = parameters;\r\n        thiss.implementation = implementation || 'return \"default placeholder function called\";'\r\n        this.setPtr(\"exceptions\", exceptions);\r\n        this.setExternalPtr(thiss.father, \"operations\", \"+=\");\r\n        return this; }\r\n\r\n    DClass(isInterface: DClass[\"interface\"] = false, isAbstract: DClass[\"abstract\"] = false, isPrimitive: LClassifier[\"isPrimitive\"] = false,\r\n           partial: DClass[\"partial\"] = false, partialdefaultname: DClass[\"partialdefaultname\"] = ''): this {\r\n        const thiss: DClass = this.thiss as any;\r\n        thiss.interface = isInterface;\r\n        thiss.abstract = isAbstract;\r\n        thiss.isPrimitive = isPrimitive;\r\n        thiss.partial = partial;\r\n        thiss.partialdefaultname = partialdefaultname;\r\n        this.setExternalPtr(thiss.father, \"classifiers\", \"+=\");\r\n        this.setExternalRootProperty('ClassNameChanged.'+thiss.id, thiss.name, '', false);\r\n\r\n        // thiss.isClass = !isPrimitive;\r\n        // thiss.isEnum = false;\r\n        return this; }\r\n\r\n    DEnumLiteral(value?: DEnumLiteral[\"value\"]): this { // vv4\r\n        const thiss: DEnumLiteral = this.thiss as any;\r\n        thiss.value = value as any; // undef is ok, handled in getter as automatic ordinal index\r\n        thiss.literal = thiss.name;\r\n        this.setExternalPtr(thiss.father, \"literals\", \"+=\");\r\n        return this; }\r\n\r\n    DEnumerator(literals: DEnumerator[\"literals\"] = []): this {\r\n        const thiss: DEnumerator = this.thiss as any;\r\n        this.setExternalPtr(thiss.father, \"classifiers\", \"+=\");\r\n        this.setPtr(\"literals\", literals);\r\n        // thiss.literals = literals;\r\n        // thiss.isClass = false;\r\n        // thiss.isEnum = true;\r\n        return this; }\r\n    DEdgePoint(): this { return this; }\r\n    DEdge(): this {\r\n        let thiss: DVoidEdge = this.thiss as any;\r\n        return this; }\r\n    DVertex(): this { return this; }\r\n    DVoidEdge(start: DGraphElement[\"id\"] | DGraphElement | LGraphElement | DModelElement[\"id\"] | DModelElement | LModelElement,\r\n              end: DGraphElement[\"id\"] | DGraphElement | LGraphElement | DModelElement[\"id\"] | DModelElement | LModelElement,\r\n              longestLabel?: DEdge[\"longestLabel\"], labels?: DEdge[\"labels\"]): this {\r\n        const thiss: DVoidEdge = this.thiss as any;\r\n        let startid: DGraphElement[\"id\"] = (windoww.LGraphElement as typeof LGraphElement).getNodeId(start);\r\n        let endid: DGraphElement[\"id\"] = (windoww.LGraphElement as typeof LGraphElement).getNodeId(end);\r\n        Log.ex(!startid || !endid, \"cannot create an edge without start or ending nodes\", {start, end, startid, endid});\r\n        thiss.anchorStart = '0';\r\n        thiss.anchorEnd = '0';\r\n        // thiss.startFollow = false;\r\n        // thiss.endFollow = false;\r\n        thiss.midnodes = [];\r\n        thiss.midPoints = []; // the logic part which instructs to generate the midnodes\r\n        // if (!thiss.model && isDModelElementPointer(startid)) thiss.model = startid;\r\n        // thiss.labels = undefined;\r\n        let ll: labelfunc = (e: LVoidEdge, s: EdgeSegment, allNodes: LGraphElement[], allSegments: EdgeSegment[]\r\n        ) => /*defining the edge label (e.start.model as any)?.name + \" ~ \" + (e.end.model as any)?.name */\" (\" + s.length.toFixed(1) + \")\";\r\n        // complex edge label func example: (thiss.longestLabel = ll)\r\n        thiss.longestLabel = longestLabel;\r\n        this.setPtr(\"start\", startid);\r\n        this.setPtr(\"end\", endid);\r\n        this.setExternalPtr(startid, \"edgesOut\", \"+=\");\r\n        this.setExternalPtr(endid, \"edgesIn\", \"+=\");\r\n\r\n        let gthis: Partial<DVoidEdge> = thiss;\r\n        delete gthis.x;\r\n        delete gthis.y;\r\n        delete gthis.w;\r\n        delete gthis.h;\r\n        delete gthis.edgesIn;\r\n        delete gthis.edgesOut;\r\n        delete gthis.anchors;\r\n        delete gthis.__isDVoidEdge;\r\n        delete (gthis as Partial<DEdge>).__isDEdge;\r\n        return this; }\r\n\r\n    DExtEdge(): this { return this; }\r\n    DRefEdge(): this { return this; }\r\n\r\n    DGraphElement(model: DGraphElement[\"model\"]|null|undefined, parentgraphID: DGraphElement[\"graph\"]|undefined,\r\n                  htmlindex: number = 1): this {\r\n        const thiss: DGraphElement = this.thiss as any;\r\n        thiss.subElements = [];\r\n        thiss.favoriteNode = false;\r\n        thiss.zIndex = htmlindex;\r\n        thiss.isSelected = {};\r\n        thiss.edgesIn = [];\r\n        thiss.edgesOut = [];\r\n        // thiss.state = {id: thiss.id+\".state\", className: thiss.className};\r\n        // 5-way anchors thiss.anchors = {'0':{x:0.5, y:0.5}, '1':{x:0.5, y:0}, '2':{x:1, y:0.5}, '3':{x:0.5, y:1}, '4':{x:0, y:0.5}} as any;\r\n        thiss.anchors = {'0':{x:0.5, y:0.5}, 't':{x:0.5, y:0},\r\n            'tr':{x:1, y:0}, 'r':{x:1, y:0.5}, 'br':{x:1, y:1},\r\n            'b':{x:0.5, y:1},\r\n            'bl':{x:0, y:1}, 'l':{x:0, y:0.5}, 'tl':{x:0, y:0},\r\n        } as any;\r\n        for (let k in (thiss.anchors as GObject)) {\r\n            let a: GObject = thiss.anchors[k];\r\n            if (!a.name) a.name = k;\r\n            if (!a.w) a.w = 15;\r\n            if (!a.h) a.h = 15;\r\n        }\r\n\r\n        this.setPtr(\"model\", model);\r\n        this.setPtr(\"graph\", parentgraphID);\r\n        this.setExternalPtr(thiss.father, \"subElements\", \"+=\");\r\n\r\n        Log.eDev(thiss.father&&DPointerTargetable.fromPointer(thiss.father).subElements.indexOf(thiss.id)!==-1, \"subelemnts+= addition have duplicates\",\r\n            {adding:thiss, d:thiss.father&&DPointerTargetable.fromPointer(thiss.father).subElements.indexOf(thiss.id)});\r\n\r\n        return this;\r\n    }\r\n\r\n    DViewElement(name: string, jsxString: string, vp?: Pointer<DViewPoint>, defaultVSize?: GraphSize, usageDeclarations: string = '', constants: string = '',\r\n                 preRenderFunc: string = '', appliableToClasses: string[] = [], oclCondition: string = '', priority?: number): this {\r\n        const thiss: DViewElement = this.thiss as any;\r\n        const vid = thiss.id;\r\n        let tv = transientProperties.view[vid];\r\n        if (!tv) transientProperties.view[vid] = tv = {} as any;\r\n\r\n        thiss.name = name;\r\n        thiss.appliableToClasses = appliableToClasses;\r\n        thiss.appliableTo = 'Any';\r\n        thiss.jsxString = jsxString;\r\n        thiss.usageDeclarations = usageDeclarations;\r\n        thiss.constants = undefined; // '{}';\r\n        thiss.preRenderFunc = ''; // '() => {return{}}';\r\n        thiss.onDragEnd = thiss.onDragStart = thiss.whileDragging =\r\n        thiss.onResizeEnd = thiss.onResizeStart = thiss.whileResizing = '';\r\n        thiss.onRotationEnd = thiss.onRotationStart = thiss.whileRotating = '';\r\n        thiss.onDataUpdate = '';\r\n        thiss.events = {};\r\n        // thiss.__transient = new DViewTransientProperties();\r\n        thiss.subViews = {};\r\n        thiss.oclCondition = oclCondition || '';\r\n        thiss.jsCondition = '';\r\n        thiss.oclUpdateCondition = '';\r\n        thiss.OCL_NEEDS_RECALCULATION = true;\r\n        thiss.explicitApplicationPriority = undefined as any; //priority as any as number;\r\n        thiss.isExclusiveView = true;\r\n        thiss.size = {};\r\n        thiss.storeSize = false;\r\n        thiss.lazySizeUpdate = true;\r\n        thiss.isValidation = false;\r\n        //thiss.constraints = [];\r\n        thiss.palette = {\r\n            'color-': U.hexToPalette(), //['#ffffff', '#ff0000', '#00ff00', '#0000ff','#aaaaaa', '#ffaaaa', '#aaffaa', '#aaaaff'],\r\n            'background-': U.hexToPalette() // ['#000000', '#33333', '#777777']};\r\n        };\r\n        thiss.css = '';\r\n        thiss.compiled_css = '';\r\n        thiss.css_MUST_RECOMPILE = true;\r\n        thiss.cssIsGlobal = false;\r\n        // thiss.palette = {};\r\n\r\n        // thiss.useSizeFrom = EuseSizeFrom.node;\r\n        // thiss.adaptHeight = false;\r\n        // thiss.adaptWidth = false;\r\n\r\n\r\n        thiss.draggable = true;\r\n        thiss.resizable = true;\r\n        //thiss.display = 'flex' as any;\r\n        thiss.defaultVSize = defaultVSize || new GraphSize(0, 0, 140.6818084716797, 32.52840805053711);\r\n        thiss.adaptWidth = false;\r\n        thiss.adaptHeight = true; //'fit-content';\r\n\r\n        thiss.edgeStartOffset = new GraphPoint(50, 50);\r\n        thiss.edgeEndOffset = new GraphPoint(50, 50);\r\n        thiss.edgeStartOffset_isPercentage = true;\r\n        thiss.edgeEndOffset_isPercentage = true;\r\n        thiss.edgeStartStopAtBoundaries = true;\r\n        thiss.edgeEndStopAtBoundaries = true;\r\n        thiss.bendingMode = EdgeBendingMode.Bezier_quadratic;\r\n        thiss.edgeGapMode = EdgeGapMode.center;\r\n        thiss.edgePointCoordMode = CoordinateMode.relativeOffset;\r\n        thiss.usageDeclarations = undefined;\r\n\r\n        /// edge only\r\n\r\n        thiss.edgeHeadSize = new GraphPoint(20, 20);\r\n        thiss.edgeTailSize = new GraphPoint(20, 20);\r\n        if (thiss.className !== 'DViewElement') return this;\r\n        const user = LUser.fromPointer(DUser.current);\r\n        // const project = user?.project; if(!project) return this;\r\n        if (!vp) vp = user?.project?.activeViewpoint.id || Defaults.viewpoints[0];\r\n        if (vp !== 'skip') {\r\n            let dvp = DPointerTargetable.fromPointer(vp);\r\n            // let subviews = {...dvp.subViews}; subviews[thiss.id] = 1.5;\r\n            // this.setExternalPtr(vp, 'subViews', '', subviews);\r\n            let subviews: GObject = {}; subviews[thiss.id] = 1.5;\r\n            this.setExternalPtr(vp, 'subViews', '+=', subviews);\r\n            this.setPtr('viewpoint', vp);\r\n        }\r\n\r\n        let trview = transientProperties.view[thiss.id] = {} as any;\r\n        // trview.?? = ???\r\n\r\n        TRANSACTION(() => {\r\n            // add relation to vp\r\n            for(let key of (windoww.DViewElement as typeof DViewElement).RecompileKeys)\r\n                this.setExternalRootProperty('VIEWS_RECOMPILE_'+key, thiss.id, '+=', false) // is pointer, but no need to set pointedby\r\n        })\r\n\r\n        // this.setExternalPtr(project.id, 'views', '+=');\r\n        // this.setExternalPtr(project.id, 'stackViews', '+=');\r\n        return this;\r\n    }\r\n\r\n    DViewPoint(): this {\r\n        const thiss: DViewPoint = (this.thiss) as any;\r\n        const user = LUser.fromPointer(DUser.current);\r\n        const project = user?.project;\r\n        if (!project) return this;\r\n        this.setExternalPtr(project.id, 'viewpoints', '+=');\r\n        // thiss._persistCallbacks.push( SetFieldAction.create(project.id, 'stackViews', [], '', false) );\r\n        return this;\r\n    }\r\n\r\n    DProject(type: DProject['type'], name: string, state: DProject['state'], m2: DProject['metamodels'], m1: DProject['models'], id?: DProject['id']): this {\r\n        const _this: DProject = U.wrapper<DProject>(this.thiss);\r\n        _this.metamodels = m2;\r\n        _this.models = m1;\r\n        _this.type = type;\r\n        _this.name = name;\r\n        _this.state = state;\r\n        if(id) _this.id = id;\r\n        this.setExternalPtr(DUser.current, 'projects', '+=');\r\n        return this;\r\n    }\r\n\r\n    static DGraph_maxID: number = 0;\r\n    public static DGraph_makeID(modelid: DGraph[\"model\"]): Pointer<DGraph, 1, 1, LGraph> {\r\n        if (!modelid) modelid = \"shapeless\";\r\n        return modelid + '^graph' + Constructors.DGraph_maxID++;\r\n    }\r\n    DGraph(): this {\r\n        const thiss: DGraph = this.thiss as any;\r\n        thiss.graph = thiss.id; // no setPtr because i want to avoid circular pointedby reference\r\n        thiss.zoom = new GraphPoint(1, 1);\r\n        thiss.offset = new GraphPoint(0, 0);  // GraphSize.apply(this, [0, 0, 0 ,0]);\r\n        thiss._subMaps = {zoom: true, graphSize: true}\r\n\r\n        const user: LUser = LUser.fromPointer(DUser.current);\r\n        if (thiss.className === 'DGraph') { // to exclude GraphVertex\r\n            user.project && this.setExternalPtr(user.project.id, 'graphs', \"+=\");\r\n            thiss.x = 0;\r\n            thiss.y = 0;\r\n            thiss.w = 0;\r\n            thiss.h = 0;\r\n        }\r\n        else {\r\n            // todo: set to default graphvertex size, so it can skip a rerender\r\n            thiss.x = 0;\r\n            thiss.y = 0;\r\n            //thiss.w = packageDefaultSize.w;\r\n            //thiss.h = packageDefaultSize.h;\r\n        }\r\n        return this; }\r\n\r\n    DVoidVertex(defaultVSize?: InitialVertexSize): this {\r\n        const thiss: DVoidVertex = this.thiss as any;\r\n        /*[]{}<>\r\n?'^~\r\n&&||\\+\r\n6nb*/\r\n        let defaultVSizeObj: InitialVertexSizeObj | undefined;\r\n        let defaultVSizeFunc: InitialVertexSizeFunc;\r\n        thiss.isResized = false;\r\n\r\n        let lvertex: LVoidVertex = LPointerTargetable.fromD(thiss);\r\n        if (typeof defaultVSize !== \"function\") { defaultVSizeObj = defaultVSize; }\r\n        else {\r\n            defaultVSizeFunc = defaultVSize;\r\n            try { defaultVSizeObj = defaultVSizeFunc(lvertex.father, lvertex); }\r\n            catch (e) { Log.e(\"Error in user DefaultVSize function:\", {e, defaultVSizeFunc, txt:defaultVSizeFunc.toString()}); }\r\n        }\r\n        if (defaultVSizeObj) {\r\n            if (defaultVSizeObj.x !== undefined) thiss.x = defaultVSizeObj.x;\r\n            if (defaultVSizeObj.y !== undefined) thiss.y = defaultVSizeObj.y;\r\n            if (defaultVSizeObj.w !== undefined) thiss.w = defaultVSizeObj.w;\r\n            if (defaultVSizeObj.h !== undefined) thiss.h = defaultVSizeObj.h;\r\n\r\n            if ((defaultVSizeObj as any).index >= 0 && thiss.className === \"DEdgePoint\") {\r\n                let updateEPindex = () => {\r\n                    let lep = lvertex as LEdgePoint;\r\n                    let le: LVoidEdge = lep.father;\r\n                    let de: DVoidEdge = le.__raw;\r\n                    let subelements = [...de.subElements];\r\n                    U.arrayRemoveAll(subelements, thiss.id);\r\n                    subelements.splice(defaultVSizeObj?.index as number, 0, thiss.id);\r\n                    // console.log(\"setting subelements\", {oldsubelements, subelements, de, le, thiss});\r\n                    le.subElements = subelements as any;\r\n                    // todo: this might break \"pointedBy\" x984\r\n                }\r\n                // updateEPindex();\r\n                // it's already wrapped in a callback\r\n                // but needs a second one because after node is created, id is auto-appended to this collection\r\n                // and i need to rewrite that append by inserting my own customized index position\r\n                console.log(\"setting subelements 0\", {updateEPindex});\r\n                setTimeout(updateEPindex, 0);\r\n                // NB: do not use this.callbacks.push because the body of this func is executed after Constructors.end() so end() can never find and execute it.\r\n            }\r\n        }\r\n\r\n        return this; }\r\n\r\n\r\n}\r\n// export const Constructors = new _Constructors();\r\n\r\n@RuntimeAccessible(\"DPointerTargetable\")\r\nexport class DPointerTargetable extends RuntimeAccessibleClass {\r\n    static defaultComponent: (ownProps: GObject, children?: (string | React.Component)[]) => React.ReactElement; //\r\n    public static maxID: number = 0;\r\n    public static logic: typeof LPointerTargetable;\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static pendingCreation: Record<Pointer<DPointerTargetable, 1, 1>, DPointerTargetable> = {};\r\n    clonedCounter?: number;\r\n    _storePath?: string[];\r\n    _subMaps?: Dictionary<string, boolean>;\r\n    id!: Pointer<DPointerTargetable, 1, 1, LPointerTargetable>;\r\n    // pointedBy: DocString<'path in store'>[] = []; // NB: potrebbe contenere puntatori invalidi.\r\n    // se viene cancellato un intero oggetto A che contiene una lista di puntatori, gli oggetti che puntano ad A rimuovono A dai loro \"poitnedBy\",\r\n    // ma gli oggetti puntati da A tramite sotto-oggetti o attributi (subviews...) non vengono aggiornati in \"pointedby\"\r\n    pointedBy: PointedBy[] = [];\r\n    public className!: string;\r\n    _state: GObject = {};\r\n\r\n    static defaultname<L extends LModelElement = LModelElement>(startingPrefix: string | ((meta:L)=>string), father?: Pointer | DPointerTargetable | ((a:string)=>boolean), metaptr?: Pointer | null): string {\r\n        let lfather: LModelElement;\r\n        // startingPrefix = \"model_\", father = ((name: string) => !dmodelnames.includes(name))\r\n        if (father) {\r\n            if (typeof father === \"string\" || (father as any).className) { // Pointer or D\r\n                lfather = LPointerTargetable.wrap(father as DModelElement) as LModelElement;\r\n                if (!lfather) return (typeof startingPrefix === \"string\" ? startingPrefix : \"unnamed_elem\"); // can happen during parse when father ptr exist but it's not in store yet. not a prob\r\n                if (typeof startingPrefix !== \"string\") {\r\n                    let meta = LPointerTargetable.from(metaptr as Pointer);\r\n                    startingPrefix = startingPrefix(meta as L);\r\n                }\r\n                const childrenNames: (string)[] = lfather.children.map(c => (c as LNamedElement)?.name);\r\n                return U.increaseEndingNumber(startingPrefix + '0', false, false, (newname) => childrenNames.indexOf(newname) >= 0);\r\n            }\r\n            else {\r\n                let condition: (a:string)=>boolean = father as any;\r\n                return U.increaseEndingNumber(startingPrefix + '0', false, false, condition);\r\n            }\r\n        }\r\n        return startingPrefix + \"1\"; }\r\n\r\n    public static new(...a:any): DPointerTargetable { //father?: Pointer, persist: boolean = false, fatherType?: Constructor, ...a:any): DPointerTargetable {\r\n        Log.exx(\"cannot instantiate abstract class DPointerTargetable\");\r\n        return null as any;\r\n        // return new Constructors(new DPointerTargetable('dwc'), father, persist, fatherType).DPointerTargetable().end();\r\n    }\r\n    constructor(fakearg_detectwrongcalls:'dwc') {\r\n        super();\r\n        if (!fakearg_detectwrongcalls) throw new Error( \"cannot build D-objects using new keyword, use the static D-Class.new method instead\");\r\n    }\r\n\r\n    static fromL<LX extends LPointerTargetable,\r\n        DX = LX extends LEnumerator ? LEnumerator : (LX extends LAttribute ? LAttribute : (LX extends LReference ? LReference : (LX extends LRefEdge ? LRefEdge : (LX extends LExtEdge ? LExtEdge : (LX extends LDataType ? LDataType : (LX extends LClass ? LClass : (LX extends LStructuralFeature ? LStructuralFeature : (LX extends LParameter ? LParameter : (LX extends LOperation ? LOperation : (LX extends LEdge ? LEdge : (LX extends LEdgePoint ? LEdgePoint : (LX extends LGraphVertex ? LGraphVertex : (LX extends LModel ? LModel : (LX extends LValue ? LValue : (LX extends LObject ? LObject : (LX extends LEnumLiteral ? LEnumLiteral : (LX extends LPackage ? LPackage : (LX extends LClassifier ? LClassifier : (LX extends LTypedElement ? LTypedElement : (LX extends LVertex ? LVertex : (LX extends LVoidEdge ? LVoidEdge : (LX extends LVoidVertex ? LVoidVertex : (LX extends LGraph ? LGraph : (LX extends LNamedElement ? LNamedElement : (LX extends LAnnotation ? LAnnotation : (LX extends LGraphElement ? LGraphElement : (LX extends LMap ? LMap : (LX extends LModelElement ? LModelElement : (LX extends LUser ? LUser : (LX extends LPointerTargetable ? LPointerTargetable : (ERROR)))))))))))))))))))))))))))))))\r\n        >(data: LX): DX {\r\n        return data.__raw as any;\r\n    }\r\n\r\n\r\n    static fromPointer<// LOW extends number, UPP extends number | 'N',\r\n        T extends Pointer | Pointer[], // <DPointerTargetable, 1, 'N', LPointerTargetable>,\r\n        DDD extends (T extends Pointer<infer D> ? D : 'undefined D'),\r\n        LOW extends (T extends Pointer<any, infer LO> ? LO : 'undefined_upp'),\r\n        UPP extends (T extends Pointer<any, number, infer UP> ? UP : 'undefined_low'),\r\n\r\n        DDDARR extends (T extends Pointer<infer D>[] ? D : 'undefined_DARR'),\r\n        LOWARR extends (T extends Pointer<any, infer LO>[] ? LO : 'undefined_uppARR'),\r\n        UPPARR extends (T extends Pointer<any, number, infer UP>[] ? 'UP_is_N' : 'undefined_lowARR'),\r\n\r\n        RET = UPPARR extends 'UP_is_N' ?\r\n            (DDDARR[]) : // 0...N\r\n            (UPP extends 1 ? (LOW extends 0 ? DDD | null : DDD) : // 0...1 && 1...1\r\n                (LOW extends 1 ? DDD : undefined)  //1...1\r\n                ),\r\n        INFERRED = {ret: RET, upp: UPP, low:LOW, ddd: DDD, dddARR: DDDARR, lowARR: LOWARR, uppARR: UPPARR},>(ptr: T, s?: DState)\r\n        : RET {\r\n        s = s || store.getState();\r\n        if (!ptr) { return ptr as any; }\r\n        if (Array.isArray(ptr)) {\r\n            return ptr.map( (p: Pointer) => DPointerTargetable.fromPointer(p, s)) as any;\r\n        }\r\n        if (typeof ptr !== \"string\") {\r\n            console.error(\"wrong parameter in DPointerTargetable.fromPointers()\", ptr);\r\n            throw new Error(\"wrong parameter in DPointerTargetable.fromPointers()\");\r\n        }\r\n        if (s && s.idlookup[ptr as string]) return s.idlookup[ptr as string] as any;\r\n        return (DPointerTargetable.pendingCreation[ptr as string] || s.idlookup[ptr as string]) as any;\r\n        // return ((s || store.getState()).idlookup[ptr as string] || DPointerTargetable.pendingCreation[ptr as string]) as any;\r\n    }\r\n\r\n    static from<// LOW extends number, UPP extends number | 'N',\r\n        PTR extends Pointer | Pointer[], // <DPointerTargetable, 1, 'N', LPointerTargetable>,\r\n        DDD extends (PTR extends Pointer<infer D> ? D : 'undefined D'),\r\n        LOW extends (PTR extends Pointer<any, infer LO> ? LO : 'undefined_upp'),\r\n        UPP extends (PTR extends Pointer<any, number, infer UP> ? UP : 'undefined_low'),\r\n\r\n        DDDARR extends (PTR extends Pointer<infer D>[] ? D : 'undefined_DARR'),\r\n        LOWARR extends (PTR extends Pointer<any, infer LO>[] ? LO : 'undefined_uppARR'),\r\n        UPPARR extends (PTR extends Pointer<any, number, infer UP>[] ? 'UP_is_N' : 'undefined_lowARR'),\r\n\r\n        LX extends LPointerTargetable,\r\n\r\n        RETPTR = UPPARR extends 'UP_is_N' ?\r\n            (DDDARR[]) : // 0...N\r\n            (UPP extends 1 ? (LOW extends 0 ? DDD | null : DDD) : // 0...1 && 1...1\r\n                (LOW extends 1 ? DDD : undefined)  //1...1\r\n                ),\r\n        // DX = LX extends LEnumerator ? DEnumerator : (LX extends LAttribute ? DAttribute : (LX extends LReference ? DReference : (LX extends LDataType ? DDataType : (LX extends LClass ? DClass : (LX extends LStructuralFeature ? DStructuralFeature : (LX extends LParameter ? DParameter : (LX extends LOperation ? DOperation : (LX extends LModel ? DModel : (LX extends LValue ? DValue : (LX extends LObject ? DObject : (LX extends LEnumLiteral ? DEnumLiteral : (LX extends LPackage ? DPackage : (LX extends LClassifier ? DClassifier : (LX extends LTypedElement ? DTypedElement : (LX extends LNamedElement ? DNamedElement : (LX extends LAnnotation ? DAnnotation : ('ERROR'))))))))))))))))),\r\n        DX = LX extends LEnumerator ? DEnumerator : (LX extends LAttribute ? DAttribute : (LX extends LReference ? DReference : (LX extends LRefEdge ? DRefEdge : (LX extends LExtEdge ? DExtEdge : (LX extends LDataType ? DDataType : (LX extends LClass ? DClass : (LX extends LStructuralFeature ? DStructuralFeature : (LX extends LParameter ? DParameter : (LX extends LOperation ? DOperation : (LX extends LEdge ? DEdge : (LX extends LEdgePoint ? DEdgePoint : (LX extends LGraphVertex ? DGraphVertex : (LX extends LModel ? DModel : (LX extends LValue ? DValue : (LX extends LObject ? DObject : (LX extends LEnumLiteral ? DEnumLiteral : (LX extends LPackage ? DPackage : (LX extends LClassifier ? DClassifier : (LX extends LTypedElement ? DTypedElement : (LX extends LVertex ? DVertex : (LX extends LVoidEdge ? DVoidEdge : (LX extends LVoidVertex ? DVoidVertex : (LX extends LGraph ? DGraph : (LX extends LNamedElement ? DNamedElement : (LX extends LAnnotation ? DAnnotation : (LX extends LGraphElement ? DGraphElement : (LX extends LMap ? DMap : (LX extends LModelElement ? DModelElement : (LX extends LUser ? DUser : (LX extends LPointerTargetable ? DPointerTargetable : (ERROR))))))))))))))))))))))))))))))),\r\n        RET = DX extends 'ERROR' ? RETPTR : (RETPTR extends DX ? RETPTR : DX),\r\n        INFERRED = {ret: RET, RETPTR:RETPTR, upp: UPP, low:LOW, ddd: DDD, dddARR: DDDARR, lowARR: LOWARR, uppARR: UPPARR, LX:LX, DX:DX}>(ptr: PTR | LX, s?: DState)\r\n        : RET {\r\n        if (!ptr) return ptr as any;\r\n        if (Array.isArray(ptr)) return DPointerTargetable.fromArr(ptr, true, s) as any;\r\n        if ((ptr as LX).__isProxy) return (ptr as LX).__raw as any;\r\n        if (typeof ptr === \"string\") {\r\n            if (s && s.idlookup[ptr as string]) return s.idlookup[ptr as string] as any;\r\n            return (DPointerTargetable.pendingCreation[ptr as string] || store.getState().idlookup[ptr as string]) as any;\r\n        }\r\n        else if ((ptr as any as GObject<DX>).className) return ptr as any;\r\n        else return undefined as any;\r\n    }\r\n    public static fromArr(arr:any[], filter: boolean = true, s?: DState): DPointerTargetable[]{\r\n        let ret: (DPointerTargetable)[] = [];\r\n        s = s || store.getState();\r\n        for (let a of arr) {\r\n            let d = DPointerTargetable.from(a, s);\r\n            if (!filter || d) ret.push(d as DPointerTargetable);\r\n        }\r\n        return ret;\r\n    }\r\n    //static from0(a: any, ...aa: any): any { return null; }\r\n    static writeable<LX extends LPointerTargetable, WX = LtoW<LX>>(l: LX): WX { return l as any; }\r\n\r\n    _persistCallbacks!: ((() => void) | Action)[]; // deleted when it becomes persistent\r\n    _derivedSubElements!: DModelElement[]; // deleted when it becomes persistent\r\n    // persist(): void { Constructors.persist(this); }// deleted when it becomes persistent\r\n}\r\n\r\nRuntimeAccessibleClass.set_extend(RuntimeAccessibleClass, DPointerTargetable);\r\n/*\r\nlet d0: LClassifier = null as any;\r\nlet ptrr: Pointer<DPackage, 1, 'N', LPackage> = null as any;\r\nlet ptr1: Pointer<DPackage, 1, 1, LPackage> = null as any;\r\nlet dd = DPointerTargetable.from(d0.id);\r\n*/\r\n\r\n\r\n/*\r\ntype Pack1<D extends DPointerTargetable, L extends LPointerTargetable = DtoL<D>, P extends Pointer<D, 0, 1, L> = Pointer<D, 0, 1, L>, R = {D:D, L:L, P:P} > = P|D|L\r\ntype PackArr<D extends DPointerTargetable, L extends LPointerTargetable = DtoL<D>, P extends Pointer<D, 0, 1, L> = Pointer<D, 0, 1, L> , ARR = Pack1<D>> = (ARR)[];\r\ntype Pack<D extends DPointerTargetable, L extends LPointerTargetable = DtoL<D>, P extends Pointer<D, 0, 1, L> = Pointer<D, 0, 1, L> , ARR = Pack1<D>> = ARR | (ARR)[];*/\r\n\r\n\r\n\r\n@RuntimeAccessible('Pointers')\r\nexport class Pointers{\r\n    static filterValid<P extends (Pointer | Pointer[]) = any, RET = P extends Pointer[] ? P : P | null>\r\n    (p: P): P | null {\r\n        const pointerval: DPointerTargetable | DPointerTargetable[] = DPointerTargetable.from(p);\r\n        if (Array.isArray(pointerval)) return pointerval.filter( p => !!p).map( p => p.id) as P;\r\n        if (!pointerval) return null;\r\n        return pointerval.id as P; }\r\n\r\n    static fromArr<D extends DPointerTargetable, L extends LPointerTargetable, P extends Pointer> (val: (P | D | L | null | undefined)[] |  (P | D | L | null | undefined)): P[] {\r\n        if (!val) val = [];\r\n        if (!Array.isArray(val)) { val = [val]; }\r\n        if (!val.length) { return []; }\r\n        if ((val[0] as any).id) { val = (val as any as (LModelElement | DModelElement)[]).filter(v => !!v).map( (v) => v.id) as any[]; }\r\n        return val.filter( v => !!v) as any[]; }\r\n\r\n    fromm<D extends DPointerTargetable, L extends LPointerTargetable, P extends Pointer> (val: (P | D | L)): P | null { return !val ? null : (val as any).id; }\r\n\r\n    from0<// LOW extends number, UPP extends number | 'N',\r\n        PTR extends Pointer | Pointer[], // <DPointerTargetable, 1, 'N', LPointerTargetable>,\r\n        // DDD extends (PTR extends Pointer<infer D> ? D : 'undefined_D'),\r\n        LOW extends (PTR extends Pointer<any, infer LO> ? LO : 'undefined_upp'),\r\n        UPP extends (PTR extends Pointer<any, number, infer UP> ? UP : 'undefined_low'),\r\n        DDD extends (PTR extends Pointer<any, number, any, infer LL> ? LL : 'undefined_L'),\r\n\r\n        LOWARR extends (PTR extends Pointer<any, infer LO>[] ? LO : 'undefined_uppARR'),\r\n        UPPARR extends (PTR extends Pointer<any, number, infer UP>[] ? 'UP_is_N' : 'undefined_lowARR'),\r\n        DDDARR extends (PTR extends Pointer<any, any, any, infer LL>[] ? LL : 'undefined_LARR'),\r\n\r\n        DX extends DPointerTargetable,\r\n        LX extends LPointerTargetable,\r\n        WX extends WPointerTargetable,\r\n        RETPTR = UPPARR extends 'UP_is_N' ?\r\n            (DDDARR[]) : // 0...N\r\n            (UPP extends 1 ? (LOW extends 0 ? DDD | null : DDD) : // 0...1 && 1...1\r\n                (LOW extends 1 ? DDD : undefined)  //1...1\r\n                ),\r\n\r\n\r\n        // DX = LX extends LEnumerator ? DEnumerator : (LX extends LAttribute ? DAttribute : (LX extends LReference ? DReference : (LX extends LDataType ? DDataType : (LX extends LClass ? DClass : (LX extends LStructuralFeature ? DStructuralFeature : (LX extends LParameter ? DParameter : (LX extends LOperation ? DOperation : (LX extends LModel ? DModel : (LX extends LValue ? DValue : (LX extends LObject ? DObject : (LX extends LEnumLiteral ? DEnumLiteral : (LX extends LPackage ? DPackage : (LX extends LClassifier ? DClassifier : (LX extends LTypedElement ? DTypedElement : (LX extends LNamedElement ? DNamedElement : (LX extends LAnnotation ? DAnnotation : ('ERROR'))))))))))))))))),\r\n        LXX = DtoL<DX>,\r\n        DXX = LtoD<LX>,\r\n        LXFinal = LXX extends 'ERROR' ? LX : LXX,\r\n        DXFinal = DXX extends 'ERROR' ? DX : DXX,\r\n        RET = {d: DXFinal, l:LXFinal}, // Pointer<DX, 0 | 1, 1 | 'N', LX>\r\n        INFERRED = {ret: RET, RETPTR: RETPTR, LXX: LXX, DXX: DXX, upp: UPP, low:LOW, ddd: DDD, dddARR: DDDARR, lowARR: LOWARR, uppARR: UPPARR, LX:LX, DX:DX}>(data: LX | DX | WX)\r\n        : INFERRED {\r\n        return null as any;\r\n    }\r\n\r\n\r\n    static from00<\r\n        // LOW extends number, UPP extends number | 'N',\r\n        // DDD extends (PTR extends Pointer<infer D> ? D : 'undefined_D'),\r\n        DWL extends {id: any},\r\n        // PCK extends (T extends Pack<infer PPP> ? PPP : never),\r\n        //ISARR extends (T extends any[] ? true : false),\r\n        // PCK1 extends (T extends any[] ? null : T extends Pack1<infer PPP> ? PPP : never), //         PCK1 extends (T extends any[] ? true : false),\r\n        // PCKA extends (T extends PackArr<infer PPP> ? PPP : 'undefined_arrpack'),\r\n        // PTR extends DWL[\"id\"], // <DPointerTargetable, 1, 'N', LPointerTargetable>,\r\n        // T extends DWL | DWL[] | null | undefined,\r\n        /*DX extends (PTR extends Pointer<infer D0> ? D0 : 'undefined_D'),\r\n        LOW extends (PTR extends Pointer<any, infer LO> ? LO : 'undefined_upp'),\r\n        UPP extends (PTR extends Pointer<any, number, infer UP> ? UP : 'undefined_low'),\r\n        LX extends (PTR extends Pointer<any, number, any, infer LL> ? LL : 'undefined_L'),\r\n\r\n        LOWARR extends (PTR extends Pointer<any, infer LO>[] ? LO : 'undefined_uppARR'),\r\n        UPPARR extends (PTR extends Pointer<any, number, infer UP>[] ? 'UP_is_N' : 'undefined_lowARR'),\r\n        DDDARR extends (PTR extends Pointer<any, any, any, infer LL>[] ? LL : 'undefined_LARR'),\r\n        RET = DX extends DPointerTargetable ? ( LOW extends number ? ( UPP extends number ? ( LX extends LPointerTargetable ? Pointer<DX, LOW, UPP, LX> : '_notret_L_') : '_notret_UPP_') : '_notret_LOW_') : '_notret_D_'\r\n        */\r\n        PTRPARAM = Pointer | Pointer[],\r\n        T = Exclude<DWL | DWL[] | PTRPARAM, unknown[]>,\r\n        // @ts-ignore\r\n        PTR = T extends null ? null : T extends undefined ? null : (T extends PTRPARAM ? T : (T extends any[] ? T[number]['id'][] : T['id'])),\r\n        // RET extends Pointer<DPointerTargetable, any, any, LPointerTargetable> = T extends DWL ? DWL[\"id\"] : (T extends DWL[] ? DWL[\"id\"] : null),\r\n        // INF = { PCK:PCK, ISARR: ISARR,  PTR: PTR, DWL: DWL, RET: RET}, // {DD:DD, LL: LL}//\r\n        >(data: T | T[] ): PTR { // RET | RET[] {\r\n        if (Array.isArray(data)) return data.filter(d => !!d).map(d => (typeof d === \"string\" ? d : (d as any as DWL).id)) as any;\r\n        else return (data ? (data as any).id : null);\r\n    } // stavolta fai infer so D|l.id\r\n\r\n\r\n    public static from<DX extends DPointerTargetable>(data:DX): DX[\"id\"]; // | {D:any};\r\n    public static from<DX extends DPointerTargetable>(data:DX[]): DX[\"id\"][]; // | {DD:any};\r\n    public static from<LX extends LPointerTargetable>(data:LX): LX[\"id\"]; // | {L:any};\r\n    public static from<LX extends LPointerTargetable>(data:LX[]): LX[\"id\"][]; // | {LL:any};\r\n    public static from<WX extends WPointerTargetable>(data:WX): WX[\"id\"]; // | {W:any};\r\n    public static from<WX extends WPointerTargetable>(data:WX[]): WX[\"id\"][]; // | {WW:any};\r\n    public static from<PTR extends Pointer<DPointerTargetable, 1, 1, LPointerTargetable>>(data:PTR): PTR; // | {P:any};\r\n    public static from<PTR extends Pointer<DPointerTargetable, 1, 1, LPointerTargetable>>(data:PTR[]): PTR[]; // | {PP:any};\r\n    public static from<T extends LPointerTargetable>(data:Pack1<T>): Pointer<LtoD<T>, 1, 1, T>; //{TEST1:any};\r\n    public static from<T extends LPointerTargetable>(data:Pack1<T>[]): Pointer<LtoD<T>, 1, 1, T>[]; //{TEST111:any};\r\n    public static from<T extends LPointerTargetable>(data:Pack<T>): Pointer<LtoD<T>, 1, 1, T>[]; //{TEST0:any};\r\n    public static from<P extends Pack<T> | undefined, T extends LPointerTargetable>(data: P): Pointer<LtoD<T>, 1, 1, T>[]; //{TEST0:any};\r\n    public static from<T extends LPointerTargetable>(data:PackArr<T>): Pointer<LtoD<T>, 1, 1, T>[]; //{TESTARR:any};\r\n    public static from<T extends LPointerTargetable>(data:Pack1<T[]>): Pointer<LtoD<T>, 1, 1, T>; //{TEST1:any};\r\n    public static from<T extends LPointerTargetable>(data:Pack1<T[]>[]): Pointer<LtoD<T>, 1, 1, T>[]; //{TEST111:any};\r\n    public static from<T extends LPointerTargetable>(data:Pack<T[]>): Pointer<LtoD<T>, 1, 1, T>[]; //{TEST0:any};\r\n    public static from<T extends LPointerTargetable>(data:PackArr<T[]>): Pointer<LtoD<T>, 1, 1, T>[]; //{TESTARR:any};\r\n\r\n    /*\r\n        public static from(data:undefined): undefined; // | {D:any};\r\n        public static from<DX extends DPointerTargetable | undefined | null>(data:DX): DX extends DPointerTargetable ? DX[\"id\"] : DX; // | {D:any};\r\n        public static from<DX extends DPointerTargetable | undefined | null>(data:DX[]): DX extends DPointerTargetable ? DX[\"id\"][] : DX; // | {DD:any};\r\n        public static from<LX extends LPointerTargetable | undefined | null>(data:LX): LX extends LPointerTargetable ? LX[\"id\"] : LX; // | {L:any};\r\n        public static from<LX extends LPointerTargetable | undefined | null>(data:LX[]): LX extends LPointerTargetable ? LX[\"id\"][] : LX; // | {LL:any};\r\n        public static from<WX extends WPointerTargetable | undefined | null>(data:WX): WX extends WPointerTargetable ? WX[\"id\"] : WX; // | {W:any};\r\n        public static from<WX extends WPointerTargetable | undefined | null>(data:WX[]): WX extends WPointerTargetable ? WX[\"id\"][] : WX; // | {WW:any};\r\n        public static from<PTR extends Pointer<DPointerTargetable, 1, 1, LPointerTargetable> | undefined | null>(data:PTR): PTR extends Pointer<DPointerTargetable, 1, 1, LPointerTargetable> ? PTR : PTR; // | {P:any};\r\n        public static from<PTR extends Pointer<DPointerTargetable, 1, 1, LPointerTargetable> | undefined | null>(data:PTR[]): PTR extends Pointer<DPointerTargetable, 1, 1, LPointerTargetable> ? PTR[] : PTR; // | {PP:any};\r\n        public static from<T extends LPointerTargetable | undefined | null>(data:Pack1<T>): T extends LPointerTargetable ? Pointer<LtoD<T>, 1, 1, T> : T; //{TEST1:any};\r\n        public static from<T extends LPointerTargetable | undefined | null>(data:Pack1<T>[]): T extends LPointerTargetable ? Pointer<LtoD<T>, 1, 1, T>[] : T; //{TEST111:any};\r\n        public static from<T extends LPointerTargetable | undefined | null>(data:Pack<T>): T extends LPointerTargetable ? Pointer<LtoD<T>, 1, 1, T>[] : T; //{TEST0:any};\r\n        public static from<T extends LPointerTargetable | undefined | null>(data:PackArr<T>): T extends LPointerTargetable ? Pointer<LtoD<T>, 1, 1, T>[] : T; //{TESTARR:any};\r\n        // public static from<T extends LPointerTargetable | undefined | null>(data:Pack1<T[]>): T extends LPointerTargetable ? Pointer<LtoD<T>, 1, 1, T> : T; //{TEST1:any};\r\n        // public static from<T extends LPointerTargetable | undefined | null>(data:Pack1<T[]>[]): T extends LPointerTargetable ? Pointer<LtoD<T>, 1, 1, T>[] : T; //{TEST111:any};\r\n        // DDD extends (T extends Pointer<infer D> ? D : 'undefined D'),*/\r\n    // returns:\r\n    // if ptr is unvalid = undefined;\r\n    // if [ptr] is unvalid = []\r\n    public static from<TT extends Pack<LPointerTargetable[]> | undefined | null,\r\n        // @ts-ignore\r\n        T extends (TT extends Pack<infer PTYPE> ? PTYPE : undefined)>(data:T): T extends null | undefined ? T : Pointer<LtoD<T>, 1, 1, T>[]; //{TEST0:any};\r\n    // @ts-ignore\r\n    public static from<T extends LPointerTargetable | undefined | null>(data: PackArr<T[]>): T extends null | undefined ? T : Pointer<LtoD<T>, 1, 1, T>[]; //{TESTARR:any};\r\n    public static from(data:null | undefined): null; // | {Dn:any};\r\n    public static from(data:(null | undefined)[]): []; // | {Dnn:any};\r\n    public static from(data:(null | undefined) | (null | undefined)[]): []; // | {Dn0:any};\r\n\r\n    // function from<PTR extends Pointer<DPointerTargetable, 1, 1, LPointerTargetable>>(data:unknown | unknown[]): PTR | PTR[] | GObject {\r\n    public static from<T extends LClass, PTR extends Pointer<DPointerTargetable, 1, 1, LPointerTargetable>>(data:unknown | unknown[]): null | PTR | PTR[]{\r\n        if (!data) return null;\r\n        if (Array.isArray(data)) return data.filter(d => !!d).map(d => (typeof d === \"string\" ? d : (d as any)?.id)) as any;\r\n        return typeof data === \"string\" ? data : (data as any)?.id;\r\n    }\r\n\r\n    static isPointer(val: any, state?: DState, doArrayCheck: boolean = false): val is Pointer {\r\n        // might cause endless loop if there are subarrays in a containment loop.\r\n        if (doArrayCheck && Array.isArray(val)) return (val as any[]).some((v) => Pointers.isPointer(val, state, true));\r\n        if (state) return DPointerTargetable.from(val, state);\r\n        return typeof val === \"string\" ? val.includes(\"Pointer\") : false;\r\n    }\r\n}\r\n\r\n/*\r\nexport type Pack1<L extends LPointerTargetable | undefined | null,\r\n    // L extends LPointerTargetable | undefined | null = LL extends LPointerTargetable[] ? LPointerTargetable : null | undefined,\r\n    D extends (L extends LPointerTargetable ? LtoD<L> : undefined | null) = (L extends LPointerTargetable ? LtoD<L> : undefined | null)> =\r\n    L extends LPointerTargetable ? ( D extends DPointerTargetable ? D | L /*| LtoW<L>* / | Pointer<D, 1, 1, L> : L) : undefined;\r\nexport type PackArr<LL extends orArr<LPointerTargetable> | undefined | null,\r\n    L extends LPointerTargetable | undefined | null = LL extends undefined | null ? undefined : unArr<LL>> = Pack1<L>[];\r\nexport type Pack<\r\n    LL extends orArr<LPointerTargetable> | undefined | null,\r\n    L extends unArr<LL> = unArr<LL>,\r\n    // L extends (LL extends orArr<LPointerTargetable> ? LPointerTargetable : undefined | null) = (LL extends orArr<LPointerTargetable> ? unArr<LL> : undefined)\r\n    >\r\n    = LL extends undefined ? undefined : Pack1<L> | PackArr<L>;\r\n*/\r\nexport type Pack1<LL extends orArr<LPointerTargetable> | undefined, L extends LPointerTargetable | undefined = unArr<LL>,\r\n    D extends (L extends LPointerTargetable ? LtoD<L> : undefined) = (L extends LPointerTargetable ? LtoD<L> : undefined)> =\r\n    L extends LPointerTargetable ? ( D extends DPointerTargetable ? D | L | Pointer<D, 1, 1, L> : undefined) : undefined;\r\nexport type PackArr<LL extends orArr<LPointerTargetable> | undefined, L extends LPointerTargetable | undefined = unArr<LL>> = Pack1<L>[];\r\nexport type Pack<LL extends orArr<LPointerTargetable> | undefined, L extends LPointerTargetable | undefined = unArr<LL>> = L extends undefined ? undefined : Pack1<L> | PackArr<L>;\r\n/*\r\nlet n: any = null;\r\nlet aa: DClass = n;\r\nlet ptrr = Pointers.from(aa.parent);\r\naa.parent = ptrr;*/\r\n\r\n@RuntimeAccessible('PendingPointedByPaths')\r\nexport class PendingPointedByPaths{\r\n    static all: PendingPointedByPaths[] = [];\r\n    // static pendingMoreThanTwice: ParsedAction[] = [];\r\n    static maxSolveAttempts: number = 2099999;\r\n    public solveAttempts: number = 1;\r\n    private stackTrace: string[];\r\n\r\n    // tmp fields, not sure what i need\r\n    public action!: ParsedAction; // todo: remove\r\n    static new(action: ParsedAction, oldState: DState): PendingPointedByPaths {\r\n        const ptr: Pointer = action.value;\r\n        const target: DPointerTargetable | null = oldState.idlookup[ptr as string];\r\n        let pendingPointedBy = new PendingPointedByPaths(action.path, ptr);\r\n        pendingPointedBy.action = action;\r\n        return pendingPointedBy;\r\n    }\r\n\r\n    private constructor(\r\n        public from: DocString<\"full Path in store including field key\">,\r\n        // todo 6: how about actions that do not include index but just += -= [] ?\r\n        public to: Pointer){\r\n        this.stackTrace = U.getStackTrace();\r\n    }\r\n    static attemptimplementationdelete(pb: PointedBy) {\r\n        let state: DState = store.getState();\r\n        let objectChain = U.followPath(state, pb.source);\r\n    }\r\n\r\n    public attemptResolve(state: DState): ParsedAction | null {\r\n        if (this.canBeResolved(state)) return this.resolve();\r\n        return null;\r\n    }\r\n\r\n    private resolve(): ParsedAction{\r\n        U.arrayRemoveAll(PendingPointedByPaths.all, this);\r\n        return Action.parse(SetRootFieldAction.create(\"idlookup.\" + this.to + '.pointedBy', PointedBy.new(this.action.path), '+=', false));\r\n    }\r\n\r\n    public saveForLater(): void { PendingPointedByPaths.all.push(this); }\r\n    private canBeResolved(state: DState): boolean {\r\n        this.solveAttempts++;\r\n        Log.exDev(this.solveAttempts >= PendingPointedByPaths.maxSolveAttempts, \"pending PointedBy action is not revolved for too long, some pointer was wrongly set up.\", this.stackTrace, this, state);\r\n        return !!state.idlookup[this.to]; }\r\n\r\n    static getSolveableActions(oldState: DState): ParsedAction[] {\r\n        let allClone = [...this.all]; // necessary because the array will remove some elements during iteration as they are solved.\r\n        return allClone.map( p => p.attemptResolve(oldState)).filter(p => (!!p)) as ParsedAction[];\r\n    }\r\n}\r\n\r\n@RuntimeAccessible('PointedBy')\r\nexport class PointedBy {\r\n    static list: string[] = [\"father\", \"parent\", \"annotations\", \"packages\", \"type\", \"subpackages\", \"classifiers\", \"exceptions\", \"parameters\", \"defaultValue\", \"instances\", \"operations\", \"features\", \"attributes\", \"references\", \"extends\", \"extendedBy\", \"implements\", \"implementedBy\", \"instanceof\", \"edges\", \"target\", \"opposite\", \"parameters\", \"exceptions\", \"literals\", \"values\"];\r\n    source: string; // elemento da cui parte il puntatore\r\n    // field: keyof DPointerTargetable;\r\n    // il bersaglio non c'√® qui, perch√® √® l'oggetto che contiene questo dentro l'array pointedBy\r\n\r\n    /*private constructor(source: DPointerTargetable, field: any) {\r\n        this.source = source;\r\n        this.field = field;\r\n    }*/\r\n\r\n    static getPath(p: PointedBy) : string { return p.source.substring(0, p.source.lastIndexOf(\".\")); }\r\n    static getLastKey(p: PointedBy) : string { return p.source.substring(p.source.lastIndexOf(\".\")); }\r\n    static getPathArr(p: PointedBy) : string[] { return p.source.split('.'); }\r\n    private constructor(source: string) {\r\n        this.source = source;\r\n    }\r\n    // don't use modifiers here,\r\n    static fromID<D extends DPointerTargetable>(ptr: Pointer<D>, field: keyof D, NoAccessModifiersHere?: never & (\"-=\" | \"+=\")) {\r\n        return PointedBy.new(\"idlookup.\" + ptr + \".\" + field);\r\n    }\r\n    static new(source: DocString<\"full path in store including key. like \\'idlookup.id.extends+=\\'\">, modifier: \"-=\" | \"+=\" | undefined = undefined, action?: ParsedAction): PointedBy {\r\n        // let source: DocString<\"full path in store including key\"> = action.path;\r\n        // if (source.includes(\"true\")) { console.error(this, action); throw new Error(\"mixed a bool\"); }\r\n        if (modifier) source = source.substring(0, source.length - (modifier?.length || 0));\r\n        return new PointedBy(source);\r\n    }\r\n    // static new0<D extends DPointerTargetable> (source: D, field: keyof D): PointedBy { return new PointedBy(source, field); }\r\n\r\n\r\n\r\n    public static remove(oldValue: Pointer | undefined, action: ParsedAction, state: DState, casee: \"+=\" | \"-=\" | undefined = undefined, oldState?:DState): DState {\r\n        if (!oldValue) return state;\r\n        let oldtarget: DPointerTargetable = state.idlookup[oldValue];\r\n        if (!oldtarget) return state;\r\n        let index = -1;\r\n        let actionpath: string = action.path.substring(0, action.path.length -(casee?.length || 0))\r\n        for (let i = 0; i < oldtarget.pointedBy.length; i++) { if (oldtarget.pointedBy[i].source === actionpath) { index = i; break; } }\r\n        if (index < 0) return state;\r\n\r\n        if (oldState === state) state = {...state} as DState;\r\n        if (oldState?.idlookup === state.idlookup) state.idlookup = {...state.idlookup};\r\n        if (oldState?.idlookup[oldValue] === state.idlookup[oldValue]) {\r\n            state.idlookup[oldValue] = {...oldtarget} as any;\r\n        }\r\n        else {\r\n            // no need\r\n        }\r\n        state.idlookup[oldValue].pointedBy.splice(index, 1) // in-place edit\r\n\r\n        // console.warn('pointedby remove:', {from: oldtarget.pointedBy, to: state.idlookup[oldValue].pointedBy, obj: state.idlookup[oldValue], index, oldValue, actionpath});\r\n        return state;\r\n    }\r\n\r\n    // important! must be called only in reducer\r\n    public static add(newtargetptr: Pointer | undefined, action: ParsedAction, state: DState, casee: \"+=\" | \"-=\" | undefined = undefined, oldState?:DState): DState {\r\n        if (!newtargetptr) return state;\r\n        // todo: if can't be done because newtarget doesn't exist, build an action from this and set it pending.\r\n        let newtarget: DPointerTargetable = state.idlookup[newtargetptr];\r\n        if (!newtarget) {\r\n            PendingPointedByPaths.new(action, state).saveForLater(); // {from: action.path, field: action.field, to: target});\r\n            return state;\r\n        }\r\n        /* simpler version but does unnecessary shallow copies\r\n        state = {...state} as DState;\r\n        state.idlookup = {...state.idlookup};\r\n        state.idlookup[newtargetptr] = {...newtarget, pointedBy:  [...newtarget.pointedBy, PointedBy.new(action.path, casee)]} as any;*/\r\n        if (oldState === state) state = {...state} as DState;\r\n        if (oldState?.idlookup === state.idlookup) state.idlookup = {...state.idlookup};\r\n        if (oldState?.idlookup[newtargetptr] === state.idlookup[newtargetptr]) {\r\n            state.idlookup[newtargetptr] = {...newtarget, pointedBy:  [...newtarget.pointedBy, PointedBy.new(action.path, casee)]} as any;\r\n        }\r\n        else {\r\n            state.idlookup[newtargetptr].pointedBy = [...newtarget.pointedBy, PointedBy.new(action.path, casee)];\r\n        }\r\n        // console.warn('pointedby add:', {from: oldtarget.pointedBy, to: state.idlookup[newtargetptr].pointedBy, obj: state.idlookup[newtargetptr]});\r\n        return state;\r\n    }\r\n}\r\n\r\ntype AnyPointer = Pointer<DPointerTargetable, number, number|'N', LPointerTargetable>;\r\n\r\n@RuntimeAccessible('LPointerTargetable')\r\nexport class LPointerTargetable<Context extends LogicContext<DPointerTargetable> = any, D extends DPointerTargetable = DPointerTargetable> extends DPointerTargetable {\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    public static structure: typeof DPointerTargetable;\r\n    public static singleton: LPointerTargetable;\r\n    public __raw!: D;\r\n    public pointedBy!: PointedBy[];\r\n    public clonedCounter?: number;\r\n\r\n    public __isProxy!: boolean;\r\n    public __serialize!: DocString<\"json\">;\r\n    private inspect!: D;\r\n    private __random!: number;\r\n    // public r!: this;\r\n\r\n    private __info_of__id = {type:\"Pointer&lt;this&gt;\",\r\n        txt:\"<a href=\\\"https://github.com/DamianoNaraku/jodel-react/wiki/identifiers\\\">\" +\r\n            \"<span>Unique identifier, and value used to point this object.</span></a>\"};\r\n\r\n    protected wrongAccessMessage(str: string): any {\r\n        let msg = \"Method \"+str+\" should not be called directly, attempting to do so should trigger get_\"+str+\"(). This is only a signature for type checking.\";\r\n        Log.ex(msg);\r\n        throw new Error(msg); }\r\n\r\n    public toString(): string { throw this.wrongAccessMessage(\"toString\"); }\r\n    protected get_toString(context: Context): () => string {\r\n        const data = context.data as DNamedElement;\r\n        return () => ( data.name ? data.name : data.className.substring(0));\r\n        // return () => data.id;\r\n    }\r\n\r\n\r\n    protected cannotSet(field: string): any { return Log.exx('\"' + field + '\" field is read-only', this); }\r\n    protected get_id(context: Context): this[\"id\"] { return context.data.id; }\r\n    protected set_id(): boolean { return this.cannotSet('id'); }\r\n\r\n    protected _get_default< DD extends DPointerTargetable, T extends string & keyof (DD) & keyof (L), L extends LModelElement = LModelElement>(data: DD, key: T): L[T]{\r\n        // @ts-ignore\r\n        return LPointerTargetable.from(data[key]);\r\n    }\r\n\r\n    _state!: GObject;\r\n    __info_of___state = {type:\"GObject\", txt: `<div>A space where the user can store informations for their operations/views.<br/>\r\n            Example: The Validation viewpoint uses it to store validation messages.<br/>\r\n            WARNING! do not set proxies in the state, set pointers instead.<br/>\r\n            <a href='https://github.com/MDEGroup/jjodel/wiki/L%E2%80%90Object-state'>Learn more on the wiki</a></div>`};\r\n\r\n    get__state(c: Context): any { return this.wrongAccessMessage('obj._state, use obj.state instead.'); }\r\n    set__state(val: this[\"_state\"], c: Context): boolean { return this.cannotSet('obj._state, use obj.state instead.'); }\r\n    get_state(context: any): any /*this['_state']*/ {\r\n        if (!context.data._state) return {};\r\n        return this.__shallowSolver(context.data._state, true, true); // to solve pointers in state\r\n        // return LPointerTargetable.wrap(context.data._state); // this should work, because data._state have id = this.id+\"._state\"\r\n    }\r\n    set_state(val: any, c: Context): boolean {\r\n        // todo: put those lobjects -> pointer checks into defaultsetter to improve it\r\n\r\n        // 3 options:\r\n        // 1) if state === node, then setting whole state is invalid\r\n        // 2) if state is a proxified obj with id = node.id+\".state\" so actions and proxy getters/setters will act on the subobject properties still invalid setting whole obj.\r\n        // 3) forbid to set the whole state, merge old state with new one, if val === undefined, state is reset.\r\n\r\n        // i choose 3)\r\n        let newState: GObject;\r\n        let oldState = c.data._state ? {...c.data._state} : {};\r\n        let changed: boolean = false;\r\n        if (val === undefined) {\r\n            if (!oldState || !Object.keys(oldState).length) return true;\r\n            newState = {};\r\n            changed = true;\r\n        }\r\n        else if (typeof val !== \"object\") { Log.ee(\"state can only be assigned with an object or undefined\"); return true; }\r\n        else {\r\n            val = this.__sanitizeValue(val);\r\n            newState = {...oldState};\r\n            for (let k in val) {\r\n                if (val[k] === undefined) {\r\n                    if (oldState[k] === undefined) continue;\r\n                    delete newState[k];\r\n                    changed = true;\r\n                    continue;\r\n                }\r\n\r\n                if (oldState[k] === val[k]) continue;\r\n                newState[k] = val[k];\r\n                changed = true;\r\n            }\r\n        }\r\n\r\n        if (!changed) return true;\r\n\r\n        SetFieldAction.new(c.data, \"_state\", newState, undefined, false);\r\n        return true;\r\n    }\r\n    protected __sanitizeValue(val: any, canEditVal: boolean = true, canEditValDeep:boolean = false): any{\r\n        if (val === undefined) { return val; }\r\n        if (val.__isProxy || val.id && val.className) return val.id;\r\n        // if (typeof val === \"string\") { return val; } else\r\n        if (typeof val !== \"object\") { return val; }\r\n        else if (Array.isArray(val)) { return val.map(v => this.__sanitizeValue(v, canEditValDeep, canEditValDeep)); }\r\n        // case val is object not array, not proxy, not D. just a POJO\r\n        let ret = canEditVal ? val : {...val};\r\n        for (let k in val) {\r\n            if (Array.isArray(val[k])) ret[k] = val[k].map((v: any)=> v && (v.__isProxy || v.id && v.className) ? v.id : v);\r\n            else if (val[k] && (val[k].__isProxy || val[k].id && val[k].className)) ret[k] = val[k].id;\r\n        }\r\n        return ret;\r\n\r\n    }\r\n\r\n    // protected _defaultCollectionGetter(c: Context, k: keyof Context[\"data\"]): LPointerTargetable[] { return LPointerTargetable.fromPointer((c.data as any)[k]); }\r\n    protected __defaultGetter(c: Context, k: keyof Context[\"data\"]): any {\r\n        // console.log(\"default Getter\");\r\n        let v = (c.data as any)[k];\r\n        return this.__shallowSolver(v, true, false);\r\n    }\r\n    protected __shallowSolver<T>(val: any, solveArrayValues: boolean, solveObjectKeys: boolean): any {\r\n        if (!val || (!solveArrayValues && !solveObjectKeys)) return val;\r\n        let state: DState = store.getState();\r\n        if (solveArrayValues && Array.isArray(val)) {\r\n            if (val.length === 0) return [];\r\n            else if (Pointers.isPointer(val[0] as any)) return LPointerTargetable.fromArr(val, state);\r\n            return val;\r\n        }\r\n        if (solveObjectKeys && typeof val === \"object\"){\r\n            let ret = {...val};\r\n            for (let key in val){\r\n                let v = val[key];\r\n                if (!Pointers.isPointer(v, undefined, true)) continue;\r\n                ret[key] = Array.isArray(v) ? LPointerTargetable.fromPointer(v, state) : LPointerTargetable.fromArr(v, state);\r\n            }\r\n            return ret;\r\n        }\r\n        return val && Pointers.isPointer(val as any, undefined) ? LPointerTargetable.fromPointer(val, state) : val;\r\n    }\r\n\r\n    protected __defaultSetter(v0: any, c: Context, k: keyof Context[\"data\"]): boolean {\r\n        // todo: get the those lobjects -> pointer checks from set_state\r\n        let v: any = this.__sanitizeValue(v0, false, false);\r\n        if (true || k in c.data) {\r\n            // check if is pointer\r\n            let isPointer: boolean;\r\n            if (Array.isArray(v)) {\r\n                if (v.length === 0) isPointer = true; // assumed, should not cause harm if it is not.\r\n                    // it will delete remove an entry in pointedBy from all oldValue entries in the array that should not be present anyway.\r\n                // like oldVal.map( id => U.arrayRemove(LData.wrap(id).pointedBy, c.data.this_id)\r\n                else isPointer = Pointers.isPointer(v[0] as any);\r\n            } else isPointer = Pointers.isPointer(v);\r\n\r\n            // autofix value\r\n            let bytes = 0;\r\n            let type: string = (this as any)[\"__info_of__\"+k]?.type;\r\n            if (type) type = U.multiReplaceAll(type, [\"array\", \"Array\", \"<\", \">\", \"[]\"], []);\r\n            switch(type){\r\n                case ShortAttribETypes.EDate: break;\r\n                default: break;\r\n                case ShortAttribETypes.EBoolean: v = !!v; break;\r\n                case ShortAttribETypes.EByte: bytes = 8; break;\r\n                case ShortAttribETypes.EShort: bytes = 16; break;\r\n                case ShortAttribETypes.EInt: bytes = 32; break;\r\n                case ShortAttribETypes.ELong: bytes = 64; break;\r\n                case ShortAttribETypes.EString: v = \"\"+v; break;\r\n                case ShortAttribETypes.EChar: v = (\"\"+v)[0]; break;\r\n                case ShortAttribETypes.EVoid: Log.exx(\"cannot set a void-typed value\", {c, d:c.data, k, v}); return true;\r\n                case ShortAttribETypes.EDouble:\r\n                case ShortAttribETypes.EFloat: v = +v; break;\r\n            }\r\n            if (bytes) {\r\n                v = Math.round(+v);\r\n                let max = v << bytes; // left shift is the same as multiplying by a power of 2, but binary and more efficient.\r\n                let min = -max + 1\r\n                if (v > max) v = max;\r\n                else if (v < min) v = min;\r\n            }\r\n            console.log(\"default Setter[\"+k+\"] = \" + v , {type, v, v0, oldv:(c.data as any)[k], isPointer});\r\n            SetFieldAction.new(c.data, k as any, v, '', isPointer);\r\n            return true;\r\n        }\r\n        return true;\r\n    }\r\n\r\n    public get__extends(superClassName: string, context: LogicContext<DPointerTargetable>): boolean {\r\n        return RuntimeAccessibleClass.extends(context.data.className, superClassName);\r\n    }\r\n\r\n    /*\r\n    public get_pointedBy(superClassName: string, context: LogicContext<DPointerTargetable>): LPointerTargetable[] {\r\n        let state: GObject = windoww.store.getState();\r\n        function getForemostObjectInPath(path: DocString<'storePath'>): undefined | LPointerTargetable {\r\n            let lastPointableObject: undefined | DPointerTargetable;\r\n            let pathArray = path.split('.');\r\n            for (let key of pathArray) {\r\n                let currentObj: GObject = state[key];\r\n                if (!currentObj) break;\r\n                if (currentObj && currentObj.id && state.idlookup[currentObj.id]) lastPointableObject = state.idlookup[currentObj.id];\r\n            }\r\n            return lastPointableObject && DPointerTargetable.wrap(lastPointableObject);\r\n        }\r\n        return (context.data.pointedBy || []).map(getForemostObjectInPath).filter( lobj => !!lobj) as LPointerTargetable[];\r\n    }*/\r\n\r\n    public set_pointedBy(val: never, context: LogicContext<DPointerTargetable>): boolean {\r\n        windoww.Log.exx('pointedBy field should never be directly edited.', {context, val});\r\n        return false;\r\n    }\r\n\r\n\r\n\r\n\r\n    static fromD<DX extends DPointerTargetable,\r\n        LX = DX extends DEnumerator ? LEnumerator : (DX extends DAttribute ? LAttribute : (DX extends DReference ? LReference : (DX extends DRefEdge ? LRefEdge : (DX extends DExtEdge ? LExtEdge : (DX extends DDataType ? LDataType : (DX extends DClass ? LClass : (DX extends DStructuralFeature ? LStructuralFeature : (DX extends DParameter ? LParameter : (DX extends DOperation ? LOperation : (DX extends DEdge ? LEdge : (DX extends DEdgePoint ? LEdgePoint : (DX extends DGraphVertex ? LGraphVertex : (DX extends DModel ? LModel : (DX extends DValue ? LValue : (DX extends DObject ? LObject : (DX extends DEnumLiteral ? LEnumLiteral : (DX extends DPackage ? LPackage : (DX extends DClassifier ? LClassifier : (DX extends DTypedElement ? LTypedElement : (DX extends DVertex ? LVertex : (DX extends DVoidEdge ? LVoidEdge : (DX extends DVoidVertex ? LVoidVertex : (DX extends DGraph ? LGraph : (DX extends DNamedElement ? LNamedElement : (DX extends DAnnotation ? LAnnotation : (DX extends DGraphElement ? LGraphElement : (DX extends DMap ? LMap : (DX extends DModelElement ? LModelElement : (DX extends DUser ? LUser : (DX extends DPointerTargetable ? LPointerTargetable : (ERROR))))))))))))))))))))))))))))))),\r\n        >(data: DX): LX;\r\n    static fromD<DX extends DPointerTargetable,\r\n        LX = DX extends DEnumerator ? LEnumerator : (DX extends DAttribute ? LAttribute : (DX extends DReference ? LReference : (DX extends DRefEdge ? LRefEdge : (DX extends DExtEdge ? LExtEdge : (DX extends DDataType ? LDataType : (DX extends DClass ? LClass : (DX extends DStructuralFeature ? LStructuralFeature : (DX extends DParameter ? LParameter : (DX extends DOperation ? LOperation : (DX extends DEdge ? LEdge : (DX extends DEdgePoint ? LEdgePoint : (DX extends DGraphVertex ? LGraphVertex : (DX extends DModel ? LModel : (DX extends DValue ? LValue : (DX extends DObject ? LObject : (DX extends DEnumLiteral ? LEnumLiteral : (DX extends DPackage ? LPackage : (DX extends DClassifier ? LClassifier : (DX extends DTypedElement ? LTypedElement : (DX extends DVertex ? LVertex : (DX extends DVoidEdge ? LVoidEdge : (DX extends DVoidVertex ? LVoidVertex : (DX extends DGraph ? LGraph : (DX extends DNamedElement ? LNamedElement : (DX extends DAnnotation ? LAnnotation : (DX extends DGraphElement ? LGraphElement : (DX extends DMap ? LMap : (DX extends DModelElement ? LModelElement : (DX extends DUser ? LUser : (DX extends DPointerTargetable ? LPointerTargetable : (ERROR))))))))))))))))))))))))))))))),\r\n        >(data: DX[]): LX[];\r\n    static fromD(data: any): any {\r\n        // return null as any;\r\n        if (Array.isArray(data)) return LPointerTargetable.wrapAll(data) as any;\r\n        return LPointerTargetable.wrap(data) as any;\r\n    }\r\n\r\n\r\n    static fromPointer<\r\n        T extends AnyPointer | AnyPointer[], // <DPointerTargetable, 1, 'N', LPointerTargetable>,\r\n        DDD extends (T extends Pointer<any, any, any, infer D> ? D : 'undefined L'),\r\n        LOW extends (T extends Pointer<any, infer LO> ? LO : 'undefined_upp'),\r\n        UPP extends (T extends Pointer<any, number, infer UP> ? UP : 'undefined_low'),\r\n\r\n        DDDARR extends (T extends Pointer<any, any, any, infer D>[] ? D : 'undefined_DARR'),\r\n        LOWARR extends (T extends Pointer<any, infer LO>[] ? LO : 'undefined_uppARR'),\r\n        UPPARR extends (T extends Pointer<any, number, infer UP>[] ? 'UP_is_N' : 'undefined_lowARR'),\r\n\r\n        RET = UPPARR extends 'UP_is_N' ?\r\n            (DDDARR[]) : // 0...N\r\n            (UPP extends 1 ? (LOW extends 0 ? DDD | null : DDD) : // 0...1 && 1...1\r\n                (LOW extends 1 ? DDD : undefined)  //1...1\r\n                ),\r\n        INFERRED = {ret: RET, upp: UPP, low:LOW, ddd: DDD, dddARR: DDDARR, lowARR: LOWARR, uppARR: UPPARR},>(ptr: T | undefined, state?: DState)\r\n        : RET {\r\n        // return null as any;\r\n        if (Array.isArray(ptr)) return LPointerTargetable.wrapAll(ptr as any, undefined, '', false, state) as any;\r\n        return LPointerTargetable.wrap(ptr) as any;\r\n    }\r\n    static fromArr(...a:any): any; // because otherwise it complains about inheriting from DPointerTargetable.fromArr\r\n    static fromArr<\r\n        PTR extends Pointer | Pointer[], // <DPointerTargetable, 1, 'N', LPointerTargetable>,\r\n        // DDD extends (PTR extends Pointer<infer D> ? D : 'undefined_D'),\r\n        LOW extends (PTR extends Pointer<any, infer LO> ? LO : 'undefined_upp'),\r\n        UPP extends (PTR extends Pointer<any, number, infer UP> ? UP : 'undefined_low'),\r\n        DDD extends (PTR extends Pointer<any, number, any, infer LL> ? LL : 'undefined_L'),\r\n\r\n        LOWARR extends (PTR extends Pointer<any, infer LO>[] ? LO : 'undefined_uppARR'),\r\n        UPPARR extends (PTR extends Pointer<any, number, infer UP>[] ? 'UP_is_N' : 'undefined_lowARR'),\r\n        DDDARR extends (PTR extends Pointer<any, any, any, infer LL>[] ? LL : 'undefined_LARR'),\r\n\r\n        DX extends DPointerTargetable,\r\n\r\n        RETPTR = UPPARR extends 'UP_is_N' ?\r\n            (DDDARR[]) : // 0...N\r\n            (UPP extends 1 ? (LOW extends 0 ? DDD | null : DDD) : // 0...1 && 1...1\r\n                (LOW extends 1 ? DDD : undefined)  //1...1\r\n                ),\r\n\r\n        // DX = LX extends LEnumerator ? DEnumerator : (LX extends LAttribute ? DAttribute : (LX extends LReference ? DReference : (LX extends LDataType ? DDataType : (LX extends LClass ? DClass : (LX extends LStructuralFeature ? DStructuralFeature : (LX extends LParameter ? DParameter : (LX extends LOperation ? DOperation : (LX extends LModel ? DModel : (LX extends LValue ? DValue : (LX extends LObject ? DObject : (LX extends LEnumLiteral ? DEnumLiteral : (LX extends LPackage ? DPackage : (LX extends LClassifier ? DClassifier : (LX extends LTypedElement ? DTypedElement : (LX extends LNamedElement ? DNamedElement : (LX extends LAnnotation ? DAnnotation : ('ERROR'))))))))))))))))),\r\n        LX = DX extends DEnumerator ? LEnumerator : (DX extends DAttribute ? LAttribute : (DX extends DReference ? LReference : (DX extends DRefEdge ? LRefEdge : (DX extends DExtEdge ? LExtEdge : (DX extends DDataType ? LDataType : (DX extends DClass ? LClass : (DX extends DStructuralFeature ? LStructuralFeature : (DX extends DParameter ? LParameter : (DX extends DOperation ? LOperation : (DX extends DEdge ? LEdge : (DX extends DEdgePoint ? LEdgePoint : (DX extends DGraphVertex ? LGraphVertex : (DX extends DModel ? LModel : (DX extends DValue ? LValue : (DX extends DObject ? LObject : (DX extends DEnumLiteral ? LEnumLiteral : (DX extends DPackage ? LPackage : (DX extends DClassifier ? LClassifier : (DX extends DTypedElement ? LTypedElement : (DX extends DVertex ? LVertex : (DX extends DVoidEdge ? LVoidEdge : (DX extends DVoidVertex ? LVoidVertex : (DX extends DGraph ? LGraph : (DX extends DNamedElement ? LNamedElement : (DX extends DAnnotation ? LAnnotation : (DX extends DGraphElement ? LGraphElement : (DX extends DMap ? LMap : (DX extends DModelElement ? LModelElement : (DX extends DUser ? LUser : (DX extends DPointerTargetable ? LPointerTargetable : (ERROR))))))))))))))))))))))))))))))),\r\n        RET = LX extends 'ERROR' ? RETPTR : (RETPTR extends LX ? RETPTR : LX),\r\n        INFERRED = {ret: RET, RETPTR: RETPTR, upp: UPP, low:LOW, ddd: DDD, dddARR: DDDARR, lowARR: LOWARR, uppARR: UPPARR, LX:LX, DX:DX}>(ptr: PTR[] | DX[], state?: DState)\r\n        : RET[] {\r\n        return LPointerTargetable.from(ptr as any, state); }\r\n\r\n    static from<// LOW extends number, UPP extends number | 'N',\r\n        PTR extends Pointer<DPointerTargetable, 0|1, 1|'N', LPointerTargetable> | Pointer[], // <DPointerTargetable, 1, 'N', LPointerTargetable>,\r\n        // DDD extends (PTR extends Pointer<infer D> ? D : 'undefined_D'),\r\n        LOW extends (PTR extends Pointer<any, infer LO> ? LO : 'undefined_upp'),\r\n        UPP extends (PTR extends Pointer<any, number, infer UP> ? UP : 'undefined_low'),\r\n        DDD extends (PTR extends Pointer<any, number, any, infer LL> ? LL : 'undefined_L'),\r\n\r\n        LOWARR extends (PTR extends Pointer<any, infer LO>[] ? LO : 'undefined_uppARR'),\r\n        UPPARR extends (PTR extends Pointer<any, number, infer UP>[] ? 'UP_is_N' : 'undefined_lowARR'),\r\n        DDDARR extends (PTR extends Pointer<any, any, any, infer LL>[] ? LL : 'undefined_LARR'),\r\n\r\n        DX extends DPointerTargetable,\r\n\r\n        RETPTR = UPPARR extends 'UP_is_N' ?\r\n            (DDDARR[]) : // 0...N\r\n            (UPP extends 1 ? (LOW extends 0 ? DDD | null : DDD) : // 0...1 && 1...1\r\n                (LOW extends 1 ? DDD : undefined)  //1...1\r\n                ),\r\n\r\n\r\n        // DX = LX extends LEnumerator ? DEnumerator : (LX extends LAttribute ? DAttribute : (LX extends LReference ? DReference : (LX extends LDataType ? DDataType : (LX extends LClass ? DClass : (LX extends LStructuralFeature ? DStructuralFeature : (LX extends LParameter ? DParameter : (LX extends LOperation ? DOperation : (LX extends LModel ? DModel : (LX extends LValue ? DValue : (LX extends LObject ? DObject : (LX extends LEnumLiteral ? DEnumLiteral : (LX extends LPackage ? DPackage : (LX extends LClassifier ? DClassifier : (LX extends LTypedElement ? DTypedElement : (LX extends LNamedElement ? DNamedElement : (LX extends LAnnotation ? DAnnotation : ('ERROR'))))))))))))))))),\r\n        LX = DX extends DEnumerator ? LEnumerator : (DX extends DAttribute ? LAttribute : (DX extends DReference ? LReference : (DX extends DRefEdge ? LRefEdge : (DX extends DExtEdge ? LExtEdge : (DX extends DDataType ? LDataType : (DX extends DClass ? LClass : (DX extends DStructuralFeature ? LStructuralFeature : (DX extends DParameter ? LParameter : (DX extends DOperation ? LOperation : (DX extends DEdge ? LEdge : (DX extends DEdgePoint ? LEdgePoint : (DX extends DGraphVertex ? LGraphVertex : (DX extends DModel ? LModel : (DX extends DValue ? LValue : (DX extends DObject ? LObject : (DX extends DEnumLiteral ? LEnumLiteral : (DX extends DPackage ? LPackage : (DX extends DClassifier ? LClassifier : (DX extends DTypedElement ? LTypedElement : (DX extends DVertex ? LVertex : (DX extends DVoidEdge ? LVoidEdge : (DX extends DVoidVertex ? LVoidVertex : (DX extends DGraph ? LGraph : (DX extends DNamedElement ? LNamedElement : (DX extends DAnnotation ? LAnnotation : (DX extends DGraphElement ? LGraphElement : (DX extends DMap ? LMap : (DX extends DModelElement ? LModelElement : (DX extends DUser ? LUser : (DX extends DPointerTargetable ? LPointerTargetable : (ERROR))))))))))))))))))))))))))))))),\r\n        RET = LX extends 'ERROR' ? RETPTR : (RETPTR extends LX ? RETPTR : LX),\r\n        INFERRED = {ret: RET, RETPTR: RETPTR, upp: UPP, low:LOW, ddd: DDD, dddARR: DDDARR, lowARR: LOWARR, uppARR: UPPARR, LX:LX, DX:DX}>(ptr: PTR | DX, s?: DState)\r\n        : RET {\r\n        // return null as any;\r\n        if (Array.isArray(ptr)) return LPointerTargetable.wrapAll(ptr) as any;\r\n        return LPointerTargetable.wrap(ptr as any) as any;\r\n    }\r\n\r\n    // static from0(a: any, ...aa: any): any { return null; }\r\n\r\n    /* OLD DELETE\r\n    public delete(): void { throw this.wrongAccessMessage(\"delete\"); }\r\n    public _delete(context: Context): void { new DeleteElementAction(context.data); }\r\n    protected get_delete(context: Context): () => void {\r\n        return () => {\r\n            alert(\"Delete in LPOINTER\")\r\n            this._delete(context);\r\n        }\r\n    }\r\n    */\r\n    public dependencies(): Dependency[] { return []; }\r\n    protected get_dependencies(context: Context): () => Dependency[] {\r\n        const data = context.proxyObject;\r\n        const dependencies: Dependency[] = [];\r\n        const ret = () => {\r\n            for(let pointedBy of data.pointedBy) {\r\n                const raw = pointedBy.source.split('.');\r\n                let root = raw[0];\r\n                const obj = raw[1] || '';\r\n                let field = raw[2] || '';\r\n\r\n                // Delete chars from end that are not in [azAZ].\r\n                const regex = /[^a-zA-Z]+$/;\r\n                root = root.replace(regex, '');\r\n                field = field.replace(regex, '');\r\n                // damiano: this is likely to cause a bug for sure somewhere when a key ends with \"s\" but is not an array. keep in mind when naming variables.\r\n                let op: ''|'-=' = (field && field.endsWith('s')) ? '-=' : '';\r\n                if(!field && root.endsWith('s')) op = '-=';\r\n\r\n                const dependency: Dependency = {root: root  as keyof DState, obj, field: field as keyof DPointerTargetable, op};\r\n                if(!dependencies.includes(dependency)) dependencies.push(dependency);\r\n            }\r\n            return dependencies\r\n        }\r\n        return ret;\r\n    }\r\n\r\n    public delete(): void {}\r\n    protected get_delete(context: Context): () => void {\r\n        const data: LPointerTargetable & GObject = context.proxyObject;\r\n        const dependencies = data.dependencies();\r\n\r\n        for(let child of data.children) {\r\n            child.delete();\r\n            child.node?.delete();\r\n        }\r\n\r\n        const ret = () => {\r\n            BEGIN();\r\n            for (let dependency of dependencies) {\r\n                const root = dependency.root;\r\n                const obj = dependency.obj;\r\n                const field = dependency.field;\r\n                const op = dependency.op;\r\n                const val = (op === '-=') ? data.id : '';\r\n                if((root === 'idlookup') && obj && field) {\r\n                    console.log('Delete', `SetFieldAction.new('${obj}', '${field}', '${val}', '${op}');`);\r\n                    SetFieldAction.new(obj, field, val, op, false);\r\n                } else {\r\n                    console.log('Delete', `SetRootFieldAction.new('${root}', '${val}', '${op}');`);\r\n                    SetRootFieldAction.new(root, val, op, false);\r\n                }\r\n            }\r\n            if(data.nodes) data.nodes.map((node: any) => node.delete());\r\n            SetRootFieldAction.new('idlookup', data.id, '-=', false);\r\n            DeleteElementAction.new(data.id);\r\n            END();\r\n        };\r\n        return ret;\r\n    }\r\n}\r\nRuntimeAccessibleClass.set_extend(RuntimeAccessibleClass, LPointerTargetable);\r\n\r\n@RuntimeAccessible('D') export class D extends DPointerTargetable{}\r\n@RuntimeAccessible('L') export class L extends LPointerTargetable{}\r\n@RuntimeAccessible('P') export class P extends Pointers{}\r\n\r\n/*\r\nlet pttr: Pointer<DClassifier, 0, 1, LClassifier> = null as any;\r\nlet ptrany: Pointer<DClassifier, 0|1, 1|'N'>[] = null as any;\r\nlet ptrarr: Pointer<DClassifier>[] = null as any;\r\nlet ptrarr2: Pointer<DClassifier, 1, 'N'> = null as any;\r\nlet d: DClassifier = null as any;\r\nlet darr: DClassifier[] = null as any;\r\n\r\ntype VoidPtr = null | undefined | '';\r\nfunction dfrom<\r\n    PARAM extends orArr<AnyPointer | VoidPtr>,//orArr<WPointerTargetable | LPointerTargetable | DPointerTargetable | AnyPointer>,\r\n\r\n\r\n    DDD extends (PARAM extends Pointer<infer DD> ? DD : 'undefined_D'),\r\n    LOW extends (PARAM extends Pointer<any, infer LO> ? LO : 'undefined_low'),\r\n    LOW0 extends (PARAM extends Pointer<any, 0, any, any> ? 0 : never),\r\n    LOW1 extends (PARAM extends Pointer<any, 1, any, any> ? 1 : never),\r\n    LOW2 extends (VoidPtr extends PARAM ? 0 | 'first' : (PARAM extends VoidPtr ? 0 | 1 | 'second': 1|'third')),\r\n    UPP extends (PARAM extends Pointer<any, number, infer UP> ? UP : 'undefined_upp'),\r\n    LLL extends (PARAM extends Pointer<any, number, any, infer LL> ? LL : 'undefined_L'),\r\n\r\n\r\n\r\n    ISVOID extends PARAM extends VoidPtr  ? 'isvoid' : never,\r\n    ISARR extends PARAM extends [] ? true : false,\r\n    ISPTR extends (PARAM extends AnyPointer | VoidPtr ? 'ptr' : never),\r\n    ISPTRARR extends (PARAM extends (AnyPointer | VoidPtr)[] | Pointer<DPointerTargetable, 1|0, 'N', LPointerTargetable> ? 'ptr_arr' : never),\r\n    ISD extends (PARAM extends DPointerTargetable ? 'd' : never),\r\n    ISDARR extends (PARAM extends DPointerTargetable[] ? 'd_arr' : never),\r\n    ISL extends (PARAM extends LPointerTargetable ? 'l' : never),\r\n    ISLARR extends (PARAM extends LPointerTargetable[] ? 'l_arr' : never),\r\n    ISW extends (PARAM extends WPointerTargetable ? 'w' : never),\r\n    ISWARR extends (PARAM extends WPointerTargetable[] ? 'w_arr' : never),\r\n    // INFER = {LOW:LOW, UPP:UPP, DDD:DDD, LLL:LLL, LOW2:LOW2},\r\n    INFER = { LOW2:LOW2},\r\n    RET = ISVOID | ISPTR | ISPTRARR | ISD | ISDARR | ISL | ISLARR | ISW | ISWARR | INFER\r\n    >\r\n(ptr: PARAM): RET { return null as any; }\r\nlet Lptr = dfrom(pttr as Pointer<DClassifier, 0, 1, LClassifier> );\r\nlet Lptrany = dfrom(ptrany);\r\nlet Lptrarr = dfrom(ptrarr);\r\nlet Lptrarr2 = dfrom(ptrarr2);\r\nlet Ld = dfrom(d);\r\nlet Ldarr = dfrom(darr);*/\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n@RuntimeAccessible('WPointerTargetable')\r\nexport class WPointerTargetable extends DPointerTargetable{\r\n    id!: never;\r\n    _storePath!: never;\r\n    _subMaps!: never;\r\n    pointedBy!: never;\r\n    // todo: WfromD, WfromL, WfromPointer, Wfrom\r\n\r\n    static fromD<DX extends DPointerTargetable, WX extends DtoW<DX>>(data: DX): WX { return LPointerTargetable.fromD(data) as any; }\r\n}\r\nRuntimeAccessibleClass.set_extend(DPointerTargetable, LPointerTargetable);\r\nRuntimeAccessibleClass.set_extend(DPointerTargetable, WPointerTargetable);\r\nfunction fffff<DX, LX = DX extends DRefEdge ? LRefEdge : 'not'>( t: DX): LX { return null as any; }\r\nlet a: DGraphElement = null as any;\r\nlet bbb = LPointerTargetable.from(a);\r\nlet bb2 = fffff(a);\r\n\r\n@Leaf\r\n@RuntimeAccessible('DUser')\r\nexport class DUser extends DPointerTargetable {\r\n    public static offlineMode: boolean = !!localStorage.getItem(\"offlineMode\");\r\n    public static isStateMachine = false;\r\n    // static current: Pointer<DUser> = 'Pointer_AnonymousUser';\r\n    static current: Pointer<DUser> = '';\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    id!: Pointer<DUser>;\r\n    username!: string;\r\n    token!: string;\r\n    projects: Pointer<DProject, 0, 'N', LProject> = [];\r\n    project: Pointer<DProject, 0, 1, LProject> = '';\r\n    __isUser: true = true; // necessary to trick duck typing to think this is NOT the superclass of anything that extends PointerTargetable.\r\n    /*public static new(id?: DUser[\"id\"], triggerActions: boolean = true): DUser {\r\n        return new Constructors(new DUser('dwc'), undefined, false, undefined, id, true).DPointerTargetable().DUser().end(); }*/\r\n    public static new(username: string, id?: DUser['id'], persist: boolean = true): DUser {\r\n        return new Constructors(new DUser('dwc'), undefined, persist, undefined, id).DPointerTargetable().DUser(username).end();\r\n    }\r\n}\r\n\r\n@RuntimeAccessible('LUser')\r\nexport class LUser<Context extends LogicContext<DUser> = any, D extends DUser = DUser> extends LPointerTargetable {\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    public __raw!: DUser;\r\n    id!: Pointer<DUser>;\r\n    username!: string;\r\n    projects!: LProject[];\r\n    project!: LProject|null;\r\n    __isUser!: true;\r\n\r\n    protected get_projects(context: Context): this['projects'] {\r\n        return LProject.fromPointer(context.data.projects);\r\n    }\r\n    protected set_projects(val: PackArr<this['projects']>, context: Context): boolean {\r\n        const data = context.data;\r\n        SetFieldAction.new(data.id, 'projects', Pointers.from(val), '', true);\r\n        return true;\r\n    }\r\n\r\n    protected get_project(context: Context): this['project'] {\r\n        const project = context.data.project;\r\n        if(project) return LProject.fromPointer(project);\r\n        return null;\r\n    }\r\n    protected set_project(val: Pack<Exclude<this['project'], null>>|null, context: Context): boolean {\r\n        const data = context.data;\r\n        if(val === null) SetFieldAction.new(data.id, 'project', '', '', false);\r\n        else SetFieldAction.new(data.id, 'project', Pointers.from(val), '', true);\r\n        return true;\r\n    }\r\n}\r\n\r\nRuntimeAccessibleClass.set_extend(DPointerTargetable, DUser);\r\nRuntimeAccessibleClass.set_extend(LPointerTargetable, LUser);\r\nexport type WUser = getWParams<LUser, DUser>;\r\n\r\n@Leaf\r\n@RuntimeAccessible('DProject')\r\nexport class DProject extends DPointerTargetable {\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n\r\n    id!: Pointer<DProject, 1, 1, LProject>;\r\n    type: 'public'|'private'|'collaborative' = 'collaborative';\r\n    name!: string;\r\n    author: Pointer<DUser> = DUser.current;\r\n    collaborators: Pointer<DUser, 0, 'N'> = [];\r\n    onlineUsers : number = 0;\r\n    metamodels: Pointer<DModel, 0, 'N'> = [];\r\n    models: Pointer<DModel, 0, 'N'> = [];\r\n    graphs: Pointer<DGraph, 0, 'N'> = [];\r\n    // views: Pointer<DViewElement, 0, 'N'> = []; // can be retrieved from viewpoints.subviews\r\n    // stackViews: Pointer<DViewPoint, 0, 'N'> = []; // ??\r\n    viewpoints: Pointer<DViewPoint, 0, 'N'> = [];\r\n    activeViewpoint: Pointer<DViewPoint, 1, 1> = Defaults.viewpoints[0];\r\n    // collaborators dict user: priority\r\n\r\n    state: string = '';\r\n\r\n    public static new(type: DProject['type'], name: string, state?: DProject['state'], m2?: DProject['metamodels'], m1?: DProject['models'], id?: DProject['id']): DProject {\r\n        return new Constructors(new DProject('dwc'), undefined, true, undefined)\r\n            .DPointerTargetable().DProject(type, name, state || '', m2 || [], m1 || [], id).end(); }\r\n}\r\n\r\n@RuntimeAccessible('LProject')\r\nexport class LProject<Context extends LogicContext<DProject> = any, D extends DProject = DProject> extends LPointerTargetable {\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n\r\n    readonly id!: Pointer<DProject>;\r\n    type!: 'public'|'private'|'collaborative';\r\n    author!: LUser;\r\n    collaborators!: LUser[];\r\n    onlineUsers!: number;\r\n    name!: string;\r\n    metamodels!: LModel[];\r\n    models!: LModel[];\r\n    graphs!: LGraph[];\r\n    // stackViews!: LViewElement[];\r\n    viewpoints!: LViewPoint[];\r\n    activeViewpoint!: LViewPoint;\r\n\r\n    // stringify state\r\n    state!: string;\r\n\r\n    /* DATA */\r\n    readonly packages!: LPackage[];\r\n    readonly classes!: LClass[];\r\n    readonly attributes!: LAttribute[];\r\n    readonly references!: LReference[];\r\n    readonly operations!: LOperation[];\r\n    readonly parameters!: LParameter[];\r\n    readonly enumerators!: LEnumerator[];\r\n    readonly literals!: LEnumLiteral[];\r\n    readonly objects!: LObject[];\r\n    readonly values!: LValue[];\r\n\r\n    /* NODES */\r\n    readonly allNodes!: NodeTypes[];\r\n    readonly graphVertexes!: LGraphVertex[];\r\n    readonly voidVertexes!: LVoidVertex[];\r\n    readonly vertexes!: LVertex[];\r\n    readonly fields!: LGraphElement[];\r\n    readonly edges!: LEdge[];\r\n    readonly edgePoints!: LEdgePoint[];\r\n\r\n    /* UTILS */\r\n    readonly children!: LPointerTargetable[];\r\n    readonly views!: LViewElement[]; // derived from viewpoints.subView\r\n\r\n    /* Functions */\r\n\r\n    protected get_name(context: Context): this['name'] {\r\n        return context.data.name;\r\n    }\r\n    protected set_name(val: this['name'], context: Context): boolean {\r\n        const data = context.data;\r\n        SetFieldAction.new(data.id, 'name', val, '', false);\r\n        return true;\r\n    }\r\n\r\n    protected get_author(context: Context): this['author'] {\r\n        return LUser.fromPointer(context.data.author);\r\n    }\r\n    protected set_author(val: Pack<this['author']>, context: Context): boolean {\r\n        const data = context.data;\r\n        SetFieldAction.new(data.id, 'author', Pointers.from(val), '', true);\r\n        return true;\r\n    }\r\n\r\n    public get_state(context: any): this['state'] {\r\n        return context.data.state;\r\n    }\r\n    public set_state(val: this['state'], context: Context): boolean {\r\n        const data = context.data;\r\n        SetFieldAction.new(data.id, 'state', val, '', false);\r\n        return true;\r\n    }\r\n\r\n    protected get_collaborators(context: Context): this['collaborators'] {\r\n        return LUser.fromPointer(context.data.collaborators);\r\n    }\r\n    protected set_collaborators(val: PackArr<this['collaborators']>, context: Context): boolean {\r\n        const data = context.data;\r\n        SetFieldAction.new(data.id, 'collaborators', Pointers.from(val), '', true);\r\n        return true;\r\n    }\r\n\r\n    protected get_onlineUsers(context: Context): this['onlineUsers'] {\r\n        return context.data.onlineUsers;\r\n    }\r\n    protected set_onlineUsers(val: this['onlineUsers'], context: Context): boolean {\r\n        const data = context.data;\r\n        SetFieldAction.new(data.id, 'onlineUsers', val, '', false);\r\n        return true;\r\n    }\r\n\r\n    protected get_metamodels(context: Context): this['metamodels'] {\r\n        return LModel.fromPointer(context.data.metamodels);\r\n    }\r\n    protected set_metamodels(val: PackArr<this['metamodels']>, context: Context): boolean {\r\n        const data = context.data;\r\n        SetFieldAction.new(data.id, 'metamodels', Pointers.from(val), '', true);\r\n        return true;\r\n    }\r\n\r\n    protected get_models(context: Context): this['models'] {\r\n        return LModel.fromPointer(context.data.models);\r\n    }\r\n    protected set_models(val: PackArr<this['models']>, context: Context): boolean {\r\n        const data = context.data;\r\n        SetFieldAction.new(data.id, 'models', Pointers.from(val), '', true);\r\n        return true;\r\n    }\r\n\r\n    protected get_graphs(context: Context): this['graphs'] {\r\n        return LGraph.fromPointer(context.data.graphs);\r\n    }\r\n    protected set_graphs(val: PackArr<this['graphs']>, context: Context): boolean {\r\n        const data = context.data;\r\n        SetFieldAction.new(data.id, 'graphs', Pointers.from(val), '', true);\r\n        return true;\r\n    }\r\n\r\n    protected get_views(c: Context): this['views'] {\r\n        // return LViewElement.fromPointer([...c.data.views, ...Defaults.views]);\r\n        let duplicateRemover: Dictionary<Pointer, LViewElement> = {};\r\n        let varr = this.get_viewpoints(c).flatMap(vp => vp.subViews);\r\n        for (let v of varr) duplicateRemover[v.id] = v;\r\n        return Object.values(duplicateRemover);\r\n    }\r\n\r\n    protected set_views(val: PackArr<this['views']>, context: Context): boolean {\r\n        return Log.exx(\"cannot set project.views, set them as subviews of a project viewpoint.\");\r\n        /*\r\n        const data = context.data;\r\n        let ptrs = Pointers.from(val);\r\n        let defaultViewsMap: Dictionary<Pointer, boolean> = U.objectFromArrayValues(Defaults.views);\r\n        ptrs = ptrs.filter(ptr => !defaultViewsMap[ptr]);\r\n        SetFieldAction.new(data.id, 'views', ptrs, '', true);\r\n        return true;*/\r\n    }\r\n    /*\r\n        protected get_stackViews(context: Context): this['stackViews'] {\r\n            return LViewElement.fromPointer(context.data.stackViews || []);\r\n        }\r\n        protected set_stackViews(val: PackArr<this['stackViews']>, context: Context): boolean {\r\n            const data = context.data;\r\n            SetFieldAction.new(data.id, 'stackViews', Pointers.from(val), '', true);\r\n            return true;\r\n        }*/\r\n\r\n    protected get_viewpoints(context: Context): this['viewpoints'] {\r\n        return LViewPoint.fromPointer([...Defaults.viewpoints, ...context.data.viewpoints]);\r\n    }\r\n    protected set_viewpoints(val: PackArr<this['viewpoints']>, context: Context): boolean {\r\n        const data = context.data;\r\n        SetFieldAction.new(data.id, 'viewpoints', Pointers.from(val), '', true);\r\n        return true;\r\n    }\r\n\r\n    protected get_activeViewpoint(context: Context): this['activeViewpoint'] {\r\n        return LViewPoint.fromPointer(context.data.activeViewpoint || Defaults.viewpoints[0]);\r\n    }\r\n    protected set_activeViewpoint(val: Pack1<this['activeViewpoint']>, context: Context): boolean {\r\n        const data = context.data;\r\n        SetFieldAction.new(data.id, 'activeViewpoint', Pointers.from(val), '', true);\r\n        return true;\r\n    }\r\n\r\n    /* DATA Getter */\r\n    protected get_packages(context: Context): this['packages'] {\r\n        const data = context.proxyObject as LProject;\r\n        return data.metamodels.flatMap(m => m.allSubPackages);\r\n    }\r\n    protected get_classes(context: Context): this['classes'] {\r\n        const data = context.proxyObject as LProject;\r\n        return data.packages.flatMap(p => p.classes);\r\n    }\r\n    protected get_attributes(context: Context): this['attributes'] {\r\n        const data = context.proxyObject as LProject;\r\n        return data.classes.flatMap(c => c.attributes);\r\n    }\r\n    protected get_references(context: Context): this['references'] {\r\n        const data = context.proxyObject as LProject;\r\n        return data.classes.flatMap(c => c.references);\r\n    }\r\n    protected get_operations(context: Context): this['operations'] {\r\n        const data = context.proxyObject as LProject;\r\n        return data.classes.flatMap(c => c.operations);\r\n    }\r\n    protected get_parameters(context: Context): this['parameters'] {\r\n        const data = context.proxyObject as LProject;\r\n        return data.operations.flatMap(o => o.parameters);\r\n    }\r\n    protected get_enumerators(context: Context): this['enumerators'] {\r\n        const data = context.proxyObject as LProject;\r\n        return data.packages.flatMap(p => p.enumerators);\r\n    }\r\n    protected get_literals(context: Context): this['literals'] {\r\n        const data = context.proxyObject as LProject;\r\n        return data.enumerators.flatMap(e => e.literals);\r\n    }\r\n    protected get_objects(context: Context): this['objects'] {\r\n        const data = context.proxyObject as LProject;\r\n        return data.models.flatMap(m => m.allSubObjects);\r\n    }\r\n    protected get_values(context: Context): this['values'] {\r\n        const data = context.proxyObject as LProject;\r\n        return data.models.flatMap(m => m.allSubValues);\r\n    }\r\n\r\n    /* NODES Getter */\r\n    protected get_allNodes(context: Context): this['allNodes'] {\r\n        const data = context.proxyObject as LProject;\r\n        const nodes: NodeTypes[] = [];\r\n        // nodes.push(...(data.metamodels.flatMap(m => m.node).filter(n => n !== undefined) as NodeTypes[]));\r\n        nodes.push(...(data.packages.flatMap(m => m.node).filter(n => n !== undefined) as NodeTypes[]));\r\n        nodes.push(...(data.classes.flatMap(m => m.node).filter(n => n !== undefined) as NodeTypes[]));\r\n        nodes.push(...(data.attributes.flatMap(m => m.node).filter(n => n !== undefined) as NodeTypes[]));\r\n        nodes.push(...(data.references.flatMap(m => m.node).filter(n => n !== undefined) as NodeTypes[]));\r\n        nodes.push(...(data.operations.flatMap(m => m.node).filter(n => n !== undefined) as NodeTypes[]));\r\n        nodes.push(...(data.parameters.flatMap(m => m.node).filter(n => n !== undefined) as NodeTypes[]));\r\n        nodes.push(...(data.enumerators.flatMap(m => m.node).filter(n => n !== undefined) as NodeTypes[]));\r\n        nodes.push(...(data.literals.flatMap(m => m.node).filter(n => n !== undefined) as NodeTypes[]));\r\n        // nodes.push(...(data.models.flatMap(m => m.node).filter(n => n !== undefined) as NodeTypes[]));\r\n        nodes.push(...(data.objects.flatMap(m => m.node).filter(n => n !== undefined) as NodeTypes[]));\r\n        nodes.push(...(data.values.flatMap(m => m.node).filter(n => n !== undefined) as NodeTypes[]));\r\n        return nodes;\r\n    }\r\n    protected get_graphVertexes(context: Context): this['graphVertexes'] {\r\n        const data = context.proxyObject as LProject;\r\n        return data.allNodes.filter(n => n.className === 'DGraphVertex') as LGraphVertex[];\r\n    }\r\n    protected get_voidVertexes(context: Context): this['voidVertexes'] {\r\n        const data = context.proxyObject as LProject;\r\n        return data.allNodes.filter(n => n.className === 'DVoidVertex') as LVoidVertex[];\r\n    }\r\n    protected get_vertexes(context: Context): this['vertexes'] {\r\n        const data = context.proxyObject as LProject;\r\n        return data.allNodes.filter(n => n.className === 'DVertex') as LVertex[];\r\n    }\r\n    protected get_fields(context: Context): this['fields'] {\r\n        const data = context.proxyObject as LProject;\r\n        return data.allNodes.filter(n => n.className === 'DGraphElement') as LGraphElement[];\r\n    }\r\n    protected get_edges(context: Context): this['edges'] {\r\n        const data = context.proxyObject as LProject;\r\n        return data.graphs.flatMap(g => g.subElements.filter(e => e.className === 'DEdge')) as LEdge[];\r\n    }\r\n    protected get_edgePoints(context: Context): this['edgePoints'] {\r\n        const data = context.proxyObject as LProject;\r\n        return data.edges.flatMap(e => e.subElements) as LEdgePoint[];\r\n    }\r\n\r\n    /* CUSTOM Functions */\r\n    protected get_children(context: Context): this['children'] {\r\n        const data = context.proxyObject as LProject;\r\n        return [\r\n            /* Data */\r\n            ...data.metamodels,\r\n            ...data.packages,\r\n            ...data.classes,\r\n            ...data.attributes,\r\n            ...data.references,\r\n            ...data.operations,\r\n            ...data.parameters,\r\n            ...data.enumerators,\r\n            ...data.literals,\r\n            ...data.models,\r\n            ...data.objects,\r\n            ...data.values,\r\n            /* Views & Viewpoints */\r\n            ...data.views.filter(v => v && !Defaults.views.includes(v.id)),\r\n            ...data.viewpoints.filter(vp => vp && !Defaults.viewpoints.includes(vp.id)),\r\n            /* Nodes */\r\n            ...data.allNodes\r\n        ];\r\n    }\r\n\r\n    /*\r\n        public pushToStackViews(view: Pack<LViewElement>): void {\r\n            throw new Error('cannot be called directly, should trigger getter. this is only for correct signature');\r\n        }\r\n        protected get_pushToStackViews(context: Context): (view: Pack<LViewElement>) => void {\r\n            return (view) => {\r\n                const data = context.data;\r\n                SetFieldAction.new(data.id, 'stackViews', Pointers.from(view), ', true);\r\n            }\r\n        }\r\n    /*\r\n        public popFromStackViews(): void {\r\n            throw new Error('cannot be called directly, should trigger getter. this is only for correct signature');\r\n        }\r\n        protected get_popFromStackViews(context: Context): () => void {\r\n            return () => {\r\n                const data = context.data;\r\n                const view = data.stackViews?.at(-1);\r\n                if(!view) return;\r\n                SetFieldAction.new(data.id, 'stackViews', view as any, '-=', true);\r\n            }\r\n        }\r\n    */\r\n    public delete(): void {\r\n        throw new Error('cannot be called directly, should trigger getter. this is only for correct signature');\r\n    }\r\n    protected get_delete(context: Context): () => void {\r\n        const data = context.proxyObject as LProject;\r\n        return () => {\r\n            TRANSACTION(()=> {\r\n                data.children.map(c => c && c.delete());\r\n                SetFieldAction.new(DUser.current, 'projects', data.id as any, '-=', true);\r\n                DeleteElementAction.new(data.id);\r\n                SetRootFieldAction.new('projects', data.id, '-=', true);\r\n            });\r\n        }\r\n    }\r\n}\r\n\r\nRuntimeAccessibleClass.set_extend(DPointerTargetable, DProject);\r\nRuntimeAccessibleClass.set_extend(LPointerTargetable, LProject);\r\nexport type WProject = getWParams<LProject, DProject>;\r\n\r\n\r\n@RuntimeAccessible('MyError')\r\nexport class MyError extends Error {\r\n    constructor(message?: string, ...otherMsg: any[]) {\r\n        // 'Error' breaks prototype chain here\r\n        super(message);\r\n        const proto = (this as any).__proto__;\r\n\r\n        console.error(proto.constructor.cname || proto.constructor.name, message, ...otherMsg);\r\n        // restore prototype chain\r\n        const actualProto = new.target.prototype;\r\n\r\n        if (Object.setPrototypeOf) { Object.setPrototypeOf(this, actualProto); }\r\n        else { (this as any).__proto__ = actualProto; }\r\n        (this as any).className = (this.constructor as typeof RuntimeAccessibleClass).cname;\r\n    }\r\n}\r\n\r\n// @RuntimeAccessible\r\nexport class JsType{\r\n    public static all: JsType[] = [];\r\n    public static object: JsType = new JsType(\"object\", JsType.isObject, false);\r\n    public static function: JsType = new JsType(\"function\", JsType.isFunction, false);\r\n    public static array: JsType = new JsType(\"array\", JsType.isArray, false);\r\n    public static date: JsType = new JsType(\"Date\", JsType.isDate, false);\r\n\r\n    public static lambdaFunction: JsType = new JsType(\"lambda-function\", JsType.isLambdaFunction, true);\r\n    public static nonLambdaFunction: JsType = new JsType(\"non-lambda-function\", JsType.isNonLambdaFunction, true);\r\n    public static symbol: JsType = new JsType(\"symbol\", JsType.isSymbol, true);\r\n    public static undefined: JsType = new JsType(\"undefined\", JsType.isUndefined, true);\r\n    public static null: JsType = new JsType(\"null\", JsType.isNull, true);\r\n    public static boolean: JsType = new JsType(\"boolean\", JsType.isBoolean, true);\r\n    public static number: JsType = new JsType(\"number\", JsType.isNumber, true);\r\n    public static bigint: JsType = new JsType(\"bigint\", JsType.isBigint, true);\r\n    public static string: JsType = new JsType(\"string\", JsType.isString, true);\r\n\r\n    private constructor(public printableTypeName: string, public check: (data: any) => boolean, public isExclusiveType: boolean){\r\n        JsType.all.push(this);\r\n    }\r\n    public toString(): string { return this.printableTypeName; }\r\n    /*\r\n    * example: isObject but not Date, not function...\r\n    * */\r\n    public static isOnlyType(data: any, type: JsType): boolean { return !JsType.getTypes(data, type).length; }\r\n    public static isAnyOfTypes(data: any, ...acceptables: JsType[]): boolean { return !!windoww.Uarr.arrayIntersection(JsType.getTypes(data), acceptables).length; }\r\n    public static getTypes(data: any, stopIfTypeIsNot?: JsType): JsType[]{\r\n        const ret: JsType[] = [];\r\n        for (const type of JsType.all) {\r\n            if (type.check(data)) {\r\n                ret.push(data);\r\n                if (stopIfTypeIsNot !== type) { return []; }\r\n                if (type.isExclusiveType) return ret;\r\n            }\r\n        }\r\n        return ret;\r\n    }\r\n\r\n    /// is...\r\n    public static isObject(data: GObject | any, returnIfNull: boolean = false): boolean { return data === null ? returnIfNull : typeof data === \"object\"; }\r\n    public static isFunction(data: Function | any): boolean { return typeof data === \"function\"; }\r\n    public static isLambdaFunction(data: Function | any): boolean {\r\n        if (!JsType.isFunction(data)) return false;\r\n        return windoww.U.getFunctionSignatureFromComments(data).isLambda; }\r\n    public static isNonLambdaFunction(data: Function | any): boolean { return JsType.isFunction(data) && !JsType.isNonLambdaFunction(data); }\r\n    public static isArray(data: Array<any> | any): boolean { return Array.isArray(data); }\r\n    public static isSymbol(data: symbol | any): boolean { return typeof data === \"symbol\"; }\r\n    public static isBoolean(data: symbol | any): boolean { return !!data === data; }\r\n    public static isNumber(data: number | any): boolean { return typeof data === \"number\"; }\r\n    public static isBigint(data: bigint | any): boolean { return typeof data === \"bigint\"; }\r\n    public static isString(data: string | any): boolean { return typeof data === \"string\"; }\r\n    public static isNull(data: null | any): boolean { return data === null; }\r\n    public static isUndefined(data: undefined | any): boolean { return data === undefined; }\r\n    public static isDate(data: Date | any): boolean { return data instanceof Date; }\r\n\r\n    /// as...\r\n    public static asObject<T>(data: GObject | any, fallbackReturn: T): T | GObject { return JsType.isObject(data) ? data : fallbackReturn; }\r\n    public static asFunction<T>(data: Function | any, fallbackReturn: T): T | Function { return JsType.isFunction(data) ? data : fallbackReturn; }\r\n    public static asLambdaFunction<T>(data: Function | any, fallbackReturn: T): T | Function { return JsType.isLambdaFunction(data) ? data : fallbackReturn; }\r\n    public static asNonLambdaFunction<T>(data: Function | any, fallbackReturn: T): T | Function { return JsType.isNonLambdaFunction(data) ? data : fallbackReturn; }\r\n    public static asArray<T, A>(data: Array<A> | any, fallbackReturn: T): T | Array<A> { return JsType.isArray(data) ? data : fallbackReturn; }\r\n    public static asSymbol<T>(data: symbol | any, fallbackReturn: T): T | symbol { return JsType.isSymbol(data) ? data : fallbackReturn; }\r\n    public static asBoolean<T>(data: boolean | any, fallbackReturn: T): T | boolean { return JsType.isBoolean(data) ? data : fallbackReturn; }\r\n    public static asNumber<T>(data: number | any, fallbackReturn: T): T | number { return JsType.isNumber(data) ? data : fallbackReturn; }\r\n    public static asBigint<T>(data: bigint | any, fallbackReturn: T): T | bigint { return JsType.isBigint(data) ? data : fallbackReturn; }\r\n    public static asString<T>(data: string | any, fallbackReturn: T): T | string { return JsType.isString(data) ? data : fallbackReturn; }\r\n    public static asNull<T>(data: null | any, fallbackReturn: T): T | null { return JsType.isNull(data) ? data : fallbackReturn; }\r\n    public static asUndefined<T>(data: undefined | any, fallbackReturn: T): T | undefined { return JsType.isUndefined(data) ? data : fallbackReturn; }\r\n    public static asDate<T>(data: Date | any, fallbackReturn: T): T | Date { return JsType.isDate(data) ? data : fallbackReturn; }\r\n    public static isPrimitive(data: any) { return !JsType.isAnyOfTypes(data, JsType.object, JsType.function, JsType.array); }\r\n}\r\n\r\n\r\nfunction invalidSuperClassError(/*callee: Class,*/ scname: string, superclass: Class): (() => never) {\r\n    return () => { windoww.Log.exDevv('parent super class \"' + scname + '\" is not implementing init_constructor', {scname, superclass, }); throw new Error(); }\r\n}\r\n// @ts-ignore\r\nfunction MixinFakeConstructor() { this.isMixinFakeConstructor = true; }\r\nexport function MixOnlyFuncs2<A1 extends any[], I1, S1, A2 extends any[], I2, S2>(c1: Class<A1, I1, S1> & typeof RuntimeAccessibleClass, c2: Class<A2, I2, S2> & typeof RuntimeAccessibleClass):\r\n    Class<A1, I1, S1> & Class<A2, I2, S2>{\r\n    return MixOnlyFuncs(c1, c2) as any;\r\n}\r\nexport function MixOnlyFuncs3<A1 extends any[], I1, S1, A2 extends any[], I2, S2>(c1: Class<A1, I1, S1> & typeof RuntimeAccessibleClass, c2: Class<A2, I2, S2> & typeof RuntimeAccessibleClass):\r\n    Class<A1&A2, I1&I2, S1&S2>{\r\n    return MixOnlyFuncs(c1, c2) as any;\r\n}\r\nexport function MixOnlyFuncs<A1 extends any[], I1, S1, A2 extends any[], I2, S2>(c1: Class<A1, I1, S1> & typeof RuntimeAccessibleClass, c2: Class<A2, I2, S2> & typeof RuntimeAccessibleClass):\r\n    CClass<Longest<A1, A2>, I1 & I2\r\n        & {\r\n        // superclass: Dictionary<string, (/*thiss: I1 & I2,* / ...superConstructorParams:ConstructorParameters<Class<A1, I1, S1>> | ConstructorParameters<Class<A2, I2, S2>>) => void>,\r\n        superclass1: Dictionary<DocString<'constructor name to make sure the user knows what superclass constructor is calling'>,  (...superConstructor1Params:ConstructorParameters<Class<A1, I1, S1>>) => void>,\r\n        superclass2: Dictionary<DocString<'constructor name to make sure the user knows what superclass constructor is calling'>,  (...superConstructor2Params:ConstructorParameters<Class<A2, I2, S2>>) => void>,\r\n        // initt: Class<A1, I1, S1>\r\n    } & AbstractMixedClass\r\n        // , Omit<Omit<Omit<S1 & S2, 'init_constructor'>, 'logic'>, 'maxID'> & typeof AbstractMixedClass> {\r\n        , S1 & S2 & GObject & typeof AbstractMixedClass> {\r\n    // strategia: passo dei finti valori che copiano i prototipi delle classi sovrascrivendo i costruttori per evitare che chiami i costruttori delle superclassi\r\n    // ma che comunque erediti campi e funzioni\r\n    // @ts-ignore\r\n    let c1noconstructor: any = MixinFakeConstructor;\r\n    let c2noconstructor: any = MixinFakeConstructor;\r\n    c1noconstructor.prototype = c1.prototype;\r\n    c2noconstructor.prototype = c2.prototype;\r\n\r\n    let disableconstructor = false;\r\n    if (!disableconstructor) {\r\n        c1noconstructor = c1;\r\n        c2noconstructor = c2; }\r\n\r\n\r\n    let ret = Mixin(c1noconstructor, c2noconstructor);\r\n    let c1name = (c1.cname || c1.name) === 'classnameFixedConstructorDoNotRenameWithoutSearchStrings' ? c1.prototype.className : c1.cname || c1.name;\r\n    let c2name = (c2.cname || c2.name) === 'classnameFixedConstructorDoNotRenameWithoutSearchStrings' ? c2.prototype.className : c2.cname || c2.name;\r\n    //ret.prototype['superclass'] = {};\r\n    // ret.prototype['superclass'][c1name] = c1.prototype.init_constructor || invalidSuperClassError(c1name, c1);\r\n    // ret.prototype['superclass'][c2name] = c2.init_constructor || invalidSuperClassError(c2name, c2);\r\n    ret.prototype['superclass1'] = {};\r\n    ret.prototype['superclass2'] = {};\r\n    ret.prototype['superclass1'][c1name] = c1.init_constructor || invalidSuperClassError(c1name, c1);\r\n    ret.prototype['superclass2'][c2name] = c2.init_constructor || invalidSuperClassError(c2name, c2);\r\n    return ret;\r\n}\r\n// console.info('ts loaded classes');\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n//*********************************************************************************************\r\n//*********************************************************************************************\r\n///////                              type juggling starts here                          ///////\r\n//*********************************************************************************************\r\n//*********************************************************************************************\r\n\r\n// export type NotAString<T extends any = 'uselessval'> = Omit<string, 'bold'> & {big: T};\r\n// export type NotAString<T extends any = 'uselessval'> = Omit<string, 'bold'>;\r\n// export type NotAString<T extends any = 'uselessval', T2 extends any = any, T3 extends any = any, T4 extends any = any> = string & Omit<string, 'bold'> & {bold: ()=>string};\r\nexport type NotAString<T extends any = 'uselessval', T2 extends any = any, T3 extends any = any, T4 extends any = any> = string & Omit<string, 'bold'> & {bolda?: T};\r\n// export type NotAString<T> = string;\r\n// type Pointer<T> = NotAString<T>;\r\nexport type Pointer<T extends DPointerTargetable = DPointerTargetable, lowerbound extends number = 1, upperbound extends number|'N' = 1,\r\n    RET extends LPointerTargetable = DtoL<T>> =\r\n    upperbound extends 'N' ? NotAString<T, lowerbound, upperbound, RET>[] : (\r\n        upperbound extends 0 ? never : (\r\n            lowerbound extends 0 ? (NotAString<T, lowerbound, upperbound, RET> | null) : NotAString<T, upperbound, lowerbound, RET>));\r\n\r\n\r\nexport type PtrString = any; // to convert Pointers to strings more explicitly then using as any\r\n// let ptr: Pointer<Object> = null as any;\r\n/*\r\nclass D extends DPointerTargetable{\r\n    parent!: Pointer<D>;\r\n    dattrib!: boolean;\r\n    juststring!: string;\r\n    nattrib!: number;\r\n    ddattrib!: Date\r\n}\r\n\r\nclass D2 extends D{\r\n    d2!: string;\r\n}\r\nclass D3 extends D{\r\n    d3!: string;\r\n}\r\n\r\n\r\n\r\ntype OverrideTypes<M, N> = { [P in keyof M]: P extends keyof N ? N[P] : M[P] }; // usage:  OverrideTypes<A, { x: number }>;\r\n\r\ninterface LFix {\r\n    parent: L;\r\n}\r\ninterface L { // no instances ever\r\n    parent: L;\r\n    lattrib: boolean;\r\n}\r\ninterface L2 extends L { // no instances ever\r\n    l2: string;\r\n}\r\ninterface L3 extends L{ // no instances ever\r\n    l3: string;\r\n}\r\n\r\nclass P { // singleton\r\n    get_parent(){}\r\n    set_parent(){}\r\n}\r\nclass P2 extends P { // singleton\r\n    get_d2() {}\r\n}\r\nclass P3 extends P { // singleton\r\n    get_d3() {}\r\n}*/\r\n\r\ntype ERROR = \"_TYPE_ERROR_\";\r\n// RegExp extends Animal ? number : string\r\n\r\n\r\nfunction buildWrapSignature(maxdepth = 100) {\r\n    let arr = windoww[\"DPointerTargetable\"].subclasses;\r\n    /*\r\n    let dict0 = arr.reduce((a, v) => ({ ...a, [v.name]: v}), {});\r\n    let dict = {}\r\n    for (let name in dict0) { let n = name.substring(1); dict[n] = {\"D\":dict0[\"D\"+n], \"L\":dict0[\"L\"+n]}; dict[\"D\"+n] = dict0[\"L\"+n]; dict[\"L\"+n] = dict0[\"D\"+n]; }\r\n    console.log(\"dict\", dict);\r\n    console.table(dict);\r\n    */\r\n    function onlyUnique(value: any, index: number, self: any) { return self.indexOf(value) === index; }\r\n\r\n    let dep = arr; // .map( (me) => { return {\"name\": me.name, \"me\": me, \"Derror\": (dict[me.name] || me).name, \"Lerror\": (dict[me.name] || me).name, \"subclasses\": [...me.subclasses]}});\r\n    let depsorted = [];\r\n\r\n    let byLevels = [];\r\n    let loopdetecter: any[] = [arr];\r\n    while (dep.length && maxdepth--) {\r\n        let namelist = dep.map((e: any) => e.name).filter(onlyUnique);\r\n        depsorted.push(...namelist);\r\n        byLevels.push([...namelist]);\r\n        let olddep = dep;\r\n        dep = dep.flatMap((d: any) => d.subclasses).filter(onlyUnique);\r\n        for (let d of dep) {\r\n            windoww.loopdetecter = loopdetecter;\r\n            windoww.dep = dep;\r\n            windoww.olddep = olddep;\r\n            windoww.byLevels = byLevels;\r\n            windoww.d = d;\r\n            if ( loopdetecter.includes(d.subclasses) ) throw new Error(\"class is not redefining subclasses static array: \" + d.name);\r\n            loopdetecter.push(d.subclasses);\r\n        }\r\n    }\r\n    console.log(\"byLevels\");\r\n    console.table(byLevels);\r\n\r\n    console.log(\"depsorted\", depsorted);\r\n\r\n    // console.log(\"map\");\r\n    // console.table(depsorted.map(dn => {let d = window[dn]; return !d ? \"\" :{name:d.name, scount: d.subclasses.length, subclasses:d.subclasses}}));\r\n\r\n\r\n    let goalSignature = \"function wrap<DX extends D, LX = DX extends D2 ? L2: (DX extends D3 ? L3: (DX extends D ? L : ERROR))>(data: DX): LX {\";\r\n    let lparam = \"ERROR\";\r\n    let epsorted = depsorted.map( e => e.substring(1)).filter(onlyUnique);\r\n    console.table(epsorted)\r\n    for (let e of epsorted) {\r\n        let D = \"D\" + e;\r\n        let L = \"L\" + e;\r\n        lparam = \"DX extends \" + D + \" ? \"  + L + \" : (\" + (lparam) + \")\";\r\n    }\r\n    let signature = \"function wrap<DX extends DPointerTargetable, LX = \" + lparam + \">(data: DX): LX {\";\r\n    return signature;\r\n}\r\nwindoww.buildWrapSignature = buildWrapSignature;\r\n// function wrap<DX extends D, LX = DX extends D2 ? L2: (DX extends D3 ? L3: (DX extends D ? L : ERROR))>(data: DX): LX {\r\n\r\n/*\r\n* NO    L -> D    /// l.__raw\r\n* NO    L -> Ptr  /// l.id\r\n*\r\n* NO    D -> Ptr   // d.id\r\n* YES   D -> L     // wrap\r\n*\r\n* NO    Ptr -> D\r\n* NO    Ptr -> L\r\n*\r\n*\r\n*\r\n*\r\n* DpointerTargetable.from( L or pointer )\r\n* LpointerTargetable.from( D or pointer )\r\n*\r\n* MyProxyHandler.wrap = LpointerTargetable.from;\r\n*\r\n* DpointerTargetable.toPointer( d );\r\n*\r\n\r\ntype subtractDL = subtract<D, L>;\r\n* */\r\n\r\n\r\n\r\ntype subtract<P, C> = { [F in keyof P]: keyof C extends undefined ? undefined : P[F] };\r\ntype Exclude3<T, U> = T & {[T in keyof U]: never};\r\ntype Override<A, B> = Omit<A, keyof B> & B; //////////////////////////////////////////// best solution so far\r\n\r\ntype Exclude2<Type, field> = {\r\n    [Property in keyof Type as Exclude<Property, keyof field>]: Type[Property]      /////////////////////////equally best solution\r\n};\r\n\r\n\r\ntype OnlyKeysOfTypeTmp<T, IncludeType> = ({[P in keyof T]: T[P] extends IncludeType ? P : never })[keyof T];\r\ntype OnlyKeysOfType<T, IncludeType> = Pick<T, OnlyKeysOfTypeTmp<T, IncludeType>>;\r\ntype RemoveKeysOfType<T, ExcludeType> = Exclude2<T, OnlyKeysOfType<T, ExcludeType>>;\r\n\r\n// todo: can't automatically convert D to L (generating the type instead of manual defining L) rules are: LClass <--- Pointer<LClass>, LClass[] <-- Pointer<LClass, 0, 'N'>, subobject = ? should not be there\r\n\r\n/**\r\n i have a documentation type that is actually a string, but it\\'s have a different purpose from the others, and i made a type to keep documentally separated.\r\n let's say it's\r\n type StringOf<P> = string; // regardless of P\r\n\r\n and i use it to define objects\r\n\r\n class C {\r\n           str: StringOf<Date>;\r\n           str2: StringOf<number>;\r\n           purestring: string;\r\n           num: number\r\n         }\r\n now i want to crete a derivate type that excludes all properties of type StringOf from C\r\n\r\n\r\n\r\n type OnlyKeysOfTypeTmp<T, IncludeType> = ({[P in keyof T]: T[P] extends IncludeType ? P : never })[keyof T];\r\n type OnlyKeysOfType<T, IncludeType> = Pick<T, OnlyKeysOfTypeTmp<T, IncludeType>>;\r\n type RemoveKeysOfType<T, ExcludeType> = Exclude2<T, OnlyKeysOfType<T, string>>;\r\n\r\n type D = RemoveKeysOfType<C, StringOf<any>>\r\n due to duck typing, this removes all StringOf attributes, but also \"purestring\" attribute.\r\n how can i remove only StringOf attributes?\r\n\r\n\r\n */\r\n\r\n\r\n\r\nexport type getWParams<L extends LPointerTargetable, D extends Object> ={\r\n    // [Property in keyof ValidObj<L>]: L[Property] extends never ? never : L[Property]\r\n    [Property in keyof L]:/*\r\n            Property extends \"opposite\" ? LReference | DReference | Pointer<DReference> :\r\n            Property extends \"parent\" ? LModelElement | DModelElement | Pointer<DModelElement> :\r\n            Property extends \"annotations\" ? LAnnotation | DAnnotation | Pointer<DAnnotation> :*/\r\n    (Property extends string ? (\r\n        Property extends \"id\" ? 'id is read-only' :\r\n            //@ts-ignore\r\n            (L[`set_${Property}`] extends (a:any, b: any, ...b:any)=> any ? // at least 2 params: 1 for val and 1 for Context\r\n                // if a set_ first parameter is Context it means the set_ is ill-defined, need to change actual method signature.\r\n                //@ts-ignore\r\n                Parameters<L[`set_${Property}`]>[0] // if set_X function is defined, get first param\r\n                //@ts-ignore\r\n                : never ///D[Property] | `todo: should define set_${Property}` // default type if it's not assigned = type in the D version\r\n                )): never)\r\n} // & L\r\n\r\n\r\nexport enum EGraphElements {\r\n    \"GraphElement\"=  \"GraphElement\",\r\n    \"Field\" =\"GraphElement\", // just an alias for now.\r\n    \"Vertex\"= \"Vertex\",\r\n    \"todo\" = \"todo\"\r\n}\r\nexport enum EModelElements{\r\n    // concrete m2\r\n    \"(m2) Model\" = \"DModel\",\r\n    \"(m2) Package\" = \"DPackage\",\r\n    \"(m2) Class\" = \"DClass\",\r\n    \"(m2) Enum\" = \"DEnumerator\",\r\n    \"(m2) Literal\" = \"DEnumLiteral\",\r\n    \"(m2) Operation\" = \"DOperation\",\r\n    \"(m2) Parameter\" = \"DParameter\",\r\n    \"(m2) Attribute\" = \"DAttribute\",\r\n    \"(m2) Reference\" = \"DReference\",\r\n    \"(m2) Annotation\" = \"DAnnotation\",\r\n    // abstract m2\r\n    \"(abstract m2) Feature\" = \"DStructuralFeature\",\r\n    \"(abstract m2) Classifier\" = \"DClassifier\",\r\n    // concrete m1\r\n    \"(m1) Object\" = \"DObject\",\r\n    \"(m1) Value\" = \"DValue\",\r\n}\r\nexport class ViewEClassMatch {\r\n    static NOT_EVALUATED_YET = undefined;\r\n    static MISMATCH = Number.NEGATIVE_INFINITY;\r\n    static MISMATCH_PRECONDITIONS = Number.NEGATIVE_INFINITY;\r\n    static MISMATCH_JS = false;\r\n    static MISMATCH_OCL = false;\r\n    static IMPLICIT_MATCH = 1;\r\n    static INHERITANCE_MATCH = 1.5;\r\n    static EXACT_MATCH = 2;\r\n    static VP_MISMATCH: number = Number.NEGATIVE_INFINITY;\r\n    static VP_Default = 1;\r\n    static VP_Decorative = 1;\r\n    static VP_Explicit = 2;\r\n}\r\n\r\nexport type ViewScore = {\r\n    viewPointMatch: number;\r\n    jsxOutput: React.ReactNode | React.ReactElement | undefined;\r\n    metaclassScore: number;\r\n    jsScore: number | boolean;\r\n    OCLScore: boolean;\r\n    finalScore: number;\r\n    usageDeclarations: GObject;\r\n    evalContext: GObject; // with added usageDeclarations for the current view\r\n    shouldUpdate: boolean; // computed along usageDeclarations in shouldComponentUpdate\r\n    shouldUpdate_reason: GObject;\r\n    nodeidcounter: Dictionary<number/*jsx char index*/, number/*counter:how many nodes generated by that jsx string line until now*/>\r\n\r\n    // usageDeclarations!: DefaultUsageDeclarations;\r\n    // oldNode: DGraphElement; moved to viewSorted_nodeused // ref to the actual node, not pointer. so even if it's modified through redux,\r\n    // it is still possible to compare old version and new version to check if view.oclUpdateCondition should trigger\r\n}\r\nexport class NodeTransientProperties{\r\n    viewSorted_modelused?: LModelElement; // L-version because it is used in oclUpdate function\r\n    viewSorted_pvid_used?: DViewElement;\r\n    viewSorted_nodeused?: LGraphElement;\r\n    stackViews!: LViewElement[]; // for each parentview, an array of Decorative Views[] sorted by score (including parent view influence).\r\n    validMainViews!: LViewElement[]; // an array of Main Views[] sorted by score (including parent view influence).\r\n    mainView!: LViewElement;\r\n    viewScores: Dictionary<Pointer<DViewElement>, ViewScore> = {} as any;\r\n    evalContext!: GObject; // global for this node (without view-specific usageDeclaration)\r\n    //force1Update!: boolean;\r\n    constructor(){\r\n        // this.stackViews = []; this.validMainViews = [];\r\n        this.viewScores = {};\r\n    }\r\n}\r\nexport class ViewTransientProperties {\r\n    // css_MUST_RECOMPILE: boolean;\r\n    // compiled_css: string; maye those are better shared in sessions\r\n    events!: Dictionary<DocString<\"functionName\">, ((...a:any)=>any)>;\r\n    oclChanged!: boolean;\r\n    jsConditionChanged!: boolean;\r\n    oclUpdateCondition_PARSED!: (oldData: LModelElement, newData:LModelElement) => boolean;// not used anymore? was like UD+shouldcompoupdate for jsx, a pre-ocl check\r\n    oclEngine!: OclEngine;\r\n    jsCondition!: undefined | ((context:GObject) => boolean);\r\n    JSXFunction!: (scope: GObject)=>ReactNode;\r\n    UDFunction!: (scope: GObject, ret: GObject)=>void;\r\n    constantsList!: string[];\r\n    UDList!: string[];\r\n    constants!: GObject;\r\n    onDataUpdate!: undefined | ((context:GObject)=>void);\r\n    onDragStart!: undefined | ((context:GObject)=>void);\r\n    onDragEnd!: undefined | ((context:GObject)=>void);\r\n    whileDragging!: undefined | ((context:GObject)=>void);\r\n    onResizeStart!: undefined | ((context:GObject)=>void);\r\n    onResizeEnd!: undefined | ((context:GObject)=>void);\r\n    whileResizing!: undefined | ((context:GObject)=>void);\r\n    onRotationStart!: undefined | ((context:GObject)=>void);\r\n    onRotationEnd!: undefined | ((context:GObject)=>void);\r\n    whileRotating!: undefined | ((context:GObject)=>void);\r\n\r\n    constructor(){\r\n        this.events = {};\r\n    }\r\n\r\n\r\n}\r\nexport class DataTransientProperties {\r\n    nodes!: Dictionary<Pointer<DGraphElement>, LGraphElement>;\r\n    node?: LGraphElement;\r\n    constructor(){\r\n        this.nodes = {};\r\n    }\r\n}\r\n\r\n// score for all view ocl + sorted views by best match\r\ntype TransientPropertiesByGraphTab = Dictionary<Pointer<DViewElement, number>> & {\r\n    /*\r\n    need_sorting: boolean;\r\n    sorted: Pointer<DViewElement>[];\r\n    // viewMatchings: Scored<DViewElement>[];\r\n    when to update?\r\n    1) data.parent.view.id: when \"suviews\" in place are changed by a view on a container element has changed (if pkg view changed, class view might change as well)\r\n    2) data.any --> when a direct value of the doject changed, amd that value was declared in ocl\r\n    3) view.appliableto --> when d-type changes (never, a class cannot become a enum or reference\r\n    4) node stuff never? or maybe entire nodes?\r\n    other data or view properties?*/\r\n};\r\nexport const transientProperties = {\r\n    node: {} as Dictionary<Pointer<DGraphElement>, NodeTransientProperties>,\r\n    view: {} as Dictionary<Pointer<DViewElement>, ViewTransientProperties>,\r\n    modelElement: {} as Dictionary<Pointer<DModelElement>, DataTransientProperties>,\r\n};\r\n(window as any).transient = (window as any).transientProperties = transientProperties;\r\n// transientProperties.nodes[nid].viewScores[vid]?.[pvid as string];\r\n/*\r\nexport const transientPropertiesByGraphTab: {viewMatchings: Dictionary<Pointer<DGraph>, Dictionary<Pointer<DModelElement>, TransientPropertiesByGraphTab>>} = {\r\n viewMatchings: {}\r\n};*/\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}