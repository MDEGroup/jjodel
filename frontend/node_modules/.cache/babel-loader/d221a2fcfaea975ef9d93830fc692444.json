{"ast":null,"code":"import { DModel, LModel, LObject, SetFieldAction, U } from '../../../joiner';\nexport class StateMachine_M1 {\n  static load1(project, m2, state, transition, command, event) {\n    const m1 = this.create(undefined, project, m2);\n    /* Command */\n    const command1 = this.createCommand(m1, command, 'unlockDoor ud');\n    const command2 = this.createCommand(m1, command, 'lockPanel lp');\n    const command3 = this.createCommand(m1, command, 'unlockPanel up');\n    const command4 = this.createCommand(m1, command, 'lockDoor ld');\n    /* Event */\n    const event1 = this.createEvent(m1, event, 'panelClosed pc');\n    const event2 = this.createEvent(m1, event, 'doorClosed dc');\n    const event3 = this.createEvent(m1, event, 'lightOn Io');\n    const event4 = this.createEvent(m1, event, 'drawerOpened do');\n    /* Events */\n    const events = m1.addObject({}, null);\n    /* State */\n    const idle = this.createState(m1, state, 'idle', [command1, command2]);\n    const active = this.createState(m1, state, 'active', []);\n    const waitingForDrawer = this.createState(m1, state, 'waitingForDrawer', []);\n    const waitingForLight = this.createState(m1, state, 'waitingForLight', []);\n    const unlockPanel = this.createState(m1, state, 'unlockPanel', [command3, command4]);\n    /* Transition */\n    const transition1 = this.createTransition(m1, transition, unlockPanel, idle, event1);\n    const transition2 = this.createTransition(m1, transition, idle, active, event2);\n    const transition3 = this.createTransition(m1, transition, active, waitingForDrawer, event3);\n    const transition4 = this.createTransition(m1, transition, active, waitingForLight, event4);\n    const transition5 = this.createTransition(m1, transition, waitingForDrawer, unlockPanel, event4);\n    const transition6 = this.createTransition(m1, transition, waitingForLight, unlockPanel, event3);\n    return [m1, idle];\n  }\n  static load2(name, project, m2, state, transition, command, event) {\n    const m1 = this.create(name, project, m2);\n    /* 168 Properties (84 commands & 84 events), 40 states and 48 transitions */\n    const commandsLength = 84;\n    const eventsLength = 84;\n    const statesLength = 40;\n    const transitionsLength = 48;\n    const commands = [];\n    const events = [];\n    const states = [];\n    const transitions = [];\n    for (let i = 0; i < commandsLength; i++) commands.push(this.createCommand(m1, command, 'C' + i));\n    for (let i = 0; i < eventsLength; i++) events.push(this.createEvent(m1, event, 'E' + i));\n    const object = m1.addObject({\n      name: 'Events'\n    }, undefined);\n    for (let i = 0; i < statesLength; i++) states.push(this.createState(m1, state, 'S' + i, [commands[i]]));\n    for (let i = 0; i < transitionsLength; i++) transitions.push(this.createTransition(m1, transition, states[i % statesLength], states[(i + 1) % statesLength], events[i]));\n    return [m1];\n  }\n  static create(name, project, m2) {\n    var _lModel$node;\n    const dModel = DModel.new(name, m2.id, false, true);\n    const lModel = LModel.fromD(dModel);\n    SetFieldAction.new(project.id, 'models', lModel.id, '+=', true);\n    SetFieldAction.new(project.id, 'graphs', (_lModel$node = lModel.node) === null || _lModel$node === void 0 ? void 0 : _lModel$node.id, '+=', true);\n    return lModel;\n  }\n  static createState(m1, state, name, actions) {\n    // const dObject = m1.addObject({$name: name, $actions: actions.map(o => o.id)}, state.id);\n    const dObject = m1.addObject({}, state.id);\n    const lObject = LObject.fromD(dObject);\n    lObject.features[0].value = name;\n    lObject.features[1].values = actions;\n    return lObject;\n  }\n  static createCommand(m1, command, name) {\n    const code = U.getRandomString(2);\n    // const dObject = m1.addObject({$name: name, $code: code}, command.id);\n    const dObject = m1.addObject({}, command.id);\n    const lObject = LObject.fromD(dObject);\n    lObject.features[0].value = name;\n    lObject.features[1].value = code;\n    return lObject;\n  }\n  static createEvent(m1, event, name) {\n    const code = U.getRandomString(2);\n    // const dObject = m1.addObject({$name: name, $code: code}, event.id);\n    const dObject = m1.addObject({}, event.id);\n    const lObject = LObject.fromD(dObject);\n    lObject.features[0].value = name;\n    lObject.features[1].value = code;\n    return lObject;\n  }\n  static createTransition(m1, transition, source, target, event) {\n    // const dObject = m1.addObject({$source: source.id, $target: target.id, $trigger: event.id}, transition.id);\n    const dObject = m1.addObject({}, transition.id);\n    const lObject = LObject.fromD(dObject);\n    lObject.features[0].values = [source];\n    lObject.features[1].values = [target];\n    lObject.features[2].values = [event];\n    return lObject;\n  }\n}","map":{"version":3,"names":["DModel","LModel","LObject","SetFieldAction","U","StateMachine_M1","load1","project","m2","state","transition","command","event","m1","create","undefined","command1","createCommand","command2","command3","command4","event1","createEvent","event2","event3","event4","events","addObject","idle","createState","active","waitingForDrawer","waitingForLight","unlockPanel","transition1","createTransition","transition2","transition3","transition4","transition5","transition6","load2","name","commandsLength","eventsLength","statesLength","transitionsLength","commands","states","transitions","i","push","object","_lModel$node","dModel","new","id","lModel","fromD","node","actions","dObject","lObject","features","value","values","code","getRandomString","source","target"],"sources":["C:/0Programmi/Dev/projects/frontend/jjodel/src/examples/StateMachine/M1/index.ts"],"sourcesContent":["import {DModel, DValue, LClass, LModel, LObject, LProject, SetFieldAction, U} from '../../../joiner';\r\n\r\nexport class StateMachine_M1 {\r\n    static load1(project: LProject, m2: LModel, state: LClass, transition: LClass, command: LClass, event: LClass): [LModel, LObject] {\r\n        const m1 = this.create(undefined, project, m2);\r\n        /* Command */\r\n        const command1 = this.createCommand(m1, command, 'unlockDoor ud');\r\n        const command2 = this.createCommand(m1, command, 'lockPanel lp');\r\n        const command3 = this.createCommand(m1, command, 'unlockPanel up');\r\n        const command4 = this.createCommand(m1, command, 'lockDoor ld');\r\n        /* Event */\r\n        const event1 = this.createEvent(m1, event, 'panelClosed pc');\r\n        const event2 = this.createEvent(m1, event, 'doorClosed dc');\r\n        const event3 = this.createEvent(m1, event, 'lightOn Io');\r\n        const event4 = this.createEvent(m1, event, 'drawerOpened do');\r\n        /* Events */\r\n        const events = m1.addObject({}, null);\r\n        /* State */\r\n        const idle = this.createState(m1, state, 'idle', [command1, command2]);\r\n        const active = this.createState(m1, state, 'active', []);\r\n        const waitingForDrawer = this.createState(m1, state, 'waitingForDrawer', []);\r\n        const waitingForLight = this.createState(m1, state, 'waitingForLight', []);\r\n        const unlockPanel = this.createState(m1, state, 'unlockPanel', [command3, command4]);\r\n        /* Transition */\r\n        const transition1 = this.createTransition(m1, transition, unlockPanel, idle, event1);\r\n        const transition2 = this.createTransition(m1, transition, idle, active, event2);\r\n        const transition3 = this.createTransition(m1, transition, active, waitingForDrawer, event3);\r\n        const transition4 = this.createTransition(m1, transition, active, waitingForLight, event4);\r\n        const transition5 = this.createTransition(m1, transition, waitingForDrawer, unlockPanel, event4);\r\n        const transition6 = this.createTransition(m1, transition, waitingForLight, unlockPanel, event3);\r\n\r\n        return [m1, idle];\r\n    }\r\n    static load2(name: string, project: LProject, m2: LModel, state: LClass, transition: LClass, command: LClass, event: LClass) {\r\n        const m1 = this.create(name, project, m2);\r\n        /* 168 Properties (84 commands & 84 events), 40 states and 48 transitions */\r\n        const commandsLength = 84; const eventsLength = 84; const statesLength = 40; const transitionsLength = 48;\r\n        const commands: LObject[] = []; const events: LObject[] = []; const states: LObject[] = []; const transitions: LObject[] = [];\r\n        for(let i = 0; i < commandsLength; i++)\r\n            commands.push(this.createCommand(m1, command, 'C' + i));\r\n        for(let i = 0; i < eventsLength; i++)\r\n            events.push(this.createEvent(m1, event, 'E' + i));\r\n        const object = m1.addObject({name: 'Events'}, undefined);\r\n        for(let i = 0; i < statesLength; i++)\r\n            states.push(this.createState(m1, state, 'S' + i, [commands[i]]))\r\n        for(let i = 0; i < transitionsLength; i++)\r\n            transitions.push(this.createTransition(m1, transition, states[i % statesLength], states[(i + 1) % statesLength], events[i]));\r\n        return [m1];\r\n    }\r\n\r\n    private static create(name: string|undefined, project: LProject, m2: LModel): LModel {\r\n        const dModel: DModel = DModel.new(name, m2.id, false, true);\r\n        const lModel: LModel = LModel.fromD(dModel);\r\n        SetFieldAction.new(project.id, 'models', lModel.id, '+=', true);\r\n        SetFieldAction.new(project.id, 'graphs', lModel.node?.id, '+=', true);\r\n        return lModel;\r\n    }\r\n    private static createState(m1: LModel, state: LClass, name: string, actions: LObject[]): LObject {\r\n        // const dObject = m1.addObject({$name: name, $actions: actions.map(o => o.id)}, state.id);\r\n        const dObject = m1.addObject({}, state.id);\r\n        const lObject: LObject = LObject.fromD(dObject);\r\n        lObject.features[0].value = name;\r\n        lObject.features[1].values = actions;\r\n        return lObject;\r\n    }\r\n    private static createCommand(m1: LModel, command: LClass, name: string): LObject {\r\n        const code = U.getRandomString(2);\r\n        // const dObject = m1.addObject({$name: name, $code: code}, command.id);\r\n        const dObject = m1.addObject({}, command.id);\r\n        const lObject: LObject = LObject.fromD(dObject);\r\n        lObject.features[0].value = name;\r\n        lObject.features[1].value = code;\r\n        return lObject;\r\n    }\r\n    public static createEvent(m1: LModel, event: LClass, name: string): LObject {\r\n        const code = U.getRandomString(2);\r\n        // const dObject = m1.addObject({$name: name, $code: code}, event.id);\r\n        const dObject = m1.addObject({}, event.id);\r\n        const lObject: LObject = LObject.fromD(dObject);\r\n        lObject.features[0].value = name;\r\n        lObject.features[1].value = code;\r\n        return lObject;\r\n    }\r\n    public static createTransition(m1: LModel, transition: LClass, source: LObject, target: LObject, event: LObject): LObject {\r\n        // const dObject = m1.addObject({$source: source.id, $target: target.id, $trigger: event.id}, transition.id);\r\n        const dObject = m1.addObject({}, transition.id);\r\n        const lObject: LObject = LObject.fromD(dObject);\r\n        lObject.features[0].values = [source];\r\n        lObject.features[1].values = [target];\r\n        lObject.features[2].values = [event];\r\n        return lObject;\r\n    }\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}