{"ast":null,"code":"var _jsxFileName = \"C:\\\\d\\\\Programming\\\\web\\\\jodel-mde\\\\src\\\\view\\\\viewElement\\\\view.tsx\",\n  _dec,\n  _class,\n  _class2,\n  _dec2,\n  _class3,\n  _class4,\n  _dec3,\n  _class5,\n  _class6,\n  _dec4,\n  _class7,\n  _class8;\nimport { BEGIN, Constructors, CoordinateMode, Debug, Defaults, DPointerTargetable, DViewPoint, EdgeBendingMode, EdgeGapMode, EGraphElements, EModelElements, END, GraphPoint, GraphSize, Log, LPointerTargetable, LUser, LViewPoint, MyProxyHandler, Pointers, RuntimeAccessible, RuntimeAccessibleClass, SetFieldAction, SetRootFieldAction, ShortAttribETypes, store, TRANSACTION, U, windoww } from \"../../joiner\";\nimport { DUser, transientProperties } from \"../../joiner/classes\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nlet CSS_Units0 = {\n  'Local-font relative': {\n    'cap': 'cap - (Cap height) the nominal height of capital letters of the element\\'s font.',\n    'ch': 'ch - Average character advance of a narrow glyph in the element\\'s font, as represented by the \"0\" (ZERO, U+0030) glyph.',\n    'em': 'em - Font size of the element\\'s font.',\n    'ex': 'ex - x-height of the element\\'s font.',\n    'ic': 'ic - Average character advance of a full-width glyph in the element\\'s font, as represented by the \"水\" (CJK water ideograph, U+6C34) glyph.',\n    'lh': 'lh - Line height of the element.'\n  },\n  'Root-font relative': {\n    'rcap': 'rcap - Cap height (the nominal height of capital letters) of the root element\\'s font.',\n    'rch': 'rch - Average character advance of a narrow glyph in the root element\\'s font, as represented by the \"0\" (ZERO, U+0030) glyph.',\n    'rem': 'rem - Font size of the root element\\'s font.',\n    'rex': 'rex - x-height of the root element\\'s font.',\n    'ric': 'ric - Average character advance of a full-width glyph in the root element\\'s font, as represented by the \"水\" (CJK water ideograph, U+6C34) glyph.',\n    'rlh': 'rlh - Line height of the root element.'\n  },\n  'Relative': {\n    'dvh': 'dvh - 1% of the dynamic viewport\\'s height.',\n    'dvw': 'dvw - 1% of the dynamic viewport\\'s width.',\n    'lvh': 'lvh - 1% of the large viewport\\'s height.',\n    'lvw': 'lvw - 1% of the large viewport\\'s width.',\n    'svh': 'svh - 1% of the small viewport\\'s height.',\n    'svw': 'svw - 1% of the small viewport\\'s width.',\n    'vb': 'vb - 1% of viewport\\'s size in the root element\\'s block axis.',\n    'vh': 'vh - 1% of viewport\\'s height.',\n    'vi': 'vi - 1% of viewport\\'s size in the root element\\'s inline axis.',\n    'vmax': 'vmax - 1% of viewport\\'s larger dimension.',\n    'vmin': 'vmin - 1% of viewport\\'s smaller dimension.',\n    'vw': 'vw - 1% of viewport\\'s width.',\n    'fr': 'fr - (Flex) Represents a flexible length within a grid container',\n    '%': '% - Percentage'\n  },\n  'Container @Query relative': {\n    'cqb': 'cqb - 1% of a query container\\'s block size',\n    'cqh': 'cqh - 1% of a query container\\'s height',\n    'cqi': 'cqi - 1% of a query container\\'s inline size',\n    'cqmax': 'cqmax - The larger value of cqi or cqb',\n    'cqmin': 'cqmin - The smaller value of cqi or cqb',\n    'cqw': 'cqw - 1% of a query container\\'s width'\n  },\n  'Absolute lengths': {\n    'cm': 'cm - (Centimeters) 1cm = 96px/2.54',\n    'in': 'in - (Inches) 1in = 2.54cm = 96px',\n    'mm': 'mm - (Millimeters) 1mm = 1/10th of 1cm',\n    'pc': 'pc - (Picas) 1pc = 1/6th of 1in',\n    'pt': 'pt - (Points) 1pt = 1/72th of 1in',\n    'px': 'px - (Pixels) 1px = 1/96th of 1in',\n    'Q': 'Q - (Quarter-millimeters) 1Q = 1/40th of 1cm'\n  },\n  'Angles': {\n    'deg': 'deg - (Degrees) There are 360 degrees in a full circle.',\n    'grad': 'grad - (Gradians) There are 400 gradians in a full circle.',\n    'rad': 'rad - (Radians) There are 2π radians in a full circle.',\n    'turn': 'turn - (Turns) There is 1 turn in a full circle.'\n  },\n  'Time': {\n    'ms': 'ms - Milliseconds',\n    's': 's - (Seconds) There are 1,000 milliseconds in a second.'\n  },\n  'Frequency': {\n    'Hz': 'Hz - (Hertz) Represents the number of occurrences per second.',\n    'kHz': 'kHz - (KiloHertz) A kiloHertz is 1000 Hertz.'\n  },\n  'Resolution': {\n    'dpcm': 'dpcm - Dots per centimeter.',\n    'dpi': 'dpi - Dots per inch.',\n    'dppx': 'dppx - Dots per px unit.'\n  }\n};\nexport let CSS_Units = CSS_Units0;\nlet pattern = [];\nCSS_Units.jsx = /*#__PURE__*/_jsxDEV(\"datalist\", {\n  id: \"__jodel_CSS_units\",\n  children: Object.keys(CSS_Units).map(k1 => {\n    let v1 = CSS_Units[k1];\n    console.log(\"optgroup css units\", {\n      k1,\n      v1,\n      karr: Object.keys(v1),\n      k1arr: Object.keys(CSS_Units)\n    });\n    return /*#__PURE__*/_jsxDEV(\"optgroup\", {\n      label: k1,\n      children: Object.keys(v1).map(k => {\n        let v = v1[k];\n        console.log(\"css units\", {\n          k,\n          v,\n          k1,\n          v1,\n          karr: Object.keys(v1),\n          k1arr: Object.keys(CSS_Units)\n        });\n        pattern.push(k);\n        return /*#__PURE__*/_jsxDEV(\"option\", {\n          value: k,\n          children: v\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 137,\n          columnNumber: 24\n        }, this);\n      })\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 15\n    }, this);\n  })\n}, void 0, false, {\n  fileName: _jsxFileName,\n  lineNumber: 127,\n  columnNumber: 17\n}, this);\n//throw new Error(\"Stop\");\nCSS_Units.pattern = \"^(\" + pattern.join('|') + \")$\";\nwindoww.CSS_Units = CSS_Units;\n\n/*\r\nexport type CSS_AbsoluteUnit = 'px' | 'cm' | 'mm' | 'pt' | 'pc' | 'in' | '';\r\nexport type CSS_RelativeDomUnit = '%' | 'fr' | 'vw' | 'vh' | 'vmin' | 'vmax';\r\nexport type CSS_RelativeFontUnit =  'em' | 'rem' | 'ex' | 'ch';\r\nexport type CSSUnit = CSS_AbsoluteUnit | CSS_RelativeFontUnit | CSS_RelativeDomUnit;*/\n\n// array of rgba: red, green, blue, alpha\n// array of rgba: red, green, blue, alpha\n\nexport let DViewElement = (_dec = RuntimeAccessible('DViewElement'), _dec(_class = (_class2 = class DViewElement extends DPointerTargetable {\n  constructor() {\n    super(...arguments);\n    this.id = void 0;\n    this.isValidation = void 0;\n    this.name = void 0;\n    this.isExclusiveView = void 0;\n    this.constants = void 0;\n    this.preRenderFunc = void 0;\n    this.jsxString = void 0;\n    this.usageDeclarations = void 0;\n    this.forceNodeType = void 0;\n    this.appliableToClasses = void 0;\n    this.appliableTo = void 0;\n    this.subViews = void 0;\n    this.oclCondition = void 0;\n    this.jsCondition = void 0;\n    this.oclUpdateCondition = void 0;\n    this.OCL_NEEDS_RECALCULATION = void 0;\n    this.OCL_UPDATE_NEEDS_RECALCULATION = void 0;\n    this.explicitApplicationPriority = void 0;\n    this.defaultVSize = void 0;\n    this.adaptHeight = void 0;\n    this.adaptWidth = void 0;\n    this.draggable = void 0;\n    this.resizable = void 0;\n    this.viewpoint = void 0;\n    this.onDataUpdate = void 0;\n    this.onDragStart = void 0;\n    this.onDragEnd = void 0;\n    this.whileDragging = void 0;\n    this.onResizeStart = void 0;\n    this.onResizeEnd = void 0;\n    this.whileResizing = void 0;\n    this.onRotationStart = void 0;\n    this.onRotationEnd = void 0;\n    this.whileRotating = void 0;\n    this.events = void 0;\n    this.bendingMode = void 0;\n    this.edgeGapMode = void 0;\n    this.storeSize = void 0;\n    this.size = void 0;\n    this.lazySizeUpdate = void 0;\n    this.edgeStartOffset = void 0;\n    this.edgeEndOffset = void 0;\n    this.edgeStartOffset_isPercentage = void 0;\n    this.edgeEndOffset_isPercentage = void 0;\n    this.edgeStartStopAtBoundaries = void 0;\n    this.edgeEndStopAtBoundaries = void 0;\n    this.edgePointCoordMode = void 0;\n    this.edgeHeadSize = void 0;\n    this.edgeTailSize = void 0;\n    this.palette = void 0;\n    this.css = void 0;\n    this.cssIsGlobal = void 0;\n    this.compiled_css = void 0;\n    this.css_MUST_RECOMPILE = void 0;\n  } // static singleton: LViewElement;\n  // static logic: typeof LViewDViewElementElement;\n  // static structure: typeof DViewElement;\n  // inherited redefine\n  // public __raw!: DViewElement;\n  // own properties\n  // only for root views (ex viewpoints) to group views semantically.\n  // processate 1 sola volta all'applicazione della vista o all'editing del campo\n  // _parsedConstants?: GObject; // should be protected but LView is not subclass\n  // evaluate tutte le volte che l'elemento viene aggiornato (il model o la view cambia).\n  // l'html template\n  // used in DefaultNode\n  // scalezoomx: boolean = false; // whether to resize the element normally using width-height or resize it using zoom-scale css\n  // scalezoomy: boolean = false;\n  // not persistent, some not shared. deve essere diverso da utente ad utente perchè dipende dal pan e zoom nel grafo dell'utente attuale.\n  // facendo pan su grafo html sposti gli elementi, per simulare uno spostamento del grafo e farlo sembrare illimitato.\n  // __transient: DViewTransientProperties;\n  // class names: DModel, DPackage, DAttribute...\n  // ocl selector\n  // js selector\n  //oclUpdateCondition_PARSED!: undefined | ((view: LViewElement)=>boolean); moved in transient\n  // if only the oclCondition needs to be reapplied to all model elements\n  // if both ocl needsto be reapplied and the oclUpdateCondition -> transient.view[v.id].oclUpdateCondition_PARSED needs to be remade\n  // priority of the view, if a node have multiple applicable views, the view with highest priority is applied.\n  // | 'fit-content' | '-webkit-fill-available';\n  /*width!: number;\r\n  height!: number;*/\n  //display!: 'block'|'contents'|'flex'|string;\n  //constraints!: GObject<\"obsolete, used in Vertex. they are triggered by events (view.onDragStart....) and can bound the size of the vertex\">[];\n  //useSizeFrom!: EuseSizeFrom;\n  // if true updates it once when the vertex is released. if false updates vertex position every X millisecond while dragging.\n  /* private */\n  /* private */\n  static new(name, jsxString, defaultVSize) {\n    let usageDeclarations = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : '';\n    let constants = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : '';\n    let preRenderFunc = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : '';\n    let appliableToClasses = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : [];\n    let oclCondition = arguments.length > 7 && arguments[7] !== undefined ? arguments[7] : '';\n    let priority = arguments.length > 8 ? arguments[8] : undefined;\n    let persist = arguments.length > 9 && arguments[9] !== undefined ? arguments[9] : true;\n    let isDefaultView = arguments.length > 10 && arguments[10] !== undefined ? arguments[10] : false;\n    let vp = arguments.length > 11 ? arguments[11] : undefined;\n    let id = isDefaultView ? 'Pointer_View' + name : undefined;\n    return new Constructors(new DViewElement('dwc'), undefined, persist, undefined, id).DPointerTargetable().DViewElement(name, jsxString, vp, defaultVSize, usageDeclarations, constants, preRenderFunc, appliableToClasses, oclCondition, priority).end();\n  }\n  static new2(name, jsxString, callback) {\n    let persist = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : true;\n    let vp = arguments.length > 4 ? arguments[4] : undefined;\n    let id = arguments.length > 5 ? arguments[5] : undefined;\n    // let id = isDefaultView ? 'Pointer_View' + name : undefined;\n    return new Constructors(new DViewElement('dwc'), undefined, persist, undefined, id).DPointerTargetable().DViewElement(name, jsxString, vp).end(callback);\n  }\n  static newDefault(forData) {\n    const jsx = `<div className={'root'}>\n    <div className={'header'}>\n        <Input\n            placeholder={\"?\"}\n            autosize={\"true\"}\n            hidden={true}\n            data={data}\n            field={\"name\"}\n        />\n    </div>\n    <div className={'body'}>To add information here,<br/> edit the view<br/><i>\"{view.name}\"</i></div>\n</div>`;\n    const palettes = {\n      \"border-color-\": {\n        type: \"color\",\n        value: [{\n          r: 187,\n          g: 187,\n          b: 187,\n          a: 1\n        }]\n      },\n      \"background-\": {\n        type: \"color\",\n        value: [{\n          r: 238,\n          g: 242,\n          b: 243,\n          a: 1\n        }]\n      },\n      \"color-\": {\n        type: \"color\",\n        value: [{\n          r: 3,\n          g: 54,\n          b: 86,\n          a: 1\n        }]\n      }\n    };\n    const css = `.root {\n    border: 1px solid var(--border-color-1);\n    border-radius: 4px;\n    background-color: var(--background-1);\n    \n    font-family: Verdana, sans-serif;\n    color: var(--color-1);\n    font-size: 11px;\n}\n \n.root div.header {\n    text-align: center;\n    border-bottom: 1px solid var(--border-color-1);\n    padding: 0px;\n    margin: 0px;\n}\n \n.root div.header {\n    font-size: 5px;\n}\n \n.root div.header input:empty {\n    margin-left: 0px;\n}\n.root div.body {\n    text-align: center;\n    font-weight: normal;  \n    height: auto;\n    padding: 5px;\n}\n `;\n    let query = '';\n    if (forData) switch (forData.className) {\n      case 'DClass':\n        query = `context DObject inv: self.instanceof.id = '${forData.id}'`;\n        break;\n      case 'DAttribute':\n      case 'DReference':\n        query = `context DValue inv: self.instanceof.id = '${forData.id}'`;\n        break;\n      default:\n        query = `context ${forData.className} inv: self.id = '${forData.id}'`;\n        break;\n    }\n    const user = LUser.fromPointer(DUser.current);\n    // const project = user?.project; if(!project) return this;\n    let name;\n    if (forData === null || forData === void 0 ? void 0 : forData.name) {\n      name = forData.name + 'View';\n    } else {\n      var _user$project;\n      const vp = (user === null || user === void 0 ? void 0 : (_user$project = user.project) === null || _user$project === void 0 ? void 0 : _user$project.activeViewpoint) || LPointerTargetable.fromPointer(Defaults.viewpoints[0]);\n      let names = vp.subViews.map(v => v && v.name);\n      name = U.increaseEndingNumber('view_' + 0, false, false, newName => names.indexOf(newName) >= 0);\n    }\n    return DViewElement.new2(name, jsx, d => {\n      d.css = css;\n      d.palette = palettes;\n      d.css_MUST_RECOMPILE = true;\n      d.oclCondition = query;\n    }, true);\n  }\n}, _class2.subclasses = [], _class2._extends = [], _class2.MeasurableKeys = ['onDataUpdate', 'onDragStart', 'onDragEnd', 'whileDragging', 'onResizeStart', 'onResizeEnd', 'whileResizing', 'onRotationStart', 'onRotationEnd', 'whileRotating'], _class2.RecompileKeys = ['onDataUpdate', 'onDragStart', 'onDragEnd', 'whileDragging', 'onResizeStart', 'onResizeEnd', 'whileResizing', 'onRotationStart', 'onRotationEnd', 'whileRotating', 'constants', 'usageDeclarations', 'jsxString', 'preconditions', 'jsCondition', 'ocl', 'events'], _class2)) || _class);\nexport let LViewElement = (_dec2 = RuntimeAccessible('LViewElement'), _dec2(_class3 = (_class4 = class LViewElement extends LPointerTargetable {\n  constructor() {\n    super(...arguments);\n    this.__raw = void 0;\n    this.id = void 0;\n    this.r = void 0;\n    this.isValidation = void 0;\n    this.name = void 0;\n    this.__info_of__name = {\n      isGlobal: true,\n      type: ShortAttribETypes.EString,\n      txt: /*#__PURE__*/_jsxDEV(\"div\", {\n        children: \"Name of the view\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 366,\n        columnNumber: 83\n      }, this)\n    };\n    this.isOverlay = void 0;\n    this.__info_of__isOverlay = {\n      isGlobal: true,\n      type: ShortAttribETypes.EBoolean,\n      txt: /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [\"If not exclusive, the view is meant to add a functional outline of tools to a primary View, or css.\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 369,\n          columnNumber: 13\n        }, this), \"A non-exclusive view cannot be applied alone and needs an exclusive view to render the main graphical content.\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 368,\n        columnNumber: 88\n      }, this)\n    };\n    this.explicitApplicationPriority = void 0;\n    this.__info_of__explicitApplicationPriority = {\n      isGlobal: true,\n      type: ShortAttribETypes.EByte,\n      label: \"explicit priority\",\n      txt: 'Application priority of view. If multiple views match an element, the highest priority will render the main jsx.'\n    };\n    this.isExclusiveView = void 0;\n    this.__info_of__isExclusiveView = {\n      isGlobal: true,\n      type: ShortAttribETypes.EBoolean,\n      txt: /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [\"If not exclusive, the view is meant to add a functional outline of tools to a primary View, or css.\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 388,\n          columnNumber: 5\n        }, this), \"A non-exclusive view cannot be applied alone and needs an exclusive view to render the main graphical content.\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 387,\n        columnNumber: 94\n      }, this)\n    };\n    this.constants = void 0;\n    this.__info_of__constants = {\n      todo: true,\n      isGlobal: true,\n      type: \"Function():Object\",\n      label: \"constants declaration\",\n      txt: /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [\"Data used in the visual representation, meant to be static values evaluated only once when the view is first applied.\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 397,\n          columnNumber: 135\n        }, this), \"Check default value view for an example.\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 398,\n          columnNumber: 49\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 397,\n        columnNumber: 13\n      }, this)\n    };\n    this.preRenderFunc = void 0;\n    this.__info_of__preRenderFunc = {\n      isGlobal: true,\n      obsolete: true,\n      type: \"Function():Object\",\n      label: \"pre-render function\",\n      txt: /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [\"Data used in the visual representation, meant to be dynamic values evaluated every time the visual representation is updated.\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 405,\n          columnNumber: 143\n        }, this), \"Replaced by usageDeclarations.\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 405,\n        columnNumber: 13\n      }, this)\n    };\n    this.jsxString = void 0;\n    this.__info_of__jsxString = {\n      isGlobal: true,\n      type: \"text\",\n      label: \"JSX template\",\n      txt: /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [\"The main ingredient, a \", /*#__PURE__*/_jsxDEV(\"a\", {\n          href: \"https://react.dev/learn/writing-markup-with-jsx\",\n          children: \"JSX template\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 413,\n          columnNumber: 41\n        }, this), \" that will be visualized in the graph.\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 413,\n        columnNumber: 13\n      }, this)\n    };\n    this.usageDeclarations = void 0;\n    this.__info_of__usageDeclarations = {\n      todo: false,\n      isGlobal: true,\n      type: \"Function():Object\",\n      label: \"usage declarations\",\n      txt: /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [\"Subset of the global or elements's data state that is graphically used.\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 429,\n          columnNumber: 13\n        }, this), \"If specified the element will only update when one of those has changed.\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 430,\n          columnNumber: 13\n        }, this), \"Can optimize performance and ensure the node is updated even when navigating remote properties that\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 431,\n          columnNumber: 13\n        }, this), \"    don\\\\'t belong to this element, like visualizing the name of an object pointed by a reference.\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 432,\n          columnNumber: 13\n        }, this), \"Context: it has the usual variables present in a JSX template (data, view, node...)\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 433,\n          columnNumber: 13\n        }, this), \"    plus a special variable \\\"ret\\\" where dependencies are registered.\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 434,\n          columnNumber: 13\n        }, this), \"Usage Example: see the default view for value.\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 428,\n        columnNumber: 14\n      }, this)\n    };\n    this.oclUpdateCondition = void 0;\n    this.__info_of__oclUpdateCondition = {\n      readType: '(view: LViewElement)=>boolean',\n      writeType: 'function string',\n      txt: \"[Optionally] Declare variables that are used in OCL condition, so that OCL will be re-checked only when those values have changed.\"\n    };\n    this.css_MUST_RECOMPILE = void 0;\n    this.cssIsGlobal = void 0;\n    this.__info_of__cssIsGlobal = {\n      type: ShortAttribETypes.EBoolean,\n      txt: \"Use with caution!\\nIf true, custom css can affect even elements not matched with this view, or outside the graph.\"\n    };\n    this.css = void 0;\n    this.__info_of__css = {\n      type: \"css string\",\n      txt: \"Inject custom css that cannot be inserted inline like :hover or css variables.\\nSupport LESS syntax.\"\n    };\n    this.compiled_css = void 0;\n    this.__info_of__compiled_css = {\n      hidden: true,\n      txt: 'css + palettes compiled from less in css'\n    };\n    this.palette = void 0;\n    this.__info_of__palette = {\n      type: \"Dictionary<prefix, colors[]>\",\n      txt: \"Specify a set of colors, numbers or text variables to be used in the graphical syntax through css variables.\"\n    };\n    this.forceNodeType = void 0;\n    this.__info_of__forceNodeType = {\n      isGlobal: true,\n      type: \"EGraphElements\",\n      enum: EGraphElements,\n      label: \"force node type\",\n      txt: /*#__PURE__*/_jsxDEV(\"div\", {\n        children: \"Forces this element to be rendered with your component of choice instead of automatic selection when generated by a <DefaultNode> tag.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 618,\n        columnNumber: 13\n      }, this)\n    };\n    this.zoom = void 0;\n    this.__info_of__zoom = {\n      todo: true,\n      isNode: true,\n      type: GraphPoint.cname,\n      txt: /*#__PURE__*/_jsxDEV(\"div\", {\n        children: \"Zooms in or out the element using css scale.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 621,\n        columnNumber: 84\n      }, this)\n    };\n    this.appliableToClasses = void 0;\n    this.__info_of__appliableToClasses = {\n      isGlobal: true,\n      type: \"EModelElements | EGraphElements\",\n      enum: {\n        ...EModelElements,\n        ...EGraphElements,\n        cname: \"EModelElements | EGraphElements\"\n      },\n      label: \"applicable to\",\n      txt: /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [\"Do a low priority match with elements of this type.\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 637,\n          columnNumber: 13\n        }, this), \"This is just a shortcut with a lower priority than a OCL match.\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 638,\n          columnNumber: 13\n        }, this), \"The same result can be obtained through OCL.\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 636,\n        columnNumber: 14\n      }, this)\n    };\n    this.appliableTo = void 0;\n    this.subViews = void 0;\n    this.__info_of__subViews = {\n      isGlobal: true,\n      hidden: true,\n      type: \"DViewElement[]\",\n      label: \"sub-views\",\n      txt: /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [\"Views that are suggested to render elements contained in the current one with a higher match priority.\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 645,\n          columnNumber: 13\n        }, this), \"Like a package view giving priority to a specific Class or Enum view to render his contained Classifiers in a common theme.\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 646,\n          columnNumber: 13\n        }, this), \"If you wish to see the subview weight attached to the collection, access view.__raw.subviews instead.\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 644,\n        columnNumber: 13\n      }, this)\n    };\n    this.setSubViewScore = void 0;\n    this.__info_of__setSubViewScore = {\n      isGlobal: true,\n      hidden: true,\n      type: \"function(ViewElement, numeric_score): void\",\n      txt: /*#__PURE__*/_jsxDEV(\"div\", {\n        children: \"Adds, updates or unsets (if boost = null) a subview with his score.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 662,\n        columnNumber: 127\n      }, this)\n    };\n    this.allSubViews = void 0;\n    this.__info_of__allSubViews = {\n      type: \"ViewElement[]\",\n      txt: \"recursively get this.subViews.\"\n    };\n    this.defaultVSize = void 0;\n    this.__info_of__defaultVSize = {\n      isNode: true,\n      type: \"GraphSize\",\n      label: \"default size\",\n      txt: 'starting size of the node'\n    };\n    this.adaptWidth = void 0;\n    this.__info_of__adaptWidth = {\n      isNode: true,\n      type: ShortAttribETypes.EBoolean,\n      label: \"adapt width\",\n      txt: 'Whether the element should expand his width to accomodate his own contents.'\n    };\n    this.adaptHeight = void 0;\n    this.__info_of__adaptHeight = {\n      isNode: true,\n      type: ShortAttribETypes.EBoolean,\n      label: \"adapt height\",\n      txt: 'Whether the element should expand his height to accomodate his own contents.'\n    };\n    this.draggable = void 0;\n    this.__info_of__draggable = {\n      isNode: true,\n      type: ShortAttribETypes.EBoolean,\n      txt: 'if the element can be dragged'\n    };\n    this.resizable = void 0;\n    this.__info_of__resizable = {\n      isNode: true,\n      type: ShortAttribETypes.EBoolean,\n      txt: 'if the element can be resized'\n    };\n    this.oclCondition = void 0;\n    this.__info_of__oclCondition = {\n      isGlobal: true,\n      hidden: true,\n      label: \"OCL apply condition\",\n      type: \"text\",\n      // TODO: what's the difference with this.query?\n      txt: 'OCL Query selector to determine which nodes or model elements should apply this view'\n    };\n    this.jsCondition = void 0;\n    this.__info_of__jsCondition = {\n      isGlobal: true,\n      hidden: true,\n      label: \"js apply condition\",\n      type: \"text\",\n      txt: 'js Query selector to determine which nodes or model elements should apply this view'\n    };\n    this.viewpoint = void 0;\n    this.__info_of__viewpoint = {\n      hidden: true,\n      type: LViewPoint.cname,\n      txt: /*#__PURE__*/_jsxDEV(\"div\", {\n        children: \"The collection of views containing this one, useful to activate multiple views at once.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 758,\n        columnNumber: 78\n      }, this)\n    };\n    this.display = void 0;\n    this.__info_of__display = {\n      obsolete: true,\n      isNode: true,\n      type: ShortAttribETypes.EString,\n      txt: 'complete css injection instead'\n    };\n    this.onDragStart = void 0;\n    this.__info_of__onDragStart = {\n      isNode: true,\n      type: \"Function():void\",\n      txt: 'Custom event activated when a node begins being dragged.'\n    };\n    this.onDragEnd = void 0;\n    this.__info_of__onDragEnd = {\n      isNode: true,\n      type: \"Function():void\",\n      txt: 'Custom event activated when a node finishes being dragged.'\n    };\n    this.whileDragging = void 0;\n    this.__info_of__whileDragging = {\n      isNode: true,\n      type: \"Function():void\",\n      txt: 'Custom event activated multiple times when mouse is moved while a node is being dragged.'\n    };\n    this.onResizeStart = void 0;\n    this.__info_of__onResizeStart = {\n      isNode: true,\n      type: \"Function():void\",\n      txt: 'Custom event activated when a node begins being resized.'\n    };\n    this.onResizeEnd = void 0;\n    this.__info_of__onResizeEnd = {\n      isNode: true,\n      type: \"Function():void\",\n      txt: 'Custom event activated when a node finishes being resized.'\n    };\n    this.whileResizing = void 0;\n    this.__info_of__whileResizing = {\n      isNode: true,\n      type: \"Function():void\",\n      txt: 'Custom event activated multiple times when mouse is moved while a node is being resized.'\n    };\n    this.onRotationStart = void 0;\n    this.__info_of__onRotationStart = {\n      isNode: true,\n      type: \"Function():void\",\n      txt: 'Custom event activated when a node begins being rotated.'\n    };\n    this.onRotationEnd = void 0;\n    this.__info_of__onRotationEnd = {\n      isNode: true,\n      type: \"Function():void\",\n      txt: 'Custom event activated when a node finishes being rotated.'\n    };\n    this.whileRotating = void 0;\n    this.__info_of__whileRotating = {\n      isNode: true,\n      type: \"Function():void\",\n      txt: 'Custom event activated multiple times when mouse is moved while a node is being rotated.'\n    };\n    this.onDataUpdate = void 0;\n    this.__info_of__onDataUpdate = {\n      isNode: true,\n      type: \"Function():void\",\n      txt: 'Custom event activated every time a property of his model, node or view is changed while the element is visibly rendered in a graph.\\n<br>Caution! this might cause loops.'\n    };\n    this.events = void 0;\n    this.event = void 0;\n    this.__info_of__events = {\n      todo: true,\n      isGlobal: true,\n      type: \"Dictionary<name, function>\",\n      txt: /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [\"Custom events callable through JSX user interaction\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 907,\n          columnNumber: 70\n        }, this), \"eg: <div onClick={()=>view.eventname()} />\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 907,\n        columnNumber: 14\n      }, this)\n    };\n    this.__info_of__event = {\n      todo: true,\n      isGlobal: true,\n      type: \"Dictionary<name, function>\",\n      txt: 'Alias for this.events'\n    };\n    this.constraints = void 0;\n    this.__info_of__constraints = {\n      todo: true,\n      isNode: true,\n      type: \"Function():void\",\n      txt: 'not supported yet'\n    };\n    this.bendingMode = void 0;\n    this.__info_of__bendingMode = {\n      isEdge: true,\n      enum: EdgeBendingMode,\n      type: '\"L\" | \"Q\" | \"C\" | \"T\" | \"S\" | \"A\" | \"QT\" | \"CS\"',\n      label: \"path mode\",\n      txt: /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          children: \"How Svg path should use the EdgePoints to bend his shape\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 957,\n          columnNumber: 16\n        }, this)\n      }, void 0, false)\n    };\n    this.edgeGapMode = void 0;\n    this.__info_of__edgeGapMode = {\n      isEdge: true,\n      enum: EdgeGapMode,\n      type: '\"gap\" | \"average\" | \"autoFill\" | \"lineFill\" | \"arcFill\"',\n      label: \"gap mode\",\n      txt: /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [\"How the segment should treat the EdgePoint interruptions.\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 962,\n            columnNumber: 78\n          }, this), \"\\\"gap\\\" leaves an empty space to not overlap the EdgePoint,\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 963,\n            columnNumber: 13\n          }, this), \"\\\"linefill\\\" makes the edge stop at the EdgePoint borders, but then connects the gap with a line.\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 962,\n          columnNumber: 16\n        }, this)\n      }, void 0, false)\n    };\n    this.storeSize = void 0;\n    this.__info_of__storeSize = {\n      isNode: true,\n      type: ShortAttribETypes.EBoolean,\n      label: \"bind sizes to view\",\n      txt: \"Active: the node position depends from the view currently displayed.Inactive: it depends from the graph.\"\n    };\n    this.lazySizeUpdate = void 0;\n    this.__info_of__lazySizeUpdate = {\n      isNode: true,\n      type: ShortAttribETypes.EBoolean,\n      txt: /*#__PURE__*/_jsxDEV(\"div\", {\n        children: \"If true updates the node position only when the drag action is finished. (best performance)\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 975,\n        columnNumber: 93\n      }, this)\n    };\n    this.edgeStartOffset = void 0;\n    this.__info_of__edgeStartOffset = {\n      isEdge: true,\n      type: GraphPoint.cname,\n      label: \"start offset\",\n      txt: \"Location where outgoing edges should start their path, relative to top-upper corner of the element.\"\n    };\n    this.edgeEndOffset = void 0;\n    this.__info_of__edgeEndOffset = {\n      isEdge: true,\n      type: GraphPoint.cname,\n      label: \"end offset\",\n      txt: 'Same as this.edgeStartOffset'\n    };\n    this.edgeStartOffset_isPercentage = void 0;\n    this.__info_of__edgeStartOffset_isPercentage = {\n      isEdge: true,\n      type: ShortAttribETypes.EBoolean,\n      label: \"start offset is a %\",\n      txt: /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [\"Whether edgeStartOffset is an absolute value or a percentage.\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 988,\n          columnNumber: 80\n        }, this), \"(eg: 50% of element width, vs 50 pixels flat).\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 988,\n        columnNumber: 14\n      }, this)\n    };\n    this.edgeEndOffset_isPercentage = void 0;\n    this.__info_of__edgeEndOffset_isPercentage = {\n      isEdge: true,\n      type: ShortAttribETypes.EBoolean,\n      label: \"end offset is a %\",\n      txt: /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [\"Whether edgeStartOffset is an absolute value or a percentage.\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 992,\n          columnNumber: 80\n        }, this), \"(eg: 50% of element width, vs 50 pixels flat).\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 992,\n        columnNumber: 14\n      }, this)\n    };\n    this.edgeStartStopAtBoundaries = void 0;\n    this.__info_of__edgeStartStopAtBoundaries = {\n      isEdge: true,\n      type: ShortAttribETypes.EBoolean,\n      label: \"start cannot cross boundaries\",\n      txt: /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [\"Whether outgoing edges should cross the node boundaries overlapping the node\\\\'s html or stop at them.\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 997,\n          columnNumber: 120\n        }, this), \"Edge arrows might enter the node if this is on.\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 997,\n        columnNumber: 14\n      }, this)\n    };\n    this.edgeEndStopAtBoundaries = void 0;\n    this.__info_of__edgeEndStopAtBoundaries = {\n      isEdge: true,\n      type: ShortAttribETypes.EBoolean,\n      label: \"end cannot cross boundaries\",\n      txt: /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [\"Whether incoming edges should cross the node boundaries overlapping the node\\\\'s html or stop at them.\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1001,\n          columnNumber: 120\n        }, this), \"Edge arrows might enter the node if this is on.\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1001,\n        columnNumber: 14\n      }, this)\n    };\n    this.edgePointCoordMode = void 0;\n    this.__info_of__edgePointCoordMode = {\n      isEdgePoint: true,\n      type: \"CoordinateMode\",\n      enum: CoordinateMode,\n      label: \"coordinate mode\",\n      txt: /*#__PURE__*/_jsxDEV(\"div\", {\n        children: \"Store coordinates as absolute coordinates or relative to start/end nodes.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1006,\n        columnNumber: 13\n      }, this)\n    };\n    this.edgeHeadSize = void 0;\n    this.__info_of__edgeHeadSize = {\n      isEdge: true,\n      type: GraphPoint.cname,\n      label: \"head decorator size\",\n      txt: /*#__PURE__*/_jsxDEV(\"div\", {\n        children: \"Size of the edge head decorator if present.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1025,\n        columnNumber: 108\n      }, this)\n    };\n    this.edgeTailSize = void 0;\n    this.__info_of__edgeTailSize = {\n      isEdge: true,\n      type: GraphPoint.cname,\n      label: \"tail decorator size\",\n      txt: /*#__PURE__*/_jsxDEV(\"div\", {\n        children: \"Size of the tail head decorator if present.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1028,\n        columnNumber: 108\n      }, this)\n    };\n    this.size = void 0;\n    this.__info_of__size = {\n      isNode: true,\n      hidden: true,\n      type: ShortAttribETypes.EInt,\n      txt: /*#__PURE__*/_jsxDEV(\"div\", {\n        children: \"Do not use directly, contains all the sizes stored in this view. use getSize, updateSize instead.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1032,\n        columnNumber: 13\n      }, this)\n    };\n    this.__info_of__updateSize = {\n      isNode: true,\n      hidden: true,\n      type: \"Function(Pointer<GraphElement | ModelElement>, GraphSize) => GraphSize\",\n      txt: /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [\"Updates the size stored in this view for target element.\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1036,\n          columnNumber: 74\n        }, this), \"@returns: the delta of the change between old value and new value.\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1036,\n        columnNumber: 13\n      }, this)\n    };\n    this.__info_of__getSize = {\n      isNode: true,\n      hidden: true,\n      type: \"Function(Pointer<GraphElement | ModelElement>) => GraphSize\",\n      txt: /*#__PURE__*/_jsxDEV(\"div\", {\n        children: \"Gets the size stored in this view for target element.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1038,\n        columnNumber: 13\n      }, this)\n    };\n  } // MixOnlyFuncs(DViewElement, LPointerTargetable)\n  // static singleton: LViewElement;\n  // static logic: typeof LViewElement;\n  // static structure: typeof DViewElement;\n  // inherited redefine\n  // own properties\n  // only for root views (ex viewpoints) to group views semantically.\n  get_isOverlay(c) {\n    return this.get_isExclusiveView(c);\n  }\n  set_isOverlay(val, c) {\n    return this.set_isExclusiveView(val, c);\n  }\n\n  // priority of the view, if a node have multiple applicable views, the view with highest priority is applied.\n\n  get_explicitApplicationPriority(c) {\n    var _c$data$jsCondition, _c$data$oclCondition;\n    if (c.data.explicitApplicationPriority !== undefined) return c.data.explicitApplicationPriority;else return (((_c$data$jsCondition = c.data.jsCondition) === null || _c$data$jsCondition === void 0 ? void 0 : _c$data$jsCondition.length) || 1) + (((_c$data$oclCondition = c.data.oclCondition) === null || _c$data$oclCondition === void 0 ? void 0 : _c$data$oclCondition.length) || 1);\n  }\n  set_explicitApplicationPriority(val, c) {\n    SetFieldAction.new(c.data, \"explicitApplicationPriority\", val, '', false);\n    return true;\n  }\n  get_isExclusiveView(c) {\n    return c.data.isExclusiveView;\n  }\n  set_isExclusiveView(val, c) {\n    if (Defaults.check(c.data.id)) return true; // cannot delete or \"demote\" to decorations the main views, to make sure there is always at least 1 appliable view.\n    return SetFieldAction.new(c.data, \"isExclusiveView\", !!val, '', false);\n  }\n\n  // Example 1: <code>{'{color:\"red\", background: \"gray\"}'}</code><br/>\n  // Example 2: <code>{'function(){\\n    let fib = [1,1]; for (let i = 2; i < 100) { fib[i] = fib[i-2]+fib[i-1]; }\\n    return fib; }'}</code><br/>\n  // evalutate tutte le volte che l'elemento viene aggiornato (il model o la view cambia)\n  _defaultGetter(c, k) {\n    return this.__defaultGetter(c, k);\n  }\n  _defaultSetter(v, c, k) {\n    return this.__defaultSetter(v, c, k);\n  }\n  get_jsxString(context) {\n    return context.data.jsxString;\n  }\n  set_jsxString(val, context) {\n    TRANSACTION(() => {\n      // const jsx = DSL.parser(val);\n      SetFieldAction.new(context.data, 'jsxString', val, '', false);\n      SetRootFieldAction.new('VIEWS_RECOMPILE_jsxString', context.data.id, '+=', false);\n    });\n    return true;\n  }\n  get_usageDeclarations(c) {\n    return c.data.usageDeclarations || \"(ret)=>{ // scope contains: data, node, view, constants, state\\n\" + \"// ** preparations and default behaviour here ** //\\n\" + \"ret.data = data\\n\" + \"ret.node = node\\n\" + \"ret.view = view\\n\" + \"// data, node, view are dependencies by default. delete them above if you want to remove them.\\n\" +\n    // if you want your node re-rendered every time, add a dependency to ret.state = state; or ret.update = Math.random();\n    \"// add preparation code here (like for loops to count something), then list the dependencies below.\\n\" + \"// ** declarations here ** //\\n\" + \"}\";\n  }\n  set_usageDeclarations(val, context) {\n    TRANSACTION(() => {\n      SetFieldAction.new(context.data, 'usageDeclarations', val, '', false);\n      SetRootFieldAction.new('VIEWS_RECOMPILE_usageDeclarations', context.data.id, '+=', false);\n    });\n    return true;\n  }\n\n  // format should be array of (usedPaths: string[]) starting with \"data.\" AUTOMATICALLY inefered from the ocl editor.\n\n  get_oclUpdateCondition(c) {\n    return transientProperties.view[c.data.id].oclUpdateCondition_PARSED;\n  }\n  set_oclUpdateCondition(val, c) {\n    TRANSACTION(() => {\n      SetFieldAction.new(c.data, \"oclUpdateCondition\", val || '', '', false);\n      // not recalculated right now because the change needs to be sent to collaborative editor users\n      // it is pointer, but i don't want to set pointedby's, it is very short lived.\n      SetRootFieldAction.new(\"OCL_UPDATE_NEEDS_RECALCULATION\", c.data.id, '+=', false);\n    });\n    return true;\n  }\n  /* moved it as setrootfield action and as array. check it after every reducer. update im same style the color palette too?\r\n      OCL_NEEDS_RECALCULATION!: boolean;\r\n      __info_of__OCL_NEEDS_RECALCULATION: Info = {hidden: true, type: ShortAttribETypes.EBoolean,\r\n          txt: \"if only the oclCondition needs to be reapplied to all model elements\"}\r\n      get_OCL_NEEDS_RECALCULATION(c: Context): this[\"OCL_NEEDS_RECALCULATION\"] { return c.data.OCL_NEEDS_RECALCULATION; }\r\n      set_OCL_NEEDS_RECALCULATION(val: this[\"OCL_NEEDS_RECALCULATION\"], c: Context): boolean { return this.cannotSet('OCL_NEEDS_RECALCULATION'); }\r\n  \r\n      OCL_UPDATE_NEEDS_RECALCULATION!: boolean;\r\n      __info_of__OCL_UPDATE_NEEDS_RECALCULATION: Info = {hidden: true, type: ShortAttribETypes.EBoolean,\r\n          txt: \"if both ocl needsto be reapplied and the oclUpdateCondition -> transient.view[v.id].oclUpdateCondition_PARSED needs to be remade\"}\r\n      get_OCL_UPDATE_NEEDS_RECALCULATION(c: Context): this[\"OCL_UPDATE_NEEDS_RECALCULATION\"] { return c.data.OCL_UPDATE_NEEDS_RECALCULATION; }\r\n      set_OCL_UPDATE_NEEDS_RECALCULATION(val: this[\"OCL_UPDATE_NEEDS_RECALCULATION\"], c: Context): boolean { return this.cannotSet('OCL_UPDATE_NEEDS_RECALCULATION'); }*/\n\n  get_cssIsGlobal(c) {\n    return c.data.cssIsGlobal;\n  }\n  set_cssIsGlobal(val, c) {\n    TRANSACTION(() => {\n      SetFieldAction.new(c.data, \"cssIsGlobal\", !!val, '', false);\n      // compile only when accessed, to prevent color inputs to do a mess of compilations\n      SetFieldAction.new(c.data, \"css_MUST_RECOMPILE\", true, '', false);\n    });\n    return true;\n  }\n  get_css(c) {\n    return c.data.css;\n  }\n  set_css(val, c) {\n    TRANSACTION(() => {\n      SetFieldAction.new(c.data, \"css\", val, '', false);\n      // compile only when accessed, to prevent color inputs to do a mess of compilations\n      SetFieldAction.new(c.data, \"css_MUST_RECOMPILE\", true, '', false);\n    });\n    return true;\n  }\n  get_compiled_css(c) {\n    if (!c.data.css_MUST_RECOMPILE) return c.data.compiled_css; // return c.proxyObject.r.__raw.compiled_css;\n    let s = '';\n    const allowLESS = false;\n    let shortPaletteName;\n    let cc = c;\n    function rgbastring(c) {\n      Log.exDev(!c, \"invalid color:\", {\n        id: cc.data.id,\n        c,\n        shortPaletteName,\n        p: cc.data.palette\n      });\n      return \"rgba(\" + c.r + \",\" + c.g + \",\" + c.b + \",\" + c.a + \")\";\n    }\n    //let palettes = U.paletteSplit(c.data.palette);\n    for (let paletteName in c.data.palette) {\n      let palette0 = c.data.palette[paletteName];\n      if (palette0.type === \"color\") {\n        let palette = palette0;\n        let colors = palette.value;\n        if (!colors.length) continue;\n        if (['-', '_'].includes(paletteName[paletteName.length - 1])) shortPaletteName = paletteName.substring(0, paletteName.length - 1);else shortPaletteName = paletteName;\n        let rgba = rgbastring(colors[0]);\n        // set prefixed name without number\n        if (allowLESS) s += \"\\t@\" + shortPaletteName + \": \" + rgba + ';\\n';\n        s += \"\\t--\" + shortPaletteName + \": \" + rgba + ';\\n';\n        // set prefixed-0 name\n        if (allowLESS) s += \"\\t@\" + paletteName + '0: ' + rgba + ';\\n';\n        s += \"\\t--\" + paletteName + '0: ' + rgba + ';\\n';\n        // set prefixed-1 to prefixed-...n names\n        for (let i = 0; i < colors.length; i++) {\n          rgba = rgbastring(colors[i]);\n          if (allowLESS) s += \"\\t@\" + paletteName + (i + 1) + \": \" + rgba + ';\\n';\n          s += \"\\t--\" + paletteName + (i + 1) + \": \" + rgba + ';\\n';\n        }\n      } else if (palette0.type === 'path') {\n        let palette = palette0;\n        let val = U.replaceAll(palette.value, 'view.', '');\n        val = U.replaceAll(val, 'this.', '');\n        val = U.replaceAll(val, 'x', palette.x);\n        val = U.replaceAll(val, 'y', palette.y);\n        val = U.replaceAll(val, '+', ' +');\n        val = U.replaceAll(val, '-', ' -'); // important: cannot add space post-dash or it's harder to distinguish unary and binary -\n        val = U.replaceAll(val, '/', ' / ');\n        val = U.replaceAll(val, '*', ' * ');\n        let valarr = val.split(/[,\\s]/);\n        // [] not allowed\n        valarr = valarr.map(val => {\n          if (!isNaN(+val)) return val;\n          let patharr = val.split('.');\n          let curr = c.data;\n          for (let pathseg of patharr) {\n            curr = curr[pathseg];\n            Log.e(!curr && (val.length > 1 || patharr.length > 1), \"invalid variable path in css path control\", {\n              token: val,\n              view: c.data.name\n            });\n            if (!curr) break;\n          }\n          if (typeof curr === \"object\" || typeof curr === \"undefined\" && (val.length > 1 || patharr.length > 1)) Log.ee(\"invalid variable path in css path control\", {\n            token: val,\n            view: c.data.name\n          });else val = curr || val;\n          return val;\n        }).filter(p => !!p);\n        for (let i = 0; i < valarr.length; i++) {\n          let val = valarr[i];\n          switch (val) {\n            // i avoid subtracting L 1 -1 with spaces. it's unary if doesn't have a postfix space.\n            default:\n              continue;\n            case '*':\n              valarr[i] = +valarr[i - 1] * +valarr[i + 1];\n              valarr[i - 1] = valarr[i + 1] = '';\n              break;\n            case '/':\n              valarr[i] = +valarr[i - 1] / +valarr[i + 1];\n              valarr[i - 1] = valarr[i + 1] = '';\n              break;\n            case '+':\n              valarr[i] = +valarr[i - 1] + +valarr[i + 1];\n              valarr[i - 1] = valarr[i + 1] = '';\n              break;\n            case '-':\n              valarr[i] = +valarr[i - 1] - +valarr[i + 1];\n              valarr[i - 1] = valarr[i + 1] = '';\n              break;\n          }\n        }\n        val = valarr.filter(p => !!p).join(' ');\n        val = \"'\" + val + \"'\";\n        if (allowLESS) s += \"\\t@\" + paletteName + \": \" + val + ';\\n';\n        s += \"\\t--\" + paletteName + ': ' + val + ';\\n';\n      } else {\n        // number or text\n        let palette = palette0;\n        let val = palette.value + (palette.unit || '');\n        if (!val) val = \"''\";\n        if (allowLESS) s += \"\\t@\" + paletteName + \": \" + val + ';\\n';\n        s += \"\\t--\" + paletteName + ': ' + val + ';\\n';\n      }\n    }\n    s += '\\n\\t' + U.replaceAll(c.data.css, '\\n', '\\n\\t');\n    const localViewSelector = '.' + c.data.id; // '[data-viewid=\"'+c.data.id+'\"]';\n    s = (!c.data.cssIsGlobal ? localViewSelector : 'body') + ' {\\n' + s + '\\n}';\n    // not an error, i'm updating directly d-view that is usually wrong, this is to prevent multiple nodes with same view to trigger compile and redux actions\n    // count as if it's a derived attribute not really part of the store.\n    c.data.css_MUST_RECOMPILE = false;\n    return c.data.compiled_css = s;\n  }\n  set_compiled_css(val, c) {\n    Log.exx(\"Do not use setter for this, set it directly in d-object, along with compiled_css.\" + \"\\nOtherwise multiple nodes of the same view will start compiling together.\\n\");\n    return false;\n  }\n  get_palette(c) {\n    return c.data.palette;\n  }\n  set_palette(val, c) {\n    TRANSACTION(() => {\n      SetFieldAction.new(c.data, \"palette\", val, '', false);\n      SetFieldAction.new(c.data, \"css_MUST_RECOMPILE\", true, '', false);\n    });\n    return true;\n  }\n\n  /*\r\n  scalezoomx!: boolean; // whether to resize the element normally using width-height or resize it using zoom-scale css\r\n  __info_of__scalezoomx: Info = {isNode: true, isEdge: false, isEdgePoint: false, txt:<div></div>}\r\n    scalezoomy!: boolean;\r\n  __info_of__scalezoomy: Info = {isNode: true, isEdge: false, isEdgePoint: false, txt:<div></div>}*/\n\n  // not persistent, some not shared. deve essere diverso da utente ad utente perchè dipende dal pan e zoom nel grafo dell'utente attuale.\n  // facendo pan su grafo html sposti gli elementi, per simulare uno spostamento del grafo e farlo sembrare illimitato.\n  // __transient: DViewTransientProperties;\n  // class names: DModel, DPackage, DAttribute...\n  get_SubViews(c) {\n    delete c.data.subViews.clonedCounter;\n    return Object.keys(c.data.subViews).map(vid => LPointerTargetable.fromPointer(vid));\n  }\n  set_SubViews(val, c) {\n    let subviewsmap;\n    if (Array.isArray(val)) {\n      let ptrsArr = Pointers.fromArr(val);\n      subviewsmap = U.objectFromArrayValues(ptrsArr, 1.5);\n    } else subviewsmap = val || {};\n    SetFieldAction.new(c.data, \"subViews\", subviewsmap, '', true);\n    return true;\n  }\n  // adds, updates or unsets (if boost = null) a subview with his score.\n  get_setSubViewScore(c) {\n    return function (subview) {\n      let boost = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1.5;\n      let subviews = {\n        ...c.data.subViews\n      };\n      let ptr = Pointers.from(subview);\n      if (boost !== null) {\n        // set mode\n        if (subviews[ptr] === boost) return;\n        subviews[ptr] = boost;\n      } else {\n        // set mode\n        if (subviews[ptr] === undefined) return;\n        delete subviews[ptr];\n      }\n      SetFieldAction.new(c.data, 'subViews', subviews, '', true);\n    };\n  }\n  get_allSubViews(c) {\n    delete c.data.subViews.clonedCounter;\n    let arr = Object.keys(c.data.subViews);\n    let nextarr = [];\n    let idmap = {};\n    let s = store.getState();\n    let dview;\n    while (arr.length) {\n      for (let vid of arr) {\n        if (idmap[vid]) continue;\n        dview = DPointerTargetable.fromPointer(vid, s);\n        if (!dview) continue;\n        idmap[vid] = dview;\n        U.arrayMergeInPlace(nextarr, Object.keys(dview.subViews));\n      }\n      arr = nextarr;\n      nextarr = [];\n    }\n    return LPointerTargetable.fromD(Object.values(idmap));\n  }\n  set_allSubViews(val, c) {\n    return this.wrongAccessMessage(\"cannot call set_allSubViews, it is a derived attribute\");\n  }\n\n  // ocl selector\n\n  get_oclCondition(context) {\n    return context.data.oclCondition;\n  }\n  set_oclCondition(val, context) {\n    val = (val || '').trim();\n    if (val === context.data.oclCondition) return true;\n    TRANSACTION(() => {\n      SetFieldAction.new(context.data, 'oclCondition', val, '', false);\n      SetRootFieldAction.new('VIEWS_RECOMPILE_ocl', context.data.id, '+=', false); // it is pointer, but for transient stuff there is no need to set pointedby's\n    });\n\n    return true;\n  }\n\n  // js selector\n\n  get_jsCondition(context) {\n    return context.data.jsCondition;\n  }\n  set_jsCondition(val, context) {\n    val = (val || '').trim();\n    if (val === context.data.jsCondition) return true;\n    TRANSACTION(() => {\n      SetFieldAction.new(context.data, 'jsCondition', val, '', false);\n      SetRootFieldAction.new('VIEWS_RECOMPILE_jsCondition', context.data.id, '+=', false);\n    });\n    return true;\n  }\n\n  // todo: how about allowing a view to be part in multiple vp's? so this reference would be an array or removed, and you navigate only from vp to v.\n\n  get_onDragStart(context) {\n    return context.data.onDragStart;\n  }\n  set_onDragStart(val, context) {\n    TRANSACTION(() => {\n      SetFieldAction.new(context.data, 'onDragStart', val, '', false);\n      SetRootFieldAction.new('VIEWS_RECOMPILE_onDragStart', context.data.id, '+=', false);\n    });\n    return true;\n  }\n  get_onDragEnd(context) {\n    return context.data.onDragEnd;\n  }\n  set_onDragEnd(val, context) {\n    TRANSACTION(() => {\n      SetFieldAction.new(context.data, 'onDragEnd', val, '', false);\n      SetRootFieldAction.new('VIEWS_RECOMPILE_onDragEnd', context.data.id, '+=', false);\n    });\n    return true;\n  }\n  get_whileDragging(context) {\n    return context.data.whileDragging;\n  }\n  set_whileDragging(val, context) {\n    TRANSACTION(() => {\n      SetFieldAction.new(context.data, 'whileDragging', val, '', false);\n      SetRootFieldAction.new('VIEWS_RECOMPILE_whileDragging', context.data.id, '+=', false);\n    });\n    return true;\n  }\n  get_onResizeStart(context) {\n    return context.data.onResizeStart;\n  }\n  set_onResizeStart(val, context) {\n    TRANSACTION(() => {\n      SetFieldAction.new(context.data, 'onResizeStart', val, '', false);\n      SetRootFieldAction.new('VIEWS_RECOMPILE_onResizeStart', context.data.id, '+=', false);\n    });\n    return true;\n  }\n  get_onResizeEnd(context) {\n    return context.data.onResizeEnd;\n  }\n  set_onResizeEnd(val, context) {\n    TRANSACTION(() => {\n      SetFieldAction.new(context.data, 'onResizeEnd', val, '', false);\n      SetRootFieldAction.new('VIEWS_RECOMPILE_onResizeEnd', context.data.id, '+=', false);\n    });\n    return true;\n  }\n  get_whileResizing(context) {\n    return context.data.whileResizing;\n  }\n  set_whileResizing(val, context) {\n    TRANSACTION(() => {\n      SetFieldAction.new(context.data, 'whileResizing', val, '', false);\n      SetRootFieldAction.new('VIEWS_RECOMPILE_whileResizing', context.data.id, '+=', false);\n    });\n    return true;\n  }\n  get_onRotationStart(context) {\n    return context.data.onRotationStart;\n  }\n  set_onRotationStart(val, context) {\n    TRANSACTION(() => {\n      SetFieldAction.new(context.data, 'onRotationStart', val, '', false);\n      SetRootFieldAction.new('VIEWS_RECOMPILE_onRotationStart', context.data.id, '+=', false);\n    });\n    return true;\n  }\n  get_onRotationEnd(context) {\n    return context.data.onRotationEnd;\n  }\n  set_onRotationEnd(val, context) {\n    TRANSACTION(() => {\n      SetFieldAction.new(context.data, 'onRotationEnd', val, '', false);\n      SetRootFieldAction.new('VIEWS_RECOMPILE_onRotationEnd', context.data.id, '+=', false);\n    });\n    return true;\n  }\n  get_whileRotating(context) {\n    return context.data.whileRotating;\n  }\n  set_whileRotating(val, context) {\n    TRANSACTION(() => {\n      SetFieldAction.new(context.data, 'whileRotating', val, '', false);\n      SetRootFieldAction.new('VIEWS_RECOMPILE_whileRotating', context.data.id, '+=', false);\n    });\n    return true;\n  }\n  get_onDataUpdate(context) {\n    return context.data.onDataUpdate;\n  }\n  set_onDataUpdate(val, context) {\n    TRANSACTION(() => {\n      SetFieldAction.new(context.data, 'onDataUpdate', val, '', false);\n      SetRootFieldAction.new('VIEWS_RECOMPILE_onDataUpdate', context.data.id, '+=', false);\n    });\n    return true;\n  }\n  get_event(c) {\n    return this.get_events(c);\n  }\n  get_events(c) {\n    Log.exx(\"use node.events instead\", U.getStackTrace());\n    return {};\n    // return transientProperties.view[c.data.id]?.events || {};\n  }\n\n  set_events(val, context) {\n    const addUD = true;\n    TRANSACTION(() => {\n      SetFieldAction.new(context.data, 'events', val, '+=', false);\n      SetRootFieldAction.new('VIEWS_RECOMPILE_events', {\n        vid: context.data.id,\n        keys: Object.keys(val)\n      }, '+=', false);\n      let udstr = context.data.usageDeclarations;\n      if (!addUD || !udstr) return;\n      let delta = U.objectDelta(context.data.events, val, false);\n      for (let key in delta) {\n        let v = val[key];\n        let autogenstr = 'ret.' + key + ' = node.events.' + key + '; // @autogenerated, do not edit\\n';\n        if (!v) udstr = udstr.split(autogenstr).join('');else {\n          if (!context.data.events[key]) {\n            // insert\n            let findstr = '// ** declarations here ** //\\n';\n            let insertat = udstr.indexOf(findstr);\n            if (insertat === -1) continue; // malformed ud, will skip\n            insertat += findstr.length;\n            udstr = udstr.substring(0, insertat) + autogenstr + udstr.substring(insertat);\n          } else {\n            // just updated func body, no name changed, no need to update UD.\n          }\n        }\n      }\n      if (udstr === context.data.usageDeclarations) return;\n      SetFieldAction.new(context.data, 'usageDeclarations', udstr, '', false);\n      SetRootFieldAction.new('VIEWS_RECOMPILE_usageDeclarations', context.data.id, '+=', false);\n    });\n    return true;\n  }\n\n  /*\r\n  bindVertexSizeToView!: boolean;\r\n  __info_of__bindVertexSizeToView: Info = {isNode:true, type:ShortAttribETypes.EBoolean, label:\"bind sizes to view\",\r\n      txt: <div>Store the vertex size inside the view instead of inside the vertex.\r\n          <br/>This causes the vertex to have different positions according to the view currently appied to it.</div>}*/\n\n  set_edgePointCoordMode(val, c) {\n    TRANSACTION(() => {\n      setTimeout(() => {\n        // needs to be done after coordinatemode change is applied\n        let s = store.getState();\n        for (let nid in transientProperties.node) {\n          var _tn$mainView;\n          let tn = transientProperties.node[nid];\n          if (!tn || ((_tn$mainView = tn.mainView) === null || _tn$mainView === void 0 ? void 0 : _tn$mainView.id) !== c.data.id) continue;\n          let lnode = LPointerTargetable.fromPointer(nid, s);\n          let triggerCoordinateModeChange = lnode;\n          triggerCoordinateModeChange.size = lnode.size;\n        }\n      }, 100);\n      SetFieldAction.new(c.data, 'edgePointCoordMode', val, '', false);\n    });\n    return true;\n  }\n\n  // use getSize, updateSize;\n\n  // public _parsedConstants!: GObject;\n  // public get__parsedConstants(c: Context): this['_parsedConstants'] { return c.data._parsedConstants || {}; }\n  get_constants(c) {\n    return c.data.constants;\n  }\n  static parseConstants(funcCode) {\n    if (!funcCode) return {};\n    let parsedConstants = {};\n    let context = {\n      __param: parsedConstants\n    };\n    context.__proto__ = windoww.defaultContext;\n    try {\n      let parsedFunc = U.parseFunctionWithContextAndScope(funcCode, context, context, ['ret']);\n      parsedFunc(context, parsedConstants);\n      // U.evalInContextAndScopeNew( \"(\"+funcCode+\")(this.__param)\", context, true, false, false);\n    } catch (e) {\n      Log.ee(\"Attempted to save an invalid view.constant setup. Cause:\\n\" + e.message.split(\"\\n\")[0], e);\n      return undefined;\n    }\n    return parsedConstants;\n  }\n  set_constants(value, c) {\n    if (value === c.data.constants) return true;\n    TRANSACTION(() => {\n      SetFieldAction.new(c.data.id, 'constants', value, '', false);\n      SetRootFieldAction.new('VIEWS_RECOMPILE_constants', c.data.id, '+=', false);\n      SetFieldAction.new(c.data.id, \"css_MUST_RECOMPILE\", true, '', false);\n    });\n    return true;\n  }\n  get_preRenderFunc(c) {\n    return c.data.preRenderFunc;\n  }\n  set_preRenderFunc(value, c) {\n    const _value = value ? value : '() => {}';\n    return SetFieldAction.new(c.data.id, 'preRenderFunc', _value, '', false);\n  }\n  get_edgeHeadSize(c) {\n    return new GraphPoint(c.data.edgeHeadSize.x, c.data.edgeHeadSize.y);\n  }\n  get_edgeTailSize(c) {\n    return new GraphPoint(c.data.edgeTailSize.x, c.data.edgeTailSize.y);\n  }\n  set_edgeHeadSize(v, c) {\n    let s = c.data.edgeHeadSize || new GraphPoint(0, 0);\n    if (!(\"x\" in v)) v.x = s.x;\n    if (!(\"y\" in v)) v.y = s.y;\n    TRANSACTION(() => {\n      SetFieldAction.new(c.data.id, \"css_MUST_RECOMPILE\", true, '', false);\n      SetFieldAction.new(c.data.id, \"edgeHeadSize\", v, '', false);\n    });\n    return true;\n  }\n  set_edgeTailSize(v, c) {\n    let s = c.data.edgeTailSize || new GraphPoint(0, 0);\n    if (!(\"x\" in v)) v.x = s.x;\n    if (!(\"y\" in v)) v.y = s.y;\n    TRANSACTION(() => {\n      SetFieldAction.new(c.data.id, \"css_MUST_RECOMPILE\", true, '', false);\n      SetFieldAction.new(c.data.id, \"edgeTailSize\", v, '', false);\n    });\n    return true;\n  }\n  get_viewpoint(context) {\n    return LViewPoint.fromPointer(context.data.viewpoint);\n  }\n  // public set_subViews(v: Pointer<DViewPoint>[], context: Context): boolean { return this.cannotSet('subViews, call set_viewpoint on the sub-elements instead.'); }\n\n  // WARNING!! if there are mass vp assignments, preserveOrder=true will cause a vp to \"lose\" subviews and keep only the last assigned.\n  set_viewpoint(v, context, manualDview) {\n    let preserveOrder = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;\n    let ret = false;\n    let vpid = v && Pointers.from(v);\n    const data = manualDview || context.data;\n    let id = data.id;\n    let oldvpid = data.viewpoint;\n    if (vpid === oldvpid) return true;\n    TRANSACTION(() => {\n      ret = SetFieldAction.new(id, \"viewpoint\", vpid, '', true);\n      if (oldvpid) {\n        let subViews = {\n          ...DPointerTargetable.fromPointer(oldvpid).subViews\n        };\n        delete subViews[id];\n        SetFieldAction.new(oldvpid, \"subViews\", subViews, '', true);\n      }\n      if (vpid) {\n        let name = data.name;\n        let copyPos = name.indexOf(\"Copy\");\n        let oldSubViews = DPointerTargetable.fromPointer(vpid).subViews;\n        let insertBefore = '';\n        let subViews = {};\n        if (copyPos) {\n          let copiedFromName = copyPos ? name.substring(0, copyPos).trim() : '';\n          if (copiedFromName in oldSubViews) insertBefore = copiedFromName;else {\n            for (let key in oldSubViews) if (key.indexOf(copiedFromName) === 0) {\n              insertBefore = key;\n              break;\n            }\n          }\n        }\n\n        // WARNING!! if there are mass vp assignments, this will cause a vp to \"lose\" subviews and keep only the last assigned.\n        if (preserveOrder && insertBefore) {\n          subViews = {};\n          for (let key in oldSubViews) {\n            subViews[key] = oldSubViews[key];\n            // just to reinsert subviews **in order** so Object.keys() fits the new subview near the cloned one.\n            if (key === insertBefore) subViews[id] = subViews[insertBefore];\n          }\n        } else {\n          subViews = {\n            ...oldSubViews\n          };\n          subViews[id] = 1.5;\n        }\n        subViews[id] = insertBefore ? subViews[insertBefore] : 1.5;\n        SetFieldAction.new(vpid, \"subViews\", subViews, '+=', true);\n      }\n    });\n    return ret;\n  }\n  get_subViews(context, key) {\n    let subViewsPointers = context.data.subViews;\n    let subViews = [];\n    for (let pointer in subViewsPointers) {\n      let item = MyProxyHandler.wrap(pointer);\n      if (item !== undefined) subViews.push(item);\n    }\n    return subViews;\n  }\n\n  // returns the delta of change\n  updateSize(id, size) {\n    return this.wrongAccessMessage(\"updateSize\");\n  }\n  get_updateSize(context) {\n    return (id, size0) => {\n      let size = size0;\n      let vp = context.proxyObject.viewpoint;\n      if (!context.data.storeSize) {\n        if (vp === null || vp === void 0 ? void 0 : vp.storeSize) return vp.updateSize(id, size);\n        return false;\n      }\n      let vsize = context.data.size[id] || (vp === null || vp === void 0 ? void 0 : vp.__raw.size[id]);\n      let newSize = new GraphSize();\n      if (size.currentCoordType === vsize.currentCoordType) {\n        // if samecoord system mix them.\n        newSize.x = (size === null || size === void 0 ? void 0 : size.x) !== undefined ? size.x : vsize.x;\n        newSize.y = (size === null || size === void 0 ? void 0 : size.y) !== undefined ? size.y : vsize.y;\n      } else if (size.x !== undefined && size.y !== undefined) {\n        // if different coord system pick all of size\n        newSize.x = size.x;\n        newSize.y = size.y;\n        newSize.currentCoordType = size.currentCoordType || CoordinateMode.absolute;\n      } else if (vsize.x !== undefined && vsize.y !== undefined) {\n        // or all of vsize if size was invalid\n        newSize.x = vsize.x;\n        newSize.y = vsize.y;\n        newSize.currentCoordType = vsize.currentCoordType || CoordinateMode.absolute;\n      }\n      let defaultsize = context.data.defaultVSize || (vp === null || vp === void 0 ? void 0 : vp.__raw.defaultVSize);\n      if (newSize.x === undefined || newSize.y === undefined) {\n        // only if pos is invalid, i take defaultvsize and force to use coord absolute.\n        newSize = new GraphSize().clone(defaultsize);\n        newSize.currentCoordType = CoordinateMode.absolute;\n      }\n      // w and h are always absolute so they can be mixed to whathever coordinate mode indipendently from the rest.\n      newSize.w = (size === null || size === void 0 ? void 0 : size.w) !== undefined ? size.w : vsize.w;\n      newSize.h = (size === null || size === void 0 ? void 0 : size.h) !== undefined ? size.h : vsize.h;\n      if (newSize.h === undefined) newSize.h = defaultsize.h || 10;\n      if (newSize.w === undefined) newSize.w = defaultsize.w || 10;\n      if (!newSize.equals(vsize)) SetFieldAction.new(context.data.id, \"size.\" + id, newSize);\n      return true;\n    };\n  }\n  get_defaultVSize(context) {\n    return context.data.defaultVSize;\n  }\n  getSize(id) {\n    return this.wrongAccessMessage(\"getSize\");\n  }\n  get_getSize(context) {\n    function impl_getSize(id) {\n      if (typeof id === \"object\") id = id.id;\n      let view = context.data;\n      let ret;\n      if (view.storeSize) {\n        ret = view.size[id];\n        if (ret) return ret;\n      }\n      let vp = context.proxyObject.viewpoint;\n      if (vp && view.id !== vp.id && vp.storeSize) {\n        ret = vp.size[id];\n        if (ret) return ret;\n      }\n      return undefined;\n    }\n    return impl_getSize;\n  }\n  set_generic_entry(context, key, val) {\n    console.log('set_generic_entry', {\n      context,\n      key,\n      val\n    });\n    SetFieldAction.new(context.data, key, val);\n    return true;\n  }\n  get_children(context) {\n    return [];\n  }\n  get_lazySizeUpdate(context) {\n    return Debug.lightMode || context.data.lazySizeUpdate;\n  }\n  set_lazySizeUpdate(val, context) {\n    return Debug.lightMode || this.set_generic_entry(context, 'lazySizeUpdate', val);\n  }\n  get_bendingMode(context) {\n    return context.data.bendingMode;\n  }\n  set_bendingMode(val, context) {\n    return this.set_generic_entry(context, 'bendingMode', val);\n  }\n  set_appliableTo(val, c) {\n    // appliableTo >= forcenodetype\n    if (!val) val = 'Any';\n    let forceNodeType = c.data.forceNodeType;\n    if (forceNodeType !== val) switch (val) {\n      // case \"Any\": break;\n      default:\n        forceNodeType = val;\n    }\n    console.log(\"set_appliableTo\", {\n      forceNodeType,\n      val\n    });\n    BEGIN();\n    if (forceNodeType !== c.data.forceNodeType) SetFieldAction.new(c.data, \"forceNodeType\", forceNodeType, '', false);\n    SetFieldAction.new(c.data, \"appliableTo\", val, '', false);\n    END();\n    return true;\n  }\n  set_forceNodeType(val, c) {\n    if (!val) val = 'Any';\n    /*let appliableTo: string = c.data.appliableTo as string;\r\n    if (appliableTo !== val) switch (appliableTo){\r\n        case undefined: case 'Any': break;\r\n        //case 'GraphVertex': if ((appliableTo as any) !== 'Graph' && (appliableTo as any) !== 'Vertex') appliableTo = val; break;\r\n        default: appliableTo = val; break;\r\n    }*/\n    BEGIN();\n    // if (appliableTo !== c.data.appliableTo) SetFieldAction.new(c.data, \"appliableTo\", appliableTo, '', false);\n    SetFieldAction.new(c.data, \"forceNodeType\", val, '', false);\n    END();\n    return true;\n  }\n  get_appliableToClasses(context) {\n    return context.data.appliableToClasses || [];\n  }\n  set_appliableToClasses(val, context) {\n    var _context$data$appliab;\n    if (!val) val = [];else if (!Array.isArray(val)) val = [val];\n    val.sort();\n    let hasChanged;\n    if (val.length === ((_context$data$appliab = context.data.appliableToClasses) === null || _context$data$appliab === void 0 ? void 0 : _context$data$appliab.length)) {\n      hasChanged = false;\n      for (let i = 0; i < val.length; i++) if (val[i] !== context.data.appliableToClasses[i]) {\n        hasChanged = true;\n        break;\n      }\n    } else hasChanged = true;\n    if (!hasChanged) return true;\n    TRANSACTION(() => {\n      this.set_generic_entry(context, \"appliableToClasses\", val);\n      SetRootFieldAction.new('VIEWS_RECOMPILE_preconditions', context.data.id, '+=', false);\n    });\n    return true;\n  }\n  set_defaultVSize(val, c) {\n    var _val$x, _val$y, _val$w, _val$h;\n    if (!val || typeof val !== \"object\") return true;\n    let x = (_val$x = val.x) !== null && _val$x !== void 0 ? _val$x : +val.x;\n    let y = (_val$y = val.y) !== null && _val$y !== void 0 ? _val$y : +val.y;\n    let w = (_val$w = val.w) !== null && _val$w !== void 0 ? _val$w : +val.w;\n    let h = (_val$h = val.h) !== null && _val$h !== void 0 ? _val$h : +val.h;\n    if (isNaN(x)) x = c.data.defaultVSize.x;\n    if (isNaN(y)) y = c.data.defaultVSize.y;\n    if (isNaN(w)) w = c.data.defaultVSize.w;\n    if (isNaN(h)) h = c.data.defaultVSize.h;\n    if (x === c.data.defaultVSize.x && y === c.data.defaultVSize.y && w === c.data.defaultVSize.w && h === c.data.defaultVSize.h) return true;\n    SetFieldAction.new(c.data, 'defaultVSize', {\n      x,\n      y,\n      w,\n      h\n    }, '', false);\n    return true;\n  }\n  duplicate() {\n    let deep = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;\n    let new_vp = arguments.length > 1 ? arguments[1] : undefined;\n    return this.wrongAccessMessage(this.constructor.cname + \"duplicate()\");\n  }\n  get_duplicate(c) {\n    var _this = this;\n    return function () {\n      let deep = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n      let new_vp0 = arguments.length > 1 ? arguments[1] : undefined;\n      console.log(\"DViewelement.duplicate\", {\n        cn: c.data.className,\n        n: c.data.name,\n        deep,\n        new_vp0\n      });\n      let lview = undefined;\n      let state = store.getState();\n      TRANSACTION(() => {\n        let pvid = c.data.viewpoint;\n        const dclone = c.data.className === 'DViewPoint' ? DViewPoint.new2(`${c.data.name} Copy`, '', undefined, true) : DViewElement.new2(`${c.data.name} Copy`, '', undefined, true, 'skip');\n        lview = LPointerTargetable.fromD(dclone);\n        const new_vp = new_vp0 || {\n          pvid\n        };\n        // || {pvid,  score: (DPointerTargetable.from(pvid, state) as DViewElement).subViews[c.data.id]}\n\n        for (let key in c.data) {\n          switch (key) {\n            case 'subViews':\n              // duplicate childrens only if deep\n              if (!deep) break;\n              // let subviews: Dictionary<Pointer, number> = {}\n              for (const oldvid in c.data.subViews) {\n                const oldScore = c.data.subViews[oldvid];\n                LPointerTargetable.fromPointer(oldvid, state).duplicate(deep, {\n                  pvid: dclone.id /*, score:oldScore*/\n                });\n                // then everything is set inside case 'viewpoint' of subviews cloning\n              }\n              //lview.subViews = subviews as any;\n              break;\n            case 'father':\n            case 'viewpoint':\n              // update parent view\n              /*\r\n              let subviews: Dictionary<Pointer, number> = {};\r\n              subviews[dclone.id] = new_vp.score;\r\n              SetFieldAction.new(new_vp.pvid, 'subViews', subviews, '+=', true);\r\n              SetFieldAction.new(dclone.id, 'viewpoint', new_vp.pvid, '+=', true);*/\n              // insert in-place right after the cloned view, with old score.\n              _this.set_viewpoint(new_vp.pvid, undefined, dclone, !deep);\n              // SetFieldAction.new(dclone.id, 'father', new_vp.vpid, '+=', true);\n              break;\n            case '':\n            case 'id':\n            case 'name':\n            case 'className':\n            case 'pointedBy':\n            case '_storePath':\n            case '_subMaps':\n            case 'clonedCounter':\n              break;\n            case 'css_MUST_RECOMPILE':\n              break;\n            case 'isValidation':\n              console.log(\"duplicate \" + c.data.name + \" set isvalidation\", {\n                data: c.data,\n                iv: c.data.isValidation\n              });\n              lview[key] = c.data[key];\n              break;\n            default:\n              try {\n                lview[key] = c.data[key];\n              } catch (e) {\n                //    Log.ee('Error on duplicate view:', e);\n              }\n          }\n        }\n\n        // insert in viewpoint.subview\n        //let defaultViews: Dictionary<Pointer, boolean> = Defaults.defaultViewsMap;\n        let vp = c.proxyObject.viewpoint;\n        // let oldViews: Pointer<DViewElement>[] = Object.keys(vp.__raw.subViews);\n        // if (Defaults.viewpoints.indexOf(vpid)) oldViews = oldViews.filter( vid => !defaultViews[vid]);\n        // let i: number = oldViews.indexOf(c.data.id);\n        /*\r\n        if (i === -1) oldViews.push(dclone.id);\r\n        else oldViews.splice(i+1, 0, dclone.id); // insert in-place right after the cloned view\r\n        vp.subViews = oldViews as any;*/\n        // SetRootFieldAction.new('stackViews', dview.id, '+=', true);\n\n        const isVP = c.data.className === 'DViewPoint';\n        if (isVP) SetRootFieldAction.new(`viewpoints`, c.data.id, '+=', true);else SetRootFieldAction.new(`viewelements`, c.data.id, '+=', true);\n        for (let key of DViewElement.RecompileKeys) SetRootFieldAction.new(`VIEWS_RECOMPILE_${key}`, c.data.id, '+=', false);\n      });\n      return lview;\n    };\n  }\n}, _class4.subclasses = [], _class4._extends = [], _class4)) || _class3);\nRuntimeAccessibleClass.set_extend(DPointerTargetable, DViewElement);\nRuntimeAccessibleClass.set_extend(LPointerTargetable, LViewElement);\nexport let DViewTransientProperties = (_dec3 = RuntimeAccessible('DViewTransientProperties'), _dec3(_class5 = (_class6 = class DViewTransientProperties extends RuntimeAccessibleClass {\n  constructor() {\n    super(...arguments);\n    this._isDViewTransientProperties = void 0;\n  } // isSelected: Dictionary<DocString<Pointer<DUser>>, boolean> = {};\n  // private: DViewPrivateTransientProperties;\n}, _class6.logic = void 0, _class6)) || _class5);\nRuntimeAccessibleClass.set_extend(RuntimeAccessibleClass, DViewTransientProperties);\nexport let LViewTransientProperties = (_dec4 = RuntimeAccessible('LViewTransientProperties'), _dec4(_class7 = (_class8 = class LViewTransientProperties extends LPointerTargetable {\n  constructor() {\n    super(...arguments);\n    this._isLViewTransientProperties = void 0;\n  } // isSelected: Dictionary<DocString<Pointer<DUser>>, boolean> = {};\n  // private!: LViewPrivateTransientProperties;\n  /*\r\n      get_private(context: LogicContext<DViewTransientProperties>): LViewPrivateTransientProperties {\r\n          return LViewTransientProperties.wrap(context.data.private, context.proxy.baseObjInLookup, context.proxy.additionalPath + '.private'); }*/\n  /*\r\n      get_isSelected(logicContext: LogicContext<TargetableProxyHandler<DViewTransientProperties>, DViewTransientProperties>): Proxyfied<Dictionary> {\r\n          // @ts-ignore for $ at end of getpath\r\n          console.log('GET_ISSELECTED handler func');\r\n          return TargetableProxyHandler.getMap(logicContext.data.isSelected, logicContext, logicContext.proxy.additionalPath + '.' + (getPath as this).isSelected.$);\r\n      }*/\n}, _class8.structure = void 0, _class8.singleton = void 0, _class8)) || _class7);\nRuntimeAccessibleClass.set_extend(DPointerTargetable, DViewTransientProperties);\nRuntimeAccessibleClass.set_extend(LPointerTargetable, LViewTransientProperties);\n\n/*\r\n\r\n@RuntimeAccessible\r\nexport class DViewPrivateTransientProperties extends DPointerTargetable{\r\n    static logic: typeof LViewPrivateTransientProperties;\r\n\r\n    public size: GraphSize\r\n    constructor(size?: GraphSize) {\r\n        super();\r\n        this.size = size || defaultVSize;\r\n    }\r\n}\r\n\r\n@RuntimeAccessible\r\nexport class LViewPrivateTransientProperties extends DViewPrivateTransientProperties{\r\n    static structure: typeof DViewPrivateTransientProperties;\r\n    static singleton: LViewPrivateTransientProperties;\r\n\r\n}*/\n// shapeless component, receive jsx from redux\n// can access any of the redux state, but will usually access 1-2 var among many,\n// how can i dynamically mapStateToProps to map only the required ones?","map":{"version":3,"names":["BEGIN","Constructors","CoordinateMode","Debug","Defaults","DPointerTargetable","DViewPoint","EdgeBendingMode","EdgeGapMode","EGraphElements","EModelElements","END","GraphPoint","GraphSize","Log","LPointerTargetable","LUser","LViewPoint","MyProxyHandler","Pointers","RuntimeAccessible","RuntimeAccessibleClass","SetFieldAction","SetRootFieldAction","ShortAttribETypes","store","TRANSACTION","U","windoww","DUser","transientProperties","jsxDEV","_jsxDEV","Fragment","_Fragment","CSS_Units0","CSS_Units","pattern","jsx","id","children","Object","keys","map","k1","v1","console","log","karr","k1arr","label","k","v","push","value","fileName","_jsxFileName","lineNumber","columnNumber","join","DViewElement","_dec","_class","_class2","constructor","arguments","isValidation","name","isExclusiveView","constants","preRenderFunc","jsxString","usageDeclarations","forceNodeType","appliableToClasses","appliableTo","subViews","oclCondition","jsCondition","oclUpdateCondition","OCL_NEEDS_RECALCULATION","OCL_UPDATE_NEEDS_RECALCULATION","explicitApplicationPriority","defaultVSize","adaptHeight","adaptWidth","draggable","resizable","viewpoint","onDataUpdate","onDragStart","onDragEnd","whileDragging","onResizeStart","onResizeEnd","whileResizing","onRotationStart","onRotationEnd","whileRotating","events","bendingMode","edgeGapMode","storeSize","size","lazySizeUpdate","edgeStartOffset","edgeEndOffset","edgeStartOffset_isPercentage","edgeEndOffset_isPercentage","edgeStartStopAtBoundaries","edgeEndStopAtBoundaries","edgePointCoordMode","edgeHeadSize","edgeTailSize","palette","css","cssIsGlobal","compiled_css","css_MUST_RECOMPILE","new","length","undefined","priority","persist","isDefaultView","vp","end","new2","callback","newDefault","forData","palettes","type","r","g","b","a","query","className","user","fromPointer","current","_user$project","project","activeViewpoint","viewpoints","names","increaseEndingNumber","newName","indexOf","d","subclasses","_extends","MeasurableKeys","RecompileKeys","LViewElement","_dec2","_class3","_class4","__raw","__info_of__name","isGlobal","EString","txt","isOverlay","__info_of__isOverlay","EBoolean","__info_of__explicitApplicationPriority","EByte","__info_of__isExclusiveView","__info_of__constants","todo","__info_of__preRenderFunc","obsolete","__info_of__jsxString","href","__info_of__usageDeclarations","__info_of__oclUpdateCondition","readType","writeType","__info_of__cssIsGlobal","__info_of__css","__info_of__compiled_css","hidden","__info_of__palette","__info_of__forceNodeType","enum","zoom","__info_of__zoom","isNode","cname","__info_of__appliableToClasses","__info_of__subViews","setSubViewScore","__info_of__setSubViewScore","allSubViews","__info_of__allSubViews","__info_of__defaultVSize","__info_of__adaptWidth","__info_of__adaptHeight","__info_of__draggable","__info_of__resizable","__info_of__oclCondition","__info_of__jsCondition","__info_of__viewpoint","display","__info_of__display","__info_of__onDragStart","__info_of__onDragEnd","__info_of__whileDragging","__info_of__onResizeStart","__info_of__onResizeEnd","__info_of__whileResizing","__info_of__onRotationStart","__info_of__onRotationEnd","__info_of__whileRotating","__info_of__onDataUpdate","event","__info_of__events","__info_of__event","constraints","__info_of__constraints","__info_of__bendingMode","isEdge","__info_of__edgeGapMode","__info_of__storeSize","__info_of__lazySizeUpdate","__info_of__edgeStartOffset","__info_of__edgeEndOffset","__info_of__edgeStartOffset_isPercentage","__info_of__edgeEndOffset_isPercentage","__info_of__edgeStartStopAtBoundaries","__info_of__edgeEndStopAtBoundaries","__info_of__edgePointCoordMode","isEdgePoint","__info_of__edgeHeadSize","__info_of__edgeTailSize","__info_of__size","EInt","__info_of__updateSize","__info_of__getSize","get_isOverlay","c","get_isExclusiveView","set_isOverlay","val","set_isExclusiveView","get_explicitApplicationPriority","_c$data$jsCondition","_c$data$oclCondition","data","set_explicitApplicationPriority","check","_defaultGetter","__defaultGetter","_defaultSetter","__defaultSetter","get_jsxString","context","set_jsxString","get_usageDeclarations","set_usageDeclarations","get_oclUpdateCondition","view","oclUpdateCondition_PARSED","set_oclUpdateCondition","get_cssIsGlobal","set_cssIsGlobal","get_css","set_css","get_compiled_css","s","allowLESS","shortPaletteName","cc","rgbastring","exDev","p","paletteName","palette0","colors","includes","substring","rgba","i","replaceAll","x","y","valarr","split","isNaN","patharr","curr","pathseg","e","token","ee","filter","unit","localViewSelector","set_compiled_css","exx","get_palette","set_palette","get_SubViews","clonedCounter","vid","set_SubViews","subviewsmap","Array","isArray","ptrsArr","fromArr","objectFromArrayValues","get_setSubViewScore","subview","boost","subviews","ptr","from","get_allSubViews","arr","nextarr","idmap","getState","dview","arrayMergeInPlace","fromD","values","set_allSubViews","wrongAccessMessage","get_oclCondition","set_oclCondition","trim","get_jsCondition","set_jsCondition","get_onDragStart","set_onDragStart","get_onDragEnd","set_onDragEnd","get_whileDragging","set_whileDragging","get_onResizeStart","set_onResizeStart","get_onResizeEnd","set_onResizeEnd","get_whileResizing","set_whileResizing","get_onRotationStart","set_onRotationStart","get_onRotationEnd","set_onRotationEnd","get_whileRotating","set_whileRotating","get_onDataUpdate","set_onDataUpdate","get_event","get_events","getStackTrace","set_events","addUD","udstr","delta","objectDelta","key","autogenstr","findstr","insertat","set_edgePointCoordMode","setTimeout","nid","node","_tn$mainView","tn","mainView","lnode","triggerCoordinateModeChange","get_constants","parseConstants","funcCode","parsedConstants","__param","__proto__","defaultContext","parsedFunc","parseFunctionWithContextAndScope","message","set_constants","get_preRenderFunc","set_preRenderFunc","_value","get_edgeHeadSize","get_edgeTailSize","set_edgeHeadSize","set_edgeTailSize","get_viewpoint","set_viewpoint","manualDview","preserveOrder","ret","vpid","oldvpid","copyPos","oldSubViews","insertBefore","copiedFromName","get_subViews","subViewsPointers","pointer","item","wrap","updateSize","get_updateSize","size0","proxyObject","vsize","newSize","currentCoordType","absolute","defaultsize","clone","w","h","equals","get_defaultVSize","getSize","get_getSize","impl_getSize","set_generic_entry","get_children","get_lazySizeUpdate","lightMode","set_lazySizeUpdate","get_bendingMode","set_bendingMode","set_appliableTo","set_forceNodeType","get_appliableToClasses","set_appliableToClasses","_context$data$appliab","sort","hasChanged","set_defaultVSize","_val$x","_val$y","_val$w","_val$h","duplicate","deep","new_vp","get_duplicate","_this","new_vp0","cn","n","lview","state","pvid","dclone","oldvid","oldScore","iv","isVP","set_extend","DViewTransientProperties","_dec3","_class5","_class6","_isDViewTransientProperties","logic","LViewTransientProperties","_dec4","_class7","_class8","_isLViewTransientProperties","structure","singleton"],"sources":["C:/d/Programming/web/jodel-mde/src/view/viewElement/view.tsx"],"sourcesContent":["import {\r\n    BEGIN,\r\n    Constructors,\r\n    CoordinateMode,\r\n    Debug, DEdgePoint,\r\n    Defaults,\r\n    DGraphElement,\r\n    Dictionary,\r\n    DModelElement,\r\n    DNamedElement,\r\n    DocString,\r\n    DPointerTargetable,\r\n    DState,\r\n    DViewPoint,\r\n    EdgeBendingMode,\r\n    EdgeGapMode,\r\n    EGraphElements,\r\n    EModelElements,\r\n    END,\r\n    getWParams,\r\n    GObject,\r\n    GraphPoint,\r\n    GraphSize,\r\n    Info, LEdgePoint, LModelElement,\r\n    Log,\r\n    LogicContext,\r\n    LPointerTargetable, LUser,\r\n    LViewPoint,\r\n    MyProxyHandler,\r\n    Pointer,\r\n    Pointers,\r\n    RuntimeAccessible,\r\n    RuntimeAccessibleClass,\r\n    SetFieldAction, SetRootFieldAction,\r\n    ShortAttribETypes,\r\n    store,\r\n    TRANSACTION,\r\n    U, ViewEClassMatch,\r\n    windoww\r\n} from \"../../joiner\";\r\nimport {DUser, EPSize, Pack1, transientProperties } from \"../../joiner/classes\";\r\nimport subViewsData from \"../../components/rightbar/viewsEditor/data/SubViewsData\";\r\nimport DSL from \"../../DSL/DSL\";\r\nimport {ReactNode} from \"react\";\r\n\r\nlet CSS_Units0 = {'Local-font relative':{\r\n        'cap':     'cap - (Cap height) the nominal height of capital letters of the element\\'s font.',\r\n        'ch':      'ch - Average character advance of a narrow glyph in the element\\'s font, as represented by the \"0\" (ZERO, U+0030) glyph.',\r\n        'em':      'em - Font size of the element\\'s font.',\r\n        'ex':      'ex - x-height of the element\\'s font.',\r\n        'ic':      'ic - Average character advance of a full-width glyph in the element\\'s font, as represented by the \"水\" (CJK water ideograph, U+6C34) glyph.',\r\n        'lh':      'lh - Line height of the element.',\r\n    },\r\n\r\n    'Root-font relative':{\r\n        'rcap':    'rcap - Cap height (the nominal height of capital letters) of the root element\\'s font.',\r\n        'rch':     'rch - Average character advance of a narrow glyph in the root element\\'s font, as represented by the \"0\" (ZERO, U+0030) glyph.',\r\n        'rem':     'rem - Font size of the root element\\'s font.',\r\n        'rex':     'rex - x-height of the root element\\'s font.',\r\n        'ric':     'ric - Average character advance of a full-width glyph in the root element\\'s font, as represented by the \"水\" (CJK water ideograph, U+6C34) glyph.',\r\n        'rlh':     'rlh - Line height of the root element.',\r\n    },\r\n\r\n    'Relative':{\r\n        'dvh':      'dvh - 1% of the dynamic viewport\\'s height.',\r\n        'dvw':      'dvw - 1% of the dynamic viewport\\'s width.',\r\n        'lvh':      'lvh - 1% of the large viewport\\'s height.',\r\n        'lvw':      'lvw - 1% of the large viewport\\'s width.',\r\n        'svh':      'svh - 1% of the small viewport\\'s height.',\r\n        'svw':      'svw - 1% of the small viewport\\'s width.',\r\n        'vb':       'vb - 1% of viewport\\'s size in the root element\\'s block axis.',\r\n        'vh':       'vh - 1% of viewport\\'s height.',\r\n        'vi':       'vi - 1% of viewport\\'s size in the root element\\'s inline axis.',\r\n        'vmax':     'vmax - 1% of viewport\\'s larger dimension.',\r\n        'vmin':     'vmin - 1% of viewport\\'s smaller dimension.',\r\n        'vw':       'vw - 1% of viewport\\'s width.',\r\n        'fr':       'fr - (Flex) Represents a flexible length within a grid container',\r\n        '%':        '% - Percentage',\r\n    },\r\n\r\n    'Container @Query relative':{\r\n        'cqb':      'cqb - 1% of a query container\\'s block size',\r\n        'cqh':      'cqh - 1% of a query container\\'s height',\r\n        'cqi':      'cqi - 1% of a query container\\'s inline size',\r\n        'cqmax':    'cqmax - The larger value of cqi or cqb',\r\n        'cqmin':    'cqmin - The smaller value of cqi or cqb',\r\n        'cqw':      'cqw - 1% of a query container\\'s width',\r\n    },\r\n\r\n    'Absolute lengths':{\r\n        'cm':      'cm - (Centimeters) 1cm = 96px/2.54',\r\n        'in':      'in - (Inches) 1in = 2.54cm = 96px',\r\n        'mm':      'mm - (Millimeters) 1mm = 1/10th of 1cm',\r\n        'pc':      'pc - (Picas) 1pc = 1/6th of 1in',\r\n        'pt':      'pt - (Points) 1pt = 1/72th of 1in',\r\n        'px':      'px - (Pixels) 1px = 1/96th of 1in',\r\n        'Q':       'Q - (Quarter-millimeters) 1Q = 1/40th of 1cm',\r\n    },\r\n\r\n    'Angles':{\r\n        'deg':      'deg - (Degrees) There are 360 degrees in a full circle.',\r\n        'grad':     'grad - (Gradians) There are 400 gradians in a full circle.',\r\n        'rad':      'rad - (Radians) There are 2π radians in a full circle.',\r\n        'turn':     'turn - (Turns) There is 1 turn in a full circle.',\r\n    },\r\n\r\n    'Time':{\r\n        'ms':     'ms - Milliseconds',\r\n        's':      's - (Seconds) There are 1,000 milliseconds in a second.',\r\n    },\r\n\r\n    'Frequency':{\r\n        'Hz':      'Hz - (Hertz) Represents the number of occurrences per second.',\r\n        'kHz':     'kHz - (KiloHertz) A kiloHertz is 1000 Hertz.',\r\n    },\r\n\r\n    'Resolution':{\r\n        'dpcm':     'dpcm - Dots per centimeter.',\r\n        'dpi':      'dpi - Dots per inch.',\r\n        'dppx':     'dppx - Dots per px unit.',\r\n    },\r\n};\r\nexport let CSS_Units: typeof CSS_Units0 & { jsx: ReactNode, pattern: string } = CSS_Units0 as any;\r\n\r\nlet pattern: string[] = [];\r\n\r\nCSS_Units.jsx = <datalist id={\"__jodel_CSS_units\"}>{\r\n   (Object.keys(CSS_Units) as (keyof typeof CSS_Units0)[]).map(k1 => {\r\n        let v1: GObject = CSS_Units[k1];\r\n       console.log(\"optgroup css units\", {k1, v1, karr:Object.keys(v1), k1arr:Object.keys(CSS_Units)});\r\n\r\n       return <optgroup label={k1}>\r\n            {Object.keys(v1).map(k => {\r\n                let v = v1[k];\r\n                console.log(\"css units\", {k, v, k1, v1, karr:Object.keys(v1), k1arr:Object.keys(CSS_Units)});\r\n                pattern.push(k);\r\n                return <option value={k}>{v}</option>\r\n            })}\r\n        </optgroup>\r\n    })\r\n}</datalist>;\r\n//throw new Error(\"Stop\");\r\nCSS_Units.pattern = \"^(\" + pattern.join('|') + \")$\";\r\nwindoww.CSS_Units = CSS_Units;\r\n\r\n\r\n/*\r\nexport type CSS_AbsoluteUnit = 'px' | 'cm' | 'mm' | 'pt' | 'pc' | 'in' | '';\r\nexport type CSS_RelativeDomUnit = '%' | 'fr' | 'vw' | 'vh' | 'vmin' | 'vmax';\r\nexport type CSS_RelativeFontUnit =  'em' | 'rem' | 'ex' | 'ch';\r\nexport type CSSUnit = CSS_AbsoluteUnit | CSS_RelativeFontUnit | CSS_RelativeDomUnit;*/\r\n\r\nexport type StringControl = {type:'text', value: string};\r\nexport type NumberControl = {type:'number', value: number, unit: DocString<\"css unit\">};\r\nexport type PaletteControl = {type:'color', value: tinycolor.ColorFormats.RGBA[]}; // array of rgba: red, green, blue, alpha\r\nexport type PathControl = {type:'path', value: string, x: string, y: string, options: {k: string, v:string}[]}; // array of rgba: red, green, blue, alpha\r\nexport type PaletteType = Dictionary<string, PaletteControl | NumberControl | StringControl | PathControl>;\r\n\r\n\r\n@RuntimeAccessible('DViewElement')\r\nexport class DViewElement extends DPointerTargetable {\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    // static singleton: LViewElement;\r\n    // static logic: typeof LViewDViewElementElement;\r\n    // static structure: typeof DViewElement;\r\n    public static MeasurableKeys: string[] = ['onDataUpdate', 'onDragStart', 'onDragEnd', 'whileDragging', 'onResizeStart',\r\n        'onResizeEnd', 'whileResizing', 'onRotationStart', 'onRotationEnd', 'whileRotating'];\r\n    public static RecompileKeys: string[] = ['onDataUpdate', 'onDragStart', 'onDragEnd', 'whileDragging', 'onResizeStart',\r\n        'onResizeEnd', 'whileResizing', 'onRotationStart', 'onRotationEnd', 'whileRotating',\r\n        'constants', 'usageDeclarations', 'jsxString', 'preconditions', 'jsCondition', 'ocl', 'events'];\r\n\r\n    // inherited redefine\r\n    // public __raw!: DViewElement;\r\n    id!: Pointer<DViewElement, 1, 1, LViewElement>;\r\n\r\n\r\n    // own properties\r\n    isValidation!: boolean; // only for root views (ex viewpoints) to group views semantically.\r\n    name!: string;\r\n    isExclusiveView!: boolean;\r\n\r\n    // processate 1 sola volta all'applicazione della vista o all'editing del campo\r\n    constants?: string;\r\n    // _parsedConstants?: GObject; // should be protected but LView is not subclass\r\n\r\n    // evaluate tutte le volte che l'elemento viene aggiornato (il model o la view cambia).\r\n    preRenderFunc!: string;\r\n\r\n    jsxString!: string; // l'html template\r\n    usageDeclarations?: string;\r\n\r\n    forceNodeType?: DocString<'component name (Vertex, Field, GraphVertex, Graph)'>; // used in DefaultNode\r\n    // scalezoomx: boolean = false; // whether to resize the element normally using width-height or resize it using zoom-scale css\r\n    // scalezoomy: boolean = false;\r\n    // not persistent, some not shared. deve essere diverso da utente ad utente perchè dipende dal pan e zoom nel grafo dell'utente attuale.\r\n    // facendo pan su grafo html sposti gli elementi, per simulare uno spostamento del grafo e farlo sembrare illimitato.\r\n    // __transient: DViewTransientProperties;\r\n    appliableToClasses!: string[]; // class names: DModel, DPackage, DAttribute...\r\n    appliableTo!: 'Any'|'Graph'|'GraphVertex'|'Vertex'|'Edge'|'EdgePoint'|'Field';\r\n    subViews!: Dictionary<Pointer<DViewElement>, number/* priority boost */>;\r\n    oclCondition!: string; // ocl selector\r\n    jsCondition!: string; // js selector\r\n    oclUpdateCondition!: DocString<(view: LViewElement)=>boolean>;\r\n    //oclUpdateCondition_PARSED!: undefined | ((view: LViewElement)=>boolean); moved in transient\r\n    OCL_NEEDS_RECALCULATION!: boolean; // if only the oclCondition needs to be reapplied to all model elements\r\n    OCL_UPDATE_NEEDS_RECALCULATION!: boolean; // if both ocl needsto be reapplied and the oclUpdateCondition -> transient.view[v.id].oclUpdateCondition_PARSED needs to be remade\r\n    explicitApplicationPriority!: number; // priority of the view, if a node have multiple applicable views, the view with highest priority is applied.\r\n    defaultVSize!: GraphSize;\r\n    adaptHeight!: boolean;// | 'fit-content' | '-webkit-fill-available';\r\n    adaptWidth!: boolean;\r\n    /*width!: number;\r\n    height!: number;*/\r\n    draggable!: boolean;\r\n    resizable!: boolean;\r\n    viewpoint!: Pointer<DViewPoint>;\r\n    //display!: 'block'|'contents'|'flex'|string;\r\n    //constraints!: GObject<\"obsolete, used in Vertex. they are triggered by events (view.onDragStart....) and can bound the size of the vertex\">[];\r\n    onDataUpdate!: string;\r\n    onDragStart!: string;\r\n    onDragEnd!: string;\r\n    whileDragging!: string;\r\n    onResizeStart!: string;\r\n    onResizeEnd!: string;\r\n    whileResizing!: string;\r\n    onRotationStart!: string;\r\n    onRotationEnd!: string;\r\n    whileRotating!: string;\r\n    events!: Dictionary<DocString<\"functionName\">, DocString<\"functionBody\">>;\r\n    bendingMode!: EdgeBendingMode;\r\n    edgeGapMode!: EdgeGapMode;\r\n    //useSizeFrom!: EuseSizeFrom;\r\n    storeSize!: boolean;\r\n    size!: Dictionary<Pointer<DModelElement> | Pointer<DGraphElement>, GraphSize>;\r\n    lazySizeUpdate!: boolean; // if true updates it once when the vertex is released. if false updates vertex position every X millisecond while dragging.\r\n    edgeStartOffset!: GraphPoint;\r\n    edgeEndOffset!: GraphPoint;\r\n    edgeStartOffset_isPercentage!: boolean;\r\n    edgeEndOffset_isPercentage!: boolean;\r\n    edgeStartStopAtBoundaries!: boolean;\r\n    edgeEndStopAtBoundaries!: boolean;\r\n    edgePointCoordMode!: CoordinateMode;\r\n    edgeHeadSize!: GraphPoint;\r\n    edgeTailSize!: GraphPoint;\r\n    palette!: Readonly<PaletteType>;\r\n    css!: string;\r\n    cssIsGlobal!: boolean;\r\n    /* private */ compiled_css!: string;\r\n    /* private */ css_MUST_RECOMPILE!: boolean;\r\n\r\n    public static new(name: string, jsxString: string, defaultVSize?: GraphSize, usageDeclarations: string = '', constants: string = '',\r\n                      preRenderFunc: string = '', appliableToClasses: string[] = [], oclCondition: string = '',\r\n                      priority?: number, persist: boolean = true, isDefaultView: boolean = false, vp?: Pointer<DViewPoint> | 'skip'): DViewElement {\r\n        let id = isDefaultView ? 'Pointer_View' + name : undefined;\r\n        return new Constructors(new DViewElement('dwc'), undefined, persist, undefined, id).DPointerTargetable().DViewElement(name, jsxString, vp, defaultVSize, usageDeclarations, constants,\r\n            preRenderFunc, appliableToClasses, oclCondition, priority).end();\r\n\r\n    }\r\n    public static new2(name: string, jsxString: string, callback?: (d:DViewElement)=>void, persist: boolean = true, vp?: Pointer<DViewPoint> | 'skip', id?: string): DViewElement {\r\n        // let id = isDefaultView ? 'Pointer_View' + name : undefined;\r\n        return new Constructors(new DViewElement('dwc'), undefined, persist, undefined, id)\r\n            .DPointerTargetable().DViewElement(name, jsxString, vp).end(callback);\r\n    }\r\n\r\n    static newDefault(forData?: DNamedElement): DViewElement{\r\n        const jsx = `<div className={'root'}>\r\n    <div className={'header'}>\r\n        <Input\r\n            placeholder={\"?\"}\r\n            autosize={\"true\"}\r\n            hidden={true}\r\n            data={data}\r\n            field={\"name\"}\r\n        />\r\n    </div>\r\n    <div className={'body'}>To add information here,<br/> edit the view<br/><i>\"{view.name}\"</i></div>\r\n</div>`;\r\n        const palettes: PaletteType = {\r\n            \"border-color-\": {type:\"color\", value: [{r:187, g:187, b:187, a:1}]},\r\n            \"background-\": {type:\"color\", value: [{r:238, g:242, b:243, a:1}]},\r\n            \"color-\": {type:\"color\", value: [{r:3, g:54, b:86, a:1}]},\r\n        }\r\n            const css = `.root {\r\n    border: 1px solid var(--border-color-1);\r\n    border-radius: 4px;\r\n    background-color: var(--background-1);\r\n    \r\n    font-family: Verdana, sans-serif;\r\n    color: var(--color-1);\r\n    font-size: 11px;\r\n}\r\n \r\n.root div.header {\r\n    text-align: center;\r\n    border-bottom: 1px solid var(--border-color-1);\r\n    padding: 0px;\r\n    margin: 0px;\r\n}\r\n \r\n.root div.header {\r\n    font-size: 5px;\r\n}\r\n \r\n.root div.header input:empty {\r\n    margin-left: 0px;\r\n}\r\n.root div.body {\r\n    text-align: center;\r\n    font-weight: normal;  \r\n    height: auto;\r\n    padding: 5px;\r\n}\r\n `;\r\n        let query = '';\r\n        if (forData) switch(forData.className) {\r\n            case 'DClass':\r\n                query = `context DObject inv: self.instanceof.id = '${forData.id}'`;\r\n                break;\r\n            case 'DAttribute':\r\n            case 'DReference':\r\n                query = `context DValue inv: self.instanceof.id = '${forData.id}'`;\r\n                break;\r\n            default:\r\n                query = `context ${forData.className} inv: self.id = '${forData.id}'`;\r\n                break;\r\n        }\r\n        const user = LUser.fromPointer(DUser.current);\r\n        // const project = user?.project; if(!project) return this;\r\n        let name: string;\r\n        if (forData?.name) {\r\n            name = forData.name + 'View';\r\n        } else {\r\n            const vp: LViewPoint = user?.project?.activeViewpoint || LPointerTargetable.fromPointer(Defaults.viewpoints[0]);\r\n            let names: string[] = vp.subViews.map(v => v && v.name);\r\n            name = U.increaseEndingNumber( 'view_' + 0, false, false, newName => names.indexOf(newName) >= 0);\r\n        }\r\n        return DViewElement.new2(name, jsx, (d)=>{\r\n            d.css = css;\r\n            d.palette = palettes;\r\n            d.css_MUST_RECOMPILE = true;\r\n            d.oclCondition = query;\r\n        }, true);\r\n    }\r\n}\r\n\r\n@RuntimeAccessible('LViewElement')\r\nexport class LViewElement<Context extends LogicContext<DViewElement, LViewElement> = any, D extends DViewElement = any>\r\n    extends LPointerTargetable { // MixOnlyFuncs(DViewElement, LPointerTargetable)\r\n\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    // static singleton: LViewElement;\r\n    // static logic: typeof LViewElement;\r\n    // static structure: typeof DViewElement;\r\n\r\n    // inherited redefine\r\n    public __raw!: DViewElement;\r\n    id!: Pointer<DViewElement, 1, 1, LViewElement>;\r\n    public r!: this;\r\n\r\n\r\n\r\n    // own properties\r\n    isValidation!: boolean; // only for root views (ex viewpoints) to group views semantically.\r\n    name!: string;\r\n    __info_of__name: Info = {isGlobal: true, type: ShortAttribETypes.EString, txt:<div>Name of the view</div>}\r\n    isOverlay!:boolean;\r\n    __info_of__isOverlay: Info = {isGlobal:true, type: ShortAttribETypes.EBoolean, txt:<div>If not exclusive, the view is meant to add a functional outline of tools to a primary View, or css.\r\n            <br/>A non-exclusive view cannot be applied alone and needs an exclusive view to render the main graphical content.</div>};\r\n    get_isOverlay(c: Context): this[\"isOverlay\"] { return this.get_isExclusiveView(c); }\r\n    set_isOverlay(val: this[\"isOverlay\"], c: Context): boolean { return this.set_isExclusiveView(val, c); }\r\n\r\n\r\n\r\n    explicitApplicationPriority!: number; // priority of the view, if a node have multiple applicable views, the view with highest priority is applied.\r\n    __info_of__explicitApplicationPriority: Info = {isGlobal: true, type: ShortAttribETypes.EByte, label:\"explicit priority\",\r\n        txt: 'Application priority of view. If multiple views match an element, the highest priority will render the main jsx.' }\r\n    get_explicitApplicationPriority(c: Context): this[\"explicitApplicationPriority\"] {\r\n        if (c.data.explicitApplicationPriority !== undefined) return c.data.explicitApplicationPriority;\r\n        else return (c.data.jsCondition?.length || 1) + (c.data.oclCondition?.length || 1); }\r\n    set_explicitApplicationPriority(val: this[\"explicitApplicationPriority\"] | undefined, c: Context): boolean {\r\n        SetFieldAction.new(c.data, \"explicitApplicationPriority\", val as number, '', false);\r\n        return true;\r\n    }\r\n\r\n    isExclusiveView!: boolean;\r\n    __info_of__isExclusiveView: Info = {isGlobal:true, type: ShortAttribETypes.EBoolean, txt:<div>If not exclusive, the view is meant to add a functional outline of tools to a primary View, or css.\r\n    <br/>A non-exclusive view cannot be applied alone and needs an exclusive view to render the main graphical content.</div>};\r\n    get_isExclusiveView(c: Context): this[\"isExclusiveView\"] { return c.data.isExclusiveView; }\r\n    set_isExclusiveView(val: this[\"isExclusiveView\"], c: Context): boolean {\r\n        if (Defaults.check(c.data.id)) return true; // cannot delete or \"demote\" to decorations the main views, to make sure there is always at least 1 appliable view.\r\n        return SetFieldAction.new(c.data, \"isExclusiveView\", !!val, '', false);\r\n    }\r\n\r\n    constants?: string;\r\n    __info_of__constants: Info = {todo:true, isGlobal: true, type: \"Function():Object\", label:\"constants declaration\",\r\n        txt:<div>Data used in the visual representation, meant to be static values evaluated only once when the view is first applied.<br/>\r\n        Check default value view for an example.<br/>\r\n    </div>};\r\n    // Example 1: <code>{'{color:\"red\", background: \"gray\"}'}</code><br/>\r\n    // Example 2: <code>{'function(){\\n    let fib = [1,1]; for (let i = 2; i < 100) { fib[i] = fib[i-2]+fib[i-1]; }\\n    return fib; }'}</code><br/>\r\n\r\n    preRenderFunc?: string; // evalutate tutte le volte che l'elemento viene aggiornato (il model o la view cambia)\r\n    __info_of__preRenderFunc: Info = {isGlobal: true, obsolete: true, type: \"Function():Object\", label:\"pre-render function\",\r\n        txt:<div>Data used in the visual representation, meant to be dynamic values evaluated every time the visual representation is updated.<br/>Replaced by usageDeclarations.</div>}\r\n\r\n    protected _defaultGetter(c: Context, k: keyof Context[\"data\"]): any { return this.__defaultGetter(c, k); }\r\n\r\n    protected _defaultSetter(v: any, c: Context, k: keyof Context[\"data\"]): any { return this.__defaultSetter(v, c, k); }\r\n\r\n    jsxString!: string;\r\n    __info_of__jsxString: Info = {isGlobal: true, type: \"text\", label:\"JSX template\",\r\n        txt:<div>The main ingredient, a <a href={\"https://react.dev/learn/writing-markup-with-jsx\"}>JSX template</a> that will be visualized in the graph.</div>}\r\n    protected get_jsxString(context: Context): this['jsxString'] {\r\n        return context.data.jsxString;\r\n    }\r\n    protected set_jsxString(val: this['jsxString'], context: Context): boolean {\r\n        TRANSACTION(() => {\r\n            // const jsx = DSL.parser(val);\r\n            SetFieldAction.new(context.data, 'jsxString', val, '', false);\r\n            SetRootFieldAction.new('VIEWS_RECOMPILE_jsxString', context.data.id, '+=', false);\r\n        });\r\n        return true;\r\n    }\r\n\r\n    usageDeclarations?: string;\r\n    __info_of__usageDeclarations: Info = {todo: false, isGlobal: true, type: \"Function():Object\", label:\"usage declarations\",\r\n        txt: <div>Subset of the global or elements's data state that is graphically used.\r\n            <br/>If specified the element will only update when one of those has changed.\r\n            <br/>Can optimize performance and ensure the node is updated even when navigating remote properties that\r\n            <br/>    don\\'t belong to this element, like visualizing the name of an object pointed by a reference.\r\n            <br/>Context: it has the usual variables present in a JSX template (data, view, node...)\r\n            <br/>    plus a special variable \"ret\" where dependencies are registered.{/*and a \"state\" variable containing the entire application state.*/}\r\n            <br/>Usage Example: see the default view for value.\r\n    </div>}\r\n    protected get_usageDeclarations(c: Context): this[\"usageDeclarations\"]{\r\n        return c.data.usageDeclarations || \"(ret)=>{ // scope contains: data, node, view, constants, state\\n\" +\r\n            \"// ** preparations and default behaviour here ** //\\n\" +\r\n            \"ret.data = data\\n\" +\r\n            \"ret.node = node\\n\" +\r\n            \"ret.view = view\\n\" +\r\n            \"// data, node, view are dependencies by default. delete them above if you want to remove them.\\n\" +\r\n            // if you want your node re-rendered every time, add a dependency to ret.state = state; or ret.update = Math.random();\r\n            \"// add preparation code here (like for loops to count something), then list the dependencies below.\\n\" +\r\n            \"// ** declarations here ** //\\n\" +\r\n            \"}\";\r\n    }\r\n    protected set_usageDeclarations(val: this['usageDeclarations'], context: Context): boolean {\r\n        TRANSACTION(()=>{\r\n            SetFieldAction.new(context.data, 'usageDeclarations', val, '', false);\r\n            SetRootFieldAction.new('VIEWS_RECOMPILE_usageDeclarations', context.data.id, '+=', false);\r\n        })\r\n        return true;\r\n    }\r\n\r\n    // format should be array of (usedPaths: string[]) starting with \"data.\" AUTOMATICALLY inefered from the ocl editor.\r\n    oclUpdateCondition!: (oldData: LModelElement, newData:LModelElement) => boolean;\r\n    __info_of__oclUpdateCondition: Info = {readType: '(view: LViewElement)=>boolean', writeType: 'function string',\r\n        txt: \"[Optionally] Declare variables that are used in OCL condition, so that OCL will be re-checked only when those values have changed.\"}\r\n    get_oclUpdateCondition(c: Context): this[\"oclUpdateCondition\"] { return transientProperties.view[c.data.id].oclUpdateCondition_PARSED; }\r\n    set_oclUpdateCondition(val: DocString<\"function\">, c: Context): boolean {\r\n        TRANSACTION(()=>{\r\n            SetFieldAction.new(c.data, \"oclUpdateCondition\", val || '', '', false);\r\n            // not recalculated right now because the change needs to be sent to collaborative editor users\r\n            // it is pointer, but i don't want to set pointedby's, it is very short lived.\r\n            SetRootFieldAction.new(\"OCL_UPDATE_NEEDS_RECALCULATION\", c.data.id, '+=', false);\r\n        });\r\n        return true;\r\n    }\r\n/* moved it as setrootfield action and as array. check it after every reducer. update im same style the color palette too?\r\n    OCL_NEEDS_RECALCULATION!: boolean;\r\n    __info_of__OCL_NEEDS_RECALCULATION: Info = {hidden: true, type: ShortAttribETypes.EBoolean,\r\n        txt: \"if only the oclCondition needs to be reapplied to all model elements\"}\r\n    get_OCL_NEEDS_RECALCULATION(c: Context): this[\"OCL_NEEDS_RECALCULATION\"] { return c.data.OCL_NEEDS_RECALCULATION; }\r\n    set_OCL_NEEDS_RECALCULATION(val: this[\"OCL_NEEDS_RECALCULATION\"], c: Context): boolean { return this.cannotSet('OCL_NEEDS_RECALCULATION'); }\r\n\r\n    OCL_UPDATE_NEEDS_RECALCULATION!: boolean;\r\n    __info_of__OCL_UPDATE_NEEDS_RECALCULATION: Info = {hidden: true, type: ShortAttribETypes.EBoolean,\r\n        txt: \"if both ocl needsto be reapplied and the oclUpdateCondition -> transient.view[v.id].oclUpdateCondition_PARSED needs to be remade\"}\r\n    get_OCL_UPDATE_NEEDS_RECALCULATION(c: Context): this[\"OCL_UPDATE_NEEDS_RECALCULATION\"] { return c.data.OCL_UPDATE_NEEDS_RECALCULATION; }\r\n    set_OCL_UPDATE_NEEDS_RECALCULATION(val: this[\"OCL_UPDATE_NEEDS_RECALCULATION\"], c: Context): boolean { return this.cannotSet('OCL_UPDATE_NEEDS_RECALCULATION'); }*/\r\n\r\n    private css_MUST_RECOMPILE!: boolean;\r\n    public cssIsGlobal!: boolean;\r\n    __info_of__cssIsGlobal: Info = {type: ShortAttribETypes.EBoolean, txt: \"Use with caution!\\nIf true, custom css can affect even elements not matched with this view, or outside the graph.\"}\r\n    get_cssIsGlobal(c: Context): this[\"cssIsGlobal\"] { return c.data.cssIsGlobal; }\r\n    set_cssIsGlobal(val: this[\"cssIsGlobal\"], c: Context): boolean {\r\n        TRANSACTION(()=>{\r\n            SetFieldAction.new(c.data, \"cssIsGlobal\", !!val, '', false);\r\n            // compile only when accessed, to prevent color inputs to do a mess of compilations\r\n            SetFieldAction.new(c.data, \"css_MUST_RECOMPILE\", true, '', false);\r\n        });\r\n        return true;\r\n    }\r\n    public css!: string;\r\n    __info_of__css: Info = {type: \"css string\", txt: \"Inject custom css that cannot be inserted inline like :hover or css variables.\\nSupport LESS syntax.\"}\r\n    get_css(c: Context): this[\"css\"] { return c.data.css; }\r\n    set_css(val:this[\"css\"], c: Context): boolean {\r\n        TRANSACTION(()=>{\r\n            SetFieldAction.new(c.data, \"css\", val, '', false);\r\n            // compile only when accessed, to prevent color inputs to do a mess of compilations\r\n            SetFieldAction.new(c.data, \"css_MUST_RECOMPILE\", true, '', false);\r\n        });\r\n        return true;\r\n    }\r\n\r\n    compiled_css!: string;\r\n    __info_of__compiled_css: Info = { hidden: true, txt:'css + palettes compiled from less in css'};\r\n    get_compiled_css(c: Context): this[\"compiled_css\"] {\r\n        if (!c.data.css_MUST_RECOMPILE) return c.data.compiled_css; // return c.proxyObject.r.__raw.compiled_css;\r\n        let s = '';\r\n        const allowLESS = false;\r\n        let shortPaletteName: string;\r\n        let cc = c;\r\n        function rgbastring(c: tinycolor.ColorFormats.RGBA): string{\r\n            Log.exDev(!c, \"invalid color:\", {id: cc.data.id, c, shortPaletteName, p:cc.data.palette});\r\n            return \"rgba(\"+c.r+\",\"+c.g+\",\"+c.b+\",\"+c.a+\")\";\r\n        }\r\n        //let palettes = U.paletteSplit(c.data.palette);\r\n        for (let paletteName in c.data.palette) {\r\n            let palette0 = c.data.palette[paletteName] as any;\r\n            if (palette0.type === \"color\") {\r\n                let palette = palette0 as PaletteControl;\r\n                let colors = palette.value;\r\n                if (!colors.length) continue;\r\n                if (['-', '_'].includes(paletteName[paletteName.length-1])) shortPaletteName = paletteName.substring(0, paletteName.length - 1);\r\n                else shortPaletteName = paletteName;\r\n                let rgba = rgbastring(colors[0]);\r\n                // set prefixed name without number\r\n                if (allowLESS) s += \"\\t@\" + shortPaletteName + \": \" + rgba + ';\\n';\r\n                s += \"\\t--\" + shortPaletteName + \": \" + rgba + ';\\n';\r\n                // set prefixed-0 name\r\n                if (allowLESS) s += \"\\t@\" + paletteName + '0: ' + rgba + ';\\n';\r\n                s += \"\\t--\" + paletteName + '0: ' + rgba + ';\\n';\r\n                // set prefixed-1 to prefixed-...n names\r\n                for (let i = 0 ; i < colors.length; i++) {\r\n                    rgba = rgbastring(colors[i]);\r\n                    if (allowLESS) s += \"\\t@\" + paletteName + (i+1) + \": \" + rgba + ';\\n';\r\n                    s += \"\\t--\" + paletteName + (i+1) + \": \" + rgba + ';\\n';\r\n                }\r\n            } else if (palette0.type === 'path'){\r\n                let palette: PathControl = palette0;\r\n                let val = U.replaceAll(palette.value, 'view.', '');\r\n                val = U.replaceAll(val, 'this.', '');\r\n                val = U.replaceAll(val, 'x', palette.x);\r\n                val = U.replaceAll(val, 'y', palette.y);\r\n                val = U.replaceAll(val, '+', ' +');\r\n                val = U.replaceAll(val, '-', ' -'); // important: cannot add space post-dash or it's harder to distinguish unary and binary -\r\n                val = U.replaceAll(val, '/', ' / ');\r\n                val = U.replaceAll(val, '*', ' * ');\r\n                let valarr: (string | number)[] = val.split(/[,\\s]/);\r\n                // [] not allowed\r\n                valarr = (valarr as string[]).map(val => {\r\n                    if (!isNaN(+val)) return val;\r\n                    let patharr: string[] = val.split('.');\r\n                    let curr: GObject = c.data;\r\n                    for (let pathseg of patharr) {\r\n                        curr = curr[pathseg];\r\n                        Log.e(!curr && (val.length > 1 || patharr.length > 1), \"invalid variable path in css path control\", {token:val, view:c.data.name});\r\n                        if (!curr) break;\r\n                    }\r\n                    if (typeof curr === \"object\" || (typeof curr === \"undefined\" && (val.length > 1 || patharr.length > 1)))\r\n                        Log.ee( \"invalid variable path in css path control\", {token:val, view:c.data.name});\r\n                    else val = curr || val;\r\n                    return val;\r\n                }).filter(p=>!!p);\r\n\r\n                for (let i = 0 ; i < valarr.length; i++) {\r\n                    let val = valarr[i];\r\n                    switch (val) { // i avoid subtracting L 1 -1 with spaces. it's unary if doesn't have a postfix space.\r\n                        default: continue;\r\n                        case '*': valarr[i] = +valarr[i-1] * +valarr[i+1]; valarr[i-1] = valarr[i+1] = ''; break;\r\n                        case '/': valarr[i] = +valarr[i-1] / +valarr[i+1]; valarr[i-1] = valarr[i+1] = ''; break;\r\n                        case '+': valarr[i] = +valarr[i-1] + +valarr[i+1]; valarr[i-1] = valarr[i+1] = ''; break;\r\n                        case '-': valarr[i] = +valarr[i-1] - +valarr[i+1]; valarr[i-1] = valarr[i+1] = ''; break;\r\n                    }\r\n                }\r\n                val = valarr.filter(p=>!!p).join(' ');\r\n                val = \"'\"+val+\"'\";\r\n                if (allowLESS) s += \"\\t@\" + paletteName + \": \" + val + ';\\n';\r\n                s += \"\\t--\" + paletteName + ': ' + val + ';\\n';\r\n            }\r\n            else {\r\n                // number or text\r\n                let palette: NumberControl | StringControl = palette0;\r\n                let val = palette.value + ((palette as NumberControl).unit || '');\r\n                if (!val) val = \"''\";\r\n                if (allowLESS) s += \"\\t@\" + paletteName + \": \" + val + ';\\n';\r\n                s += \"\\t--\" + paletteName + ': ' + val + ';\\n';\r\n            }\r\n        }\r\n        s += '\\n\\t' + U.replaceAll(c.data.css, '\\n', '\\n\\t');\r\n        const localViewSelector = '.'+c.data.id; // '[data-viewid=\"'+c.data.id+'\"]';\r\n        s = (!c.data.cssIsGlobal ? localViewSelector : 'body') +' {\\n' + s + '\\n}';\r\n        // not an error, i'm updating directly d-view that is usually wrong, this is to prevent multiple nodes with same view to trigger compile and redux actions\r\n        // count as if it's a derived attribute not really part of the store.\r\n        c.data.css_MUST_RECOMPILE = false;\r\n        return c.data.compiled_css = s;\r\n    }\r\n    set_compiled_css(val: this[\"compiled_css\"], c: Context): boolean {\r\n        Log.exx(\"Do not use setter for this, set it directly in d-object, along with compiled_css.\" +\r\n        \"\\nOtherwise multiple nodes of the same view will start compiling together.\\n\" as any);\r\n        return false;\r\n    }\r\n\r\n    public palette!: PaletteType;\r\n    __info_of__palette: Info = {type: \"Dictionary<prefix, colors[]>\", txt:\"Specify a set of colors, numbers or text variables to be used in the graphical syntax through css variables.\"}\r\n    get_palette(c: Context): this[\"palette\"] { return c.data.palette; }\r\n    set_palette(val:this[\"palette\"], c: Context): boolean {\r\n        TRANSACTION(()=>{\r\n            SetFieldAction.new(c.data, \"palette\", val, '', false);\r\n            SetFieldAction.new(c.data, \"css_MUST_RECOMPILE\", true, '', false);\r\n        });\r\n    return true; }\r\n\r\n    forceNodeType?: DocString<'component name'>;\r\n    __info_of__forceNodeType: Info = {isGlobal:true, type: \"EGraphElements\", enum: EGraphElements, label:\"force node type\",\r\n        txt:<div>Forces this element to be rendered with your component of choice instead of automatic selection when generated by a &lt;DefaultNode&gt; tag.</div>}\r\n\r\n    zoom!: GraphPoint;\r\n    __info_of__zoom: Info = {todo: true, isNode: true, type: GraphPoint.cname, txt:<div>Zooms in or out the element using css scale.</div>}\r\n    /*\r\n    scalezoomx!: boolean; // whether to resize the element normally using width-height or resize it using zoom-scale css\r\n    __info_of__scalezoomx: Info = {isNode: true, isEdge: false, isEdgePoint: false, txt:<div></div>}\r\n\r\n    scalezoomy!: boolean;\r\n    __info_of__scalezoomy: Info = {isNode: true, isEdge: false, isEdgePoint: false, txt:<div></div>}*/\r\n\r\n    // not persistent, some not shared. deve essere diverso da utente ad utente perchè dipende dal pan e zoom nel grafo dell'utente attuale.\r\n    // facendo pan su grafo html sposti gli elementi, per simulare uno spostamento del grafo e farlo sembrare illimitato.\r\n    // __transient: DViewTransientProperties;\r\n\r\n    appliableToClasses!: string[]; // class names: DModel, DPackage, DAttribute...\r\n    __info_of__appliableToClasses: Info = {isGlobal: true, type: \"EModelElements | EGraphElements\",\r\n        enum: {...EModelElements, ...EGraphElements, cname:\"EModelElements | EGraphElements\"}, label:\"applicable to\",\r\n        txt: <div>Do a low priority match with elements of this type.\r\n            <br/>This is just a shortcut with a lower priority than a OCL match.\r\n            <br/>The same result can be obtained through OCL.</div>}\r\n\r\n    appliableTo!: 'Any'|'Graph'|'GraphVertex'|'Vertex'|'Edge'|'EdgePoint'|'Field';\r\n\r\n    subViews!: LViewElement[];\r\n    __info_of__subViews: Info = {isGlobal: true, hidden: true, type: \"DViewElement[]\", label:\"sub-views\",\r\n        txt:<div>Views that are suggested to render elements contained in the current one with a higher match priority.\r\n            <br/>Like a package view giving priority to a specific Class or Enum view to render his contained Classifiers in a common theme.\r\n            <br/>If you wish to see the subview weight attached to the collection, access view.__raw.subviews instead.</div>}\r\n    get_SubViews(c: Context): this[\"subViews\"] {\r\n        delete c.data.subViews.clonedCounter;\r\n        return Object.keys(c.data.subViews).map( vid => LPointerTargetable.fromPointer(vid) as LViewElement);\r\n    }\r\n    set_SubViews(val: this[\"subViews\"] | GObject, c: Context): boolean {\r\n        let subviewsmap: GObject;\r\n        if (Array.isArray(val)) {\r\n            let ptrsArr = Pointers.fromArr(val);\r\n            subviewsmap = U.objectFromArrayValues(ptrsArr, 1.5);\r\n        } else subviewsmap = val || {};\r\n        SetFieldAction.new(c.data, \"subViews\", subviewsmap, '', true);\r\n        return true; }\r\n\r\n\r\n    setSubViewScore!: (subview: Pack1<LViewElement>, boost?: number | null) => void;\r\n    __info_of__setSubViewScore: Info = {isGlobal: true, hidden: true, type: \"function(ViewElement, numeric_score): void\", txt:<div>Adds, updates or unsets (if boost = null) a subview with his score.</div>}\r\n\r\n    // adds, updates or unsets (if boost = null) a subview with his score.\r\n    get_setSubViewScore(c: Context): ((subview: Pack1<LViewElement>, boost?: number | null) => void) {\r\n        return (subview: Pack1<LViewElement>, boost: number| null = 1.5 ) => {\r\n            let subviews = {...c.data.subViews};\r\n            let ptr = Pointers.from(subview) as Pointer<DViewElement>;\r\n            if (boost !== null) { // set mode\r\n                if (subviews[ptr] === boost) return;\r\n                subviews[ptr] = boost;\r\n            } else {// set mode\r\n                if (subviews[ptr] === undefined) return;\r\n                delete subviews[ptr];\r\n            }\r\n            SetFieldAction.new(c.data, 'subViews',  subviews, '', true);\r\n        };\r\n    }\r\n\r\n\r\n    allSubViews!: LViewElement[];\r\n    __info_of__allSubViews: Info = {type: \"ViewElement[]\", txt: \"recursively get this.subViews.\"}\r\n    get_allSubViews(c: Context): this[\"allSubViews\"] {\r\n        delete c.data.subViews.clonedCounter;\r\n        let arr: Pointer<DViewElement>[] = Object.keys(c.data.subViews);\r\n        let nextarr: Pointer<DViewElement>[] = [];\r\n        let idmap: Dictionary<Pointer, DViewElement> = {};\r\n        let s: DState = store.getState();\r\n        let dview: DViewElement;\r\n        while (arr.length) {\r\n            for (let vid of arr) {\r\n                if (idmap[vid]) continue;\r\n                dview = DPointerTargetable.fromPointer(vid, s);\r\n                if (!dview) continue;\r\n                idmap[vid] = dview;\r\n                U.arrayMergeInPlace(nextarr, Object.keys(dview.subViews));\r\n            }\r\n            arr = nextarr;\r\n            nextarr = [];\r\n        }\r\n        return LPointerTargetable.fromD(Object.values(idmap));\r\n    }\r\n    set_allSubViews(val: this[\"allSubViews\"], c: Context): boolean { return this.wrongAccessMessage(\"cannot call set_allSubViews, it is a derived attribute\"); }\r\n\r\n\r\n    defaultVSize!: GraphSize;\r\n    __info_of__defaultVSize: Info = {isNode:true, type: \"GraphSize\", label:\"default size\", txt: 'starting size of the node'}\r\n\r\n\r\n    adaptWidth!: boolean;\r\n    __info_of__adaptWidth: Info = {isNode:true, type: ShortAttribETypes.EBoolean, label:\"adapt width\",\r\n        txt: 'Whether the element should expand his width to accomodate his own contents.'}\r\n\r\n    adaptHeight!: boolean;\r\n    __info_of__adaptHeight: Info = {isNode:true, type: ShortAttribETypes.EBoolean, label:\"adapt height\",\r\n        txt: 'Whether the element should expand his height to accomodate his own contents.'}\r\n\r\n    draggable!: boolean;\r\n    __info_of__draggable: Info = {isNode: true, type: ShortAttribETypes.EBoolean, txt: 'if the element can be dragged'}\r\n\r\n    resizable!: boolean;\r\n    __info_of__resizable: Info = {isNode: true, type: ShortAttribETypes.EBoolean, txt: 'if the element can be resized'}\r\n\r\n    oclCondition!: string; // ocl selector\r\n    __info_of__oclCondition: Info = {isGlobal: true, hidden:true, label:\"OCL apply condition\", type: \"text\", // TODO: what's the difference with this.query?\r\n        txt: 'OCL Query selector to determine which nodes or model elements should apply this view'}\r\n    protected get_oclCondition(context: Context): this['oclCondition'] {\r\n        return context.data.oclCondition;\r\n    }\r\n    set_oclCondition(val: string, context: Context): boolean {\r\n        val = (val || '').trim();\r\n        if (val === context.data.oclCondition) return true;\r\n        TRANSACTION(()=>{\r\n            SetFieldAction.new(context.data, 'oclCondition', val, '', false);\r\n            SetRootFieldAction.new('VIEWS_RECOMPILE_ocl', context.data.id, '+=', false); // it is pointer, but for transient stuff there is no need to set pointedby's\r\n        })\r\n        return true;\r\n    }\r\n\r\n    jsCondition!: string; // js selector\r\n    __info_of__jsCondition: Info = {isGlobal: true, hidden:true, label:\"js apply condition\", type: \"text\",\r\n        txt: 'js Query selector to determine which nodes or model elements should apply this view'}\r\n    protected get_jsCondition(context: Context): this['jsCondition'] {\r\n        return context.data.jsCondition;\r\n    }\r\n    set_jsCondition(val: string, context: Context): boolean {\r\n        val = (val || '').trim();\r\n        if (val === context.data.jsCondition) return true;\r\n        TRANSACTION(()=>{\r\n            SetFieldAction.new(context.data, 'jsCondition', val, '', false);\r\n            SetRootFieldAction.new('VIEWS_RECOMPILE_jsCondition', context.data.id, '+=', false);\r\n        })\r\n        return true;\r\n    }\r\n\r\n    // todo: how about allowing a view to be part in multiple vp's? so this reference would be an array or removed, and you navigate only from vp to v.\r\n    viewpoint!: LViewPoint;\r\n    __info_of__viewpoint: Info = {hidden: true, type: LViewPoint.cname, txt: <div>The collection of views containing this one, useful to activate multiple views at once.</div>}\r\n\r\n    display!: 'block'|'contents';\r\n    __info_of__display: Info = {obsolete: true, isNode: true, type: ShortAttribETypes.EString,\r\n        txt: 'complete css injection instead'}\r\n\r\n    onDragStart!: string;\r\n    __info_of__onDragStart: Info = {isNode: true, type: \"Function():void\",\r\n        txt: 'Custom event activated when a node begins being dragged.'}\r\n    protected get_onDragStart(context: Context): this['onDragStart'] {\r\n        return context.data.onDragStart;\r\n    }\r\n    protected set_onDragStart(val: this['onDragStart'], context: Context): boolean {\r\n        TRANSACTION(()=>{\r\n            SetFieldAction.new(context.data, 'onDragStart', val, '', false);\r\n            SetRootFieldAction.new('VIEWS_RECOMPILE_onDragStart', context.data.id, '+=', false);\r\n        })\r\n        return true;\r\n    }\r\n\r\n    onDragEnd!: string;\r\n    __info_of__onDragEnd: Info = {isNode: true, type: \"Function():void\",\r\n        txt: 'Custom event activated when a node finishes being dragged.'}\r\n    protected get_onDragEnd(context: Context): this['onDragEnd'] {\r\n        return context.data.onDragEnd;\r\n    }\r\n    protected set_onDragEnd(val: this['onDragEnd'], context: Context): boolean {\r\n        TRANSACTION(()=>{\r\n            SetFieldAction.new(context.data, 'onDragEnd', val, '', false);\r\n            SetRootFieldAction.new('VIEWS_RECOMPILE_onDragEnd', context.data.id, '+=', false);\r\n        })\r\n        return true;\r\n    }\r\n\r\n    whileDragging!: string;\r\n    __info_of__whileDragging: Info = {isNode: true, type: \"Function():void\",\r\n        txt: 'Custom event activated multiple times when mouse is moved while a node is being dragged.'}\r\n    protected get_whileDragging(context: Context): this['whileDragging'] {\r\n        return context.data.whileDragging;\r\n    }\r\n    protected set_whileDragging(val: this['whileDragging'], context: Context): boolean {\r\n        TRANSACTION(()=>{\r\n            SetFieldAction.new(context.data, 'whileDragging', val, '', false);\r\n            SetRootFieldAction.new('VIEWS_RECOMPILE_whileDragging', context.data.id, '+=', false);\r\n        })\r\n        return true;\r\n    }\r\n\r\n    onResizeStart!: string;\r\n    __info_of__onResizeStart: Info = {isNode: true, type: \"Function():void\",\r\n    txt: 'Custom event activated when a node begins being resized.'}\r\n    protected get_onResizeStart(context: Context): this['onResizeStart'] {\r\n        return context.data.onResizeStart;\r\n    }\r\n    protected set_onResizeStart(val: this['onResizeStart'], context: Context): boolean {\r\n        TRANSACTION(()=>{\r\n            SetFieldAction.new(context.data, 'onResizeStart', val, '', false);\r\n            SetRootFieldAction.new('VIEWS_RECOMPILE_onResizeStart', context.data.id, '+=', false);\r\n        })\r\n        return true;\r\n    }\r\n\r\n    onResizeEnd!: string;\r\n    __info_of__onResizeEnd: Info = {isNode: true, type: \"Function():void\",\r\n        txt: 'Custom event activated when a node finishes being resized.'}\r\n    protected get_onResizeEnd(context: Context): this['onResizeEnd'] {\r\n        return context.data.onResizeEnd;\r\n    }\r\n    protected set_onResizeEnd(val: this['onResizeEnd'], context: Context): boolean {\r\n        TRANSACTION(()=>{\r\n            SetFieldAction.new(context.data, 'onResizeEnd', val, '', false);\r\n            SetRootFieldAction.new('VIEWS_RECOMPILE_onResizeEnd', context.data.id, '+=', false);\r\n        })\r\n        return true;\r\n    }\r\n\r\n    whileResizing!: string;\r\n    __info_of__whileResizing: Info = {isNode: true, type: \"Function():void\",\r\n        txt: 'Custom event activated multiple times when mouse is moved while a node is being resized.'}\r\n    protected get_whileResizing(context: Context): this['whileResizing'] {\r\n        return context.data.whileResizing;\r\n    }\r\n    protected set_whileResizing(val: this['whileResizing'], context: Context): boolean {\r\n        TRANSACTION(()=>{\r\n            SetFieldAction.new(context.data, 'whileResizing', val, '', false);\r\n            SetRootFieldAction.new('VIEWS_RECOMPILE_whileResizing', context.data.id, '+=', false);\r\n        })\r\n        return true;\r\n    }\r\n\r\n    onRotationStart!: string;\r\n    __info_of__onRotationStart: Info = {isNode: true, type: \"Function():void\",\r\n    txt: 'Custom event activated when a node begins being rotated.'}\r\n    protected get_onRotationStart(context: Context): this['onRotationStart'] {\r\n        return context.data.onRotationStart;\r\n    }\r\n    protected set_onRotationStart(val: this['onRotationStart'], context: Context): boolean {\r\n        TRANSACTION(()=>{\r\n            SetFieldAction.new(context.data, 'onRotationStart', val, '', false);\r\n            SetRootFieldAction.new('VIEWS_RECOMPILE_onRotationStart', context.data.id, '+=', false);\r\n        })\r\n        return true;\r\n    }\r\n\r\n    onRotationEnd!: string;\r\n    __info_of__onRotationEnd: Info = {isNode: true, type: \"Function():void\",\r\n        txt: 'Custom event activated when a node finishes being rotated.'}\r\n    protected get_onRotationEnd(context: Context): this['onRotationEnd'] {\r\n        return context.data.onRotationEnd;\r\n    }\r\n    protected set_onRotationEnd(val: this['onRotationEnd'], context: Context): boolean {\r\n        TRANSACTION(()=>{\r\n        SetFieldAction.new(context.data, 'onRotationEnd', val, '', false);\r\n        SetRootFieldAction.new('VIEWS_RECOMPILE_onRotationEnd', context.data.id, '+=', false);\r\n        })\r\n        return true;\r\n    }\r\n\r\n    whileRotating!: string;\r\n    __info_of__whileRotating: Info = {isNode: true, type: \"Function():void\",\r\n        txt: 'Custom event activated multiple times when mouse is moved while a node is being rotated.'}\r\n    protected get_whileRotating(context: Context): this['whileRotating'] {\r\n        return context.data.whileRotating;\r\n    }\r\n    protected set_whileRotating(val: this['whileRotating'], context: Context): boolean {\r\n        TRANSACTION(()=>{\r\n            SetFieldAction.new(context.data, 'whileRotating', val, '', false);\r\n            SetRootFieldAction.new('VIEWS_RECOMPILE_whileRotating', context.data.id, '+=', false);\r\n        })\r\n        return true;\r\n    }\r\n\r\n    onDataUpdate!: string;\r\n    __info_of__onDataUpdate: Info = {isNode: true, type: \"Function():void\",\r\n        txt: 'Custom event activated every time a property of his model, node or view is changed while the element is visibly rendered in a graph.\\n<br>Caution! this might cause loops.'}\r\n    protected get_onDataUpdate(context: Context): this['onDataUpdate'] {\r\n        return context.data.onDataUpdate;\r\n    }\r\n    protected set_onDataUpdate(val: this['onDataUpdate'], context: Context): boolean {\r\n        TRANSACTION(()=>{\r\n            SetFieldAction.new(context.data, 'onDataUpdate', val, '', false);\r\n            SetRootFieldAction.new('VIEWS_RECOMPILE_onDataUpdate', context.data.id, '+=', false);\r\n        })\r\n        return true;\r\n    }\r\n\r\n    events!: Dictionary<DocString<\"functionName\">, ((...a:any)=>any)>;\r\n    event!:  Dictionary<DocString<\"functionName\">, ((...a:any)=>any)>;\r\n    __info_of__events: Info = {todo: true, isGlobal: true, type: \"Dictionary<name, function>\",\r\n        txt: <div>Custom events callable through JSX user interaction<br/>eg: &lt;div onClick=&#123;()=&gt;view.eventname()&#125; /&gt;</div>}\r\n    __info_of__event: Info = {todo: true, isGlobal: true, type: \"Dictionary<name, function>\", txt: 'Alias for this.events'}\r\n    protected get_event(c: Context): this['events'] { return this.get_events(c); }\r\n    protected get_events(c: Context): this['events'] {\r\n        Log.exx(\"use node.events instead\", U.getStackTrace());\r\n        return {};\r\n        // return transientProperties.view[c.data.id]?.events || {};\r\n    }\r\n    protected set_events(val: DViewElement[\"events\"], context: Context): boolean {\r\n        const addUD = true;\r\n        TRANSACTION(()=> {\r\n            SetFieldAction.new(context.data, 'events', val, '+=', false);\r\n            SetRootFieldAction.new('VIEWS_RECOMPILE_events', {\r\n                vid: context.data.id,\r\n                keys: Object.keys(val)\r\n            }, '+=', false);\r\n            let udstr = context.data.usageDeclarations;\r\n            if (!addUD || !udstr) return;\r\n            let delta = U.objectDelta(context.data.events, val, false);\r\n            for (let key in delta) {\r\n                let v = val[key];\r\n                let autogenstr = 'ret.' + key + ' = node.events.'+key+'; // @autogenerated, do not edit\\n';\r\n                if (!v) udstr = udstr.split(autogenstr).join('');\r\n                else {\r\n                    if (!context.data.events[key]) { // insert\r\n                        let findstr = '// ** declarations here ** //\\n';\r\n                        let insertat = udstr.indexOf(findstr);\r\n                        if (insertat === -1) continue; // malformed ud, will skip\r\n                        insertat += findstr.length;\r\n                        udstr = udstr.substring(0, insertat) + autogenstr + udstr.substring(insertat);\r\n                    } else {\r\n                        // just updated func body, no name changed, no need to update UD.\r\n                    }\r\n                }\r\n            }\r\n            if (udstr === context.data.usageDeclarations) return;\r\n            SetFieldAction.new(context.data, 'usageDeclarations', udstr, '', false);\r\n            SetRootFieldAction.new('VIEWS_RECOMPILE_usageDeclarations', context.data.id, '+=', false);\r\n        })\r\n        return true;\r\n    }\r\n\r\n    constraints!: GObject<\"todo, used in Vertex. they are triggered by events (view.onDragStart....) and can bound the size of the vertex\">[];\r\n    __info_of__constraints: Info = {todo: true, isNode: true, type: \"Function():void\",\r\n        txt: 'not supported yet'}\r\n\r\n\r\n    bendingMode!: EdgeBendingMode;\r\n    __info_of__bendingMode: Info = {isEdge: true, enum: EdgeBendingMode, type: '\"L\" | \"Q\" | \"C\" | \"T\" | \"S\" | \"A\" | \"QT\" | \"CS\"',\r\n        label:\"path mode\",\r\n        txt: <><div>How Svg path should use the EdgePoints to bend his shape{/*<a href={\"https://css-tricks.com/svg-path-syntax-illustrated-guide/\"}>to bend his shape</a>*/}</div></>}\r\n\r\n    edgeGapMode!: EdgeGapMode;\r\n    __info_of__edgeGapMode: Info = {isEdge: true, enum: EdgeGapMode, type: '\"gap\" | \"average\" | \"autoFill\" | \"lineFill\" | \"arcFill\"',\r\n        label:\"gap mode\",\r\n        txt: <><div>How the segment should treat the EdgePoint interruptions.<br/>\"gap\" leaves an empty space to not overlap the EdgePoint,\r\n            <br/>\"linefill\" makes the edge stop at the EdgePoint borders, but then connects the gap with a line.</div></>}\r\n\r\n    /*\r\n    bindVertexSizeToView!: boolean;\r\n    __info_of__bindVertexSizeToView: Info = {isNode:true, type:ShortAttribETypes.EBoolean, label:\"bind sizes to view\",\r\n        txt: <div>Store the vertex size inside the view instead of inside the vertex.\r\n            <br/>This causes the vertex to have different positions according to the view currently appied to it.</div>}*/\r\n    storeSize!: boolean;\r\n    __info_of__storeSize: Info = {isNode: true, type: ShortAttribETypes.EBoolean, label:\"bind sizes to view\",\r\n        txt: \"Active: the node position depends from the view currently displayed.Inactive: it depends from the graph.\"}\r\n\r\n    lazySizeUpdate!: boolean;\r\n    __info_of__lazySizeUpdate: Info = {isNode: true, type: ShortAttribETypes.EBoolean, txt: <div>If true updates the node position only when the drag action is finished. (best performance)</div>}\r\n\r\n    edgeStartOffset!: GraphPoint;\r\n    __info_of__edgeStartOffset: Info = {isEdge: true, type: GraphPoint.cname, label:\"start offset\",\r\n        txt: \"Location where outgoing edges should start their path, relative to top-upper corner of the element.\"}\r\n\r\n    edgeEndOffset!: GraphPoint;\r\n    __info_of__edgeEndOffset: Info = {isEdge: true,  type: GraphPoint.cname, label:\"end offset\",\r\n        txt: 'Same as this.edgeStartOffset'}\r\n\r\n\r\n    edgeStartOffset_isPercentage!: boolean;\r\n    __info_of__edgeStartOffset_isPercentage: Info = {isEdge: true, type:ShortAttribETypes.EBoolean, label:\"start offset is a %\",\r\n        txt: <div>Whether edgeStartOffset is an absolute value or a percentage.<br/>(eg: 50% of element width, vs 50 pixels flat).</div>}\r\n\r\n    edgeEndOffset_isPercentage!: boolean;\r\n    __info_of__edgeEndOffset_isPercentage: Info = {isEdge: true, type:ShortAttribETypes.EBoolean, label:\"end offset is a %\",\r\n        txt: <div>Whether edgeStartOffset is an absolute value or a percentage.<br/>(eg: 50% of element width, vs 50 pixels flat).</div>}\r\n\r\n\r\n    edgeStartStopAtBoundaries!: boolean;\r\n    __info_of__edgeStartStopAtBoundaries: Info = {isEdge: true, type:ShortAttribETypes.EBoolean, label:\"start cannot cross boundaries\",\r\n        txt: <div>Whether outgoing edges should cross the node boundaries overlapping the node\\'s html or stop at them.<br/>Edge arrows might enter the node if this is on.</div>}\r\n\r\n    edgeEndStopAtBoundaries!: boolean;\r\n    __info_of__edgeEndStopAtBoundaries: Info = {isEdge: true, type: ShortAttribETypes.EBoolean, label:\"end cannot cross boundaries\",\r\n        txt: <div>Whether incoming edges should cross the node boundaries overlapping the node\\'s html or stop at them.<br/>Edge arrows might enter the node if this is on.</div>}\r\n\r\n\r\n    edgePointCoordMode!: CoordinateMode;\r\n    __info_of__edgePointCoordMode: Info = {isEdgePoint: true, type: \"CoordinateMode\", enum: CoordinateMode, label:\"coordinate mode\",\r\n        txt:<div>Store coordinates as absolute coordinates or relative to start/end nodes.</div>}\r\n    set_edgePointCoordMode(val: CoordinateMode, c: Context): boolean {\r\n        TRANSACTION(()=>{\r\n            setTimeout(()=>{ // needs to be done after coordinatemode change is applied\r\n                let s: DState = store.getState();\r\n                for (let nid in transientProperties.node) {\r\n                    let tn = transientProperties.node[nid];\r\n                    if (!tn || tn.mainView?.id !== c.data.id) continue;\r\n                    let lnode: LEdgePoint = LPointerTargetable.fromPointer(nid, s);\r\n                    let triggerCoordinateModeChange = lnode as any;\r\n                    triggerCoordinateModeChange.size = lnode.size;\r\n                }\r\n            }, 100);\r\n            SetFieldAction.new(c.data, 'edgePointCoordMode', val, '', false);\r\n        })\r\n        return true;\r\n    }\r\n\r\n    edgeHeadSize!: GraphPoint;\r\n    __info_of__edgeHeadSize: Info = {isEdge: true, type:GraphPoint.cname, label:\"head decorator size\", txt:<div>Size of the edge head decorator if present.</div>}\r\n\r\n    edgeTailSize!: GraphPoint;\r\n    __info_of__edgeTailSize: Info = {isEdge: true, type:GraphPoint.cname, label:\"tail decorator size\", txt:<div>Size of the tail head decorator if present.</div>}\r\n\r\n    protected size!: Dictionary<Pointer<DModelElement> | Pointer<DGraphElement>, GraphSize>; // use getSize, updateSize;\r\n    __info_of__size: Info = {isNode: true, hidden:true, type: ShortAttribETypes.EInt,\r\n        txt:<div>Do not use directly, contains all the sizes stored in this view. use getSize, updateSize instead.</div>}\r\n\r\n\r\n    __info_of__updateSize: Info = {isNode:true, hidden:true, type:\"Function(Pointer<GraphElement | ModelElement>, GraphSize) => GraphSize\",\r\n        txt:<div>Updates the size stored in this view for target element.<br/>@returns: the delta of the change between old value and new value.</div>}\r\n    __info_of__getSize: Info = {isNode:true, hidden:true, type:\"Function(Pointer<GraphElement | ModelElement>) => GraphSize\",\r\n        txt:<div>Gets the size stored in this view for target element.</div>}\r\n\r\n    // public _parsedConstants!: GObject;\r\n    // public get__parsedConstants(c: Context): this['_parsedConstants'] { return c.data._parsedConstants || {}; }\r\n\r\n    public get_constants(c: Context): this['constants'] {\r\n        return c.data.constants;\r\n    }\r\n\r\n\r\n    public static parseConstants(funcCode?: string): GObject | undefined {\r\n        if (!funcCode) return {};\r\n        let parsedConstants: GObject = {};\r\n        let context: GObject = {__param: parsedConstants};\r\n        context.__proto__ = windoww.defaultContext;\r\n        try{\r\n            let parsedFunc = U.parseFunctionWithContextAndScope(funcCode, context, context, ['ret']);\r\n            parsedFunc(context, parsedConstants);\r\n            // U.evalInContextAndScopeNew( \"(\"+funcCode+\")(this.__param)\", context, true, false, false);\r\n        } catch (e: any) {\r\n            Log.ee(\"Attempted to save an invalid view.constant setup. Cause:\\n\" + e.message.split(\"\\n\")[0], e)\r\n            return undefined;\r\n        }\r\n        return parsedConstants;\r\n    }\r\n\r\n    public set_constants(value: this['constants'], c: Context): boolean {\r\n        if (value === c.data.constants) return true;\r\n        TRANSACTION(()=> {\r\n            SetFieldAction.new(c.data.id, 'constants', value, '', false);\r\n            SetRootFieldAction.new('VIEWS_RECOMPILE_constants', c.data.id, '+=', false);\r\n            SetFieldAction.new(c.data.id, \"css_MUST_RECOMPILE\", true, '', false);\r\n        })\r\n        return true;\r\n    }\r\n\r\n    public get_preRenderFunc(c: Context): this['preRenderFunc'] {\r\n        return c.data.preRenderFunc;\r\n    }\r\n    public set_preRenderFunc(value: this['preRenderFunc'], c: Context): boolean {\r\n        const _value = value ? value : '() => {}';\r\n        return SetFieldAction.new(c.data.id, 'preRenderFunc', _value, '', false);\r\n    }\r\n\r\n    public get_edgeHeadSize(c: Context): this[\"edgeHeadSize\"] { return new GraphPoint(c.data.edgeHeadSize.x, c.data.edgeHeadSize.y); }\r\n    public get_edgeTailSize(c: Context): this[\"edgeTailSize\"] { return new GraphPoint(c.data.edgeTailSize.x, c.data.edgeTailSize.y); }\r\n    public set_edgeHeadSize(v: Partial<this[\"edgeHeadSize\"]>, c: Context): boolean {\r\n        let s = c.data.edgeHeadSize || new GraphPoint(0, 0);\r\n        if (!(\"x\" in v)) v.x = s.x;\r\n        if (!(\"y\" in v)) v.y = s.y;\r\n        TRANSACTION(()=>{\r\n            SetFieldAction.new(c.data.id, \"css_MUST_RECOMPILE\", true, '', false);\r\n            SetFieldAction.new(c.data.id, \"edgeHeadSize\", v as GraphPoint, '', false);\r\n        });\r\n        return true; }\r\n    public set_edgeTailSize(v: Partial<this[\"edgeTailSize\"]>, c: Context): boolean {\r\n        let s = c.data.edgeTailSize || new GraphPoint(0, 0);\r\n        if (!(\"x\" in v)) v.x = s.x;\r\n        if (!(\"y\" in v)) v.y = s.y;\r\n        TRANSACTION(()=>{\r\n            SetFieldAction.new(c.data.id, \"css_MUST_RECOMPILE\", true, '', false);\r\n            SetFieldAction.new(c.data.id, \"edgeTailSize\", v as GraphPoint, '', false);\r\n        });\r\n        return true;\r\n    }\r\n\r\n    public get_viewpoint(context: Context): this[\"viewpoint\"] {\r\n        return (LViewPoint.fromPointer(context.data.viewpoint as Pointer<DViewPoint>));\r\n    }\r\n    // public set_subViews(v: Pointer<DViewPoint>[], context: Context): boolean { return this.cannotSet('subViews, call set_viewpoint on the sub-elements instead.'); }\r\n\r\n    // WARNING!! if there are mass vp assignments, preserveOrder=true will cause a vp to \"lose\" subviews and keep only the last assigned.\r\n    public set_viewpoint(v: Pointer<DViewPoint>, context: Context, manualDview?: DViewElement, preserveOrder: boolean = false): boolean {\r\n        let ret = false;\r\n        let vpid: Pointer<DViewPoint> = v && Pointers.from(v);\r\n        const data =  (manualDview || context.data);\r\n        let id = data.id;\r\n        let oldvpid: Pointer<DViewPoint> = data.viewpoint;\r\n        if (vpid === oldvpid) return true;\r\n\r\n        TRANSACTION(()=>{\r\n            ret = SetFieldAction.new(id, \"viewpoint\", vpid, '', true);\r\n            if (oldvpid) {\r\n                let subViews = {...DPointerTargetable.fromPointer(oldvpid).subViews};\r\n                delete subViews[id];\r\n                SetFieldAction.new(oldvpid, \"subViews\", subViews, '', true);\r\n            }\r\n            if (vpid) {\r\n                let name = data.name;\r\n                let copyPos = name.indexOf(\"Copy\");\r\n                let oldSubViews = DPointerTargetable.fromPointer(vpid).subViews;\r\n                let insertBefore: string = '';\r\n                let subViews: GObject = {};\r\n                if (copyPos) {\r\n                    let copiedFromName: string = copyPos ? name.substring(0, copyPos).trim() : '';\r\n                    if (copiedFromName in oldSubViews) insertBefore = copiedFromName;\r\n                    else {\r\n                        for (let key in oldSubViews) if (key.indexOf(copiedFromName) === 0) { insertBefore = key; break; }\r\n                    }\r\n                }\r\n\r\n\r\n                // WARNING!! if there are mass vp assignments, this will cause a vp to \"lose\" subviews and keep only the last assigned.\r\n                if (preserveOrder && insertBefore) {\r\n                    subViews = {};\r\n                    for (let key in oldSubViews) {\r\n                        subViews[key] = oldSubViews[key];\r\n                        // just to reinsert subviews **in order** so Object.keys() fits the new subview near the cloned one.\r\n                        if (key === insertBefore) subViews[id] = subViews[insertBefore];\r\n                    }\r\n                } else { subViews = {...oldSubViews}; subViews[id] = 1.5; }\r\n                subViews[id] = insertBefore ? subViews[insertBefore] : 1.5;\r\n                SetFieldAction.new(vpid, \"subViews\", subViews, '+=', true);\r\n            }\r\n        })\r\n        return ret;\r\n    }\r\n\r\n\r\n    public get_subViews(context: Context, key: string): LViewElement[]{\r\n        let subViewsPointers = context.data.subViews;\r\n        let subViews: LViewElement[] = [];\r\n        for (let pointer in subViewsPointers) {\r\n            let item: LViewElement = MyProxyHandler.wrap(pointer);\r\n            if (item !== undefined) subViews.push(item);\r\n        }\r\n        return subViews;\r\n    }\r\n\r\n    // returns the delta of change\r\n    public updateSize(id: Pointer<DModelElement> | Pointer<DGraphElement>, size: Partial<GraphSize>): boolean { return this.wrongAccessMessage(\"updateSize\"); }\r\n    public get_updateSize(context: Context): this[\"updateSize\"] {\r\n        return (id: Pointer<DModelElement> | Pointer<DGraphElement>, size0: Partial<GraphSize>) => {\r\n            let size: EPSize = size0 as any;\r\n            let vp = context.proxyObject.viewpoint;\r\n            if (!context.data.storeSize) {\r\n                if (vp?.storeSize) return vp.updateSize(id, size);\r\n                return false;\r\n            }\r\n            let vsize: EPSize = (context.data.size[id] || vp?.__raw.size[id]) as EPSize;\r\n            let newSize: EPSize = new GraphSize() as EPSize;\r\n            if (size.currentCoordType === vsize.currentCoordType) { // if samecoord system mix them.\r\n                newSize.x = size?.x !== undefined ? size.x : vsize.x;\r\n                newSize.y = size?.y !== undefined ? size.y : vsize.y;\r\n            } else if (size.x !== undefined && size.y !== undefined) { // if different coord system pick all of size\r\n                newSize.x = size.x;\r\n                newSize.y = size.y;\r\n                newSize.currentCoordType = size.currentCoordType || CoordinateMode.absolute;\r\n            } else if (vsize.x !== undefined && vsize.y !== undefined) { // or all of vsize if size was invalid\r\n                newSize.x = vsize.x;\r\n                newSize.y = vsize.y;\r\n                newSize.currentCoordType = vsize.currentCoordType || CoordinateMode.absolute;\r\n            }\r\n            let defaultsize = context.data.defaultVSize || vp?.__raw.defaultVSize;\r\n            if (newSize.x === undefined || newSize.y === undefined) { // only if pos is invalid, i take defaultvsize and force to use coord absolute.\r\n                newSize = new GraphSize().clone(defaultsize) as EPSize;\r\n                newSize.currentCoordType = CoordinateMode.absolute;\r\n            }\r\n            // w and h are always absolute so they can be mixed to whathever coordinate mode indipendently from the rest.\r\n            newSize.w = size?.w !== undefined ? size.w : vsize.w;\r\n            newSize.h = size?.h !== undefined ? size.h : vsize.h;\r\n            if (newSize.h === undefined) newSize.h = defaultsize.h || 10;\r\n            if (newSize.w === undefined) newSize.w = defaultsize.w || 10;\r\n\r\n            if (!newSize.equals(vsize)) SetFieldAction.new(context.data.id, \"size.\" + id as any, newSize);\r\n            return true;\r\n        }\r\n    }\r\n\r\n    public get_defaultVSize(context: Context): this[\"defaultVSize\"]{ return context.data.defaultVSize; }\r\n    public getSize(id: Pointer<DModelElement> | Pointer<DGraphElement>): GraphSize | undefined{ return this.wrongAccessMessage(\"getSize\"); }\r\n    public get_getSize(context: Context): ((...a:Parameters<this[\"getSize\"]>)=>ReturnType<LViewElement[\"getSize\"]>) {\r\n        function impl_getSize(id: Pointer<DModelElement> | Pointer<DGraphElement>): ReturnType<LViewElement[\"getSize\"]> {\r\n            if (typeof id === \"object\") id = (id as any).id;\r\n            let view = context.data;\r\n            let ret: GraphSize;\r\n            if (view.storeSize){\r\n                ret = view.size[id];\r\n                if(ret) return ret; }\r\n            let vp = context.proxyObject.viewpoint;\r\n            if (vp && view.id !== vp.id && vp.storeSize){\r\n                ret = vp.size[id];\r\n                if (ret) return ret; }\r\n            return undefined;\r\n        }\r\n\r\n        return impl_getSize; }\r\n\r\n    set_generic_entry(context: Context, key: keyof DViewElement, val: any): boolean {\r\n        console.log('set_generic_entry', {context, key, val});\r\n        SetFieldAction.new(context.data, key, val);\r\n        return true;\r\n    }\r\n\r\n    get_children(context: Context): never[] { return []; }\r\n\r\n\r\n    get_lazySizeUpdate(context: Context): D[\"lazySizeUpdate\"] { return Debug.lightMode || context.data.lazySizeUpdate; }\r\n    set_lazySizeUpdate(val: D[\"lazySizeUpdate\"], context: Context): boolean {\r\n        return Debug.lightMode || this.set_generic_entry(context, 'lazySizeUpdate', val);\r\n    }\r\n\r\n    get_bendingMode(context: Context): D[\"bendingMode\"] { return context.data.bendingMode; }\r\n    set_bendingMode(val: D[\"bendingMode\"], context: Context): boolean {\r\n        return this.set_generic_entry(context, 'bendingMode', val);\r\n    }\r\n\r\n    set_appliableTo(val: this[\"appliableTo\"], c: Context): boolean { // appliableTo >= forcenodetype\r\n        if (!val) val = 'Any';\r\n        let forceNodeType: string = c.data.forceNodeType as string;\r\n        if (forceNodeType !== val) switch(val) {\r\n            // case \"Any\": break;\r\n            default: forceNodeType = val;\r\n        }\r\n\r\n        console.log(\"set_appliableTo\", {forceNodeType, val});\r\n        BEGIN()\r\n        if (forceNodeType !== c.data.forceNodeType) SetFieldAction.new(c.data, \"forceNodeType\", forceNodeType, '', false);\r\n        SetFieldAction.new(c.data, \"appliableTo\", val, '', false);\r\n        END();\r\n        return true;\r\n    }\r\n    set_forceNodeType(val: this[\"forceNodeType\"], c: Context): boolean {\r\n        if (!val) val = 'Any';\r\n        /*let appliableTo: string = c.data.appliableTo as string;\r\n        if (appliableTo !== val) switch (appliableTo){\r\n            case undefined: case 'Any': break;\r\n            //case 'GraphVertex': if ((appliableTo as any) !== 'Graph' && (appliableTo as any) !== 'Vertex') appliableTo = val; break;\r\n            default: appliableTo = val; break;\r\n        }*/\r\n        BEGIN()\r\n        // if (appliableTo !== c.data.appliableTo) SetFieldAction.new(c.data, \"appliableTo\", appliableTo, '', false);\r\n        SetFieldAction.new(c.data, \"forceNodeType\", val, '', false);\r\n        END();\r\n        return true;\r\n    }\r\n    get_appliableToClasses(context: Context): this[\"appliableToClasses\"] { return context.data.appliableToClasses || []; }\r\n    set_appliableToClasses(val: this[\"appliableToClasses\"], context: Context): boolean {\r\n        if (!val) val = [];\r\n        else if (!Array.isArray(val)) val = [val];\r\n        val.sort();\r\n        let hasChanged: boolean;\r\n        if (val.length === context.data.appliableToClasses?.length) {\r\n            hasChanged = false;\r\n            for (let i = 0; i < val.length; i++) if (val[i] !== context.data.appliableToClasses[i]) { hasChanged = true; break; }\r\n        } else hasChanged = true;\r\n\r\n        if (!hasChanged) return true;\r\n        TRANSACTION(()=>{\r\n            this.set_generic_entry(context, \"appliableToClasses\", val);\r\n            SetRootFieldAction.new('VIEWS_RECOMPILE_preconditions', context.data.id, '+=', false);\r\n        })\r\n        return true;\r\n    }\r\n\r\n    set_defaultVSize(val: GraphSize, c: Context): boolean{\r\n        if (!val || typeof val !== \"object\") return true;\r\n        let x = val.x ?? +val.x;\r\n        let y = val.y ?? +val.y;\r\n        let w = val.w ?? +val.w;\r\n        let h = val.h ?? +val.h;\r\n        if (isNaN(x)) x = c.data.defaultVSize.x;\r\n        if (isNaN(y)) y = c.data.defaultVSize.y;\r\n        if (isNaN(w)) w = c.data.defaultVSize.w;\r\n        if (isNaN(h)) h = c.data.defaultVSize.h;\r\n        if (x === c.data.defaultVSize.x && y === c.data.defaultVSize.y && w === c.data.defaultVSize.w && h === c.data.defaultVSize.h) return true;\r\n        SetFieldAction.new(c.data, 'defaultVSize', {x, y, w, h} as any, '', false);\r\n        return true\r\n    }\r\n\r\n\r\n    public duplicate(deep: boolean = true, new_vp?: DuplicateVPChange): this {\r\n        return this.wrongAccessMessage( (this.constructor as typeof RuntimeAccessibleClass).cname + \"duplicate()\"); }\r\n    protected get_duplicate(c: Context): ((deep?: boolean, new_vp?: DuplicateVPChange) => LViewElement) {\r\n        return (deep: boolean = false, new_vp0?: DuplicateVPChange) => {\r\n            console.log(\"DViewelement.duplicate\", {cn: c.data.className, n:c.data.name, deep, new_vp0});\r\n            let lview: LViewElement = undefined as any;\r\n            let state: DState = store.getState();\r\n            TRANSACTION( () => {\r\n                let pvid: Pointer<DViewPoint> = c.data.viewpoint as Pointer<DViewPoint>;\r\n                const dclone: DViewElement = c.data.className === 'DViewPoint' ?\r\n                    DViewPoint.new2(`${c.data.name} Copy`, '', undefined, true) :\r\n                    DViewElement.new2(`${c.data.name} Copy`, '', undefined, true, 'skip');\r\n                lview = LPointerTargetable.fromD(dclone);\r\n                const new_vp: DuplicateVPChange = new_vp0 || {pvid};\r\n                // || {pvid,  score: (DPointerTargetable.from(pvid, state) as DViewElement).subViews[c.data.id]}\r\n\r\n                for (let key in c.data) {\r\n                    switch(key) {\r\n                        case 'subViews':\r\n                            // duplicate childrens only if deep\r\n                            if (!deep) break;\r\n                            // let subviews: Dictionary<Pointer, number> = {}\r\n                            for (const oldvid in c.data.subViews) {\r\n                                const oldScore = c.data.subViews[oldvid];\r\n                                (LPointerTargetable.fromPointer(oldvid, state) as LViewElement).duplicate(deep, {pvid:dclone.id/*, score:oldScore*/});\r\n                                // then everything is set inside case 'viewpoint' of subviews cloning\r\n                            }\r\n                            //lview.subViews = subviews as any;\r\n                            break;\r\n                        case 'father':\r\n                        case 'viewpoint':\r\n                            // update parent view\r\n                            /*\r\n                            let subviews: Dictionary<Pointer, number> = {};\r\n                            subviews[dclone.id] = new_vp.score;\r\n                            SetFieldAction.new(new_vp.pvid, 'subViews', subviews, '+=', true);\r\n                            SetFieldAction.new(dclone.id, 'viewpoint', new_vp.pvid, '+=', true);*/\r\n                            // insert in-place right after the cloned view, with old score.\r\n                            this.set_viewpoint(new_vp.pvid, undefined as any, dclone, !deep);\r\n                            // SetFieldAction.new(dclone.id, 'father', new_vp.vpid, '+=', true);\r\n                            break;\r\n                        case '':\r\n                        case 'id':\r\n                        case 'name':\r\n                        case 'className':\r\n                        case 'pointedBy':\r\n                        case '_storePath':\r\n                        case '_subMaps':\r\n                        case 'clonedCounter': break;\r\n                        case 'css_MUST_RECOMPILE': break;\r\n\r\n                        case 'isValidation':\r\n                            console.log(\"duplicate \" + c.data.name + \" set isvalidation\", {data:c.data, iv:c.data.isValidation});\r\n                            (lview as any)[key] = (c.data as any)[key];\r\n                            break;\r\n                        default:\r\n                            try {\r\n                                (lview as any)[key] = (c.data as any)[key];\r\n                            } catch(e) {\r\n                            //    Log.ee('Error on duplicate view:', e);\r\n                            }\r\n                    }\r\n                }\r\n\r\n                // insert in viewpoint.subview\r\n                //let defaultViews: Dictionary<Pointer, boolean> = Defaults.defaultViewsMap;\r\n                let vp: LViewPoint = c.proxyObject.viewpoint;\r\n                // let oldViews: Pointer<DViewElement>[] = Object.keys(vp.__raw.subViews);\r\n                // if (Defaults.viewpoints.indexOf(vpid)) oldViews = oldViews.filter( vid => !defaultViews[vid]);\r\n                // let i: number = oldViews.indexOf(c.data.id);\r\n                /*\r\n                if (i === -1) oldViews.push(dclone.id);\r\n                else oldViews.splice(i+1, 0, dclone.id); // insert in-place right after the cloned view\r\n                vp.subViews = oldViews as any;*/\r\n                // SetRootFieldAction.new('stackViews', dview.id, '+=', true);\r\n\r\n\r\n                const isVP = c.data.className === 'DViewPoint';\r\n                if (isVP) SetRootFieldAction.new(`viewpoints`, c.data.id, '+=', true);\r\n                else SetRootFieldAction.new(`viewelements`, c.data.id, '+=', true);\r\n                for (let key of DViewElement.RecompileKeys) SetRootFieldAction.new(`VIEWS_RECOMPILE_${key}`, c.data.id, '+=', false);\r\n            })\r\n            return lview;\r\n        }\r\n    }\r\n}\r\nRuntimeAccessibleClass.set_extend(DPointerTargetable, DViewElement);\r\nRuntimeAccessibleClass.set_extend(LPointerTargetable, LViewElement);\r\n\r\ntype DuplicateVPChange = {\r\n    pvid: Pointer<DViewElement>,\r\n    // score: number //unused\r\n}\r\nexport type WViewElement = getWParams<LViewElement, DPointerTargetable>;\r\n\r\n@RuntimeAccessible('DViewTransientProperties')\r\nexport class DViewTransientProperties extends RuntimeAccessibleClass{\r\n    static logic: typeof LPointerTargetable;\r\n    _isDViewTransientProperties!: true;\r\n    // isSelected: Dictionary<DocString<Pointer<DUser>>, boolean> = {};\r\n    // private: DViewPrivateTransientProperties;\r\n}\r\n\r\nRuntimeAccessibleClass.set_extend(RuntimeAccessibleClass, DViewTransientProperties);\r\n@RuntimeAccessible('LViewTransientProperties')\r\nexport class LViewTransientProperties extends LPointerTargetable{\r\n    static structure: typeof DPointerTargetable;\r\n    static singleton: LViewTransientProperties;\r\n    _isLViewTransientProperties!: true;\r\n\r\n    // isSelected: Dictionary<DocString<Pointer<DUser>>, boolean> = {};\r\n    // private!: LViewPrivateTransientProperties;\r\n    /*\r\n        get_private(context: LogicContext<DViewTransientProperties>): LViewPrivateTransientProperties {\r\n            return LViewTransientProperties.wrap(context.data.private, context.proxy.baseObjInLookup, context.proxy.additionalPath + '.private'); }*/\r\n    /*\r\n        get_isSelected(logicContext: LogicContext<TargetableProxyHandler<DViewTransientProperties>, DViewTransientProperties>): Proxyfied<Dictionary> {\r\n            // @ts-ignore for $ at end of getpath\r\n            console.log('GET_ISSELECTED handler func');\r\n            return TargetableProxyHandler.getMap(logicContext.data.isSelected, logicContext, logicContext.proxy.additionalPath + '.' + (getPath as this).isSelected.$);\r\n        }*/\r\n}\r\n\r\nRuntimeAccessibleClass.set_extend(DPointerTargetable, DViewTransientProperties);\r\nRuntimeAccessibleClass.set_extend(LPointerTargetable, LViewTransientProperties);\r\nexport type WViewTransientProperties = getWParams<LViewTransientProperties, DViewTransientProperties>;\r\n\r\n/*\r\n\r\n@RuntimeAccessible\r\nexport class DViewPrivateTransientProperties extends DPointerTargetable{\r\n    static logic: typeof LViewPrivateTransientProperties;\r\n\r\n    public size: GraphSize\r\n    constructor(size?: GraphSize) {\r\n        super();\r\n        this.size = size || defaultVSize;\r\n    }\r\n}\r\n\r\n@RuntimeAccessible\r\nexport class LViewPrivateTransientProperties extends DViewPrivateTransientProperties{\r\n    static structure: typeof DViewPrivateTransientProperties;\r\n    static singleton: LViewPrivateTransientProperties;\r\n\r\n}*/\r\n// shapeless component, receive jsx from redux\r\n// can access any of the redux state, but will usually access 1-2 var among many,\r\n// how can i dynamically mapStateToProps to map only the required ones?\r\n\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}