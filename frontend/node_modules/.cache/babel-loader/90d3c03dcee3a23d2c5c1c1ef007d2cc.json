{"ast":null,"code":"import _objectSpread from\"C:/d/Programming/web/jodel-mde/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _classCallCheck from\"C:/d/Programming/web/jodel-mde/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"C:/d/Programming/web/jodel-mde/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"C:/d/Programming/web/jodel-mde/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"C:/d/Programming/web/jodel-mde/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from'react';import{connect}from'react-redux';import{DV}from'../../joiner';import'./style.scss';/*\r\n*   What's uncatched:\r\n*   - reducer\r\n*   - mapstatetoprops, if reducer doesn't do his job\r\n*\r\n*\r\n*\r\n*\r\n*\r\n* */import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var TryComponent=/*#__PURE__*/function(_React$Component){_inherits(TryComponent,_React$Component);var _super=_createSuper(TryComponent);function TryComponent(props){var _this;_classCallCheck(this,TryComponent);_this=_super.call(this,props);_this.state={error:undefined,info:undefined,stateUpdateTime:0};return _this;}_createClass(TryComponent,[{key:\"componentDidCatch\",value:function componentDidCatch(error,info){// this is called after error propagation and a full render cycle is complete, i use it to trigger a rerender with more accurate infos.\nthis.setState({error:error,info:info,stateUpdateTime:this.props.stateUpdateTime});}},{key:\"render\",value:function render(){/*\r\n        if (this.props.stateUpdateTime !== this.state.stateUpdateTime) {\r\n            // after a redux state update try checking if error is gone\r\n            return this.props.children;\r\n        }*/if(this.state.error){// You can render any custom fallback UI\nreturn this.catch(this.state.error,this.state.info);}if(!/*#__PURE__*/React.isValidElement(this.props.children)){// You can render any custom fallback UI\nconsole.error(\"Children is not a valid React Element\",this.props.children,this);return this.catch({message:\"Children is not a valid React Element\"},undefined);}return this.props.children;}},{key:\"catch\",value:function _catch(error,info){var _this2=this;console.error(\"uncatched error:\",{state:_objectSpread({},this.state)});var debug=false;if(debug)return/*#__PURE__*/_jsx(\"div\",{children:\"error\"});if(this.props.catch){try{if(typeof this.props.catch===\"function\")return this.props.catch(error,info);if(/*#__PURE__*/React.isValidElement(this.props.catch))return this.props.catch;}catch(e){console.error(\"uncatched error WITH INVALID CATCHING FUNC\",{catcherFuncError:e});}}var mailbody=encodeURIComponent(\"This mail is auto-generated, it might contain data of your views or model.\\n\"+\"If your project have sensitive personal information please check the report below to omit them.\\n\\n\"+\"\"+(error===null||error===void 0?void 0:error.message)+\"\\n\\n\"+\"_error_stack:\\n\"+(info?info.componentStack:''));var mailtitle=encodeURIComponent(\"Jodel assisted error report\");var mailrecipients=[\"damiano.divincenzo@student.univaq.it\",\"giordano.tinella@student.univaq.it\"];// \"mailto:no-one@snai1mai1.com?subject=look at this website&body=Hi,I found this website and thought you might like it http://www.geocities.com/wowhtml\"\nvar mailto=\"mailto:\"+mailrecipients.join(',')+\"?subject=\"+mailtitle+\"&body=\"+mailbody;var gitissue=\"https://github.com/MDEGroup/jjodel/issues/new?title=\"+mailtitle+\"&body=\"+mailbody;var shortErrorBody=((error===null||error===void 0?void 0:error.message)||\"\\n\").split(\"\\n\")[0];var visibleMessage=/*#__PURE__*/_jsxs(\"div\",{onClick:function onClick(){return _this2.setState({error:undefined,info:undefined});},children:[/*#__PURE__*/_jsxs(\"div\",{children:[\"ut:\",this.state.stateUpdateTime,\", \",shortErrorBody]}),/*#__PURE__*/_jsx(\"div\",{children:\"What you can try:\"}),/*#__PURE__*/_jsxs(\"ul\",{children:[/*#__PURE__*/_jsx(\"li\",{children:\"- Undo the last change\"}),/*#__PURE__*/_jsxs(\"li\",{children:[\"- \",/*#__PURE__*/_jsx(\"a\",{href:mailto,children:\"Mail the developers\"}),\" or \",/*#__PURE__*/_jsx(\"a\",{href:gitissue,target:\"_blank\",children:\"open an issue\"})]})]})]});return DV.error_raw(visibleMessage,\"unhandled\");}}],[{key:\"getDerivedStateFromError\",value:function getDerivedStateFromError(error){// Update state so the next render will show the fallback UI.\nreturn{error:error,info:undefined};// this first set an error and stops error propagation\n}}]);return TryComponent;}(React.Component);TryComponent.cname=\"TryComponent\";var rendercount=0;function mapStateToProps(state,ownProps){var ret={};ret.stateUpdateTime=rendercount++;// new Date().getTime();\nreturn ret;}function mapDispatchToProps(dispatch){var ret={};return ret;}var TryConnected=connect(mapStateToProps,mapDispatchToProps)(TryComponent);export function Try(props){return/*#__PURE__*/_jsx(TryConnected,_objectSpread(_objectSpread({},_objectSpread({},props)),{},{children:props.children}));}TryComponent.cname='TryComponent';TryConnected.cname='TryConnected';Try.cname='Try';","map":{"version":3,"names":["React","connect","DV","jsx","_jsx","jsxs","_jsxs","TryComponent","_React$Component","_inherits","_super","_createSuper","props","_this","_classCallCheck","call","state","error","undefined","info","stateUpdateTime","_createClass","key","value","componentDidCatch","setState","render","catch","isValidElement","children","console","message","_catch","_this2","_objectSpread","debug","e","catcherFuncError","mailbody","encodeURIComponent","componentStack","mailtitle","mailrecipients","mailto","join","gitissue","shortErrorBody","split","visibleMessage","onClick","href","target","error_raw","getDerivedStateFromError","Component","cname","rendercount","mapStateToProps","ownProps","ret","mapDispatchToProps","dispatch","TryConnected","Try"],"sources":["C:/d/Programming/web/jodel-mde/src/components/forEndUser/Try.tsx"],"sourcesContent":["import React, {Dispatch, ErrorInfo, KeyboardEvent, ReactElement, ReactNode} from 'react';\r\nimport {connect} from 'react-redux';\r\nimport {DState} from '../../redux/store';\r\nimport {\r\n    Defaults,\r\n    DPointerTargetable,\r\n    DV,\r\n    GObject,\r\n    Keystrokes,\r\n    LPointerTargetable,\r\n    Overlap,\r\n    Pointer,\r\n    U\r\n} from '../../joiner';\r\nimport {useStateIfMounted} from 'use-state-if-mounted';\r\nimport './style.scss';\r\n/*\r\n*   What's uncatched:\r\n*   - reducer\r\n*   - mapstatetoprops, if reducer doesn't do his job\r\n*\r\n*\r\n*\r\n*\r\n*\r\n* */\r\nclass TryComponent extends React.Component<AllProps, State> {\r\n    static cname: string = \"TryComponent\";\r\n    constructor(props: AllProps) {\r\n        super(props);\r\n        this.state = { error: undefined, info: undefined, stateUpdateTime: 0 };\r\n    }\r\n\r\n    static getDerivedStateFromError(error: Error) {\r\n        // Update state so the next render will show the fallback UI.\r\n        return { error, info: undefined }; // this first set an error and stops error propagation\r\n    }\r\n\r\n    componentDidCatch(error: Error, info: React.ErrorInfo): void {\r\n        // this is called after error propagation and a full render cycle is complete, i use it to trigger a rerender with more accurate infos.\r\n        this.setState({error, info, stateUpdateTime: this.props.stateUpdateTime});\r\n    }\r\n\r\n    render() {\r\n        /*\r\n        if (this.props.stateUpdateTime !== this.state.stateUpdateTime) {\r\n            // after a redux state update try checking if error is gone\r\n            return this.props.children;\r\n        }*/\r\n        if (this.state.error) {\r\n            // You can render any custom fallback UI\r\n            return this.catch(this.state.error, this.state.info);\r\n        }\r\n        if (!React.isValidElement(this.props.children)) {\r\n            // You can render any custom fallback UI\r\n            console.error(\"Children is not a valid React Element\", this.props.children, this);\r\n            return this.catch({message: \"Children is not a valid React Element\"} as any, undefined);\r\n        }\r\n        return this.props.children;\r\n    }\r\n\r\n    catch(error: Error, info?: React.ErrorInfo): ReactNode{\r\n        console.error(\"uncatched error:\", {state:{...this.state}});\r\n        let debug = false;\r\n        if (debug) return<div>error</div>;\r\n        if (this.props.catch) {\r\n            try{\r\n                if (typeof this.props.catch === \"function\") return this.props.catch(error, info);\r\n                if (React.isValidElement(this.props.catch)) return this.props.catch;\r\n            }\r\n            catch (e) {\r\n                console.error(\"uncatched error WITH INVALID CATCHING FUNC\", {catcherFuncError:e});\r\n            }\r\n        }\r\n        let mailbody: string = encodeURIComponent(\r\n            \"This mail is auto-generated, it might contain data of your views or model.\\n\" +\r\n            \"If your project have sensitive personal information please check the report below to omit them.\\n\\n\" +\r\n            \"\" + error?.message + \"\\n\\n\" +\r\n            \"_error_stack:\\n\" + (info ? info.componentStack : '')\r\n        );\r\n        let mailtitle: string =  encodeURIComponent(\"Jodel assisted error report\");\r\n        let mailrecipients = [\"damiano.divincenzo@student.univaq.it\", \"giordano.tinella@student.univaq.it\"];\r\n        // \"mailto:no-one@snai1mai1.com?subject=look at this website&body=Hi,I found this website and thought you might like it http://www.geocities.com/wowhtml\"\r\n        let mailto = \"mailto:\"+mailrecipients.join(',')+\"?subject=\"+mailtitle+\"&body=\"+mailbody;\r\n        let gitissue = \"https://github.com/MDEGroup/jjodel/issues/new?title=\"+mailtitle+\"&body=\"+mailbody;\r\n        let shortErrorBody = (error?.message || \"\\n\").split(\"\\n\")[0];\r\n\r\n\r\n        let visibleMessage: ReactNode = <div onClick={()=> this.setState({error:undefined, info: undefined})}>\r\n            <div>ut:{this.state.stateUpdateTime}, { shortErrorBody }</div>\r\n            <div>What you can try:</div>\r\n            <ul>\r\n                <li>- Undo the last change</li>\r\n                <li>- <a href={mailto}>Mail the developers</a> or <a href={gitissue} target=\"_blank\">open an issue</a></li>\r\n            </ul>\r\n        </div>\r\n        return DV.error_raw(visibleMessage, \"unhandled\");\r\n    }\r\n}\r\ninterface State{\r\n    error?: Error;\r\n    info?: React.ErrorInfo;\r\n    stateUpdateTime: number;\r\n}\r\ninterface OwnProps {\r\n    key?: React.Key | null;\r\n    catch?: ReactNode | ((error: Error, info?: React.ErrorInfo) => ReactNode);\r\n    children: ReactNode;\r\n}\r\ninterface StateProps {\r\n    stateUpdateTime: number;\r\n}\r\ninterface DispatchProps { }\r\ntype AllProps = Overlap<OwnProps, Overlap<StateProps, DispatchProps>>;\r\n\r\nlet rendercount: number = 0;\r\nfunction mapStateToProps(state: DState, ownProps: OwnProps): StateProps {\r\n    const ret: StateProps = {} as any;\r\n    ret.stateUpdateTime = rendercount++; // new Date().getTime();\r\n    return ret;\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch<any>): DispatchProps {\r\n    const ret: DispatchProps = {};\r\n    return ret;\r\n}\r\n\r\nconst TryConnected =\r\n    connect<StateProps, DispatchProps, OwnProps, DState>(mapStateToProps, mapDispatchToProps)(TryComponent);\r\n\r\n\r\nexport function Try(props: OwnProps): ReactElement {\r\n    return <TryConnected {...{...props}}>{props.children}</TryConnected>;\r\n}\r\n\r\nTryComponent.cname = 'TryComponent';\r\nTryConnected.cname = 'TryConnected';\r\nTry.cname = 'Try';\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}