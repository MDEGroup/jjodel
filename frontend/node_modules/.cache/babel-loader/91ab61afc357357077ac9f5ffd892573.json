{"ast":null,"code":"var _jsxFileName = \"C:\\\\0Programmi\\\\Dev\\\\projects\\\\frontend\\\\jjodel\\\\src\\\\components\\\\editors\\\\Mqtt.tsx\",\n  _s = $RefreshSig$(),\n  _this = this;\nimport { Action, DUser, LUser, SetRootFieldAction, U } from '../../joiner';\nimport { useState } from 'react';\nimport { connect } from 'react-redux';\nimport WebSockets from \"../../webSockets/WebSockets\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction MqttEditorComponent(props) {\n  _s();\n  const {\n    user\n  } = props;\n  const [ip, setIp] = useState('mqtt://localhost');\n  const [port, setPort] = useState(1883);\n  const connect = async () => {\n    var _user$project;\n    U.writeLog('create', 'MQTT', 'Connection');\n    SetRootFieldAction.new('isLoading', true);\n    WebSockets.iot.io.opts.query = {\n      'project': (_user$project = user.project) === null || _user$project === void 0 ? void 0 : _user$project.id,\n      'brokerUrl': `${ip}:${port}`\n    };\n    WebSockets.iot.off('pull-action');\n    WebSockets.iot.on('pull-action', receivedAction => {\n      const action = Action.fromJson(receivedAction);\n      action.hasFired = 0;\n      console.log('Received Action from server.', action);\n      action.fire();\n    });\n    WebSockets.iot.connect();\n    await U.sleep(1);\n    SetRootFieldAction.new('isLoading', false);\n  };\n  const disconnect = async () => {\n    SetRootFieldAction.new('isLoading', true);\n    WebSockets.iot.off('pull-action');\n    WebSockets.iot.off('logger');\n    WebSockets.iot.disconnect();\n    await U.sleep(1);\n    SetRootFieldAction.new('isLoading', false);\n  };\n  return /*#__PURE__*/_jsxDEV(\"section\", {\n    className: 'p-2',\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: 'd-flex',\n      children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n        className: 'd-block my-auto',\n        children: \"Middleware\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 40,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          width: '15px',\n          height: '15px'\n        },\n        className: `d-block ms-2 my-auto circle ${WebSockets.iot.connected ? 'bg-success' : 'bg-danger'}`\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 41,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 39,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: 'p-1 d-flex',\n      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n        className: 'my-auto',\n        children: \"Ip Address:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 44,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: 'text',\n        defaultValue: ip,\n        onChange: e => setIp(e.target.value),\n        className: 'my-auto input ms-auto',\n        spellCheck: false\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 45,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 43,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: 'p-1 d-flex',\n      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n        className: 'my-auto',\n        children: \"Port:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 48,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: 'number',\n        defaultValue: port,\n        onChange: e => setPort(e.target.valueAsNumber),\n        className: 'my-auto input ms-auto',\n        spellCheck: false\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 49,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 47,\n      columnNumber: 9\n    }, this), WebSockets.iot.connected ? /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: disconnect,\n      className: 'mt-3 btn btn-primary w-100 p-2',\n      children: \"Disconnect\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 52,\n      columnNumber: 13\n    }, this) : /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: connect,\n      className: 'mt-3 btn btn-primary w-100 p-2',\n      children: \"Connect\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 53,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 38,\n    columnNumber: 12\n  }, this);\n}\n_s(MqttEditorComponent, \"I2i7Bts8HcNqCWSX8jA9+VjHM3A=\");\n_c = MqttEditorComponent;\nfunction mapStateToProps(state, ownProps) {\n  const ret = {};\n  ret.user = LUser.fromPointer(DUser.current);\n  return ret;\n}\nfunction mapDispatchToProps(dispatch) {\n  const ret = {};\n  return ret;\n}\nexport const MqttEditorConnected = connect(mapStateToProps, mapDispatchToProps)(MqttEditorComponent);\nexport const Mqtt = function (props) {\n  let children = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n  return /*#__PURE__*/_jsxDEV(MqttEditorConnected, {\n    ...props,\n    children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 81,\n    columnNumber: 12\n  }, _this);\n};\n_c2 = Mqtt;\nMqttEditorComponent.cname = 'MqttComponent';\nMqttEditorConnected.cname = 'MqttConnected';\nMqtt.cname = 'Mqtt';\nvar _c, _c2;\n$RefreshReg$(_c, \"MqttEditorComponent\");\n$RefreshReg$(_c2, \"Mqtt\");","map":{"version":3,"names":["Action","DUser","LUser","SetRootFieldAction","U","useState","connect","WebSockets","jsxDEV","_jsxDEV","MqttEditorComponent","props","_s","user","ip","setIp","port","setPort","_user$project","writeLog","new","iot","io","opts","query","project","id","off","on","receivedAction","action","fromJson","hasFired","console","log","fire","sleep","disconnect","className","children","fileName","_jsxFileName","lineNumber","columnNumber","style","width","height","connected","type","defaultValue","onChange","e","target","value","spellCheck","valueAsNumber","onClick","_c","mapStateToProps","state","ownProps","ret","fromPointer","current","mapDispatchToProps","dispatch","MqttEditorConnected","Mqtt","arguments","length","undefined","_this","_c2","cname","$RefreshReg$"],"sources":["C:/0Programmi/Dev/projects/frontend/jjodel/src/components/editors/Mqtt.tsx"],"sourcesContent":["import {Action, CompositeAction, DState, DUser, GObject, LUser, SetRootFieldAction, store, U} from '../../joiner';\r\nimport {Component, Dispatch, ReactElement, useState} from 'react';\r\nimport {connect} from 'react-redux';\r\nimport {FakeStateProps} from \"../../joiner/types\";\r\nimport WebSockets from \"../../webSockets/WebSockets\";\r\n\r\nfunction MqttEditorComponent(props: AllProps) {\r\n    const {user} = props;\r\n    const [ip, setIp] = useState('mqtt://localhost');\r\n    const [port, setPort] = useState(1883);\r\n\r\n    const connect = async() => {\r\n        U.writeLog('create', 'MQTT', 'Connection');\r\n        SetRootFieldAction.new('isLoading', true);\r\n        WebSockets.iot.io.opts.query = {\r\n            'project': user.project?.id,\r\n            'brokerUrl': `${ip}:${port}`\r\n        };\r\n        WebSockets.iot.off('pull-action');\r\n        WebSockets.iot.on('pull-action', (receivedAction: GObject<Action & CompositeAction>) => {\r\n            const action = Action.fromJson(receivedAction); action.hasFired = 0;\r\n            console.log('Received Action from server.', action);\r\n            action.fire();\r\n        });\r\n        WebSockets.iot.connect();\r\n        await U.sleep(1);\r\n        SetRootFieldAction.new('isLoading', false);\r\n    }\r\n    const disconnect = async() => {\r\n        SetRootFieldAction.new('isLoading', true);\r\n        WebSockets.iot.off('pull-action');\r\n        WebSockets.iot.off('logger');\r\n        WebSockets.iot.disconnect();\r\n        await U.sleep(1);\r\n        SetRootFieldAction.new('isLoading', false);\r\n    }\r\n\r\n    return <section className={'p-2'}>\r\n        <div className={'d-flex'}>\r\n            <h4 className={'d-block my-auto'}>Middleware</h4>\r\n            <div style={{width: '15px', height: '15px'}} className={`d-block ms-2 my-auto circle ${WebSockets.iot.connected ? 'bg-success' : 'bg-danger'}`}></div>\r\n        </div>\r\n        <div className={'p-1 d-flex'}>\r\n            <label className={'my-auto'}>Ip Address:</label>\r\n            <input type={'text'} defaultValue={ip} onChange={e => setIp(e.target.value)} className={'my-auto input ms-auto'} spellCheck={false} />\r\n        </div>\r\n        <div className={'p-1 d-flex'}>\r\n            <label className={'my-auto'}>Port:</label>\r\n            <input type={'number'} defaultValue={port} onChange={e => setPort(e.target.valueAsNumber)} className={'my-auto input ms-auto'} spellCheck={false} />\r\n        </div>\r\n        {WebSockets.iot.connected ?\r\n            <button onClick={disconnect} className={'mt-3 btn btn-primary w-100 p-2'}>Disconnect</button> :\r\n            <button onClick={connect} className={'mt-3 btn btn-primary w-100 p-2'}>Connect</button>\r\n        }\r\n    </section>;\r\n}\r\ninterface OwnProps {}\r\ninterface StateProps {user: LUser}\r\ninterface DispatchProps {}\r\ntype AllProps = OwnProps & StateProps & DispatchProps;\r\n\r\n\r\nfunction mapStateToProps(state: DState, ownProps: OwnProps): StateProps {\r\n    const ret: StateProps = {} as FakeStateProps;\r\n    ret.user = LUser.fromPointer(DUser.current);\r\n    return ret;\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch<any>): DispatchProps {\r\n    const ret: DispatchProps = {};\r\n    return ret;\r\n}\r\n\r\n\r\nexport const MqttEditorConnected = connect<StateProps, DispatchProps, OwnProps, DState>(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(MqttEditorComponent);\r\n\r\nexport const Mqtt = (props: OwnProps, children: (string | Component)[] = []): ReactElement => {\r\n    return <MqttEditorConnected {...{...props, children}} />;\r\n}\r\n\r\nMqttEditorComponent.cname = 'MqttComponent';\r\nMqttEditorConnected.cname = 'MqttConnected';\r\nMqtt.cname = 'Mqtt';\r\n"],"mappings":";;;AAAA,SAAQA,MAAM,EAA2BC,KAAK,EAAWC,KAAK,EAAEC,kBAAkB,EAASC,CAAC,QAAO,cAAc;AACjH,SAA2CC,QAAQ,QAAO,OAAO;AACjE,SAAQC,OAAO,QAAO,aAAa;AAEnC,OAAOC,UAAU,MAAM,6BAA6B;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAErD,SAASC,mBAAmBA,CAACC,KAAe,EAAE;EAAAC,EAAA;EAC1C,MAAM;IAACC;EAAI,CAAC,GAAGF,KAAK;EACpB,MAAM,CAACG,EAAE,EAAEC,KAAK,CAAC,GAAGV,QAAQ,CAAC,kBAAkB,CAAC;EAChD,MAAM,CAACW,IAAI,EAAEC,OAAO,CAAC,GAAGZ,QAAQ,CAAC,IAAI,CAAC;EAEtC,MAAMC,OAAO,GAAG,MAAAA,CAAA,KAAW;IAAA,IAAAY,aAAA;IACvBd,CAAC,CAACe,QAAQ,CAAC,QAAQ,EAAE,MAAM,EAAE,YAAY,CAAC;IAC1ChB,kBAAkB,CAACiB,GAAG,CAAC,WAAW,EAAE,IAAI,CAAC;IACzCb,UAAU,CAACc,GAAG,CAACC,EAAE,CAACC,IAAI,CAACC,KAAK,GAAG;MAC3B,SAAS,GAAAN,aAAA,GAAEL,IAAI,CAACY,OAAO,cAAAP,aAAA,uBAAZA,aAAA,CAAcQ,EAAE;MAC3B,WAAW,EAAE,GAAGZ,EAAE,IAAIE,IAAI;IAC9B,CAAC;IACDT,UAAU,CAACc,GAAG,CAACM,GAAG,CAAC,aAAa,CAAC;IACjCpB,UAAU,CAACc,GAAG,CAACO,EAAE,CAAC,aAAa,EAAGC,cAAiD,IAAK;MACpF,MAAMC,MAAM,GAAG9B,MAAM,CAAC+B,QAAQ,CAACF,cAAc,CAAC;MAAEC,MAAM,CAACE,QAAQ,GAAG,CAAC;MACnEC,OAAO,CAACC,GAAG,CAAC,8BAA8B,EAAEJ,MAAM,CAAC;MACnDA,MAAM,CAACK,IAAI,CAAC,CAAC;IACjB,CAAC,CAAC;IACF5B,UAAU,CAACc,GAAG,CAACf,OAAO,CAAC,CAAC;IACxB,MAAMF,CAAC,CAACgC,KAAK,CAAC,CAAC,CAAC;IAChBjC,kBAAkB,CAACiB,GAAG,CAAC,WAAW,EAAE,KAAK,CAAC;EAC9C,CAAC;EACD,MAAMiB,UAAU,GAAG,MAAAA,CAAA,KAAW;IAC1BlC,kBAAkB,CAACiB,GAAG,CAAC,WAAW,EAAE,IAAI,CAAC;IACzCb,UAAU,CAACc,GAAG,CAACM,GAAG,CAAC,aAAa,CAAC;IACjCpB,UAAU,CAACc,GAAG,CAACM,GAAG,CAAC,QAAQ,CAAC;IAC5BpB,UAAU,CAACc,GAAG,CAACgB,UAAU,CAAC,CAAC;IAC3B,MAAMjC,CAAC,CAACgC,KAAK,CAAC,CAAC,CAAC;IAChBjC,kBAAkB,CAACiB,GAAG,CAAC,WAAW,EAAE,KAAK,CAAC;EAC9C,CAAC;EAED,oBAAOX,OAAA;IAAS6B,SAAS,EAAE,KAAM;IAAAC,QAAA,gBAC7B9B,OAAA;MAAK6B,SAAS,EAAE,QAAS;MAAAC,QAAA,gBACrB9B,OAAA;QAAI6B,SAAS,EAAE,iBAAkB;QAAAC,QAAA,EAAC;MAAU;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAI,CAAC,eACjDlC,OAAA;QAAKmC,KAAK,EAAE;UAACC,KAAK,EAAE,MAAM;UAAEC,MAAM,EAAE;QAAM,CAAE;QAACR,SAAS,EAAE,+BAA+B/B,UAAU,CAACc,GAAG,CAAC0B,SAAS,GAAG,YAAY,GAAG,WAAW;MAAG;QAAAP,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAM,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACrJ,CAAC,eACNlC,OAAA;MAAK6B,SAAS,EAAE,YAAa;MAAAC,QAAA,gBACzB9B,OAAA;QAAO6B,SAAS,EAAE,SAAU;QAAAC,QAAA,EAAC;MAAW;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAO,CAAC,eAChDlC,OAAA;QAAOuC,IAAI,EAAE,MAAO;QAACC,YAAY,EAAEnC,EAAG;QAACoC,QAAQ,EAAEC,CAAC,IAAIpC,KAAK,CAACoC,CAAC,CAACC,MAAM,CAACC,KAAK,CAAE;QAACf,SAAS,EAAE,uBAAwB;QAACgB,UAAU,EAAE;MAAM;QAAAd,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAE,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACrI,CAAC,eACNlC,OAAA;MAAK6B,SAAS,EAAE,YAAa;MAAAC,QAAA,gBACzB9B,OAAA;QAAO6B,SAAS,EAAE,SAAU;QAAAC,QAAA,EAAC;MAAK;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAO,CAAC,eAC1ClC,OAAA;QAAOuC,IAAI,EAAE,QAAS;QAACC,YAAY,EAAEjC,IAAK;QAACkC,QAAQ,EAAEC,CAAC,IAAIlC,OAAO,CAACkC,CAAC,CAACC,MAAM,CAACG,aAAa,CAAE;QAACjB,SAAS,EAAE,uBAAwB;QAACgB,UAAU,EAAE;MAAM;QAAAd,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAE,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACnJ,CAAC,EACLpC,UAAU,CAACc,GAAG,CAAC0B,SAAS,gBACrBtC,OAAA;MAAQ+C,OAAO,EAAEnB,UAAW;MAACC,SAAS,EAAE,gCAAiC;MAAAC,QAAA,EAAC;IAAU;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAQ,CAAC,gBAC7FlC,OAAA;MAAQ+C,OAAO,EAAElD,OAAQ;MAACgC,SAAS,EAAE,gCAAiC;MAAAC,QAAA,EAAC;IAAO;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAQ,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OAEtF,CAAC;AACd;AAAC/B,EAAA,CAjDQF,mBAAmB;AAAA+C,EAAA,GAAnB/C,mBAAmB;AAwD5B,SAASgD,eAAeA,CAACC,KAAa,EAAEC,QAAkB,EAAc;EACpE,MAAMC,GAAe,GAAG,CAAC,CAAmB;EAC5CA,GAAG,CAAChD,IAAI,GAAGX,KAAK,CAAC4D,WAAW,CAAC7D,KAAK,CAAC8D,OAAO,CAAC;EAC3C,OAAOF,GAAG;AACd;AAEA,SAASG,kBAAkBA,CAACC,QAAuB,EAAiB;EAChE,MAAMJ,GAAkB,GAAG,CAAC,CAAC;EAC7B,OAAOA,GAAG;AACd;AAGA,OAAO,MAAMK,mBAAmB,GAAG5D,OAAO,CACtCoD,eAAe,EACfM,kBACJ,CAAC,CAACtD,mBAAmB,CAAC;AAEtB,OAAO,MAAMyD,IAAI,GAAG,SAAAA,CAACxD,KAAe,EAA0D;EAAA,IAAxD4B,QAAgC,GAAA6B,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAE,SAAA,GAAAF,SAAA,MAAG,EAAE;EACvE,oBAAO3D,OAAA,CAACyD,mBAAmB;IAAM,GAAGvD,KAAK;IAAE4B;EAAQ;IAAAC,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,GAAA4B,KAAI,CAAC;AAC5D,CAAC;AAAAC,GAAA,GAFYL,IAAI;AAIjBzD,mBAAmB,CAAC+D,KAAK,GAAG,eAAe;AAC3CP,mBAAmB,CAACO,KAAK,GAAG,eAAe;AAC3CN,IAAI,CAACM,KAAK,GAAG,MAAM;AAAC,IAAAhB,EAAA,EAAAe,GAAA;AAAAE,YAAA,CAAAjB,EAAA;AAAAiB,YAAA,CAAAF,GAAA","ignoreList":[]},"metadata":{},"sourceType":"module"}