{"ast":null,"code":"\"use strict\";\n\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n    };\n    return extendStatics(d, b);\n  };\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n    extendStatics(d, b);\n    function __() {\n      this.constructor = d;\n    }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.ClassifierContextExpression = void 0;\nvar InvariantExpression_1 = require(\"../InvariantExpression\");\nvar DefExpression_1 = require(\"../DefExpression\");\nvar ContextExpression_1 = require(\"./ContextExpression\");\n/**\n * Define invariants and definitions on a given types\n *\n * @oclExpression context <Type> (inv|def)\n */\nvar ClassifierContextExpression = /** @class */function (_super) {\n  __extends(ClassifierContextExpression, _super);\n  function ClassifierContextExpression(targetType, rules) {\n    var _this = _super.call(this) || this;\n    if (!(rules instanceof Array)) {\n      rules = [rules];\n    }\n    _this.targetType = targetType;\n    _this.invs = rules.filter(function (i) {\n      return i instanceof InvariantExpression_1.InvariantExpression;\n    });\n    _this.defs = rules.filter(function (i) {\n      return i instanceof DefExpression_1.DefExpression;\n    });\n    return _this;\n  }\n  ClassifierContextExpression.prototype.getInvs = function () {\n    return this.invs;\n  };\n  ClassifierContextExpression.prototype.getDefs = function () {\n    return this.defs;\n  };\n  ClassifierContextExpression.prototype.accept = function (visitor) {\n    var accept = _super.prototype.accept.call(this, visitor);\n    if (accept === false) {\n      return false;\n    } else {\n      var visitorTargetType = visitor.getRegisteredType(visitor.getTargetTypeName()) || visitor.getTargetTypeName();\n      var expressionTargetType = visitor.getRegisteredType(this.targetType) || this.targetType;\n      if (typeof visitorTargetType === 'string' || typeof expressionTargetType === 'string') {\n        return this.targetType === visitor.getTargetTypeName();\n      } else {\n        return visitorTargetType instanceof expressionTargetType || visitorTargetType === expressionTargetType;\n      }\n    }\n  };\n  ClassifierContextExpression.prototype.evaluate = function (visitor) {\n    _super.prototype.evaluate.call(this, visitor);\n    if (this.accept(visitor)) {\n      this.getDefs().forEach(function (def) {\n        return def.evaluate(visitor);\n      });\n      var invs = this.getInvs();\n      return !invs.map(function (inv) {\n        var evaluationResult = inv.evaluate(visitor);\n        if (evaluationResult === false) {\n          visitor.addFailedInvariant(inv);\n        }\n        return evaluationResult;\n      }).some(function (inv) {\n        return inv === false;\n      });\n    }\n  };\n  return ClassifierContextExpression;\n}(ContextExpression_1.ContextExpression);\nexports.ClassifierContextExpression = ClassifierContextExpression;","map":{"version":3,"names":["InvariantExpression_1","require","DefExpression_1","ContextExpression_1","ClassifierContextExpression","_super","__extends","targetType","rules","_this","call","Array","invs","filter","i","InvariantExpression","defs","DefExpression","prototype","getInvs","getDefs","accept","visitor","visitorTargetType","getRegisteredType","getTargetTypeName","expressionTargetType","evaluate","forEach","def","map","inv","evaluationResult","addFailedInvariant","some","ContextExpression","exports"],"sources":["../../../../lib/components/expressions/context/ClassifierContextExpression.ts"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"script"}