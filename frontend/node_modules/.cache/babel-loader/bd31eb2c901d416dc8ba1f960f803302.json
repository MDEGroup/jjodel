{"ast":null,"code":"import React from'react';import{connect}from'react-redux';import{compressToBase64,decompressFromBase64}from\"async-lz-string\";import{Log,store,U}from'../../joiner';import{DefaultView}from'../../common/DV';/*\r\n*   What's uncatched:\r\n*   - reducer\r\n*   - mapstatetoprops, if reducer doesn't do his job\r\n*\r\n*\r\n*\r\n*\r\n*\r\n* */ // todo: after we have a server, instead of this, make an automatic error report with POST requests to the server without having the uri char limit\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";class TryComponent extends React.Component{constructor(props){super(props);this.state={error:undefined,info:undefined,stateUpdateTime:0,canUseClipboard:true};}static getDerivedStateFromError(error){// Update state so the next render will show the fallback UI.\nreturn{error,info:undefined};// this first set an error and stops error propagation\n}postGitIssue(content){let owner='MDEGroup';let repo='jjodel';let obj={owner,repo,title:'Automatic bug report',body:content,labels:['bug','auto-bug'],headers:{'X-GitHub-Api-Version':'2022-11-28'}};this.postBugReport(\"https://api.github.com/repos/\".concat(owner,\"/\").concat(repo,\"/issues\"),JSON.stringify(obj));}postBugReport(url,content){var xhr=new XMLHttpRequest();xhr.open(\"POST\",url,true);xhr.setRequestHeader('Content-Type','application/json');xhr.send(content);}componentDidCatch(error,info){console.error(\"uncatched error didcatch:\",{info});// this is called after error propagation and a full render cycle is complete, i use it to trigger a rerender with more accurate infos.\nthis.setState({error,info,stateUpdateTime:this.props.stateUpdateTime});}render(){/*\r\n        if (this.props.stateUpdateTime !== this.state.stateUpdateTime) {\r\n            // after a redux state update try checking if error is gone\r\n            return this.props.children;\r\n        }*/if(this.state.error){// You can render any custom fallback UI\nreturn this.catch(this.state.error,this.state.info);}if(Array.isArray(this.props.children)){console.error(\"<Try /> can have only 1 subcomponent\",this.props.children,this);return this.catch({message:\"<Try /> can have only 1 subcomponent. If you need more wrap them inside a <>React.fragment</>\"},undefined);}if(!/*#__PURE__*/React.isValidElement(this.props.children)){// You can render any custom fallback UI\nconsole.error(\"Children is not a valid React Element\",this.props.children,this);return this.catch({message:\"Children is not a valid React Element\"},undefined);}return this.props.children;}reset(){this.setState({error:undefined,info:undefined,lz:undefined});}catch(error,info){var _state$version;console.error(\"uncatched error:\",{state:{...this.state}});let debug=false;if(debug)return/*#__PURE__*/_jsx(\"div\",{children:\"error\"});if(this.props.catch){try{if(typeof this.props.catch===\"function\")return this.props.catch(error,info);if(/*#__PURE__*/React.isValidElement(this.props.catch))return this.props.catch;}catch(e){console.error(\"uncatched error WITH INVALID CATCHING FUNC\",{catcherFuncError:e});}}let state=store.getState();let title=\"Jodel assisted error report V\"+(state===null||state===void 0?void 0:(_state$version=state.version)===null||_state$version===void 0?void 0:_state$version.n);window.tryerror=error;let reportstr=this.state.lz||this.stringreport(Log.getByError(error));let mongoreport={state:state,when:new Date()+'',e:{'stack':error.stack,'msg':error.message},compostack:info===null||info===void 0?void 0:info.componentStack};// todo giordano: salva report su mongodb\nconst msgbody_notencoded=\"This mail is auto-generated, it might contain data of your views or model.\\n\"+\"If your project have sensitive personal information please do a manual report instead.\"+// check the report below to omit them.\\n\\n\" +\n\"\"+(error===null||error===void 0?void 0:error.message)+\"\\n\\n\"+(reportstr?'logger report'+(this.state.lz?' (lz-base64)':'')+':\\n'+encodeURIComponent(reportstr)+'\\n\\n':'')+\"_stack:\\n\"+U.cropStr(error.stack||'',30,0,35,15)+'\\n\\n'+\"_component_stack:\\n\"+(info?U.cropStr(info.componentStack,10,0,35,5):'');let{mailto,gitissue}=U.mailerror(TryComponent.mailRecipients,title,msgbody_notencoded,this.state.canUseClipboard,undefined,()=>{this.setState({canUseClipboard:false});});let shortErrorBody=((error===null||error===void 0?void 0:error.message)||\"\\n\").split(\"\\n\")[0];let visibleMessage=/*#__PURE__*/_jsxs(\"div\",{onClick:()=>this.reset(),children:[/*#__PURE__*/_jsx(\"div\",{children:info?\"has info\":\"###########\"}),/*#__PURE__*/_jsxs(\"div\",{children:[\"ut:\",this.state.stateUpdateTime,\", \",shortErrorBody]}),/*#__PURE__*/_jsx(\"div\",{children:\"What you can try:\"}),/*#__PURE__*/_jsxs(\"ul\",{children:[/*#__PURE__*/_jsx(\"li\",{children:\"- Undo the last change\"}),/*#__PURE__*/_jsxs(\"li\",{children:[\"- \",mailto&&[/*#__PURE__*/_jsx(\"a\",{href:mailto,children:\"Mail the developers\"}),\" or\"],\" \",/*#__PURE__*/_jsx(\"a\",{href:gitissue,target:\"_blank\",children:\"open an issue\"})]})]}),state.debug?this.decompress():undefined]});return DefaultView.error(visibleMessage,\"unhandled\");}decompress(){function dec(e){e.stopPropagation();let s=undefined,s1=undefined,s2=undefined,o=undefined;try{s=e.target.value;}catch(e){console.error(\"crashed decompress\",e);}try{s1=decodeURIComponent(s);}catch(e){console.error(\"crashed decompress uri\",e);}try{s2=decompressFromBase64(s1);}catch(e){console.error(\"crashed decompress lz\",e);}if(s2){s2.then(v=>{try{o=JSON.parse(s2=v);}catch(e){console.error(\"crashed decompress p\",e,v);}}).finally(()=>{let out={s,uri:s1,lz:s2,o};console.log('decompress final',out);$('#decompress')[0].innerText=JSON.stringify(o||out,null,4);});}else{let out={s,uri:s1,lz:s2,o};console.log('decompress else',out);$('#decompress')[0].innerText=JSON.stringify(o||out,null,4);}}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"span\",{children:\"Debug mode: paste error report to decompress it.\"}),/*#__PURE__*/_jsx(\"textarea\",{className:\"w-100\",onChange:dec}),/*#__PURE__*/_jsx(\"textarea\",{id:\"decompress\",className:\"w-100\"})]});}stringreport(loggerReport0){if(!loggerReport0)return undefined;let loggerReport={...loggerReport0};window.loggerReport=loggerReport;delete loggerReport.exception;loggerReport=U.cropDeepObject(loggerReport);loggerReport.time=loggerReport0.time;// do not \"crop\" timestamp\ndelete loggerReport.short_string;let s=JSON.stringify(U.cropDeepObject(loggerReport));/*(window as any).compressToUTF16 = compressToUTF16;\r\n        (window as any).decompressFromUTF16 = decompressFromUTF16;\r\n        (window as any).compressToBase64 = compressToBase64;\r\n        (window as any).decompressFromBase64 = decompressFromBase64;\r\n        (window as any).ss = s;*/ // or: LZString.compressToBase64()\nif(s.length>100)compressToBase64(s).then(v=>this.setState({lz:v}));return s;}}TryComponent.cname=\"TryComponent\";TryComponent.mailRecipients=[\"damiano.divincenzo@student.univaq.it\",\"giordano.tinella@student.univaq.it\"];let rendercount=0;function mapStateToProps(state,ownProps){const ret={};ret.stateUpdateTime=rendercount++;// new Date().getTime();\nreturn ret;}function mapDispatchToProps(dispatch){const ret={};return ret;}const TryConnected=connect(mapStateToProps,mapDispatchToProps)(TryComponent);export function Try(props){return/*#__PURE__*/_jsx(TryConnected,{...props,children:props.children});}TryComponent.cname='TryComponent';TryConnected.cname='TryConnected';Try.cname='Try';","map":{"version":3,"names":["React","connect","compressToBase64","decompressFromBase64","Log","store","U","DefaultView","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","TryComponent","Component","constructor","props","state","error","undefined","info","stateUpdateTime","canUseClipboard","getDerivedStateFromError","postGitIssue","content","owner","repo","obj","title","body","labels","headers","postBugReport","concat","JSON","stringify","url","xhr","XMLHttpRequest","open","setRequestHeader","send","componentDidCatch","console","setState","render","catch","Array","isArray","children","message","isValidElement","reset","lz","_state$version","debug","e","catcherFuncError","getState","version","n","window","tryerror","reportstr","stringreport","getByError","mongoreport","when","Date","stack","compostack","componentStack","msgbody_notencoded","encodeURIComponent","cropStr","mailto","gitissue","mailerror","mailRecipients","shortErrorBody","split","visibleMessage","onClick","href","target","decompress","dec","stopPropagation","s","s1","s2","o","value","decodeURIComponent","then","v","parse","finally","out","uri","log","$","innerText","className","onChange","id","loggerReport0","loggerReport","exception","cropDeepObject","time","short_string","length","cname","rendercount","mapStateToProps","ownProps","ret","mapDispatchToProps","dispatch","TryConnected","Try"],"sources":["C:/0Programmi/Dev/projects/frontend/jjodel/src/components/forEndUser/Try.tsx"],"sourcesContent":["import React, {Dispatch, ErrorInfo, KeyboardEvent, ReactElement, ReactNode} from 'react';\r\nimport {connect} from 'react-redux';\r\nimport {DState} from '../../redux/store';\r\nimport {compressToBase64, compressToUTF16, decompressFromBase64, decompressFromUTF16} from \"async-lz-string\";\r\nimport {\r\n    Defaults,\r\n    DPointerTargetable,\r\n    DV,\r\n    GObject,\r\n    Keystrokes,\r\n    Log,\r\n    LPointerTargetable,\r\n    Overlap,\r\n    Pointer, store,\r\n    U, LoggerCategoryState\r\n} from '../../joiner';\r\nimport { DefaultView } from '../../common/DV';\r\n/*\r\n*   What's uncatched:\r\n*   - reducer\r\n*   - mapstatetoprops, if reducer doesn't do his job\r\n*\r\n*\r\n*\r\n*\r\n*\r\n* */\r\n\r\n// todo: after we have a server, instead of this, make an automatic error report with POST requests to the server without having the uri char limit\r\nclass TryComponent extends React.Component<AllProps, State> {\r\n    static cname: string = \"TryComponent\";\r\n    static mailRecipients = [\"damiano.divincenzo@student.univaq.it\", \"giordano.tinella@student.univaq.it\"];\r\n\r\n    constructor(props: AllProps) {\r\n        super(props);\r\n        this.state = { error: undefined, info: undefined, stateUpdateTime: 0, canUseClipboard: true};\r\n    }\r\n\r\n    static getDerivedStateFromError(error: Error) {\r\n        // Update state so the next render will show the fallback UI.\r\n        return { error, info: undefined }; // this first set an error and stops error propagation\r\n    }\r\n\r\n    private postGitIssue(content: string){\r\n        let owner = 'MDEGroup';\r\n        let repo = 'jjodel';\r\n        let obj = {\r\n            owner,\r\n            repo,\r\n            title: 'Automatic bug report',\r\n            body: content,\r\n            labels: [\r\n                'bug', 'auto-bug'\r\n            ],\r\n            headers: {\r\n                'X-GitHub-Api-Version': '2022-11-28'\r\n            }\r\n        }\r\n        this.postBugReport(`https://api.github.com/repos/${owner}/${repo}/issues`, JSON.stringify(obj));\r\n\r\n    }\r\n    private postBugReport(url: string, content: string){\r\n        var xhr = new XMLHttpRequest();\r\n        xhr.open(\"POST\", url, true);\r\n        xhr.setRequestHeader('Content-Type', 'application/json');\r\n        xhr.send(content);\r\n    }\r\n\r\n    componentDidCatch(error: Error, info: React.ErrorInfo): void {\r\n        console.error(\"uncatched error didcatch:\", {info});\r\n        // this is called after error propagation and a full render cycle is complete, i use it to trigger a rerender with more accurate infos.\r\n        this.setState({error, info, stateUpdateTime: this.props.stateUpdateTime});\r\n    }\r\n\r\n    render() {\r\n        /*\r\n        if (this.props.stateUpdateTime !== this.state.stateUpdateTime) {\r\n            // after a redux state update try checking if error is gone\r\n            return this.props.children;\r\n        }*/\r\n        if (this.state.error) {\r\n            // You can render any custom fallback UI\r\n            return this.catch(this.state.error, this.state.info);\r\n        }\r\n        if (Array.isArray(this.props.children)) {\r\n            console.error(\"<Try /> can have only 1 subcomponent\", this.props.children, this);\r\n            return this.catch({message: \"<Try /> can have only 1 subcomponent. If you need more wrap them inside a <>React.fragment</>\"} as any, undefined);\r\n        }\r\n        if (!React.isValidElement(this.props.children)) {\r\n            // You can render any custom fallback UI\r\n            console.error(\"Children is not a valid React Element\", this.props.children, this);\r\n            return this.catch({message: \"Children is not a valid React Element\"} as any, undefined);\r\n        }\r\n        return this.props.children;\r\n    }\r\n    reset(){\r\n        this.setState({error:undefined, info: undefined, lz: undefined});\r\n    }\r\n\r\n    catch(error: Error, info?: React.ErrorInfo): ReactNode{\r\n        console.error(\"uncatched error:\", {state:{...this.state}});\r\n        let debug = false;\r\n        if (debug) return<div>error</div>;\r\n        if (this.props.catch) {\r\n            try {\r\n                if (typeof this.props.catch === \"function\") return this.props.catch(error, info);\r\n                if (React.isValidElement(this.props.catch)) return this.props.catch;\r\n            }\r\n            catch (e) {\r\n                console.error(\"uncatched error WITH INVALID CATCHING FUNC\", {catcherFuncError:e});\r\n            }\r\n        }\r\n\r\n\r\n        let state: DState = store.getState();\r\n        let title = \"Jodel assisted error report V\"+state?.version?.n;\r\n        (window as any).tryerror = error;\r\n        let reportstr = this.state.lz || this.stringreport(Log.getByError(error));\r\n        let mongoreport = {state: state, when: new Date()+'', e:{'stack':error.stack, 'msg':error.message}, compostack: info?.componentStack};\r\n        // todo giordano: salva report su mongodb\r\n\r\n        const msgbody_notencoded: string = \"This mail is auto-generated, it might contain data of your views or model.\\n\" +\r\n            \"If your project have sensitive personal information please do a manual report instead.\"+// check the report below to omit them.\\n\\n\" +\r\n            \"\" + error?.message + \"\\n\\n\" +\r\n            (reportstr ? 'logger report'+(this.state.lz ? ' (lz-base64)' : '')+':\\n' + encodeURIComponent(reportstr) +'\\n\\n' : '') +\r\n            \"_stack:\\n\" + U.cropStr(error.stack || '', 30, 0, 35, 15) + '\\n\\n'+\r\n            \"_component_stack:\\n\" + (info ? U.cropStr(info.componentStack, 10, 0, 35, 5) : '');\r\n\r\n        let {mailto, gitissue} = U.mailerror(TryComponent.mailRecipients, title, msgbody_notencoded, this.state.canUseClipboard,\r\n            undefined, ()=>{this.setState({canUseClipboard: false})});\r\n\r\n        let shortErrorBody = (error?.message || \"\\n\").split(\"\\n\")[0];\r\n        let visibleMessage: ReactNode = <div onClick={()=> this.reset()}>\r\n            <div>{info ? \"has info\": \"###########\"}</div>\r\n            <div>ut:{this.state.stateUpdateTime}, { shortErrorBody }</div>\r\n            <div>What you can try:</div>\r\n            <ul>\r\n                <li>- Undo the last change</li>\r\n                <li>- {mailto && [<a href={mailto}>Mail the developers</a>, \" or\"]} <a href={gitissue} target=\"_blank\">open an issue</a></li>\r\n            </ul>\r\n            {state.debug ? this.decompress() : undefined}\r\n        </div>\r\n        return DefaultView.error(visibleMessage, \"unhandled\");\r\n    }\r\n\r\n    decompress(){\r\n        function dec(e:any){\r\n            e.stopPropagation();\r\n            let s: any=undefined, s1: any=undefined, s2:Promise<string>=undefined as any, o: any=undefined;\r\n            try { s = e.target.value; } catch (e) {\r\n                console.error(\"crashed decompress\", e);\r\n            }\r\n            try { s1 = decodeURIComponent(s); } catch (e) {\r\n                console.error(\"crashed decompress uri\", e);\r\n            }\r\n            try { s2 = decompressFromBase64(s1); } catch (e) {\r\n                console.error(\"crashed decompress lz\", e);\r\n            }\r\n            if (s2) {s2.then(v=> {\r\n                try { o = JSON.parse(s2=v as any) } catch (e) { console.error(\"crashed decompress p\", e, v); }\r\n            }).finally(()=>{\r\n                let out = {s, uri:s1, lz:s2, o};\r\n                console.log('decompress final', out);\r\n                $('#decompress')[0].innerText = JSON.stringify(o ||  out, null, 4);\r\n\r\n            })} else {\r\n                let out = {s, uri:s1, lz:s2, o};\r\n                console.log('decompress else', out);\r\n                $('#decompress')[0].innerText = JSON.stringify(o ||  out, null, 4);\r\n            }\r\n        }\r\n        return (<><span>Debug mode: paste error report to decompress it.</span><textarea className={\"w-100\"} onChange={dec}></textarea><textarea id={\"decompress\"} className={\"w-100\"} /></>);\r\n    }\r\n\r\n\r\n    private stringreport(loggerReport0?: GObject): string | undefined{\r\n        if (!loggerReport0) return undefined;\r\n        let loggerReport = {...loggerReport0};\r\n        (window as any).loggerReport = loggerReport;\r\n        delete loggerReport.exception;\r\n        loggerReport = U.cropDeepObject(loggerReport);\r\n        loggerReport.time = loggerReport0.time; // do not \"crop\" timestamp\r\n        delete loggerReport.short_string\r\n        let s = JSON.stringify(U.cropDeepObject(loggerReport));\r\n        /*(window as any).compressToUTF16 = compressToUTF16;\r\n        (window as any).decompressFromUTF16 = decompressFromUTF16;\r\n        (window as any).compressToBase64 = compressToBase64;\r\n        (window as any).decompressFromBase64 = decompressFromBase64;\r\n        (window as any).ss = s;*/\r\n        // or: LZString.compressToBase64()\r\n        if (s.length > 100) compressToBase64(s).then((v)=> this.setState({lz:v}));\r\n        return s;\r\n    }\r\n}\r\ninterface State{\r\n    error?: Error;\r\n    info?: React.ErrorInfo;\r\n    stateUpdateTime: number;\r\n    canUseClipboard: boolean;\r\n    lz?: string;\r\n}\r\ninterface OwnProps {\r\n    key?: React.Key | null;\r\n    catch?: ReactNode | ((error: Error, info?: React.ErrorInfo) => ReactNode);\r\n    children: ReactNode;\r\n}\r\ninterface StateProps {\r\n    stateUpdateTime: number;\r\n}\r\ninterface DispatchProps { }\r\ntype AllProps = Overlap<OwnProps, Overlap<StateProps, DispatchProps>>;\r\n\r\nlet rendercount: number = 0;\r\nfunction mapStateToProps(state: DState, ownProps: OwnProps): StateProps {\r\n    const ret: StateProps = {} as any;\r\n    ret.stateUpdateTime = rendercount++; // new Date().getTime();\r\n    return ret;\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch<any>): DispatchProps {\r\n    const ret: DispatchProps = {};\r\n    return ret;\r\n}\r\n\r\nconst TryConnected =\r\n    connect<StateProps, DispatchProps, OwnProps, DState>(mapStateToProps, mapDispatchToProps)(TryComponent);\r\n\r\n\r\nexport function Try(props: OwnProps): ReactElement {\r\n    return <TryConnected {...{...props}}>{props.children}</TryConnected>;\r\n}\r\n\r\nTryComponent.cname = 'TryComponent';\r\nTryConnected.cname = 'TryConnected';\r\nTry.cname = 'Try';\r\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,KAAqE,OAAO,CACxF,OAAQC,OAAO,KAAO,aAAa,CAEnC,OAAQC,gBAAgB,CAAmBC,oBAAoB,KAA4B,iBAAiB,CAC5G,OAMIC,GAAG,CAGMC,KAAK,CACdC,CAAC,KACE,cAAc,CACrB,OAASC,WAAW,KAAQ,iBAAiB,CAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IATA,CAWA;AAAA,OAAAC,GAAA,IAAAC,IAAA,gCAAAC,IAAA,IAAAC,KAAA,gCAAAC,QAAA,IAAAC,SAAA,yBACA,KAAM,CAAAC,YAAY,QAAS,CAAAd,KAAK,CAACe,SAA2B,CAIxDC,WAAWA,CAACC,KAAe,CAAE,CACzB,KAAK,CAACA,KAAK,CAAC,CACZ,IAAI,CAACC,KAAK,CAAG,CAAEC,KAAK,CAAEC,SAAS,CAAEC,IAAI,CAAED,SAAS,CAAEE,eAAe,CAAE,CAAC,CAAEC,eAAe,CAAE,IAAI,CAAC,CAChG,CAEA,MAAO,CAAAC,wBAAwBA,CAACL,KAAY,CAAE,CAC1C;AACA,MAAO,CAAEA,KAAK,CAAEE,IAAI,CAAED,SAAU,CAAC,CAAE;AACvC,CAEQK,YAAYA,CAACC,OAAe,CAAC,CACjC,GAAI,CAAAC,KAAK,CAAG,UAAU,CACtB,GAAI,CAAAC,IAAI,CAAG,QAAQ,CACnB,GAAI,CAAAC,GAAG,CAAG,CACNF,KAAK,CACLC,IAAI,CACJE,KAAK,CAAE,sBAAsB,CAC7BC,IAAI,CAAEL,OAAO,CACbM,MAAM,CAAE,CACJ,KAAK,CAAE,UAAU,CACpB,CACDC,OAAO,CAAE,CACL,sBAAsB,CAAE,YAC5B,CACJ,CAAC,CACD,IAAI,CAACC,aAAa,iCAAAC,MAAA,CAAiCR,KAAK,MAAAQ,MAAA,CAAIP,IAAI,YAAWQ,IAAI,CAACC,SAAS,CAACR,GAAG,CAAC,CAAC,CAEnG,CACQK,aAAaA,CAACI,GAAW,CAAEZ,OAAe,CAAC,CAC/C,GAAI,CAAAa,GAAG,CAAG,GAAI,CAAAC,cAAc,CAAC,CAAC,CAC9BD,GAAG,CAACE,IAAI,CAAC,MAAM,CAAEH,GAAG,CAAE,IAAI,CAAC,CAC3BC,GAAG,CAACG,gBAAgB,CAAC,cAAc,CAAE,kBAAkB,CAAC,CACxDH,GAAG,CAACI,IAAI,CAACjB,OAAO,CAAC,CACrB,CAEAkB,iBAAiBA,CAACzB,KAAY,CAAEE,IAAqB,CAAQ,CACzDwB,OAAO,CAAC1B,KAAK,CAAC,2BAA2B,CAAE,CAACE,IAAI,CAAC,CAAC,CAClD;AACA,IAAI,CAACyB,QAAQ,CAAC,CAAC3B,KAAK,CAAEE,IAAI,CAAEC,eAAe,CAAE,IAAI,CAACL,KAAK,CAACK,eAAe,CAAC,CAAC,CAC7E,CAEAyB,MAAMA,CAAA,CAAG,CACL;AACR;AACA;AACA;AACA,WACQ,GAAI,IAAI,CAAC7B,KAAK,CAACC,KAAK,CAAE,CAClB;AACA,MAAO,KAAI,CAAC6B,KAAK,CAAC,IAAI,CAAC9B,KAAK,CAACC,KAAK,CAAE,IAAI,CAACD,KAAK,CAACG,IAAI,CAAC,CACxD,CACA,GAAI4B,KAAK,CAACC,OAAO,CAAC,IAAI,CAACjC,KAAK,CAACkC,QAAQ,CAAC,CAAE,CACpCN,OAAO,CAAC1B,KAAK,CAAC,sCAAsC,CAAE,IAAI,CAACF,KAAK,CAACkC,QAAQ,CAAE,IAAI,CAAC,CAChF,MAAO,KAAI,CAACH,KAAK,CAAC,CAACI,OAAO,CAAE,+FAA+F,CAAC,CAAShC,SAAS,CAAC,CACnJ,CACA,GAAI,cAACpB,KAAK,CAACqD,cAAc,CAAC,IAAI,CAACpC,KAAK,CAACkC,QAAQ,CAAC,CAAE,CAC5C;AACAN,OAAO,CAAC1B,KAAK,CAAC,uCAAuC,CAAE,IAAI,CAACF,KAAK,CAACkC,QAAQ,CAAE,IAAI,CAAC,CACjF,MAAO,KAAI,CAACH,KAAK,CAAC,CAACI,OAAO,CAAE,uCAAuC,CAAC,CAAShC,SAAS,CAAC,CAC3F,CACA,MAAO,KAAI,CAACH,KAAK,CAACkC,QAAQ,CAC9B,CACAG,KAAKA,CAAA,CAAE,CACH,IAAI,CAACR,QAAQ,CAAC,CAAC3B,KAAK,CAACC,SAAS,CAAEC,IAAI,CAAED,SAAS,CAAEmC,EAAE,CAAEnC,SAAS,CAAC,CAAC,CACpE,CAEA4B,KAAKA,CAAC7B,KAAY,CAAEE,IAAsB,CAAY,KAAAmC,cAAA,CAClDX,OAAO,CAAC1B,KAAK,CAAC,kBAAkB,CAAE,CAACD,KAAK,CAAC,CAAC,GAAG,IAAI,CAACA,KAAK,CAAC,CAAC,CAAC,CAC1D,GAAI,CAAAuC,KAAK,CAAG,KAAK,CACjB,GAAIA,KAAK,CAAE,mBAAMhD,IAAA,QAAA0C,QAAA,CAAK,OAAK,CAAK,CAAC,CACjC,GAAI,IAAI,CAAClC,KAAK,CAAC+B,KAAK,CAAE,CAClB,GAAI,CACA,GAAI,MAAO,KAAI,CAAC/B,KAAK,CAAC+B,KAAK,GAAK,UAAU,CAAE,MAAO,KAAI,CAAC/B,KAAK,CAAC+B,KAAK,CAAC7B,KAAK,CAAEE,IAAI,CAAC,CAChF,gBAAIrB,KAAK,CAACqD,cAAc,CAAC,IAAI,CAACpC,KAAK,CAAC+B,KAAK,CAAC,CAAE,MAAO,KAAI,CAAC/B,KAAK,CAAC+B,KAAK,CACvE,CACA,MAAOU,CAAC,CAAE,CACNb,OAAO,CAAC1B,KAAK,CAAC,4CAA4C,CAAE,CAACwC,gBAAgB,CAACD,CAAC,CAAC,CAAC,CACrF,CACJ,CAGA,GAAI,CAAAxC,KAAa,CAAGb,KAAK,CAACuD,QAAQ,CAAC,CAAC,CACpC,GAAI,CAAA9B,KAAK,CAAG,+BAA+B,EAACZ,KAAK,SAALA,KAAK,kBAAAsC,cAAA,CAALtC,KAAK,CAAE2C,OAAO,UAAAL,cAAA,iBAAdA,cAAA,CAAgBM,CAAC,EAC5DC,MAAM,CAASC,QAAQ,CAAG7C,KAAK,CAChC,GAAI,CAAA8C,SAAS,CAAG,IAAI,CAAC/C,KAAK,CAACqC,EAAE,EAAI,IAAI,CAACW,YAAY,CAAC9D,GAAG,CAAC+D,UAAU,CAAChD,KAAK,CAAC,CAAC,CACzE,GAAI,CAAAiD,WAAW,CAAG,CAAClD,KAAK,CAAEA,KAAK,CAAEmD,IAAI,CAAE,GAAI,CAAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAEZ,CAAC,CAAC,CAAC,OAAO,CAACvC,KAAK,CAACoD,KAAK,CAAE,KAAK,CAACpD,KAAK,CAACiC,OAAO,CAAC,CAAEoB,UAAU,CAAEnD,IAAI,SAAJA,IAAI,iBAAJA,IAAI,CAAEoD,cAAc,CAAC,CACrI;AAEA,KAAM,CAAAC,kBAA0B,CAAG,8EAA8E,CAC7G,wFAAwF,CAAC;AACzF,EAAE,EAAGvD,KAAK,SAALA,KAAK,iBAALA,KAAK,CAAEiC,OAAO,EAAG,MAAM,EAC3Ba,SAAS,CAAG,eAAe,EAAE,IAAI,CAAC/C,KAAK,CAACqC,EAAE,CAAG,cAAc,CAAG,EAAE,CAAC,CAAC,KAAK,CAAGoB,kBAAkB,CAACV,SAAS,CAAC,CAAE,MAAM,CAAG,EAAE,CAAC,CACtH,WAAW,CAAG3D,CAAC,CAACsE,OAAO,CAACzD,KAAK,CAACoD,KAAK,EAAI,EAAE,CAAE,EAAE,CAAE,CAAC,CAAE,EAAE,CAAE,EAAE,CAAC,CAAG,MAAM,CAClE,qBAAqB,EAAIlD,IAAI,CAAGf,CAAC,CAACsE,OAAO,CAACvD,IAAI,CAACoD,cAAc,CAAE,EAAE,CAAE,CAAC,CAAE,EAAE,CAAE,CAAC,CAAC,CAAG,EAAE,CAAC,CAEtF,GAAI,CAACI,MAAM,CAAEC,QAAQ,CAAC,CAAGxE,CAAC,CAACyE,SAAS,CAACjE,YAAY,CAACkE,cAAc,CAAElD,KAAK,CAAE4C,kBAAkB,CAAE,IAAI,CAACxD,KAAK,CAACK,eAAe,CACnHH,SAAS,CAAE,IAAI,CAAC,IAAI,CAAC0B,QAAQ,CAAC,CAACvB,eAAe,CAAE,KAAK,CAAC,CAAC,EAAC,CAAC,CAE7D,GAAI,CAAA0D,cAAc,CAAG,CAAC,CAAA9D,KAAK,SAALA,KAAK,iBAALA,KAAK,CAAEiC,OAAO,GAAI,IAAI,EAAE8B,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAC5D,GAAI,CAAAC,cAAyB,cAAGxE,KAAA,QAAKyE,OAAO,CAAEA,CAAA,GAAK,IAAI,CAAC9B,KAAK,CAAC,CAAE,CAAAH,QAAA,eAC5D1C,IAAA,QAAA0C,QAAA,CAAM9B,IAAI,CAAG,UAAU,CAAE,aAAa,CAAM,CAAC,cAC7CV,KAAA,QAAAwC,QAAA,EAAK,KAAG,CAAC,IAAI,CAACjC,KAAK,CAACI,eAAe,CAAC,IAAE,CAAE2D,cAAc,EAAO,CAAC,cAC9DxE,IAAA,QAAA0C,QAAA,CAAK,mBAAiB,CAAK,CAAC,cAC5BxC,KAAA,OAAAwC,QAAA,eACI1C,IAAA,OAAA0C,QAAA,CAAI,wBAAsB,CAAI,CAAC,cAC/BxC,KAAA,OAAAwC,QAAA,EAAI,IAAE,CAAC0B,MAAM,EAAI,cAACpE,IAAA,MAAG4E,IAAI,CAAER,MAAO,CAAA1B,QAAA,CAAC,qBAAmB,CAAG,CAAC,CAAE,KAAK,CAAC,CAAC,GAAC,cAAA1C,IAAA,MAAG4E,IAAI,CAAEP,QAAS,CAACQ,MAAM,CAAC,QAAQ,CAAAnC,QAAA,CAAC,eAAa,CAAG,CAAC,EAAI,CAAC,EAC7H,CAAC,CACJjC,KAAK,CAACuC,KAAK,CAAG,IAAI,CAAC8B,UAAU,CAAC,CAAC,CAAGnE,SAAS,EAC3C,CAAC,CACN,MAAO,CAAAb,WAAW,CAACY,KAAK,CAACgE,cAAc,CAAE,WAAW,CAAC,CACzD,CAEAI,UAAUA,CAAA,CAAE,CACR,QAAS,CAAAC,GAAGA,CAAC9B,CAAK,CAAC,CACfA,CAAC,CAAC+B,eAAe,CAAC,CAAC,CACnB,GAAI,CAAAC,CAAM,CAACtE,SAAS,CAAEuE,EAAO,CAACvE,SAAS,CAAEwE,EAAkB,CAACxE,SAAgB,CAAEyE,CAAM,CAACzE,SAAS,CAC9F,GAAI,CAAEsE,CAAC,CAAGhC,CAAC,CAAC4B,MAAM,CAACQ,KAAK,CAAE,CAAE,MAAOpC,CAAC,CAAE,CAClCb,OAAO,CAAC1B,KAAK,CAAC,oBAAoB,CAAEuC,CAAC,CAAC,CAC1C,CACA,GAAI,CAAEiC,EAAE,CAAGI,kBAAkB,CAACL,CAAC,CAAC,CAAE,CAAE,MAAOhC,CAAC,CAAE,CAC1Cb,OAAO,CAAC1B,KAAK,CAAC,wBAAwB,CAAEuC,CAAC,CAAC,CAC9C,CACA,GAAI,CAAEkC,EAAE,CAAGzF,oBAAoB,CAACwF,EAAE,CAAC,CAAE,CAAE,MAAOjC,CAAC,CAAE,CAC7Cb,OAAO,CAAC1B,KAAK,CAAC,uBAAuB,CAAEuC,CAAC,CAAC,CAC7C,CACA,GAAIkC,EAAE,CAAE,CAACA,EAAE,CAACI,IAAI,CAACC,CAAC,EAAG,CACjB,GAAI,CAAEJ,CAAC,CAAGzD,IAAI,CAAC8D,KAAK,CAACN,EAAE,CAACK,CAAQ,CAAC,CAAC,CAAE,MAAOvC,CAAC,CAAE,CAAEb,OAAO,CAAC1B,KAAK,CAAC,sBAAsB,CAAEuC,CAAC,CAAEuC,CAAC,CAAC,CAAE,CACjG,CAAC,CAAC,CAACE,OAAO,CAAC,IAAI,CACX,GAAI,CAAAC,GAAG,CAAG,CAACV,CAAC,CAAEW,GAAG,CAACV,EAAE,CAAEpC,EAAE,CAACqC,EAAE,CAAEC,CAAC,CAAC,CAC/BhD,OAAO,CAACyD,GAAG,CAAC,kBAAkB,CAAEF,GAAG,CAAC,CACpCG,CAAC,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC,CAACC,SAAS,CAAGpE,IAAI,CAACC,SAAS,CAACwD,CAAC,EAAKO,GAAG,CAAE,IAAI,CAAE,CAAC,CAAC,CAEtE,CAAC,CAAC,EAAC,IAAM,CACL,GAAI,CAAAA,GAAG,CAAG,CAACV,CAAC,CAAEW,GAAG,CAACV,EAAE,CAAEpC,EAAE,CAACqC,EAAE,CAAEC,CAAC,CAAC,CAC/BhD,OAAO,CAACyD,GAAG,CAAC,iBAAiB,CAAEF,GAAG,CAAC,CACnCG,CAAC,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC,CAACC,SAAS,CAAGpE,IAAI,CAACC,SAAS,CAACwD,CAAC,EAAKO,GAAG,CAAE,IAAI,CAAE,CAAC,CAAC,CACtE,CACJ,CACA,mBAAQzF,KAAA,CAAAE,SAAA,EAAAsC,QAAA,eAAE1C,IAAA,SAAA0C,QAAA,CAAM,kDAAgD,CAAM,CAAC,cAAA1C,IAAA,aAAUgG,SAAS,CAAE,OAAQ,CAACC,QAAQ,CAAElB,GAAI,CAAW,CAAC,cAAA/E,IAAA,aAAUkG,EAAE,CAAE,YAAa,CAACF,SAAS,CAAE,OAAQ,CAAE,CAAC,EAAE,CAAC,CACxL,CAGQvC,YAAYA,CAAC0C,aAAuB,CAAqB,CAC7D,GAAI,CAACA,aAAa,CAAE,MAAO,CAAAxF,SAAS,CACpC,GAAI,CAAAyF,YAAY,CAAG,CAAC,GAAGD,aAAa,CAAC,CACpC7C,MAAM,CAAS8C,YAAY,CAAGA,YAAY,CAC3C,MAAO,CAAAA,YAAY,CAACC,SAAS,CAC7BD,YAAY,CAAGvG,CAAC,CAACyG,cAAc,CAACF,YAAY,CAAC,CAC7CA,YAAY,CAACG,IAAI,CAAGJ,aAAa,CAACI,IAAI,CAAE;AACxC,MAAO,CAAAH,YAAY,CAACI,YAAY,CAChC,GAAI,CAAAvB,CAAC,CAAGtD,IAAI,CAACC,SAAS,CAAC/B,CAAC,CAACyG,cAAc,CAACF,YAAY,CAAC,CAAC,CACtD;AACR;AACA;AACA;AACA,iCAJQ,CAKA;AACA,GAAInB,CAAC,CAACwB,MAAM,CAAG,GAAG,CAAEhH,gBAAgB,CAACwF,CAAC,CAAC,CAACM,IAAI,CAAEC,CAAC,EAAI,IAAI,CAACnD,QAAQ,CAAC,CAACS,EAAE,CAAC0C,CAAC,CAAC,CAAC,CAAC,CACzE,MAAO,CAAAP,CAAC,CACZ,CACJ,CApKM5E,YAAY,CACPqG,KAAK,CAAW,cAAc,CADnCrG,YAAY,CAEPkE,cAAc,CAAG,CAAC,sCAAsC,CAAE,oCAAoC,CAAC,CAqL1G,GAAI,CAAAoC,WAAmB,CAAG,CAAC,CAC3B,QAAS,CAAAC,eAAeA,CAACnG,KAAa,CAAEoG,QAAkB,CAAc,CACpE,KAAM,CAAAC,GAAe,CAAG,CAAC,CAAQ,CACjCA,GAAG,CAACjG,eAAe,CAAG8F,WAAW,EAAE,CAAE;AACrC,MAAO,CAAAG,GAAG,CACd,CAEA,QAAS,CAAAC,kBAAkBA,CAACC,QAAuB,CAAiB,CAChE,KAAM,CAAAF,GAAkB,CAAG,CAAC,CAAC,CAC7B,MAAO,CAAAA,GAAG,CACd,CAEA,KAAM,CAAAG,YAAY,CACdzH,OAAO,CAA8CoH,eAAe,CAAEG,kBAAkB,CAAC,CAAC1G,YAAY,CAAC,CAG3G,MAAO,SAAS,CAAA6G,GAAGA,CAAC1G,KAAe,CAAgB,CAC/C,mBAAOR,IAAA,CAACiH,YAAY,EAAM,GAAGzG,KAAK,CAAAkC,QAAA,CAAIlC,KAAK,CAACkC,QAAQ,CAAe,CAAC,CACxE,CAEArC,YAAY,CAACqG,KAAK,CAAG,cAAc,CACnCO,YAAY,CAACP,KAAK,CAAG,cAAc,CACnCQ,GAAG,CAACR,KAAK,CAAG,KAAK","ignoreList":[]},"metadata":{},"sourceType":"module"}