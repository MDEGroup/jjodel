{"ast":null,"code":"import _regeneratorRuntime from\"C:/d/Programming/web/jodel-mde/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/d/Programming/web/jodel-mde/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import React from'react';import'./App.scss';import'./styles/view.scss';import'./styles/style.scss';import{DUser,LUser,SetRootFieldAction,statehistory,stateInitializer,U}from\"./joiner\";import{connect}from\"react-redux\";import Loader from\"./components/loader/Loader\";import{useEffectOnce}from\"usehooks-ts\";import{HashRouter,Route,Routes}from'react-router-dom';import PathChecker from\"./components/pathChecker/PathChecker\";import{AuthApi}from\"./api/persistance\";import{AccountPage,AllProjectsPage,ArchivePage,AuthPage,CommunityPage,ProjectPage,SettingsPage,UpdatesPage}from\"./pages\";import{ExternalLibraries}from\"./components/forEndUser/ExternalLibraries\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var userHasInteracted=false;function endPendingActions(){if(!userHasInteracted)firstInteraction();}function firstInteraction(){statehistory.globalcanundostate=true;}function App(props){var debug=props.debug;var isLoading=props.isLoading;var tooltip=props.tooltip;var user=props.user;useEffectOnce(function(){_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:SetRootFieldAction.new('isLoading',true);_context.next=3;return stateInitializer();case 3:/* Offline by default */if(!DUser.current)AuthApi.offline();_context.next=6;return U.sleep(1);case 6:SetRootFieldAction.new('isLoading',false);case 7:case\"end\":return _context.stop();}}},_callee);}))();});return/*#__PURE__*/_jsxs(_Fragment,{children:[isLoading&&/*#__PURE__*/_jsx(Loader,{}),/*#__PURE__*/_jsx(ExternalLibraries,{}),/*#__PURE__*/_jsxs(HashRouter,{children:[/*#__PURE__*/_jsx(PathChecker,{}),/*#__PURE__*/_jsxs(Routes,{children:[DUser.current&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Route,{path:'account',element:/*#__PURE__*/_jsx(AccountPage,{})}),/*#__PURE__*/_jsx(Route,{path:'settings',element:/*#__PURE__*/_jsx(SettingsPage,{})}),/*#__PURE__*/_jsx(Route,{path:'updates',element:/*#__PURE__*/_jsx(UpdatesPage,{})}),/*#__PURE__*/_jsx(Route,{path:'community',element:/*#__PURE__*/_jsx(CommunityPage,{})}),/*#__PURE__*/_jsx(Route,{path:'allProjects',element:/*#__PURE__*/_jsx(AllProjectsPage,{})}),/*#__PURE__*/_jsx(Route,{path:'archive',element:/*#__PURE__*/_jsx(ArchivePage,{})}),/*#__PURE__*/_jsx(Route,{path:'project',element:/*#__PURE__*/_jsx(ProjectPage,{})}),/*#__PURE__*/_jsx(Route,{path:'*',element:/*#__PURE__*/_jsx(AccountPage,{})})]}),/*#__PURE__*/_jsx(Route,{path:'auth',element:/*#__PURE__*/_jsx(AuthPage,{})}),/*#__PURE__*/_jsx(Route,{path:'*',element:isLoading?/*#__PURE__*/_jsx(\"div\",{}):/*#__PURE__*/_jsx(Loader,{})})]})]})]});/*\r\n    if (user) {\r\n        return(<div className={'d-flex flex-column h-100 p-1 REACT-ROOT' + (props.debug ? ' debug' : '')}\r\n                    onClick={e => statehistory.globalcanundostate = true}>\r\n            {isLoading && <Loader />}\r\n            {tooltip && <ToolTip />}\r\n            <Navbar />\r\n            <Helper />\r\n            {(project) ? (project.type === 'collaborative' && !DUser.offlineMode) ? <CollaborativeAttacher project={project} /> : <Editor /> : <Dashboard />}\r\n        </div>);\r\n    } else {\r\n        return(<>\r\n            {isLoading && <Loader />}\r\n            <Auth />\r\n        </>);\r\n    }\r\n    */}function mapStateToProps(state,ownProps){var ret={};ret.debug=state.debug;ret.isLoading=state.isLoading;ret.user=LUser.fromPointer(DUser.current);// needed here as props, because apparently functional components are memoized by default.\nret.offlineMode=DUser.offlineMode;ret.tooltip=state.tooltip;console.log(\"app re mapstate\",{u:DUser.current,o:DUser.offlineMode});return ret;}function mapDispatchToProps(dispatch){var ret={};return ret;}export var AppConnected=connect(mapStateToProps,mapDispatchToProps)(App);export default AppConnected;/* SPLASH SCREEN\r\nreturn(<div className={'w-100 h-100 text-center bg-smoke'}>\r\n    <img style={{height: '60%', width: '80%'}} className={'mt-3 rounded shadow'} src={SplashImage}></img>\r\n    <Oval height={80} width={80} wrapperStyle={{justifyContent: 'center'}} wrapperClass={'mt-3'}\r\n          color={'#475e6c'} secondaryColor={'#ff8811'} />\r\n</div>);\r\n*/","map":{"version":3,"names":["React","DUser","LUser","SetRootFieldAction","statehistory","stateInitializer","U","connect","Loader","useEffectOnce","HashRouter","Route","Routes","PathChecker","AuthApi","AccountPage","AllProjectsPage","ArchivePage","AuthPage","CommunityPage","ProjectPage","SettingsPage","UpdatesPage","ExternalLibraries","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","userHasInteracted","endPendingActions","firstInteraction","globalcanundostate","App","props","debug","isLoading","tooltip","user","_asyncToGenerator","_regeneratorRuntime","mark","_callee","wrap","_callee$","_context","prev","next","new","current","offline","sleep","stop","children","path","element","mapStateToProps","state","ownProps","ret","fromPointer","offlineMode","console","log","u","o","mapDispatchToProps","dispatch","AppConnected"],"sources":["C:/d/Programming/web/jodel-mde/src/App.tsx"],"sourcesContent":["import React, {Dispatch} from 'react';\r\nimport './App.scss';\r\nimport './styles/view.scss';\r\nimport './styles/style.scss';\r\nimport {DState, DUser, LUser, SetRootFieldAction, statehistory, stateInitializer, U} from \"./joiner\";\r\nimport {connect} from \"react-redux\";\r\nimport Loader from \"./components/loader/Loader\";\r\nimport {FakeStateProps} from \"./joiner/types\";\r\nimport {useEffectOnce} from \"usehooks-ts\";\r\nimport {HashRouter, Route, Routes} from 'react-router-dom';\r\nimport PathChecker from \"./components/pathChecker/PathChecker\";\r\nimport {AuthApi} from \"./api/persistance\";\r\nimport {\r\n    AccountPage,\r\n    AllProjectsPage,\r\n    ArchivePage,\r\n    AuthPage,\r\n    CommunityPage,\r\n    ProjectPage,\r\n    SettingsPage,\r\n    UpdatesPage\r\n} from \"./pages\";\r\nimport {ExternalLibraries} from \"./components/forEndUser/ExternalLibraries\";\r\n\r\nlet userHasInteracted = false;\r\nfunction endPendingActions() {\r\n    if (!userHasInteracted) firstInteraction();\r\n}\r\nfunction firstInteraction(){\r\n    statehistory.globalcanundostate = true;\r\n}\r\n\r\nfunction App(props: AllProps): JSX.Element {\r\n    const debug = props.debug;\r\n    const isLoading = props.isLoading;\r\n    const tooltip = props.tooltip;\r\n    let user: LUser = props.user;\r\n\r\n\r\n    useEffectOnce(() => {\r\n        (async function () {\r\n            SetRootFieldAction.new('isLoading', true);\r\n            await stateInitializer();\r\n            /* Offline by default */\r\n            if(!DUser.current) AuthApi.offline();\r\n            await U.sleep(1);\r\n            SetRootFieldAction.new('isLoading', false);\r\n        })();\r\n\r\n    });\r\n\r\n    return(<>\r\n        {isLoading && <Loader />}\r\n        <ExternalLibraries />\r\n        <HashRouter>\r\n            <PathChecker />\r\n            <Routes>\r\n                {DUser.current && <>\r\n                    <Route path={'account'} element={<AccountPage />} />\r\n                    <Route path={'settings'} element={<SettingsPage />} />\r\n                    <Route path={'updates'} element={<UpdatesPage />} />\r\n                    <Route path={'community'} element={<CommunityPage />} />\r\n                    <Route path={'allProjects'} element={<AllProjectsPage />} />\r\n                    <Route path={'archive'} element={<ArchivePage />} />\r\n                    <Route path={'project'} element={<ProjectPage />} />\r\n                    <Route path={'*'} element={<AccountPage />} />\r\n                </>}\r\n                <Route path={'auth'} element={<AuthPage />} />\r\n                <Route path={'*'} element={isLoading ? <div></div> : <Loader />} />\r\n            </Routes>\r\n        </HashRouter>\r\n    </>);\r\n\r\n    /*\r\n    if (user) {\r\n        return(<div className={'d-flex flex-column h-100 p-1 REACT-ROOT' + (props.debug ? ' debug' : '')}\r\n                    onClick={e => statehistory.globalcanundostate = true}>\r\n            {isLoading && <Loader />}\r\n            {tooltip && <ToolTip />}\r\n            <Navbar />\r\n            <Helper />\r\n            {(project) ? (project.type === 'collaborative' && !DUser.offlineMode) ? <CollaborativeAttacher project={project} /> : <Editor /> : <Dashboard />}\r\n        </div>);\r\n    } else {\r\n        return(<>\r\n            {isLoading && <Loader />}\r\n            <Auth />\r\n        </>);\r\n    }\r\n    */\r\n}\r\n\r\ninterface OwnProps {room?: string}\r\ninterface StateProps {\r\n    offlineMode: boolean,\r\n    debug: boolean,\r\n    isLoading: boolean\r\n    tooltip: string,\r\n    user: LUser\r\n}\r\ninterface DispatchProps {}\r\ntype AllProps = OwnProps & StateProps & DispatchProps;\r\n\r\n\r\nfunction mapStateToProps(state: DState, ownProps: OwnProps): StateProps {\r\n    const ret: StateProps = {} as FakeStateProps;\r\n    ret.debug = state.debug;\r\n    ret.isLoading = state.isLoading;\r\n    ret.user = LUser.fromPointer(DUser.current);\r\n    // needed here as props, because apparently functional components are memoized by default.\r\n    ret.offlineMode = DUser.offlineMode;\r\n    ret.tooltip = state.tooltip;\r\n    console.log(\"app re mapstate\", {u:DUser.current, o:DUser.offlineMode});\r\n    return ret;\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch<any>): DispatchProps {\r\n    const ret: DispatchProps = {};\r\n    return ret;\r\n}\r\n\r\nexport const AppConnected = connect<StateProps, DispatchProps, OwnProps, DState>(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(App);\r\n\r\nexport default AppConnected;\r\n\r\n\r\n/* SPLASH SCREEN\r\nreturn(<div className={'w-100 h-100 text-center bg-smoke'}>\r\n    <img style={{height: '60%', width: '80%'}} className={'mt-3 rounded shadow'} src={SplashImage}></img>\r\n    <Oval height={80} width={80} wrapperStyle={{justifyContent: 'center'}} wrapperClass={'mt-3'}\r\n          color={'#475e6c'} secondaryColor={'#ff8811'} />\r\n</div>);\r\n*/\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}