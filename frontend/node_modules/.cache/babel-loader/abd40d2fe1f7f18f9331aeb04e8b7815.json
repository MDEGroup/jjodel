{"ast":null,"code":"var _jsxFileName = \"C:\\\\d\\\\Programming\\\\web\\\\jodel-mde\\\\src\\\\components\\\\forEndUser\\\\Input.tsx\",\n  _s = $RefreshSig$();\nimport React, { useRef } from 'react';\nimport { connect } from 'react-redux';\nimport { Defaults, Keystrokes, LPointerTargetable, store, U } from '../../joiner';\nimport { useStateIfMounted } from 'use-state-if-mounted';\nimport './inputselect.scss';\nimport { Tooltip } from './Tooltip';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport function getSelectOptions(data, field, options, children) {\n  console.log(\"select options pre\", {\n    data,\n    field,\n    options\n  });\n  if (options) return options;\n  // children is auto-filled to empty array even if it is not set explicitly in jsx\n  if (Array.isArray(children) && children.length > 0) return children;\n  let returns;\n  let primitives;\n  let classes;\n  let enumerators;\n  let objects;\n  let m2classname;\n  let hasPrimitives = false;\n  let hasReturnTypes = false;\n  if (field === 'type') {\n    if (data) switch (data.className) {\n      case 'DValue':\n        let m2 = data.instanceof;\n        if (!m2) return data.model.allSubObjects;\n        let dm2 = m2.__raw;\n        if (dm2.className === \"DAttribute\") break;\n        m2classname = dm2.name;\n        let m1modelid = data.model.id;\n        return m2.instances.filter(o => o.model.id === m1modelid);\n      case 'DAttribute':\n        enumerators = data.enums;\n        hasPrimitives = true;\n        break;\n      case 'DReference':\n        classes = data.classes;\n        break;\n      case 'DOperation':\n        classes = data.classes;\n        enumerators = data.enums;\n        hasPrimitives = hasReturnTypes = true;\n        break;\n      case 'DParameter':\n        classes = data.classes;\n        enumerators = data.enums;\n        hasPrimitives = true;\n        break;\n    }\n  }\n  let state;\n  // todo: all this stuff might be better moved in mapstatetoprops, or the select list won't update properly.\n  if (hasPrimitives) {\n    if (!state) state = store.getState();\n    primitives = LPointerTargetable.fromPointer(state.primitiveTypes);\n  }\n  if (hasReturnTypes) {\n    if (!state) state = store.getState();\n    primitives = LPointerTargetable.fromPointer(state.returnTypes);\n  }\n  console.log(\"select options\", {\n    data,\n    field,\n    returns,\n    primitives,\n    classes,\n    enumerators\n  });\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [returns && returns.length > 0 && /*#__PURE__*/_jsxDEV(\"optgroup\", {\n      label: 'Defaults',\n      children: returns.map((returnType, i) => {\n        return /*#__PURE__*/_jsxDEV(\"option\", {\n          value: returnType.id,\n          children: returnType.name\n        }, i, false, {\n          fileName: _jsxFileName,\n          lineNumber: 68,\n          columnNumber: 28\n        }, this);\n      })\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 49\n    }, this), primitives && primitives.length && /*#__PURE__*/_jsxDEV(\"optgroup\", {\n      label: 'Primitives',\n      children: primitives.map((primitive, i) => {\n        return /*#__PURE__*/_jsxDEV(\"option\", {\n          value: primitive.id,\n          children: primitive.name\n        }, i, false, {\n          fileName: _jsxFileName,\n          lineNumber: 73,\n          columnNumber: 28\n        }, this);\n      })\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 51\n    }, this), enumerators && enumerators.length > 0 && /*#__PURE__*/_jsxDEV(\"optgroup\", {\n      label: 'Enumerators',\n      children: enumerators.map((enumerator, i) => {\n        return /*#__PURE__*/_jsxDEV(\"option\", {\n          value: enumerator.id,\n          children: enumerator.name\n        }, i, false, {\n          fileName: _jsxFileName,\n          lineNumber: 78,\n          columnNumber: 28\n        }, this);\n      })\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 57\n    }, this), classes && classes.length > 0 && /*#__PURE__*/_jsxDEV(\"optgroup\", {\n      label: 'Classes',\n      children: classes.map((classifier, i) => {\n        return /*#__PURE__*/_jsxDEV(\"option\", {\n          value: classifier.id,\n          children: classifier.name\n        }, i, false, {\n          fileName: _jsxFileName,\n          lineNumber: 83,\n          columnNumber: 28\n        }, this);\n      })\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 49\n    }, this), objects && objects.length > 0 && /*#__PURE__*/_jsxDEV(\"optgroup\", {\n      label: m2classname ? 'Instances of ' + m2classname : \"All objects\",\n      children: objects.map((classifier, i) => {\n        return /*#__PURE__*/_jsxDEV(\"option\", {\n          value: classifier.id,\n          children: classifier.name\n        }, i, false, {\n          fileName: _jsxFileName,\n          lineNumber: 88,\n          columnNumber: 28\n        }, this);\n      })\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 49\n    }, this)]\n  }, void 0, true);\n}\nexport function InputComponent(props) {\n  _s();\n  var _data;\n  const data = props.data;\n  const getter = props.getter;\n  const setter = props.setter;\n  const field = props.field;\n  const oldValue = !data ? undefined : getter ? getter(data, field) : data[field]; // !== undefined); ? data[field] : 'undefined'\n  let [value, setValue] = useStateIfMounted(oldValue);\n  const [isTouched, setIsTouched] = useStateIfMounted(false);\n  const inputRef = useRef(null);\n  if (props.tag === 'select') value = oldValue; // select does not use state.\n  let serializeValue = val => (val === null || val === void 0 ? void 0 : val.id) || value;\n  if (props.tag === \"select\") console.log(\"select render 0\", oldValue, value, isTouched);\n  function valueDidChange(v1, v2) {\n    return serializeValue(v1) !== serializeValue(v2);\n    /*\r\n    let rawv1 = v1?.__raw || v1;\r\n    let rawv2 = v2?.__raw || v2;\r\n    if (rawv1 !== v1 || rawv2 !== v2) { return v1?.clonedCounter !== v2?.clonedCounter; }\r\n    return v1 !== v2;*/\n  }\n\n  // I check if the value that I have in my local state is being edited by other <Input />\n  if (props.tag !== 'select' && !isTouched && valueDidChange(value, oldValue)) {\n    setValue(serializeValue(oldValue));\n    setIsTouched(false);\n  }\n  if (!(data || getter && setter)) return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: \"Either props.data or both getter & setter are required.\"\n  }, void 0, false);\n  let readOnly;\n  if (props.readonly !== undefined) readOnly = props.readonly;\n  // else if (props.disabled !== undefined) readOnly = props.disabled;\n  else readOnly = props.debugmodee !== 'true' && Defaults.check(data === null || data === void 0 ? void 0 : data.id);\n  const type = props.type ? props.type : 'text';\n  const label = props.jsxLabel || props.label;\n  let tooltip = (props.tooltip === true ? data === null || data === void 0 ? void 0 : (_data = data['__info_of__' + field]) === null || _data === void 0 ? void 0 : _data.txt : props.tooltip) || '';\n  let css = ''; //'my-auto input ';\n  //css += (jsxLabel) ? 'ms-1' : (label) ? 'ms-auto' : '';\n  css += props.hidden ? ' hidden-input' : '';\n  let autosize = props.autosize === undefined ? false : props.autosize; // props.type==='text'\n  css += autosize ? ' autosize-input' : '';\n  const isBoolean = ['checkbox', 'radio'].includes(type);\n  const onChange = evt => {\n    console.log(\"onChange\", {\n      oldValue,\n      value,\n      nv: getValueFromEvent(evt),\n      evt,\n      ev: evt.target.value\n    });\n    if (readOnly) return;\n    if (isBoolean) {\n      const target = evt.target.checked;\n      if (setter) setter(target, data, field);else data[field] = target;\n      return;\n    }\n    if (props.tag === \"select\") {\n      confirmValue(evt);\n    } else {\n      console.log(\"setValue\", {\n        value,\n        nv: getValueFromEvent(evt),\n        evt,\n        ev: evt.target.value\n      });\n      setValue(getValueFromEvent(evt));\n      setIsTouched(true); // I'm editing the element in my local state.\n      // the actual set is done in onBlur\n    }\n  };\n\n  const onKeyDown = evt => {\n    if (props.tag === 'select') return;\n    if (evt.key === Keystrokes.enter) confirmValue(evt);\n    if (evt.key === Keystrokes.escape) {\n      const oldValue = getter ? getter(data, field) : data[field];\n      writeHtmlValueFromEvent(evt, oldValue);\n      setValue(serializeValue(oldValue));\n      setIsTouched(false);\n      evt.target.blur();\n      // to optimize: probably can remove a large part of this function because this should trigger blur event as well. or move \"change\" event contents here\n      // optimize 2: memoize the whole component, so it won't update unless the displayed value changed. this would also fix cursor going to input end when pressing enter.\n    }\n  };\n\n  const getValueFromEvent = evt => {\n    switch (props.tag) {\n      case \"textarea\":\n      case \"input\":\n      case \"select\":\n      case \"\":\n      case null:\n      case undefined:\n        return evt.target.value;\n      default:\n        return evt.target.innerText;\n    }\n  };\n  const writeHtmlValueFromEvent = (evt, value) => {\n    value = serializeValue(value);\n    switch (props.tag) {\n      case \"textarea\":\n      case \"input\":\n      case \"select\":\n      case \"\":\n      case null:\n      case undefined:\n        return evt.target.value = value;\n      default:\n        return evt.target.innerText = value;\n    }\n  };\n  const onBlur = evt => {\n    if (props.tag === 'select') return;\n    confirmValue(evt);\n  };\n  const confirmValue = evt => {\n    if (readOnly || isBoolean) return;\n    const newValue = getValueFromEvent(evt);\n    const oldValue = getter ? getter(data, field) : data[field];\n    console.log(\"onChange confirm\", {\n      evt,\n      newValue,\n      oldValue,\n      changed: valueDidChange(newValue, oldValue),\n      readOnly,\n      isBoolean,\n      nnv: serializeValue(newValue)\n    });\n    if (valueDidChange(newValue, oldValue)) {\n      if (setter) setter(newValue, data, field);else data[field] = serializeValue(newValue);\n    }\n    // I terminate my editing, so I communicate it to other <Input /> that render the same field.\n    setIsTouched(false);\n  };\n  if (props.tag === \"select\") console.log(\"select render 4\");\n  const otherprops = {\n    ...props\n  };\n  delete otherprops.data;\n  delete otherprops.field;\n  delete otherprops.getter;\n  delete otherprops.setter;\n  delete otherprops.label;\n  delete otherprops.jsxLabel;\n  delete otherprops.tooltip;\n  delete otherprops.hidden;\n  delete otherprops.inputStyle;\n  delete otherprops.children;\n  delete otherprops.autosize; // because react complains is bool in dom attribute or unknown attrib name\n\n  let checked = undefined;\n  if (isBoolean) checked = typeof value === \"boolean\" ? value : typeof value === \"string\" ? U.fromBoolString(value) : !!value;\n  let cursor;\n  if (tooltip) cursor = 'help';else if (readOnly) cursor = 'not-allowed';else if (isBoolean) cursor = 'pointer';else cursor = 'auto';\n  let inputProps = {\n    spellCheck: props.spellCkeck || false,\n    readOnly,\n    disabled: readOnly,\n    type,\n    value: serializeValue(value),\n    checked,\n    className: [props.inputClassName, css].join(' '),\n    style: props.inputStyle || {},\n    onChange,\n    onBlur,\n    onKeyDown\n  }; // key:`${field}.${data?.id}`\n  if (!inputProps.style.cursor && cursor === 'not-allowed') {\n    inputProps.style.cursor = cursor;\n  }\n  let input;\n  let rootprops = {\n    ...otherprops\n  };\n  switch (typeof rootprops.ref) {\n    default:\n      rootprops.ref = inputRef;\n      break;\n    case \"object\":\n      let oldref = rootprops.ref;\n      rootprops.ref = v => {\n        oldref.current = inputRef.current = v;\n      };\n      break;\n    case \"function\":\n      let oldreff = rootprops.ref;\n      rootprops.ref = v => {\n        oldreff(v);\n        inputRef.current = v;\n      };\n      break;\n  }\n  if (tooltip) {\n    rootprops.onMouseEnter = () => Tooltip.show(tooltip, true, rootprops.ref);\n    rootprops.onMouseLeave = () => Tooltip.hide();\n  }\n  let rootkeys = new Set(...Object.keys(rootprops));\n  //  merge events: ltodo: might want to distinguish which events are merged between root and input and which not.\n  //  onChange surely needs merge. onMouseHover might not to let it trigger on label too.\n  for (let k of rootkeys) {\n    if (!(k[0] === 'o' && k[1] === 'n' && k[2] && k[2].toUpperCase() === k[2])) continue;\n    if (inputProps[k]) inputProps[k] = function () {\n      for (var _len = arguments.length, a = new Array(_len), _key = 0; _key < _len; _key++) {\n        a[_key] = arguments[_key];\n      }\n      inputProps[k](arguments);\n      rootprops[k](arguments);\n    };else inputProps[k] = rootprops[k];\n    delete rootprops[k];\n  }\n  if (props.tag === \"select\") console.log(\"select render 8\");\n  if (!label && !autosize) {\n    if (rootprops.className) inputProps.className = rootprops.className + ' ' + inputProps.className;\n    if (rootprops.style) U.objectMergeInPlace(inputProps.style, rootprops.style);\n    inputProps = {\n      ...rootprops,\n      ...inputProps\n    };\n    switch (props.tag) {\n      case \"textarea\":\n        return /*#__PURE__*/_jsxDEV(\"textarea\", {\n          ...inputProps,\n          children: inputProps.value\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 266,\n          columnNumber: 37\n        }, this);\n      case \"select\":\n        return /*#__PURE__*/_jsxDEV(\"select\", {\n          ...inputProps,\n          children: getSelectOptions(data, field, props.options, props.children)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 267,\n          columnNumber: 35\n        }, this);\n      case null:\n      case undefined:\n      case \"\":\n      case \"input\":\n        return /*#__PURE__*/_jsxDEV(\"input\", {\n          ...inputProps\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 268,\n          columnNumber: 70\n        }, this);\n      default:\n        inputProps.contentEditable = inputProps.contentEditable !== false;\n        return /*#__PURE__*/React.createElement(props.tag, inputProps, props.children);\n    }\n  }\n  if (autosize) rootprops.className = (rootprops.className || '') + ' autosize-input-container';\n  if (props.tag === \"select\") console.log(\"select render 9\");\n  switch (props.tag) {\n    case \"textarea\":\n      input = /*#__PURE__*/_jsxDEV(\"textarea\", {\n        ...inputProps,\n        children: inputProps.value\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 278,\n        columnNumber: 34\n      }, this);\n      break;\n    case \"select\":\n      input = /*#__PURE__*/_jsxDEV(\"select\", {\n        ...inputProps,\n        children: getSelectOptions(data, field, props.options, props.children)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 279,\n        columnNumber: 32\n      }, this);\n      break;\n    case null:\n    case undefined:\n    case \"\":\n    case \"input\":\n      input = /*#__PURE__*/_jsxDEV(\"input\", {\n        ...inputProps\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 280,\n        columnNumber: 67\n      }, this);\n      break;\n    default:\n      inputProps.contentEditable = inputProps.contentEditable !== false;\n      input = /*#__PURE__*/React.createElement(props.tag, inputProps, props.children);\n      break;\n  }\n  if (props.tag === \"select\") console.log(\"select render 10\");\n  return /*#__PURE__*/_jsxDEV(\"label\", {\n    ...rootprops,\n    children: [label || undefined, input]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 287,\n    columnNumber: 12\n  }, this);\n  /*\r\n  return(<label className={'p-1'} {...otherprops}\r\n                style={rootStyle}>\r\n        {label && <span className={'my-auto'} onMouseEnter={e => setShowTooltip(true)}\r\n                      onMouseLeave={e => setShowTooltip(false)}>{label}\r\n      </span>}\r\n        {jsxLabel && <span onMouseEnter={e => setShowTooltip(true)}\r\n                         onMouseLeave={e => setShowTooltip(false)} style={{width: '100%'}}>{jsxLabel}\r\n      </span>}\r\n        {(tooltip && showTooltip) && <div className={'my-tooltip'}>\r\n          <b className={'text-center text-capitalize'}>{field}</b>\r\n          <br />\r\n          <label>{tooltip}</label>\r\n      </div>}\r\n        {autosize ? <div className={(autosize ? 'autosize-input-container' : '') + (props.asLabel ? ' labelstyle' : '')}\r\n                       data-value={value}>{input}\r\n      </div> : input}\r\n  </label>);\r\n  */\n}\n_s(InputComponent, \"nlzZzFhpjnEHW6d8jEzTV191MA8=\", false, function () {\n  return [useStateIfMounted, useStateIfMounted];\n});\n_c = InputComponent;\nInputComponent.cname = 'InputComponent';\nexport function InputMapStateToProps(state, ownProps) {\n  var _ownProps$data;\n  const ret = {};\n  const pointer = typeof ownProps.data === 'string' ? ownProps.data : (_ownProps$data = ownProps.data) === null || _ownProps$data === void 0 ? void 0 : _ownProps$data.id;\n  ret.debugmodee = state.debug ? 'true' : 'false';\n  if (pointer) ret.data = LPointerTargetable.fromPointer(pointer);\n  return ret;\n}\n_c2 = InputMapStateToProps;\nfunction mapDispatchToProps(dispatch) {\n  const ret = {};\n  return ret;\n}\nexport const InputConnected = connect(InputMapStateToProps, mapDispatchToProps)(InputComponent);\n\n// export function Input(props: InputOwnProps, children: (string | React.Component)[] = []): ReactElement { return 'input' as any; }\nexport function Input(props) {\n  let children = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n  return /*#__PURE__*/_jsxDEV(InputConnected, {\n    ...props,\n    children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 375,\n    columnNumber: 12\n  }, this);\n}\n\n// export function TextArea(props: InputOwnProps, children: (string | React.Component)[] = []): ReactElement { return 'textarea' as any; }\n_c3 = Input;\nexport function TextArea(props) {\n  let children = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n  return /*#__PURE__*/_jsxDEV(InputConnected, {\n    ...props,\n    children,\n    tag: \"textarea\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 380,\n    columnNumber: 12\n  }, this);\n}\n//export function Select(props: SelectOwnProps, children: (string | React.Component)[] = []): ReactElement { return 'select' as any; }\n_c4 = TextArea;\nexport function Select(props) {\n  let children = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n  return /*#__PURE__*/_jsxDEV(InputConnected, {\n    ...props,\n    children,\n    tag: \"select\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 384,\n    columnNumber: 12\n  }, this);\n}\n_c5 = Select;\nexport const Edit = Input;\nInputComponent.cname = 'InputComponent';\nInputConnected.cname = 'InputConnected';\nInput.cname = 'Input';\nTextArea.cname = 'TextArea';\nSelect.cname = 'Select';\nEdit.cname = 'Edit';\nvar _c, _c2, _c3, _c4, _c5;\n$RefreshReg$(_c, \"InputComponent\");\n$RefreshReg$(_c2, \"InputMapStateToProps\");\n$RefreshReg$(_c3, \"Input\");\n$RefreshReg$(_c4, \"TextArea\");\n$RefreshReg$(_c5, \"Select\");","map":{"version":3,"names":["React","useRef","connect","Defaults","Keystrokes","LPointerTargetable","store","U","useStateIfMounted","Tooltip","jsxDEV","_jsxDEV","Fragment","_Fragment","getSelectOptions","data","field","options","children","console","log","Array","isArray","length","returns","primitives","classes","enumerators","objects","m2classname","hasPrimitives","hasReturnTypes","className","m2","instanceof","model","allSubObjects","dm2","__raw","name","m1modelid","id","instances","filter","o","enums","state","getState","fromPointer","primitiveTypes","returnTypes","label","map","returnType","i","value","fileName","_jsxFileName","lineNumber","columnNumber","primitive","enumerator","classifier","InputComponent","props","_s","_data","getter","setter","oldValue","undefined","setValue","isTouched","setIsTouched","inputRef","tag","serializeValue","val","valueDidChange","v1","v2","readOnly","readonly","debugmodee","check","type","jsxLabel","tooltip","txt","css","hidden","autosize","isBoolean","includes","onChange","evt","nv","getValueFromEvent","ev","target","checked","confirmValue","onKeyDown","key","enter","escape","writeHtmlValueFromEvent","blur","innerText","onBlur","newValue","changed","nnv","otherprops","inputStyle","fromBoolString","cursor","inputProps","spellCheck","spellCkeck","disabled","inputClassName","join","style","input","rootprops","ref","oldref","v","current","oldreff","onMouseEnter","show","onMouseLeave","hide","rootkeys","Set","Object","keys","k","toUpperCase","_len","arguments","a","_key","objectMergeInPlace","contentEditable","createElement","_c","cname","InputMapStateToProps","ownProps","_ownProps$data","ret","pointer","debug","_c2","mapDispatchToProps","dispatch","InputConnected","Input","_c3","TextArea","_c4","Select","_c5","Edit","$RefreshReg$"],"sources":["C:/d/Programming/web/jodel-mde/src/components/forEndUser/Input.tsx"],"sourcesContent":["import React, {Dispatch, KeyboardEvent, LegacyRef, ReactElement, ReactNode, useRef} from 'react';\r\nimport {connect} from 'react-redux';\r\nimport {DState} from '../../redux/store';\r\nimport {\r\n    Defaults,\r\n    DObject,\r\n    DPointerTargetable,\r\n    GObject,\r\n    Keystrokes, LAttribute,\r\n    LClass, LEnumerator, LModel, LObject,\r\n    LPointerTargetable, LReference, LValue,\r\n    Overlap,\r\n    Pointer, PrimitiveType, Selectors,\r\n    store,\r\n    U\r\n} from '../../joiner';\r\nimport {useStateIfMounted} from 'use-state-if-mounted';\r\nimport './inputselect.scss';\r\nimport { Tooltip } from './Tooltip';\r\n\r\n\r\nexport function getSelectOptions(data: any, field: string, options: ReactNode, children?: ReactNode) {\r\n    console.log(\"select options pre\", {data, field, options});\r\n    if (options) return options;\r\n    // children is auto-filled to empty array even if it is not set explicitly in jsx\r\n    if (Array.isArray(children) && children.length > 0) return children;\r\n    let returns: LClass[] | undefined;\r\n    let primitives: LClass[] | undefined;\r\n    let classes: LClass[] | undefined;\r\n    let enumerators: LEnumerator[] | undefined;\r\n    let objects: LObject[] | undefined;\r\n    let m2classname: string | undefined;\r\n    let hasPrimitives: boolean = false;\r\n    let hasReturnTypes: boolean = false;\r\n    if ((field) === 'type') {\r\n        if (data) switch (data.className) {\r\n            case 'DValue':\r\n                let m2: LReference | LAttribute | undefined = (data as LValue).instanceof;\r\n                if (!m2) return (data as LValue).model.allSubObjects;\r\n                let dm2 = m2.__raw;\r\n                if (dm2.className === \"DAttribute\") break;\r\n                m2classname = dm2.name;\r\n                let m1modelid = data.model.id;\r\n                return m2.instances.filter( o => o.model.id === m1modelid);\r\n            case 'DAttribute': enumerators = data.enums; hasPrimitives = true; break;\r\n            case 'DReference': classes = data.classes; break;\r\n            case 'DOperation': classes = data.classes; enumerators = data.enums; hasPrimitives = hasReturnTypes = true; break;\r\n            case 'DParameter': classes = data.classes; enumerators = data.enums; hasPrimitives = true; break;\r\n        }\r\n    }\r\n    let state: DState | undefined;\r\n    // todo: all this stuff might be better moved in mapstatetoprops, or the select list won't update properly.\r\n    if (hasPrimitives) {\r\n        if (!state) state = store.getState();\r\n        primitives = LPointerTargetable.fromPointer(state.primitiveTypes);\r\n    }\r\n    if (hasReturnTypes) {\r\n        if (!state) state = store.getState();\r\n        primitives = LPointerTargetable.fromPointer(state.returnTypes);\r\n    }\r\n\r\n    console.log(\"select options\", {data, field, returns, primitives, classes, enumerators})\r\n\r\n    return (\r\n        <>\r\n            {(returns && returns.length > 0) && <optgroup label={'Defaults'}>\r\n                {returns.map((returnType, i) => {\r\n                    return <option key={i} value={returnType.id}>{returnType.name}</option>\r\n                })}\r\n            </optgroup>}\r\n            {(primitives && primitives.length) && <optgroup label={'Primitives'}>\r\n                {primitives.map((primitive, i) => {\r\n                    return <option key={i} value={primitive.id}>{primitive.name}</option>\r\n                })}\r\n            </optgroup>}\r\n            {(enumerators && enumerators.length > 0) && <optgroup label={'Enumerators'}>\r\n                {enumerators.map((enumerator, i) => {\r\n                    return <option key={i} value={enumerator.id}>{enumerator.name}</option>\r\n                })}\r\n            </optgroup>}\r\n            {(classes && classes.length > 0) && <optgroup label={'Classes'}>\r\n                {classes.map((classifier, i) => {\r\n                    return <option key={i} value={classifier.id}>{classifier.name}</option>\r\n                })}\r\n            </optgroup>}\r\n            {(objects && objects.length > 0) && <optgroup label={m2classname ? 'Instances of ' + m2classname : \"All objects\"}>\r\n                {objects.map((classifier, i) => {\r\n                    return <option key={i} value={classifier.id}>{classifier.name}</option>\r\n                })}\r\n            </optgroup>}\r\n            {/*options*/}\r\n        </>);\r\n}\r\nexport function InputComponent(props: AllProps) {\r\n    const data = props.data;\r\n    const getter = props.getter;\r\n    const setter = props.setter;\r\n    const field: string = props.field as string;\r\n    const oldValue: PrimitiveType | LPointerTargetable = (!data) ? undefined : (getter) ? getter(data, field) : data[field]; // !== undefined); ? data[field] : 'undefined'\r\n    let [value, setValue] = useStateIfMounted<PrimitiveType | LPointerTargetable>(oldValue);\r\n    const [isTouched, setIsTouched] = useStateIfMounted(false);\r\n    const inputRef = useRef<Element | null>(null);\r\n    if (props.tag === 'select') value = oldValue; // select does not use state.\r\n    let serializeValue = (val: LPointerTargetable | PrimitiveType): string | PrimitiveType => (val as LPointerTargetable)?.id || (value as any);\r\n\r\n    if (props.tag === \"select\")console.log(\"select render 0\", oldValue, value, isTouched);\r\n    function valueDidChange(v1: any, v2: any): boolean {\r\n        return serializeValue(v1) !== serializeValue(v2);\r\n        /*\r\n        let rawv1 = v1?.__raw || v1;\r\n        let rawv2 = v2?.__raw || v2;\r\n        if (rawv1 !== v1 || rawv2 !== v2) { return v1?.clonedCounter !== v2?.clonedCounter; }\r\n        return v1 !== v2;*/\r\n    }\r\n\r\n    // I check if the value that I have in my local state is being edited by other <Input />\r\n    if (props.tag !== 'select' && !isTouched && valueDidChange(value, oldValue)){\r\n        setValue(serializeValue(oldValue));\r\n        setIsTouched(false);\r\n    }\r\n\r\n\r\n    if (!(data || (getter && setter))) return(<>Either props.data or both getter & setter are required.</>);\r\n    let readOnly: boolean;\r\n    if (props.readonly !== undefined) readOnly = props.readonly;\r\n    // else if (props.disabled !== undefined) readOnly = props.disabled;\r\n    else readOnly = props.debugmodee !== 'true' && Defaults.check(data?.id)\r\n\r\n    const type = (props.type) ? props.type : 'text';\r\n    const label: ReactNode|undefined = props.jsxLabel || props.label;\r\n    let tooltip: ReactNode|string|undefined = ((props.tooltip === true) ? data?.['__info_of__' + field]?.txt : props.tooltip) || '';\r\n\r\n    let css = '';//'my-auto input ';\r\n    //css += (jsxLabel) ? 'ms-1' : (label) ? 'ms-auto' : '';\r\n    css += (props.hidden) ? ' hidden-input' : '';\r\n    let autosize: boolean = props.autosize === undefined ? false : props.autosize; // props.type==='text'\r\n    css += autosize ? ' autosize-input' : '';\r\n    const isBoolean = (['checkbox', 'radio'].includes(type));\r\n\r\n\r\n    const onChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\r\n        console.log(\"onChange\", {oldValue, value, nv: getValueFromEvent(evt), evt, ev: evt.target.value});\r\n        if (readOnly) return;\r\n        if (isBoolean) {\r\n            const target = evt.target.checked;\r\n            if (setter) setter(target, data, field);\r\n            else data[field] = target;\r\n            return;\r\n        }\r\n        if (props.tag === \"select\") {\r\n            confirmValue(evt as any);\r\n        } else {\r\n            console.log(\"setValue\", {value, nv: getValueFromEvent(evt), evt, ev: evt.target.value});\r\n            setValue(getValueFromEvent(evt));\r\n            setIsTouched(true);     // I'm editing the element in my local state.\r\n            // the actual set is done in onBlur\r\n        }\r\n    }\r\n    const onKeyDown = (evt: React.KeyboardEvent<HTMLInputElement>) => {\r\n        if (props.tag === 'select') return;\r\n        if (evt.key === Keystrokes.enter) confirmValue(evt as any);\r\n        if (evt.key === Keystrokes.escape) {\r\n            const oldValue = getter ? getter(data, field) : data[field];\r\n            writeHtmlValueFromEvent(evt as any, oldValue);\r\n            setValue(serializeValue(oldValue));\r\n            setIsTouched(false);\r\n            (evt.target as HTMLInputElement).blur();\r\n            // to optimize: probably can remove a large part of this function because this should trigger blur event as well. or move \"change\" event contents here\r\n            // optimize 2: memoize the whole component, so it won't update unless the displayed value changed. this would also fix cursor going to input end when pressing enter.\r\n        }\r\n    }\r\n    const getValueFromEvent = (evt: { target: HTMLInputElement | HTMLSelectElement | HTMLTextAreaElement }) => {\r\n        switch (props.tag){\r\n            case \"textarea\": case \"input\": case \"select\": case \"\": case null: case undefined: return evt.target.value;\r\n            default: return evt.target.innerText;\r\n        }\r\n    }\r\n    const writeHtmlValueFromEvent = (evt: { target: HTMLInputElement | HTMLSelectElement | HTMLTextAreaElement }, value: any) => {\r\n        value = serializeValue(value);\r\n        switch (props.tag){\r\n            case \"textarea\": case \"input\": case \"select\": case \"\": case null: case undefined: return evt.target.value = value;\r\n            default: return evt.target.innerText = value;\r\n        }\r\n    }\r\n\r\n    const onBlur = (evt: { target: HTMLInputElement | HTMLSelectElement | HTMLTextAreaElement }) => {\r\n        if (props.tag === 'select') return;\r\n        confirmValue(evt);\r\n    }\r\n    const confirmValue = (evt: { target: HTMLInputElement | HTMLSelectElement | HTMLTextAreaElement }) => {\r\n        if (readOnly || isBoolean) return;\r\n        const newValue: string = getValueFromEvent(evt);\r\n        const oldValue = getter ? getter(data, field) : data[field];\r\n        console.log(\"onChange confirm\", {evt, newValue, oldValue, changed: valueDidChange(newValue, oldValue), readOnly, isBoolean, nnv:serializeValue(newValue)});\r\n        if (valueDidChange(newValue, oldValue)){\r\n            if (setter) setter(newValue, data, field);\r\n            else data[field] = serializeValue(newValue);\r\n        }\r\n        // I terminate my editing, so I communicate it to other <Input /> that render the same field.\r\n        setIsTouched(false);\r\n    }\r\n    if (props.tag === \"select\")console.log(\"select render 4\")\r\n\r\n    const otherprops: GObject = {...props};\r\n    delete otherprops.data;\r\n    delete otherprops.field;\r\n    delete otherprops.getter;\r\n    delete otherprops.setter;\r\n    delete otherprops.label;\r\n    delete otherprops.jsxLabel;\r\n    delete otherprops.tooltip;\r\n    delete otherprops.hidden;\r\n    delete otherprops.inputStyle;\r\n    delete otherprops.children;\r\n    delete otherprops.autosize; // because react complains is bool in dom attribute or unknown attrib name\r\n\r\n    let checked: boolean | undefined = undefined;\r\n    if (isBoolean) checked = typeof value === \"boolean\" ? value : (typeof value === \"string\" ? U.fromBoolString(value) : !!value);\r\n\r\n    let cursor: string;\r\n    if (tooltip) cursor = 'help';\r\n    else if (readOnly) cursor = 'not-allowed';\r\n    else if (isBoolean) cursor = 'pointer';\r\n    else cursor = 'auto';\r\n\r\n    let inputProps: GObject = { spellCheck: (props as any).spellCkeck || false, readOnly, disabled: readOnly, type, value: serializeValue(value), checked,\r\n        className: [props.inputClassName, css].join(' '),\r\n        style: (props.inputStyle || {}),\r\n        onChange, onBlur, onKeyDown} // key:`${field}.${data?.id}`\r\n    if (!inputProps.style.cursor && cursor === 'not-allowed') { inputProps.style.cursor = cursor; }\r\n\r\n    let input: ReactNode;\r\n    let rootprops: GObject = {...otherprops};\r\n    switch (typeof rootprops.ref) {\r\n        default: rootprops.ref = inputRef; break;\r\n        case \"object\":\r\n            let oldref = rootprops.ref;\r\n            rootprops.ref = (v: Element | null) => { oldref.current = inputRef.current = v; }\r\n            break;\r\n        case \"function\":\r\n            let oldreff = rootprops.ref;\r\n            rootprops.ref = (v: Element | null) => { oldreff(v); inputRef.current = v; }\r\n            break;\r\n    }\r\n\r\n    if (tooltip) {\r\n        rootprops.onMouseEnter = () => Tooltip.show(tooltip, true, (rootprops.ref));\r\n        rootprops.onMouseLeave = () => Tooltip.hide();\r\n    }\r\n    let rootkeys = new Set(...Object.keys(rootprops));\r\n    //  merge events: ltodo: might want to distinguish which events are merged between root and input and which not.\r\n    //  onChange surely needs merge. onMouseHover might not to let it trigger on label too.\r\n    for (let k of rootkeys) {\r\n        if (!(k[0] === 'o' && k[1] === 'n' && k[2] && k[2].toUpperCase() === k[2])) continue;\r\n        if (inputProps[k]) inputProps[k] = function(...a:any) { inputProps[k](arguments); rootprops[k](arguments); }\r\n        else inputProps[k] = rootprops[k];\r\n        delete rootprops[k];\r\n    }\r\n    if (props.tag === \"select\")console.log(\"select render 8\")\r\n\r\n    if (!label && !autosize) {\r\n        if (rootprops.className) inputProps.className = rootprops.className + ' ' + inputProps.className;\r\n        if (rootprops.style) U.objectMergeInPlace(inputProps.style, rootprops.style);\r\n        inputProps = {...rootprops, ...inputProps};\r\n        switch (props.tag){\r\n            case \"textarea\": return <textarea {...inputProps}>{inputProps.value}</textarea>;\r\n            case \"select\": return <select {...inputProps}>{getSelectOptions(data, field, props.options, props.children)}</select>;\r\n            case null: case undefined: case \"\": case \"input\": return <input {...inputProps} />;\r\n            default:\r\n                inputProps.contentEditable = inputProps.contentEditable !== false;\r\n                return React.createElement(props.tag, inputProps, props.children);\r\n        }\r\n    }\r\n    if (autosize) rootprops.className = (rootprops.className || '') + ' autosize-input-container';\r\n    if (props.tag === \"select\")console.log(\"select render 9\")\r\n\r\n    switch (props.tag){\r\n        case \"textarea\": input = <textarea {...inputProps}>{inputProps.value}</textarea>; break;\r\n        case \"select\": input = <select {...inputProps}>{getSelectOptions(data, field, props.options, props.children)}</select>; break;\r\n        case null: case undefined: case \"\": case \"input\": input = <input {...inputProps} />; break;\r\n        default:\r\n            inputProps.contentEditable = inputProps.contentEditable !== false;\r\n            input = React.createElement(props.tag, inputProps, props.children); break;\r\n    }\r\n    if (props.tag === \"select\")console.log(\"select render 10\")\r\n\r\n    return <label {...rootprops}>{label || undefined}{input}</label>;\r\n    /*\r\n    return(<label className={'p-1'} {...otherprops}\r\n                  style={rootStyle}>\r\n\r\n        {label && <span className={'my-auto'} onMouseEnter={e => setShowTooltip(true)}\r\n                        onMouseLeave={e => setShowTooltip(false)}>{label}\r\n        </span>}\r\n\r\n        {jsxLabel && <span onMouseEnter={e => setShowTooltip(true)}\r\n                           onMouseLeave={e => setShowTooltip(false)} style={{width: '100%'}}>{jsxLabel}\r\n        </span>}\r\n\r\n        {(tooltip && showTooltip) && <div className={'my-tooltip'}>\r\n            <b className={'text-center text-capitalize'}>{field}</b>\r\n            <br />\r\n            <label>{tooltip}</label>\r\n        </div>}\r\n\r\n        {autosize ? <div className={(autosize ? 'autosize-input-container' : '') + (props.asLabel ? ' labelstyle' : '')}\r\n                         data-value={value}>{input}\r\n        </div> : input}\r\n    </label>);\r\n    */\r\n}\r\n\r\nInputComponent.cname = 'InputComponent';\r\nexport interface InputOwnProps {\r\n    data?: LPointerTargetable | DPointerTargetable | Pointer<DPointerTargetable, 1, 1, LPointerTargetable>;\r\n    field?: string;\r\n    // DANGER: use the data provided in parameters instead of using js closure, as the proxy accessed from using closure won't be updated in rerenders.\r\n    getter?: (data: any/*LPointerTargetable*/, field: string) => string | boolean | undefined;\r\n    setter?: (value: string|boolean, data: any, field: string) => void;\r\n    label?: string | ReactNode;\r\n    jsxLabel?: ReactNode; // @deprecated, use label\r\n    type?: 'checkbox'|'color'|'date'|'datetime-local'|'email'|'file'|'image'|'month'|\r\n    'number'|'password'|'radio'|'range'|'tel'|'text'|'time'|'url'|'week';\r\n    className?: string;\r\n    style?: GObject;\r\n    readonly?: boolean;\r\n    tooltip?: boolean | ReactNode;\r\n    hidden?: boolean;\r\n    autosize?: boolean;\r\n    inputClassName?: string;\r\n    inputStyle?: GObject;\r\n    key?: React.Key | null;\r\n    placeholder?: string;\r\n    tag?: string;\r\n    children?: ReactNode;\r\n    // todo: div contenteditable\r\n}\r\n\r\nexport interface SelectOwnProps extends Omit<InputOwnProps, 'setter'> {\r\n    options?: JSX.Element;\r\n    setter?: (value: string, data: any, field: string) => void; // parent select has value: string | boolean\r\n}\r\ninterface RealOwnProps extends Omit<SelectOwnProps, 'setter'>{\r\n    setter: InputOwnProps['setter'];\r\n}\r\n\r\ninterface StateProps {\r\n    debugmodee: string;\r\n    data: LPointerTargetable & GObject;\r\n    // selected: Dictionary<Pointer<DUser>, LModelElement | null>;\r\n}\r\ninterface DispatchProps { }\r\ntype AllProps = Overlap<RealOwnProps, Overlap<StateProps, DispatchProps>>;\r\n\r\n\r\nexport function InputMapStateToProps(state: DState, ownProps: RealOwnProps): StateProps {\r\n    const ret: StateProps = {} as any;\r\n    const pointer: Pointer | undefined = typeof ownProps.data === 'string' ? ownProps.data : ownProps.data?.id;\r\n    ret.debugmodee = state.debug ? 'true' : 'false';\r\n    if (pointer) ret.data = LPointerTargetable.fromPointer(pointer);\r\n    return ret;\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch<any>): DispatchProps {\r\n    const ret: DispatchProps = {};\r\n    return ret;\r\n}\r\n\r\nexport const InputConnected =\r\n    connect<StateProps, DispatchProps, RealOwnProps, DState>(InputMapStateToProps, mapDispatchToProps)(InputComponent);\r\n\r\n\r\n// export function Input(props: InputOwnProps, children: (string | React.Component)[] = []): ReactElement { return 'input' as any; }\r\nexport function Input(props: InputOwnProps, children: (string | React.Component)[] = []): ReactElement {\r\n    return <InputConnected {...{...props, children} as any} />;\r\n}\r\n\r\n// export function TextArea(props: InputOwnProps, children: (string | React.Component)[] = []): ReactElement { return 'textarea' as any; }\r\nexport function TextArea(props: InputOwnProps, children: (string | React.Component)[] = []): ReactElement {\r\n    return <InputConnected {...{...props, children, tag:\"textarea\"} as any} />;\r\n}\r\n//export function Select(props: SelectOwnProps, children: (string | React.Component)[] = []): ReactElement { return 'select' as any; }\r\nexport function Select(props: SelectOwnProps, children: (string | React.Component)[] = []): ReactElement {\r\n    return <InputConnected {...{...props, children, tag:\"select\"} as any} />;\r\n}\r\nexport const Edit = Input;\r\n\r\nInputComponent.cname = 'InputComponent';\r\nInputConnected.cname = 'InputConnected';\r\nInput.cname = 'Input';\r\nTextArea.cname = 'TextArea';\r\nSelect.cname = 'Select';\r\nEdit.cname = 'Edit';\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}