{"ast":null,"code":"import Collaborative from'./Collaborative';import{Action,SetRootFieldAction}from'../../joiner';import{useEffect,useState}from\"react\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";function CollaborativeAttacher(props){const project=props.project;const[actions,setActions]=useState([]);useEffect(()=>{SetRootFieldAction.new('collaborativeSession',true);Collaborative.client.io.opts.query={'project':project.id};Collaborative.client.connect();/*\r\n        return () => {\r\n            Collaborative.client.off('pullAction');\r\n            Collaborative.client.disconnect();\r\n            SetRootFieldAction.new('collaborativeSession', false);\r\n        }\r\n        */Collaborative.client.on('pullAction',action=>{const receivedAction=Action.fromJson(action);console.log('Received Action from server.',action);receivedAction.hasFired=0;if(!actions.includes(receivedAction.id)){console.log('Received actions',actions);setActions([...actions,action.id]);receivedAction.fire();}});},[]);return/*#__PURE__*/_jsx(_Fragment,{});}export default CollaborativeAttacher;","map":{"version":3,"names":["Collaborative","Action","SetRootFieldAction","useEffect","useState","Fragment","_Fragment","jsx","_jsx","CollaborativeAttacher","props","project","actions","setActions","new","client","io","opts","query","id","connect","on","action","receivedAction","fromJson","console","log","hasFired","includes","fire"],"sources":["C:/0Programmi/Dev/projects/frontend/jjodel/frontend/src/components/collaborative/CollaborativeAttacher.tsx"],"sourcesContent":["import Collaborative from './Collaborative';\r\nimport type {CompositeAction, GObject, LProject, Pointer} from '../../joiner';\r\nimport {Action, SetRootFieldAction} from '../../joiner';\r\nimport {useEffect, useState} from \"react\";\r\n\r\ninterface Props {project: LProject}\r\nfunction CollaborativeAttacher(props: Props) {\r\n    const project = props.project;\r\n    const [actions, setActions] = useState<Pointer[]>([]);\r\n\r\n    useEffect(() => {\r\n        SetRootFieldAction.new('collaborativeSession', true);\r\n        Collaborative.client.io.opts.query = {'project': project.id};\r\n        Collaborative.client.connect();\r\n        /*\r\n        return () => {\r\n            Collaborative.client.off('pullAction');\r\n            Collaborative.client.disconnect();\r\n            SetRootFieldAction.new('collaborativeSession', false);\r\n        }\r\n        */\r\n        Collaborative.client.on('pullAction', (action: GObject<Action & CompositeAction>) => {\r\n            const receivedAction = Action.fromJson(action);\r\n            console.log('Received Action from server.', action);\r\n            receivedAction.hasFired = 0;\r\n            if(!actions.includes(receivedAction.id)) {\r\n                console.log('Received actions', actions)\r\n                setActions([...actions, action.id]);\r\n                receivedAction.fire();\r\n            }\r\n        });\r\n    }, []);\r\n\r\n    return(<></>);\r\n}\r\n\r\nexport default CollaborativeAttacher;\r\n"],"mappings":"AAAA,MAAO,CAAAA,aAAa,KAAM,iBAAiB,CAE3C,OAAQC,MAAM,CAAEC,kBAAkB,KAAO,cAAc,CACvD,OAAQC,SAAS,CAAEC,QAAQ,KAAO,OAAO,CAAC,OAAAC,QAAA,IAAAC,SAAA,gCAAAC,GAAA,IAAAC,IAAA,yBAG1C,QAAS,CAAAC,qBAAqBA,CAACC,KAAY,CAAE,CACzC,KAAM,CAAAC,OAAO,CAAGD,KAAK,CAACC,OAAO,CAC7B,KAAM,CAACC,OAAO,CAAEC,UAAU,CAAC,CAAGT,QAAQ,CAAY,EAAE,CAAC,CAErDD,SAAS,CAAC,IAAM,CACZD,kBAAkB,CAACY,GAAG,CAAC,sBAAsB,CAAE,IAAI,CAAC,CACpDd,aAAa,CAACe,MAAM,CAACC,EAAE,CAACC,IAAI,CAACC,KAAK,CAAG,CAAC,SAAS,CAAEP,OAAO,CAACQ,EAAE,CAAC,CAC5DnB,aAAa,CAACe,MAAM,CAACK,OAAO,CAAC,CAAC,CAC9B;AACR;AACA;AACA;AACA;AACA;AACA,UACQpB,aAAa,CAACe,MAAM,CAACM,EAAE,CAAC,YAAY,CAAGC,MAAyC,EAAK,CACjF,KAAM,CAAAC,cAAc,CAAGtB,MAAM,CAACuB,QAAQ,CAACF,MAAM,CAAC,CAC9CG,OAAO,CAACC,GAAG,CAAC,8BAA8B,CAAEJ,MAAM,CAAC,CACnDC,cAAc,CAACI,QAAQ,CAAG,CAAC,CAC3B,GAAG,CAACf,OAAO,CAACgB,QAAQ,CAACL,cAAc,CAACJ,EAAE,CAAC,CAAE,CACrCM,OAAO,CAACC,GAAG,CAAC,kBAAkB,CAAEd,OAAO,CAAC,CACxCC,UAAU,CAAC,CAAC,GAAGD,OAAO,CAAEU,MAAM,CAACH,EAAE,CAAC,CAAC,CACnCI,cAAc,CAACM,IAAI,CAAC,CAAC,CACzB,CACJ,CAAC,CAAC,CACN,CAAC,CAAE,EAAE,CAAC,CAEN,mBAAOrB,IAAA,CAAAF,SAAA,GAAI,CAAC,CAChB,CAEA,cAAe,CAAAG,qBAAqB","ignoreList":[]},"metadata":{},"sourceType":"module"}