{"ast":null,"code":"import{LGraphElement,Log,RuntimeAccessibleClass,transientProperties,U,windoww}from'../../joiner';import React,{PureComponent}from'react';import{connect}from'react-redux';import'./style.scss';// <-- tenuto per retro-compatibilità ma dovrebbe sparire\nimport'./editors.scss';// <-- stile comune a tutte le tab editor (idealmente da tenere leggero)\nimport'./console.scss';// <-- stile di questa tab\nimport ReactDOM from\"react-dom\";import{Empty}from\"./Empty\";import{Tooltip}from\"../forEndUser/Tooltip\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";const Convert=require('ansi-to-html');let ansiConvert=window.ansiConvert;if(!ansiConvert)window.ansiconvert=ansiConvert=new Convert();class ThisState{constructor(){this.expression='';this.output=null;this.expressionIndex=0;this.expressionHistory=[''];this.initialState=true;this.time=0;}}// trasformato in class component così puoi usare il this nella console. e non usa accidentalmente window come contesto\nlet hiddenkeys=[\"jsxString\",\"pointedBy\",\"clonedCounter\",\"parent\",\"_subMaps\",\"inspect\",\"__random\"];function fixproxy(output){var _output;let hideDKeys=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;let addLKeys=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;let ret={output};if(!output)return ret;let proxy;if((_output=output)===null||_output===void 0?void 0:_output.__isProxy){proxy=output;output=output.__raw;//Object.fromEntries(Object.getOwnPropertyNames(p).map(k => [k, p[k]]));\n}else proxy=undefined;switch(typeof output){case\"function\":{let fdata=U.buildFunctionDocumentation(output);return{output:fdata};}default:return ret;case\"object\":// if (Array.isArray(output)) { ret.output = output; break; /* no need to go inside, it is already done at render phase */ }\nret.output=output={...output};// if (ret.output.anchors) ret.output.anchors = JSON.stringify(ret.output.anchors);\nif(addLKeys&&proxy){var _RuntimeAccessibleCla,_RuntimeAccessibleCla2,_output2;let Lsingleton=((_RuntimeAccessibleCla=RuntimeAccessibleClass.get((_output2=output)===null||_output2===void 0?void 0:_output2.className))===null||_RuntimeAccessibleCla===void 0?void 0:(_RuntimeAccessibleCla2=_RuntimeAccessibleCla.logic)===null||_RuntimeAccessibleCla2===void 0?void 0:_RuntimeAccessibleCla2.singleton)||{};let comments={};ret.shortcuts={...Lsingleton};ret.comments=comments;for(let key in output){if(Lsingleton[\"__info_of__\"+key])comments[key]=Lsingleton[\"__info_of__\"+key];}for(let key in Lsingleton){if(key in output||key.indexOf(\"__info_of__\")===0){delete ret.shortcuts[key];continue;}else{if(ret.shortcuts[key]===undefined)ret.shortcuts[key]='';}if(key.indexOf(\"info\")>=0&&key.indexOf(\"of\")>=0){Log.eDevv('Possible error on __info_of__ misnamed as '+key+', if the name was intentional'+' and not an Info object add an allowal rule here.');continue;}if(Lsingleton[\"__info_of__\"+key])comments[key]=Lsingleton[\"__info_of__\"+key];if(comments[key])continue;// if explicitly commented, i will not attempt to generate documentation.\nlet entryvalue=Lsingleton[key];switch(typeof entryvalue){default:case\"object\":ret.shortcuts[key]=entryvalue;break;case\"function\":ret.shortcuts[key]=U.buildFunctionDocumentation(entryvalue);break;}}}if(hiddenkeys){ret.hiddenkeys={};for(let key of hiddenkeys){ret.hiddenkeys[key]=output[key];delete output[key];// delete output.shortcuts[key];\n}}break;}//@ts-ignore\nret={...ret,shortcuts:undefined,comments:undefined,hiddenkeys:undefined};console.log('kkkk',ret);return ret;}class ConsoleComponent extends PureComponent{constructor(props){super(props);this.lastNode=void 0;this._context={};this.outputhtml=null;this.state=new ThisState();this.change=this.change.bind(this);this.change(undefined);}change(evt){var _this$props$node;if(!this)return;// component being destroyed and remade after code hot update\nlet expression0=(evt?evt.target.value:this.state.expression)||'';let expression=expression0.trim();let output;// let context = {...this.props, props: this.props}; // makeEvalContext(this.props as any, {} as any);\nlet nid=(_this$props$node=this.props.node)===null||_this$props$node===void 0?void 0:_this$props$node.id;let tn=transientProperties.node[nid];if(nid&&tn){// let component = GraphElementComponent.map[this.props.node.id];\nthis._context={...tn.viewScores[tn.mainView.id].evalContext};this._context.fromcomponent=true;}else{this._context={...this.props,props:this.props};}try{// if (expression === 'this') expression = 'data'; // it does a mess by taking a L-singleton with all his __info_of__ stuff\nif(expression==='this')output=this._context;else output=U.evalInContextAndScope(expression||'<span class=\"console-msg\">undefined</span>',this._context,this._context);}catch(e){console.error(\"console error\",e);// output = '<span class=\"console-error\">Invalid Syntax!</span> <span class=\"console-error-msg\">' + e.toString() + '<span>' ; }\noutput='<span class=\"console-error-msg\"><i class=\"bi bi-exclamation-square-fill\"></i><span>'+e.toString()+'</span></span>';}this.setState({expression:expression0,output});}// textarea: HTMLTextAreaElement | null = null;\ngetClickableEntry(expression,k,arr){return/*#__PURE__*/_jsxs(\"li\",{onClick:()=>{let isnum=!isNaN(+k);let isregular=isnum?true:/\\w/.test(k);let append;if(isnum)append='['+k+']';else if(isregular)append='.'+k;else append='['+JSON.stringify(k)+']';this.setState({expression:expression?expression+append:k}/*, ()=> { this.change(); }*/);},children:[k,arr&&arr[k]?/*#__PURE__*/_jsxs(_Fragment,{children:[\":\",arr[k]]}):undefined]});}setState(s,callback){if(s){if(s.initialState){delete s.initialState;return super.setState(s);}let s0={...s};let olds=this.state;if(s0.expressionIndex&&s0.expressionIndex!==olds.expressionIndex)s.expression=olds.expressionHistory[s0.expressionIndex];if(s0.expressionHistory&&s0.expressionHistory!==olds.expressionHistory){let len=s0.expressionHistory.length;if(len>10)s.expressionHistory=s0.expressionHistory.slice(len-10,len);}if(s0.expression&&s0.expression!==olds.expression){var _s$expressionIndex;let time=new Date().getTime();let oldtime=olds.time;Log.exDev(s0.expressionIndex!==undefined,'cannot set both index and expression together');let i=(_s$expressionIndex=s.expressionIndex)!==null&&_s$expressionIndex!==void 0?_s$expressionIndex:olds.expressionIndex;let slice;if(time-oldtime<1000){slice=olds.expressionHistory.slice(0,i);}else{slice=olds.expressionHistory.slice(0,i+1);s.expressionIndex=i+1;}s.time=time;s.expressionHistory=[...slice,s0.expression];console.log('setstate',{olds:{...olds},s,slice,i,s0});}if(s.expression!==olds.expression&&!('output'in s)){let call0=callback;callback=()=>{call0===null||call0===void 0?void 0:call0();this.change();};}}super.setState(s,callback);}render(){var _this$state$output,_this$props$node2,_this$props$node3;/*const [expression, setExpression] = useStateIfMounted('data');\r\n        const [output, setOutput] = useStateIfMounted('');*/if(!this.props.node)return/*#__PURE__*/_jsx(Empty,{msg:\"Select a node.\"});let expression=this.state.expression.trim();if(expression==='this')expression='data';const data=this.props.data;if(this.lastNode!==this.props.node.id)this.change();// force reevaluation if selected node changed\nthis.lastNode=this.props.node.id;let outstr;// try { outstr = U.circularStringify(this.state.output, (key, value)=> { return value.__isProxy ? value.name : value; }, \"\\t\", 1) }\n// (window as any).inspect = util.inspect;\n// (window as any).tmpp = this.state.output;\nlet ashtml;let output=this.state.output;let shortcuts=undefined;let comments=undefined;let hidden=undefined;let jsxComments={};let shortcutsjsx=undefined;try{var _output3;if(Array.isArray(output)){comments={\"separator\":'<span>Similar to <a href={\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/join\"}>Array.join(separator)</a>'+', but supports array of JSX nodes and JSX as separator argument.</span>'};shortcuts={\"separator\":\"\"};}if(Array.isArray(output)){output=output.map(o=>fixproxy(o).output);}else{let ret=fixproxy(output);output=ret.output;comments=ret.comments;shortcuts=ret.shortcuts;hidden=ret.hiddenkeys;}// todo: as i fix the displaying of a LViewElement without replacing it with __raw,\n//  i will fix window, component and props displaying too i think they crash for props.data, props.view...\nif((_output3=output)===null||_output3===void 0?void 0:_output3._reactInternals){output={\"React.Component\":{props:\"...navigate to expand...\",state:\"\",_isMounted:output._isMounted}};}outstr='<h4>Result</h4><section class=\"group result-container\"><div class=\"output-row\" tabindex=\"984\">'+U.objectInspect(output)+\"<span>\";let commentsPopup=\"\";if(shortcuts||comments){// if(!shortcuts) shortcuts = {};\nif(!comments)comments={};for(let commentKey in comments){var _commentVal,_commentVal2,_commentVal3,_commentVal3$type;let commentVal=comments[commentKey];let txt=(_commentVal=commentVal)===null||_commentVal===void 0?void 0:_commentVal.txt;if(txt&&typeof txt!==\"string\"){// try to inject jsx\njsxComments[commentKey]=txt;txt=\"<span id='console_output_comment_\"+commentKey+\"'  class='console-msg'/>\";// fallback read text, that should go deep iteration, but 1 level deep should be enough.\n// let arr: any[] = (Array.isArray(txt?.props?.children) ? txt.props.children : (txt.props.children ? [txt.props.children] : []));\n// txt = arr.map(e => typeof e === \"string\" ? e : e?.props?.children + '' || '').join(\"\");\n}if((_commentVal2=commentVal)===null||_commentVal2===void 0?void 0:_commentVal2.type)commentVal=\"\\t\\t<span class='console-msg'>\"+(((_commentVal3=commentVal)===null||_commentVal3===void 0?void 0:(_commentVal3$type=_commentVal3.type)===null||_commentVal3$type===void 0?void 0:_commentVal3$type.cname)||commentVal.type)+\"</span>\";// + \" ~ \" + txt;\n// warning: unicode char but should not make a problem. 𐀹\ncommentVal+='<div class=\"output-comment my-tooltip\">'+txt+'</div></div><div class=\"output-row\" tabindex=\"984\">';let commentKeyEscaped=U.multiReplaceAll(commentKey,[\"$\",\"-\"],[\"\\\\$\",\"\\\\-\"]);// _ should be safe, .-,?^ not happening?\nlet regexp=new RegExp(\"^({?\\\\s*\"+commentKeyEscaped+\":.*)$\",\"gm\");let regexpCloseTags=new RegExp(\"(\\\\<span style\\\\=\\\"color\\\\:\\\\#)\",\"gm\");outstr=U.replaceAll(outstr,\"$\",\"£\");outstr=outstr.replace(regexp,\"$1\"+commentVal);outstr=outstr.replace(regexpCloseTags,\"</span>$1\");outstr=U.replaceAll(outstr,\"£\",\"$\");}/*if (shortcuts) outstr += \"</div></section><br><br>\" +\r\n                    \"<h4>Shortcuts</h4><section class='group shortcuts-container'><div class=\\\"output-row\\\" tabindex=\\\"984\\\">\" + U.objectInspect(shortcuts)+\"</section>\";\r\n                */if(shortcuts){shortcutsjsx=/*#__PURE__*/_jsx(\"ul\",{children:Object.keys(shortcuts).sort().map(k=>this.getClickableEntry(expression,k,shortcuts))});}// if (hidden) outstr +=\"</div><br><br><h4>Other less useful properties</h4><div class=\\\"output-row\\\" tabindex=\\\"984\\\">\" + format(hidden);\n// warning: unicode char but should not make a problem.\n// outstr = U.replaceAll( outstr, '𐀹,\\n', '],</span>\\n</div><div class=\"output-row\" tabindex=\"984\"><span style=\"color:#000\">');\noutstr=U.replaceAll(outstr,'<span style=\"color:#000\" class=\"console-msg\">,\\n','</span><span style=\"color:#000\" class=\"console-msg\">,</span>\\n</div><div class=\"output-row\" tabindex=\"984\"><span class=\"console-msg\" style=\"color:#000\">');outstr=U.replaceAll(outstr,'],\\n','],</span>\\n</div><div class=\"output-row\" tabindex=\"984\"><span class=\"console-msg\" style=\"color:#000\">');outstr=U.replaceAll(outstr,'},\\n','},</span>\\n</div><div class=\"output-row\" tabindex=\"984\"><span class=\"console-msg\" style=\"color:#000\">');}ashtml=true;}catch(e){console.error(e);throw e;outstr=\"[circular object]: \"+e.toString();ashtml=false;}let contextkeysarr;let contextkeys='';if(this.state.expression.trim()===\"this\")contextkeys=\"Warning: \\\"this\\\" in the console is aliased to data instead of the whole context of a GraphElement component.\";let objraw=((_this$state$output=this.state.output)===null||_this$state$output===void 0?void 0:_this$state$output.__raw)||(typeof this.state.output===\"object\"?this.state.output:\"[primitiveValue]\")||{};if(this.state.expression.trim()===\"\")contextkeysarr=[\"data\",\"node\",\"view\",\"component\"];else if(typeof objraw===\"string\"){contextkeysarr=Object.keys(String.prototype);}else contextkeysarr=(Array.isArray(objraw)?[...Object.keys(objraw).filter(k=>k<=10).map(k=>k===10?'...':''+k),...Object.keys(Array.prototype)]:Object.getOwnPropertyNames(objraw))||[];contextkeys=/*#__PURE__*/_jsx(\"ul\",{children:contextkeysarr.sort().map(k=>this.getClickableEntry(expression,k))});let injectCommentJSX=()=>{try{for(let key in jsxComments){if(hiddenkeys.includes(key))continue;let commentNode=document.getElementById(\"console_output_comment_\"+key);Log.eDev(!commentNode,\"failed to find comment placeholder\",{key,v:jsxComments[key],jsxComments});if(commentNode)ReactDOM.render(jsxComments[key],commentNode);}}catch(e){console.error(\"failed to inject console output comment:\",e);}};setTimeout(injectCommentJSX,1);this.setNativeConsoleVariables();windoww.output=output;windoww.contextkeysarr=contextkeysarr;windoww.contextkeys=contextkeys;const undo=()=>{let expressionIndex=Math.max(0,this.state.expressionIndex-1);if(expressionIndex===this.state.expressionIndex)return;this.setState({expressionIndex});};const redo=()=>{const expressionHistory=this.state.expressionHistory;let expressionIndex=Math.min(expressionHistory.length-1,this.state.expressionIndex+1);if(expressionIndex===this.state.expressionIndex)return;this.setState({expressionIndex});};let canredo=this.state.expressionIndex<this.state.expressionHistory.length-1;let canundo=this.state.expressionIndex>0;return/*#__PURE__*/_jsxs(\"div\",{className:'w-100 h-100 p-2 console',children:[/*#__PURE__*/_jsxs(\"h1\",{children:[\"On \",((data===null||data===void 0?void 0:data.name)||\"model-less node (\"+((_this$props$node2=this.props.node)===null||_this$props$node2===void 0?void 0:_this$props$node2.className)+\")\")+\" - \"+((_this$props$node3=this.props.node)===null||_this$props$node3===void 0?void 0:_this$props$node3.className)]}),/*#__PURE__*/_jsxs(\"div\",{className:\"console-terminal p-0 mb-2 w-100\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"commands\",children:[/*#__PURE__*/_jsx(\"i\",{onClick:e=>{this.setState({expression:''});},title:'Empty console',className:\"bi bi-slash-circle\"}),/*#__PURE__*/_jsx(\"i\",{onClick:e=>{var _this$outputhtml;if(!this.state.expression.trim()){return Tooltip.show('Nothing to copy',undefined,undefined,2);}let s=((_this$outputhtml=this.outputhtml)===null||_this$outputhtml===void 0?void 0:_this$outputhtml.innerText)||'';s=s.substring('Result'.length).trim();U.clipboardCopy(s,()=>Tooltip.show('Content copied to clipboard',undefined,undefined,2));},title:'Copy in the clipboard',className:\"bi bi-clipboard-plus\"}),/*#__PURE__*/_jsx(\"i\",{onClick:redo,title:'redo',className:\"redo bi bi-arrow-right-square\"+(canredo?'':\" disabled\")}),/*#__PURE__*/_jsx(\"i\",{onClick:undo,title:'undo',className:\"undo bi bi-arrow-left-square\"+(canundo?'':\" disabled\")})]}),/*#__PURE__*/_jsx(\"textarea\",{id:'console',spellCheck:false,className:'p-0 input w-100',onChange:this.change,value:this.state.expression})]}),false&&/*#__PURE__*/_jsxs(\"div\",{children:[\"Debug history (index = \",this.state.expressionIndex,\")\",this.state.expressionHistory.map((s,i)=>/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(\"div\",{style:{border:'1px solid '+(i===this.state.expressionIndex?'red':'gray'),marginTop:'5px',height:'30px'},children:s})}))]}),/*#__PURE__*/_jsx(\"hr\",{className:'mt-1 mb-1'}),this.state.expression&&ashtml&&/*#__PURE__*/_jsx(\"div\",{className:\"console-output-container console-msg\",ref:e=>this.outputhtml=e,dangerouslySetInnerHTML:ashtml?{__html:outstr}:undefined}),this.state.expression&&!ashtml&&/*#__PURE__*/_jsx(\"div\",{className:\"console-output-container console-msg\",ref:e=>this.outputhtml=e,style:{whiteSpace:\"pre\"},children:outstr}),shortcutsjsx&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Shortcuts\"}),/*#__PURE__*/_jsx(\"section\",{className:\"group shortcuts-container\",children:shortcutsjsx})]}),/*#__PURE__*/_jsx(\"label\",{className:\"context-keys mt-2\",children:\"Context keys\"}),/*#__PURE__*/_jsxs(\"section\",{className:'group context-keys-list',style:{whiteSpace:\"pre\"},children:[contextkeys,\" \"]})]});}setNativeConsoleVariables(){var _context$data,_context$data2;// just fordebugging\nlet context=this._context;windoww.context=context;windoww.data=context.data;windoww.node=context.node;windoww.edge=context.edge;windoww.output=this.state.output;if((_context$data=context.data)===null||_context$data===void 0?void 0:_context$data.model)windoww.model=(_context$data2=context.data)===null||_context$data2===void 0?void 0:_context$data2.model;}}ConsoleComponent.cname=\"ConsoleComponent\";function mapStateToProps(state,ownProps){var _state$_lastSelected;const ret={};const nodeid=(_state$_lastSelected=state._lastSelected)===null||_state$_lastSelected===void 0?void 0:_state$_lastSelected.node;const node=nodeid?LGraphElement.fromPointer(nodeid):null;ret.node=node;ret.data=(node===null||node===void 0?void 0:node.model)?node.model:null;ret.view=(node===null||node===void 0?void 0:node.view)?node.view:null;return ret;}function mapDispatchToProps(dispatch){const ret={};return ret;}export const ConsoleConnected=connect(mapStateToProps,mapDispatchToProps)(ConsoleComponent);export const Console=function(props){let children=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];return/*#__PURE__*/_jsx(ConsoleConnected,{...props,children});};export default Console;","map":{"version":3,"names":["LGraphElement","Log","RuntimeAccessibleClass","transientProperties","U","windoww","React","PureComponent","connect","ReactDOM","Empty","Tooltip","Fragment","_Fragment","jsxs","_jsxs","jsx","_jsx","Convert","require","ansiConvert","window","ansiconvert","ThisState","constructor","expression","output","expressionIndex","expressionHistory","initialState","time","hiddenkeys","fixproxy","_output","hideDKeys","arguments","length","undefined","addLKeys","ret","proxy","__isProxy","__raw","fdata","buildFunctionDocumentation","_RuntimeAccessibleCla","_RuntimeAccessibleCla2","_output2","Lsingleton","get","className","logic","singleton","comments","shortcuts","key","indexOf","eDevv","entryvalue","console","log","ConsoleComponent","props","lastNode","_context","outputhtml","state","change","bind","evt","_this$props$node","expression0","target","value","trim","nid","node","id","tn","viewScores","mainView","evalContext","fromcomponent","evalInContextAndScope","e","error","toString","setState","getClickableEntry","k","arr","onClick","isnum","isNaN","isregular","test","append","JSON","stringify","children","s","callback","s0","olds","len","slice","_s$expressionIndex","Date","getTime","oldtime","exDev","i","call0","render","_this$state$output","_this$props$node2","_this$props$node3","msg","data","outstr","ashtml","hidden","jsxComments","shortcutsjsx","_output3","Array","isArray","map","o","_reactInternals","_isMounted","objectInspect","commentsPopup","commentKey","_commentVal","_commentVal2","_commentVal3","_commentVal3$type","commentVal","txt","type","cname","commentKeyEscaped","multiReplaceAll","regexp","RegExp","regexpCloseTags","replaceAll","replace","Object","keys","sort","contextkeysarr","contextkeys","objraw","String","prototype","filter","getOwnPropertyNames","injectCommentJSX","includes","commentNode","document","getElementById","eDev","v","setTimeout","setNativeConsoleVariables","undo","Math","max","redo","min","canredo","canundo","name","title","_this$outputhtml","show","innerText","substring","clipboardCopy","spellCheck","onChange","style","border","marginTop","height","ref","dangerouslySetInnerHTML","__html","whiteSpace","_context$data","_context$data2","context","edge","model","mapStateToProps","ownProps","_state$_lastSelected","nodeid","_lastSelected","fromPointer","view","mapDispatchToProps","dispatch","ConsoleConnected","Console"],"sources":["C:/0Programmi/Dev/projects/frontend/jjodel/src/components/editors/Console.tsx"],"sourcesContent":["import {\r\n    DEdge,\r\n    DGraphElement,\r\n    Dictionary,\r\n    DState,\r\n    GObject,\r\n    LGraphElement,\r\n    LModelElement,\r\n    Log,\r\n    LPointerTargetable,\r\n    LViewElement,\r\n    Pointer,\r\n    RuntimeAccessibleClass,\r\n    transientProperties,\r\n    U,\r\n    windoww\r\n} from '../../joiner';\r\nimport {FakeStateProps} from '../../joiner/types';\r\nimport React, {Component, Dispatch, PureComponent, ReactElement, ReactNode} from 'react';\r\nimport {connect} from 'react-redux';\r\n\r\nimport './style.scss'; // <-- tenuto per retro-compatibilità ma dovrebbe sparire\r\nimport './editors.scss'; // <-- stile comune a tutte le tab editor (idealmente da tenere leggero)\r\nimport './console.scss'; // <-- stile di questa tab\r\nimport ReactDOM from \"react-dom\";\r\nimport {Empty} from \"./Empty\";\r\nimport {Tooltip} from \"../forEndUser/Tooltip\";\r\n\r\nconst Convert = require('ansi-to-html');\r\n\r\nlet ansiConvert = (window as any).ansiConvert;\r\nif (!ansiConvert) (window as any).ansiconvert = ansiConvert = new Convert();\r\n\r\nclass ThisState{\r\n    expression: string = '';\r\n    output: any = null;\r\n    expressionIndex: number = 0;\r\n    expressionHistory: string[] = [''];\r\n    initialState: boolean = true;\r\n    time: number = 0;\r\n}\r\n\r\n// trasformato in class component così puoi usare il this nella console. e non usa accidentalmente window come contesto\r\n\r\nlet hiddenkeys = [\"jsxString\", \"pointedBy\", \"clonedCounter\", \"parent\", \"_subMaps\", \"inspect\", \"__random\"];\r\nfunction fixproxy(output: any/*but not array*/, hideDKeys: boolean = true, addLKeys: boolean = true):\r\n    { output: any, shortcuts?: GObject<'L singleton'>, comments?: Dictionary<string, string | {type:string, txt:string}>, hiddenkeys?: GObject} {\r\n\r\n    let ret: ReturnType<typeof fixproxy> = {output};\r\n    if (!output) return ret;\r\n\r\n    let proxy: LPointerTargetable | undefined;\r\n    if (output?.__isProxy) {\r\n        proxy = output;\r\n        output = output.__raw; //Object.fromEntries(Object.getOwnPropertyNames(p).map(k => [k, p[k]]));\r\n    } else proxy = undefined;\r\n\r\n    switch (typeof output) {\r\n        case \"function\": {\r\n            let fdata =  U.buildFunctionDocumentation(output);\r\n            return {output: fdata};\r\n        }\r\n        default: return ret;\r\n        case \"object\":\r\n            // if (Array.isArray(output)) { ret.output = output; break; /* no need to go inside, it is already done at render phase */ }\r\n            ret.output = output = {...output};\r\n            // if (ret.output.anchors) ret.output.anchors = JSON.stringify(ret.output.anchors);\r\n            if ((addLKeys && proxy)) {\r\n                let Lsingleton: GObject<'L singleton'> = (RuntimeAccessibleClass.get(output?.className)?.logic?.singleton) || {};\r\n                let comments: Dictionary<string, string | {type:string, txt:string}> = {};\r\n                ret.shortcuts = {...Lsingleton};\r\n                ret.comments = comments;\r\n                for (let key in output) {\r\n                    if (Lsingleton[\"__info_of__\" + key]) comments[key] = Lsingleton[\"__info_of__\" + key];\r\n                }\r\n                for (let key in Lsingleton) {\r\n                    if ((key in output) || (key.indexOf(\"__info_of__\") === 0)) {\r\n                        delete ret.shortcuts[key];\r\n                        continue;\r\n                    } else { if (ret.shortcuts[key] === undefined) ret.shortcuts[key] = ''; }\r\n                    if (key.indexOf(\"info\") >=0 && key.indexOf(\"of\") >=0){\r\n                        Log.eDevv('Possible error on __info_of__ misnamed as '+key+', if the name was intentional' +\r\n                            ' and not an Info object add an allowal rule here.');\r\n                        continue;\r\n                    }\r\n                    if (Lsingleton[\"__info_of__\" + key]) comments[key] = Lsingleton[\"__info_of__\" + key];\r\n                    if (comments[key]) continue; // if explicitly commented, i will not attempt to generate documentation.\r\n                    let entryvalue = Lsingleton[key];\r\n                    switch (typeof entryvalue) {\r\n                        default:\r\n                        case \"object\":\r\n                            ret.shortcuts[key] = entryvalue;\r\n                            break;\r\n                        case \"function\":\r\n                            ret.shortcuts[key] = U.buildFunctionDocumentation(entryvalue);\r\n                            break;\r\n                    }\r\n                }\r\n            }\r\n            if (hiddenkeys) {\r\n                ret.hiddenkeys = {};\r\n                for (let key of hiddenkeys) {\r\n                    ret.hiddenkeys[key] = output[key];\r\n                    delete output[key];\r\n                    // delete output.shortcuts[key];\r\n                }\r\n            }\r\n            break;\r\n    }\r\n\r\n    //@ts-ignore\r\n    ret ={...ret, shortcuts: undefined, comments: undefined, hiddenkeys: undefined};\r\n    console.log('kkkk',  ret);\r\n\r\n    return ret;\r\n}\r\n\r\n\r\nclass ConsoleComponent extends PureComponent<AllProps, ThisState>{\r\n    public static cname: string = \"ConsoleComponent\";\r\n    lastNode?: Pointer<DGraphElement>;\r\n    constructor(props: AllProps) {\r\n        super(props);\r\n        this.state = new ThisState();\r\n        this.change = this.change.bind(this);\r\n        this.change(undefined);\r\n    }\r\n    private _context: GObject = {};\r\n    change(evt?: React.ChangeEvent<HTMLTextAreaElement>) {\r\n        if (!this) return; // component being destroyed and remade after code hot update\r\n        let expression0: string = (evt ? evt.target.value : this.state.expression) || '';\r\n        let expression: string = expression0.trim();\r\n        let output;\r\n        // let context = {...this.props, props: this.props}; // makeEvalContext(this.props as any, {} as any);\r\n\r\n        let nid = this.props.node?.id;\r\n        let tn = transientProperties.node[nid as string];\r\n        if (nid && tn) {\r\n            // let component = GraphElementComponent.map[this.props.node.id];\r\n            this._context = {...tn.viewScores[tn.mainView.id].evalContext};\r\n            this._context.fromcomponent = true;\r\n        }\r\n        else {\r\n            this._context = {...this.props, props: this.props};\r\n        }\r\n        try {\r\n            // if (expression === 'this') expression = 'data'; // it does a mess by taking a L-singleton with all his __info_of__ stuff\r\n            if (expression === 'this') output = this._context;\r\n            else output = U.evalInContextAndScope(expression || '<span class=\"console-msg\">undefined</span>', this._context, this._context);\r\n        }\r\n        catch (e: any) {\r\n            console.error(\"console error\", e);\r\n            // output = '<span class=\"console-error\">Invalid Syntax!</span> <span class=\"console-error-msg\">' + e.toString() + '<span>' ; }\r\n            output = '<span class=\"console-error-msg\"><i class=\"bi bi-exclamation-square-fill\"></i><span>' + e.toString() + '</span></span>' ; }\r\n        this.setState({expression:expression0, output });\r\n    }\r\n\r\n    // textarea: HTMLTextAreaElement | null = null;\r\n    getClickableEntry(expression: string, k: string, arr?: any): JSX.Element{\r\n        return <li onClick={()=> {\r\n            let isnum = !isNaN(+k);\r\n            let isregular: boolean = isnum ? true : /\\w/.test(k);\r\n            let append: string;\r\n            if (isnum) append = '['+k+']';\r\n            else if (isregular) append = '.'+k;\r\n            else append = '['+JSON.stringify(k)+']';\r\n            this.setState({expression: (expression ? expression + append : k)}/*, ()=> { this.change(); }*/);\r\n        }}>{k}{arr && arr[k] ? <>:{arr[k]}</> : undefined}</li>;\r\n    }\r\n\r\n    outputhtml: HTMLElement | null = null;\r\n    setState(s: GObject<Partial<ThisState>> | null, callback?: (...a:any) => any): void{\r\n        if (s){\r\n            if (s.initialState) {\r\n                delete s.initialState;\r\n                return super.setState(s as any);\r\n            }\r\n            let s0: GObject<ThisState> = {...s} as any;\r\n            let olds = this.state;\r\n            if (s0.expressionIndex && s0.expressionIndex !== olds.expressionIndex) s.expression = olds.expressionHistory[s0.expressionIndex];\r\n            if (s0.expressionHistory && s0.expressionHistory !== olds.expressionHistory){\r\n                let len = s0.expressionHistory.length;\r\n                if (len > 10) s.expressionHistory = s0.expressionHistory.slice(len - 10, len);\r\n            }\r\n            if (s0.expression && s0.expression !== olds.expression) {\r\n                let time = new Date().getTime();\r\n                let oldtime = olds.time;\r\n                Log.exDev(s0.expressionIndex !== undefined, 'cannot set both index and expression together');\r\n                let i = s.expressionIndex ?? olds.expressionIndex;\r\n                let slice: string[];\r\n                if (time - oldtime < 1000) {\r\n                    slice = olds.expressionHistory.slice(0, i);\r\n                }\r\n                else {\r\n                    slice = olds.expressionHistory.slice(0, i+1);\r\n                    s.expressionIndex = i + 1;\r\n                }\r\n                s.time = time;\r\n                s.expressionHistory = [...slice, s0.expression];\r\n                console.log('setstate', {olds: {...olds}, s, slice, i, s0});\r\n            }\r\n            if (s.expression !== olds.expression && !('output' in s)) {\r\n                let call0 = callback;\r\n                callback = () => { call0?.(); this.change(); }\r\n            }\r\n        }\r\n        super.setState(s as any, callback);\r\n    }\r\n    render(){\r\n        /*const [expression, setExpression] = useStateIfMounted('data');\r\n        const [output, setOutput] = useStateIfMounted('');*/\r\n\r\n        if (!this.props.node) return <Empty msg={\"Select a node.\"} />;\r\n        let expression = this.state.expression.trim();\r\n        if (expression === 'this') expression = 'data';\r\n        const data = this.props.data;\r\n        if (this.lastNode !== this.props.node.id) this.change(); // force reevaluation if selected node changed\r\n        this.lastNode = this.props.node.id;\r\n\r\n        let outstr;\r\n        // try { outstr = U.circularStringify(this.state.output, (key, value)=> { return value.__isProxy ? value.name : value; }, \"\\t\", 1) }\r\n        // (window as any).inspect = util.inspect;\r\n        // (window as any).tmpp = this.state.output;\r\n        let ashtml: boolean\r\n        let output: any = this.state.output;\r\n        let shortcuts: GObject<'L singleton'> | undefined = undefined;\r\n        let comments: Dictionary<string, string | {type:string, txt:string}> | undefined = undefined;\r\n        let hidden: Dictionary<string, string> | undefined = undefined;\r\n        let jsxComments: Dictionary<string, JSX.Element[]> = {};\r\n        let shortcutsjsx: ReactNode = undefined;\r\n        try {\r\n            if (Array.isArray(output)){\r\n                comments = {\"separator\": '<span>Similar to <a href={\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/join\"}>Array.join(separator)</a>' +\r\n                        ', but supports array of JSX nodes and JSX as separator argument.</span>'};\r\n                shortcuts = {\"separator\": \"\"};\r\n            }\r\n            if (Array.isArray(output)) {\r\n                output = output.map(o => fixproxy(o).output);\r\n            }\r\n            else {\r\n                let ret = fixproxy(output);\r\n                output = ret.output;\r\n                comments = ret.comments;\r\n                shortcuts = ret.shortcuts;\r\n                hidden = ret.hiddenkeys;\r\n            }\r\n            // todo: as i fix the displaying of a LViewElement without replacing it with __raw,\r\n            //  i will fix window, component and props displaying too i think they crash for props.data, props.view...\r\n            if (output?._reactInternals) {\r\n                output = {\"React.Component\": {props:\"...navigate to expand...\", state:\"\", _isMounted:output._isMounted}}\r\n            }\r\n            outstr = '<h4>Result</h4><section class=\"group result-container\"><div class=\"output-row\" tabindex=\"984\">' + U.objectInspect(output)+\"<span>\";\r\n            let commentsPopup = \"\";\r\n            if (shortcuts || comments){\r\n                // if(!shortcuts) shortcuts = {};\r\n                if (!comments) comments = {};\r\n                for (let commentKey in comments){\r\n                    let commentVal: any = comments[commentKey];\r\n                    let txt = commentVal?.txt;\r\n                    if (txt && typeof txt !== \"string\") {\r\n                        // try to inject jsx\r\n                        jsxComments[commentKey] = txt;\r\n                        txt = \"<span id='console_output_comment_\" + commentKey + \"'  class='console-msg'/>\";\r\n                        // fallback read text, that should go deep iteration, but 1 level deep should be enough.\r\n                        // let arr: any[] = (Array.isArray(txt?.props?.children) ? txt.props.children : (txt.props.children ? [txt.props.children] : []));\r\n                        // txt = arr.map(e => typeof e === \"string\" ? e : e?.props?.children + '' || '').join(\"\");\r\n                    }\r\n                    if (commentVal?.type) commentVal = \"\\t\\t<span class='console-msg'>\" + (commentVal?.type?.cname || commentVal.type)+\"</span>\"; // + \" ~ \" + txt;\r\n                    // warning: unicode char but should not make a problem. 𐀹\r\n                    commentVal += '<div class=\"output-comment my-tooltip\">' + txt + '</div></div><div class=\"output-row\" tabindex=\"984\">'\r\n\r\n                    let commentKeyEscaped = U.multiReplaceAll(commentKey, [\"$\", \"-\"], [\"\\\\$\", \"\\\\-\"]); // _ should be safe, .-,?^ not happening?\r\n                    let regexp = new RegExp(\"^({?\\\\s*\" +commentKeyEscaped+\":.*)$\", \"gm\");\r\n                    let regexpCloseTags = new RegExp(\"(\\\\<span style\\\\=\\\"color\\\\:\\\\#)\", \"gm\");\r\n                    outstr = U.replaceAll( outstr, \"$\", \"£\");\r\n                    outstr = outstr.replace(regexp, \"$1\" + commentVal);\r\n                    outstr = outstr.replace(regexpCloseTags,  \"</span>$1\");\r\n                    outstr = U.replaceAll(outstr, \"£\", \"$\");\r\n                }\r\n\r\n\r\n                /*if (shortcuts) outstr += \"</div></section><br><br>\" +\r\n                    \"<h4>Shortcuts</h4><section class='group shortcuts-container'><div class=\\\"output-row\\\" tabindex=\\\"984\\\">\" + U.objectInspect(shortcuts)+\"</section>\";\r\n                */\r\n\r\n                if (shortcuts) {\r\n                    shortcutsjsx = <ul>{\r\n                        Object.keys(shortcuts).sort().map(k=>this.getClickableEntry(expression, k, shortcuts))\r\n                    }</ul>\r\n                }\r\n                // if (hidden) outstr +=\"</div><br><br><h4>Other less useful properties</h4><div class=\\\"output-row\\\" tabindex=\\\"984\\\">\" + format(hidden);\r\n                // warning: unicode char but should not make a problem.\r\n                // outstr = U.replaceAll( outstr, '𐀹,\\n', '],</span>\\n</div><div class=\"output-row\" tabindex=\"984\"><span style=\"color:#000\">');\r\n                outstr = U.replaceAll( outstr, '<span style=\"color:#000\" class=\"console-msg\">,\\n',\r\n                    '</span><span style=\"color:#000\" class=\"console-msg\">,</span>\\n</div><div class=\"output-row\" tabindex=\"984\"><span class=\"console-msg\" style=\"color:#000\">');\r\n                outstr = U.replaceAll( outstr, '],\\n', '],</span>\\n</div><div class=\"output-row\" tabindex=\"984\"><span class=\"console-msg\" style=\"color:#000\">');\r\n                outstr = U.replaceAll( outstr, '},\\n', '},</span>\\n</div><div class=\"output-row\" tabindex=\"984\"><span class=\"console-msg\" style=\"color:#000\">');\r\n            }\r\n            ashtml = true; }\r\n        catch(e: any) {\r\n            console.error(e);\r\n            throw e;\r\n            outstr = \"[circular object]: \" + e.toString();\r\n            ashtml = false;\r\n        }\r\n        let contextkeysarr: (string)[];\r\n        let contextkeys: ReactNode = '';\r\n        if (this.state.expression.trim() === \"this\") contextkeys = \"Warning: \\\"this\\\" in the console is aliased to data instead of the whole context of a GraphElement component.\";\r\n\r\n        let objraw = this.state.output?.__raw || (typeof this.state.output === \"object\" ? this.state.output : \"[primitiveValue]\") || {};\r\n        if (this.state.expression.trim() === \"\") contextkeysarr = [\"data\", \"node\", \"view\", \"component\"];\r\n        else if (typeof objraw === \"string\") { contextkeysarr = Object.keys(String.prototype); }\r\n        else contextkeysarr = (Array.isArray(objraw) ?\r\n                [...(Object.keys(objraw) as any as number[]).filter(k => (k) <= 10).map(k=>k===10 ? '...' : ''+k), ...Object.keys(Array.prototype)]\r\n                : Object.getOwnPropertyNames(objraw)) || [];\r\n\r\n        contextkeys = <ul>{\r\n            contextkeysarr.sort().map(k=>this.getClickableEntry(expression, k))\r\n        }</ul>;\r\n\r\n\r\n        let injectCommentJSX = () => {\r\n            try{ for (let key in jsxComments) {\r\n                if (hiddenkeys.includes(key)) continue;\r\n                let commentNode: HTMLElement | null = document.getElementById(\"console_output_comment_\"+key);\r\n                Log.eDev(!commentNode, \"failed to find comment placeholder\", {key, v:jsxComments[key], jsxComments});\r\n                if (commentNode) ReactDOM.render(jsxComments[key], commentNode);\r\n            } }\r\n            catch (e) { console.error(\"failed to inject console output comment:\", e)}\r\n        }\r\n        setTimeout(injectCommentJSX, 1)\r\n        this.setNativeConsoleVariables();\r\n        windoww.output = output;\r\n        windoww.contextkeysarr = contextkeysarr;\r\n        windoww.contextkeys = contextkeys;\r\n        const undo = ()=>{\r\n            let expressionIndex = Math.max(0, this.state.expressionIndex - 1);\r\n            if (expressionIndex === this.state.expressionIndex) return;\r\n            this.setState({ expressionIndex })\r\n        }\r\n        const redo = ()=>{\r\n            const expressionHistory = this.state.expressionHistory;\r\n            let expressionIndex = Math.min(expressionHistory.length-1, this.state.expressionIndex + 1);\r\n            if (expressionIndex === this.state.expressionIndex) return;\r\n            this.setState({ expressionIndex })\r\n        }\r\n        let canredo = this.state.expressionIndex < this.state.expressionHistory.length - 1;\r\n        let canundo = this.state.expressionIndex > 0;\r\n\r\n        return(<div className={'w-100 h-100 p-2 console'}>\r\n            <h1>\r\n                On {((data as GObject)?.name || \"model-less node (\" + this.props.node?.className + \")\") + \" - \" + this.props.node?.className}\r\n            </h1>\r\n            <div className='console-terminal p-0 mb-2 w-100'>\r\n                <div className='commands'>\r\n                    <i onClick={(e) => { this.setState({expression:''})} } title={'Empty console'} className=\"bi bi-slash-circle\" />\r\n                    <i onClick={(e) => {\r\n                        if (!this.state.expression.trim()) { return Tooltip.show('Nothing to copy', undefined, undefined, 2); }\r\n                        let s = this.outputhtml?.innerText || '';\r\n                        s = s.substring('Result'.length).trim();\r\n                        U.clipboardCopy(s, ()=> Tooltip.show('Content copied to clipboard', undefined, undefined, 2));\r\n                    }} title={'Copy in the clipboard'} className=\"bi bi-clipboard-plus\" />\r\n                    {/* @ts-ignore */}\r\n                    <i onClick={redo} title={'redo'} className={\"redo bi bi-arrow-right-square\" + (canredo ? '':\" disabled\")} />\r\n                    {/* @ts-ignore */}\r\n                    <i onClick={undo} title={'undo'} className={\"undo bi bi-arrow-left-square\" + (canundo ? '':\" disabled\")} />\r\n                </div>\r\n                <textarea id={'console'} spellCheck={false} className={'p-0 input w-100'} onChange={this.change} value={this.state.expression} ></textarea>\r\n            </div>\r\n            {false && <div>Debug history (index = {this.state.expressionIndex})\r\n                {this.state.expressionHistory.map((s, i) => (<>\r\n                        <div style={{\r\n                            border: '1px solid ' + (i === this.state.expressionIndex ? 'red' : 'gray'),\r\n                            marginTop: '5px',\r\n                            height: '30px'\r\n                        }}>{s}</div>\r\n                    </>\r\n                ))}</div>}\r\n            {/*<label>Query {(this.state.expression)}</label>*/}\r\n            <hr className={'mt-1 mb-1'} />\r\n            { this.state.expression &&  ashtml && <div className={\"console-output-container console-msg\"}\r\n                        ref={(e)=>this.outputhtml = e} dangerouslySetInnerHTML={ashtml ? { __html: outstr as string} : undefined} /> }\r\n\r\n            { this.state.expression && !ashtml && <div className={\"console-output-container console-msg\"}\r\n                        ref={(e)=>this.outputhtml = e} style={{whiteSpace:\"pre\"}}>{ outstr }</div>}\r\n\r\n            {shortcutsjsx && <><h4>Shortcuts</h4><section className='group shortcuts-container'>{shortcutsjsx}</section></>}\r\n            <label className={\"context-keys mt-2\"}>Context keys</label>\r\n            {\r\n                <section className={'group context-keys-list'} style={{whiteSpace:\"pre\"}}>{contextkeys} </section>\r\n            }\r\n        </div>)\r\n    }\r\n\r\n    private setNativeConsoleVariables(): void { // just fordebugging\r\n        let context = this._context;\r\n        windoww.context = context;\r\n        windoww.data = context.data;\r\n        windoww.node = context.node;\r\n        windoww.edge = context.edge;\r\n        windoww.output = this.state.output;\r\n        if (context.data?.model) windoww.model = context.data?.model;\r\n    }\r\n}\r\n\r\ninterface OwnProps {}\r\ninterface StateProps {\r\n    data: LModelElement|null\r\n    node: LGraphElement|null\r\n    view: LViewElement|null\r\n}\r\ninterface DispatchProps {}\r\n\r\ntype AllProps = OwnProps & StateProps & DispatchProps;\r\n\r\nfunction mapStateToProps(state: DState, ownProps: OwnProps): StateProps {\r\n    const ret: StateProps = {} as FakeStateProps;\r\n    const nodeid = state._lastSelected?.node;\r\n    const node: LGraphElement|null = (nodeid) ? LGraphElement.fromPointer(nodeid) : null;\r\n    ret.node = node;\r\n    ret.data = (node?.model) ? node.model : null;\r\n    ret.view = (node?.view) ? node.view : null;\r\n    return ret;\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch<any>): DispatchProps {\r\n    const ret: DispatchProps = {} as any;\r\n    return ret;\r\n}\r\n\r\n\r\nexport const ConsoleConnected = connect<StateProps, DispatchProps, OwnProps, DState>(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(ConsoleComponent);\r\n\r\nexport const Console = (props: OwnProps, children: (string | Component)[] = []): ReactElement => {\r\n    return <ConsoleConnected {...{...props, children}} />;\r\n}\r\nexport default Console;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}