{"ast":null,"code":"import _objectSpread from\"C:/d/Programming/web/jodel-mde/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"C:/d/Programming/web/jodel-mde/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/d/Programming/web/jodel-mde/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import React from'react';import{connect}from'react-redux';import{LProject,U}from'../joiner';import Dashboard from'./Dashboard';import{ProjectsApi}from\"../api/persistance\";import{useNavigate}from\"react-router-dom\";import Project from\"./components/Project\";import Storage from\"../data/storage\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function AllProjectsComponent(props){var projects=props.projects;var navigate=useNavigate();var selectProject=function selectProject(id){navigate(\"/project?id=\".concat(id));U.refresh();};var exportProject=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(project){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:U.download(\"\".concat(project.name,\".jjodel\"),JSON.stringify(project.__raw));case 1:case\"end\":return _context.stop();}}},_callee);}));return function exportProject(_x){return _ref.apply(this,arguments);};}();var deleteProject=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(project){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return ProjectsApi.delete(project);case 2:case\"end\":return _context2.stop();}}},_callee2);}));return function deleteProject(_x2){return _ref2.apply(this,arguments);};}();var reader=new FileReader();reader.onload=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(e){var _e$target;var content,project,_projects,filtered;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:/* Import Project File */content=String((_e$target=e.target)===null||_e$target===void 0?void 0:_e$target.result);if(content){_context3.next=3;break;}return _context3.abrupt(\"return\");case 3:try{project=JSON.parse(content);_projects=Storage.read('projects')||[];filtered=_projects.filter(function(p){return p.id!==project.id;});filtered.push(project);Storage.write('projects',filtered);U.refresh();}catch(e){alert('Invalid File.');}case 4:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x3){return _ref3.apply(this,arguments);};}();var importProject=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(e){var files,file;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:files=e.target.files||[];if(files.length){_context4.next=3;break;}return _context4.abrupt(\"return\");case 3:file=files[0];reader.readAsText(file);case 5:case\"end\":return _context4.stop();}}},_callee4);}));return function importProject(_x4){return _ref4.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(Dashboard,{children:[/*#__PURE__*/_jsx(\"input\",{type:'file',className:'btn btn-success p-1 mx-1',onChange:/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(e){return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.next=2;return importProject(e);case 2:return _context5.abrupt(\"return\",_context5.sent);case 3:case\"end\":return _context5.stop();}}},_callee5);}));return function(_x5){return _ref5.apply(this,arguments);};}()}),/*#__PURE__*/_jsx(\"div\",{style:{overflow:'scroll'},className:'d-flex flex-wrap',children:projects.map(function(p){return/*#__PURE__*/_jsx(Project,{data:p},p.id);})})]});}function mapStateToProps(state,ownProps){var ret={};ret.projects=LProject.fromArr(state.projects);return ret;}function mapDispatchToProps(dispatch){var ret={};return ret;}var AllProjectsConnected=connect(mapStateToProps,mapDispatchToProps)(AllProjectsComponent);var AllProjectsPage=function AllProjectsPage(props){var children=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];return/*#__PURE__*/_jsx(AllProjectsConnected,_objectSpread({},_objectSpread(_objectSpread({},props),{},{children:children})));};export default AllProjectsPage;","map":{"version":3,"names":["React","connect","LProject","U","Dashboard","ProjectsApi","useNavigate","Project","Storage","jsx","_jsx","jsxs","_jsxs","AllProjectsComponent","props","projects","navigate","selectProject","id","concat","refresh","exportProject","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","project","wrap","_callee$","_context","prev","next","download","name","JSON","stringify","__raw","stop","_x","apply","arguments","deleteProject","_ref2","_callee2","_callee2$","_context2","delete","_x2","reader","FileReader","onload","_ref3","_callee3","e","_e$target","content","_projects","filtered","_callee3$","_context3","String","target","result","abrupt","parse","read","filter","p","push","write","alert","_x3","importProject","_ref4","_callee4","files","file","_callee4$","_context4","length","readAsText","_x4","children","type","className","onChange","_ref5","_callee5","_callee5$","_context5","sent","_x5","style","overflow","map","data","mapStateToProps","state","ownProps","ret","fromArr","mapDispatchToProps","dispatch","AllProjectsConnected","AllProjectsPage","undefined","_objectSpread"],"sources":["C:/d/Programming/web/jodel-mde/src/pages/AllProjects.tsx"],"sourcesContent":["import React, {Dispatch, Component, ReactElement, ChangeEvent} from 'react';\r\nimport {connect} from 'react-redux';\r\nimport {DProject, DState, DUser, LProject, U} from '../joiner';\r\nimport {FakeStateProps} from '../joiner/types';\r\nimport Dashboard from './Dashboard';\r\nimport {ProjectsApi} from \"../api/persistance\";\r\nimport {useNavigate} from \"react-router-dom\";\r\nimport Project from \"./components/Project\";\r\nimport Storage from \"../data/storage\";\r\n\r\n\r\nfunction AllProjectsComponent(props: AllProps) {\r\n    const {projects} = props;\r\n    const navigate = useNavigate();\r\n\r\n    const selectProject = (id: DProject['id']) => {\r\n        navigate(`/project?id=${id}`);\r\n        U.refresh();\r\n    }\r\n    const exportProject = async(project: LProject) => {\r\n        U.download(`${project.name}.jjodel`, JSON.stringify(project.__raw));\r\n    }\r\n    const deleteProject = async(project: LProject) => {\r\n        await ProjectsApi.delete(project);\r\n    }\r\n\r\n    const reader = new FileReader();\r\n    reader.onload = async e => {\r\n        /* Import Project File */\r\n        const content = String(e.target?.result);\r\n        if(!content) return;\r\n        try {\r\n            const project = JSON.parse(content) as DProject;\r\n            const projects = Storage.read<DProject[]>('projects') || [];\r\n            const filtered = projects.filter(p => p.id !== project.id);\r\n            filtered.push(project);\r\n            Storage.write('projects', filtered);\r\n            U.refresh();\r\n        } catch (e) {alert('Invalid File.')}\r\n    }\r\n    const importProject = async(e: ChangeEvent<HTMLInputElement>) => {\r\n        const files = e.target.files || [];\r\n        if(!files.length) return;\r\n        const file = files[0];\r\n        reader.readAsText(file);\r\n    }\r\n\r\n    return(<Dashboard>\r\n        <input type={'file'} className={'btn btn-success p-1 mx-1'} onChange={async e => await importProject(e)} />\r\n        <div style={{overflow: 'scroll'}} className={'d-flex flex-wrap'}>\r\n            {projects.map(p => <Project key={p.id} data={p} />)}\r\n        </div>\r\n    </Dashboard>);\r\n}\r\n\r\ninterface OwnProps {}\r\ninterface StateProps {projects: LProject[]}\r\ninterface DispatchProps {}\r\ntype AllProps = OwnProps & StateProps & DispatchProps;\r\n\r\n\r\nfunction mapStateToProps(state: DState, ownProps: OwnProps): StateProps {\r\n    const ret: StateProps = {} as FakeStateProps;\r\n    ret.projects = LProject.fromArr(state.projects);\r\n    return ret;\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch<any>): DispatchProps {\r\n    const ret: DispatchProps = {};\r\n    return ret;\r\n}\r\n\r\nconst AllProjectsConnected = connect<StateProps, DispatchProps, OwnProps, DState>(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(AllProjectsComponent);\r\n\r\nconst AllProjectsPage = (props: OwnProps, children: (string | Component)[] = []): ReactElement => {\r\n    return <AllProjectsConnected {...{...props, children}} />;\r\n}\r\n\r\nexport default AllProjectsPage;\r\n\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}