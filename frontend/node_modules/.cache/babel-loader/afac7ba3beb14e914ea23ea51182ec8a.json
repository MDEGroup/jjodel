{"ast":null,"code":"/* Viewpoints > Style */import React,{useState,useRef,useEffect}from'react';import{connect}from\"react-redux\";import{useStateIfMounted}from\"use-state-if-mounted\";import tinycolor from\"tinycolor2\";import Editor from\"@monaco-editor/react\";import'smart-webcomponents-react/source/styles/smart.default.css';import{EdgeHead,Input,Keystrokes,Log,LViewElement,U}from'../../../../joiner';import{CSS_Units}from'../../../../view/viewElement/view';import{Color}from'../../../forEndUser/Color';import{Btn,CommandBar}from'../../../commandbar/CommandBar';import{HRule}from'../../../widgets/Widgets';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function makeNumericInput(prefix,number,setNumber,setText,readOnly){let min;let max;let step=undefined;switch(number.unit){case'':case'px':min=0;max=300;break;case'pt':break;// 1pt = 1.33 px; 1px = 0.75pt\ncase'cm':case'mm':min=0;max=200;break;// 1mm = 3.7px\ncase'ch':case'ex':case'em':case'rem':case'in':// 1in = 96px\ncase'pc':// 2px = 0.125 picas; 18.75pc = 300px\ncase'fr':min=0;max=20;step=0.5;break;case\"%\":case\"vh\":case\"vw\":case\"vmax\":case\"vmin\":min=0;max=100;break;}let roundedValue0=Math.round(((number.value||0)-(typeof step===\"number\"?number.value%step:number.value%0.1))*10000)/10000;// % works on decimals right.\nlet roundedValue=typeof step===\"number\"?Math.round((number.value||0)*(1/step))*step:Math.round(number.value*100)/100;// % works on decimals right.\nreturn/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"input\",{className:\"value\",placeholder:\"value\",type:\"range\",disabled:readOnly,defaultValue:number.value,min:min,max:max,step:\"any\",onBlur:e=>{setNumber(e,prefix);},onMouseUp:e=>{setNumber(e,prefix);}},\"s\"+number.value),/*#__PURE__*/_jsx(\"input\",{className:\"spinner\",placeholder:\"value\",type:\"number\",disabled:readOnly,defaultValue:roundedValue,\"data-dv\":roundedValue,\"data-dv2\":number.value,step:step,onBlur:e=>{setNumber(e,prefix);},onKeyDown:e=>{if(e.key===Keystrokes.enter)setNumber(e,prefix);if(e.key===Keystrokes.escape)e.target.value=''+number.value;}},roundedValue)]});}// delete button <button className=\"btn btn-danger ms-1\"><i className=\"p-1 bi bi-trash3-fill\"/></button>\nfunction PaletteDataComponent(props){const view=props.view;const readOnly=props.readonly;let palette={...view.palette};let tmp=undefined;const[css,setCss]=useStateIfMounted(view.css);const[expand,setExpand]=useStateIfMounted(false);const change=value=>{if(value!==undefined)setCss(value);};// save in local state for frequent changes.\nconst blur=()=>view.css=css;// confirm in redux state for final state\n/* *** alfonso *** */function useClickOutside(ref,onClickOutside){useEffect(()=>{function handleClickOutside(event){if(ref.current&&!ref.current.contains(event.target)){onClickOutside();}}// Bind\n// @ts-ignore\ndocument.addEventListener(\"mousedown\",handleClickOutside);return()=>{// dispose\n// @ts-ignore\ndocument.removeEventListener(\"mousedown\",handleClickOutside);};},[ref,onClickOutside]);}const AddPalette=()=>{const[open,setOpen]=useState(false);const menuRef=useRef(null);useClickOutside(menuRef,()=>{setOpen(false);});return/*#__PURE__*/_jsx(_Fragment,{children:!open?/*#__PURE__*/_jsxs(\"div\",{className:'add-palette-item',onClick:()=>{setOpen(true);},children:[/*#__PURE__*/_jsx(\"i\",{style:{color:'white'},className:\"bi bi-plus\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Add new\"})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:'add-palette-item active',onClick:()=>{setOpen(false);},children:/*#__PURE__*/_jsx(\"i\",{style:{color:'white'},className:\"bi bi-plus\"})}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>addControl('palette'),className:\"btn btn-success my-btn btn-color\",children:\"Palette\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>addControl('number'),className:\"btn btn-success my-btn btn-number\",children:\"Number\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>addControl('text'),className:\"btn btn-success my-btn btn-textual\",children:\"Text\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>addControl('path'),className:\"btn btn-success my-btn btn-path\",children:\"Path\"})]})});};/* *** */const addControl=type=>{if(readOnly)return;let i;let prefix0;//= 'palette_' + i + '-';\nswitch(type){default:Log.exDevv(\"unexpected case in addControl:\"+type);return;case'path':i=Object.values(palette).filter(o=>o.type===\"path\").length+1;prefix0='path_';break;case'text':i=Object.values(palette).filter(o=>o.type===\"text\").length+1;prefix0='text_';break;case'number':i=Object.values(palette).filter(o=>o.type===\"number\").length+1;prefix0='numeric_';break;case'palette':i=Object.values(palette).filter(o=>Array.isArray(o)).length+1;prefix0='palette_';break;}let prefix;while(true){prefix=prefix0+i++;if(prefix in palette)continue;break;}switch(type){default:Log.exDevv(\"unexpected case in addControl:\"+type);return;case'path':const agglabel=\"◇ Aggregation / Composition\";const extendlabel=\"△ \"+EdgeHead.extend;const asslabel=\"Λ \"+EdgeHead.reference;let headdict={[asslabel]:'M 0 0   L x y/2   L 0 y',[extendlabel]:'M 0 0   L x y/2   L 0 y   Z',[agglabel]:'M 0 y/2   L x/2 0   L x y/2   L x/2 y   Z'};let predefinedPaths=Object.entries(headdict).map(e=>({k:e[0],v:e[1]}));tmp={...palette};tmp[prefix]={type:'path',value:'',x:'edgeHeadSize.x',y:'edgeHeadSize.y',options:predefinedPaths};break;case'text':tmp={...palette};tmp[prefix]={type:'text',value:''};break;case'number':tmp={...palette};tmp[prefix]={type:'number',value:0,unit:'px'};break;case'palette':tmp={...palette};tmp[prefix]={type:'color',value:[]};break;}view.palette=palette=tmp;};const setGeneric=(e,prefix,key)=>{const val=e.target.value;if(readOnly||palette[prefix][key]===val)return;let tmp={...palette};tmp[prefix][key]=val;view.palette=palette=tmp;};const setText=(e,prefix)=>{const val=e.target.value;if(readOnly||palette[prefix].value===val)return;let tmp={...palette};tmp[prefix].value=val;view.palette=palette=tmp;};const setNumber=(e,prefix)=>{const val=+e.target.value||0;if(readOnly||palette[prefix].value===val)return;let tmp={...palette};tmp[prefix].value=val;view.palette=palette=tmp;};const setUnit=(e,prefix)=>{const val=e.target.value===undefined?'px':e.target.value;if(readOnly||val===palette[prefix].unit)return;let tmp={...palette};tmp[prefix].unit=val;view.palette=palette=tmp;};const changePrefix=(oldPrefix,newPrefix)=>{// @ts-ignore\nnewPrefix=newPrefix.replaceAll(/[^\\w\\-]/g,'-');// /^[^a-zA-Z0-9_\\-]*$/, '-');\nif(readOnly||palette[newPrefix])return;// refuse to overwrite existing palette name (2 different palettes with same name)\ntmp={...palette};tmp[newPrefix]=palette[oldPrefix];delete tmp[oldPrefix];view.palette=palette=tmp;};const removeControl=prefix=>{if(readOnly||!palette[prefix])return;tmp={...palette};delete tmp[prefix];view.palette=palette=tmp;};const addColor=function(prefix,colors){let index=arguments.length>2&&arguments[2]!==undefined?arguments[2]:-1;let skipFirst=arguments.length>3&&arguments[3]!==undefined?arguments[3]:true;if(readOnly)return;if(!Array.isArray(colors)){colors=[colors];skipFirst=false;}let tmp={...palette};let lastAdded=undefined;for(let i=colors.length-1;i>=(skipFirst?1:0);i--){let color=colors[i];let rgba=color.toRgb();console.log(\"addingColor:\",{rgba,lastAdded,color});if(rgba===lastAdded)continue;lastAdded=rgba;if(!tmp[prefix])tmp[prefix]={type:'color',value:[]};else tmp[prefix]={...tmp[prefix]};tmp[prefix].value=[...tmp[prefix].value];if(index>=0)tmp[prefix].value.splice(index+1,0,rgba);else tmp[prefix].value.push(rgba);}view.palette=palette=tmp;};const setColor=(prefix,index,hex,alpha)=>{let tmp={...palette};if(readOnly||!tmp[prefix])tmp[prefix]={type:'color',value:[]};else tmp[prefix]={...tmp[prefix]};let oldColor=tmp[prefix].value[index];if(hex){let color=tinycolor(hex);if(alpha!==undefined)color.setAlpha(alpha);let rgba=color.toRgb();if(oldColor&&oldColor.a!==undefined)rgba.a=oldColor.a;tmp[prefix].value[index]=oldColor=rgba;view.palette=palette=tmp;}if(alpha!==undefined)tmp[prefix].value[index]={...oldColor,a:alpha};};const transparencyColor=(prefix,index,color,alpha)=>{if(readOnly||!palette[prefix])return;let tmp={...palette};if(!alpha&&alpha!==0)alpha=1;tmp[prefix]={...tmp[prefix]};tmp[prefix].value=[...tmp[prefix].value];tmp[prefix].value[index]={...tmp[prefix].value[index]};tmp[prefix].value[index].a=alpha;color.setAlpha(alpha);console.log(\"set transparency\",{color,tinycolor,oldcolor:tmp[prefix].value[index]});view.palette=palette=tmp;};const removeColor=(prefix,index)=>{if(readOnly||!palette[prefix])return;let tmp={...palette};tmp[prefix].value=[...tmp[prefix].value];tmp[prefix].value=tmp[prefix].value.filter((c,i)=>i!==index);view.palette=palette=tmp;};const cssIsGlobal=view.cssIsGlobal;let a;let dropDownButton={current:null};function addcss(color){let ret={};ret.background=color.toRgbString();// ret.opacity = color.getAlpha();\nreturn ret;}function invert(color){let transformGrays=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0.2;transformGrays=transformGrays*128;let{r,g,b,a}=color.toRgb();r=Math.abs(r-128)<=transformGrays?r>=128?0:255:255-r;g=Math.abs(g-128)<=transformGrays?g>=128?0:255:255-g;b=Math.abs(b-128)<=transformGrays?b>=128?0:255:255-b;if(a||a===0)a=255-a;return tinycolor({r,g,b,a}).toRgbString();}function style(c){return{backgroundColor:c.toRgbString(),color:invert(c)};}let palettes=U.paletteSplit(palette);function palettewrap(prefix,node){return/*#__PURE__*/_jsxs(\"div\",{className:\"palette-row-container\",children:[/*#__PURE__*/_jsx(\"input\",{className:\"prefix\",style:{maxHeight:'var(--input-height)',borderRadius:'var(--radius)'},placeholder:\"variable name\",defaultValue:prefix,onBlur:e=>changePrefix(prefix,e.target.value),disabled:readOnly}),node]});}const vcss=view.css;let colors=Object.keys(palettes.color).sort();const lines=Math.round(vcss.split(/\\r|\\r\\n|\\n/).length*1.8)<5?10:Math.round(vcss.split(/\\r|\\r\\n|\\n/).length*1.8);return/*#__PURE__*/_jsxs(\"section\",{className:'p-3 style-tab',children:[/*#__PURE__*/_jsxs(\"h1\",{className:'view',children:[\"View: \",props.view.name]}),/*#__PURE__*/_jsxs(\"div\",{className:\"controls\",style:{position:'relative',zIndex:2},children:[colors.map((entry,index,entries)=>{let prefix=entry;let paletteobj=palettes.color[prefix];let colors=paletteobj.value.map(v=>tinycolor(v));let suggestions=[tinycolor('#ffaaaa')];// todo: compute according to current row \"colors\"\nreturn palettewrap(prefix,/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"palette-row\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"color-container\",style:{maxHeight:'var(--input-height)',borderRadius:'var(--radius)'},children:colors.map((color,i)=>/*#__PURE__*/_jsx(Color,{readonly:readOnly,data:view,field:'palette',canDelete:!readOnly,getter:()=>colors[i].toHexString(),setter:newVal=>{setColor(prefix,i,newVal);},style:{background:'white'},inputStyle:{opacity:color.getAlpha()},childrenn:/*#__PURE__*/_jsxs(\"div\",{className:\"content suggestions\",tabIndex:-1,style:{backgroundColor:\"inherit\"},onClick:e=>{e.preventDefault();e.stopPropagation();},children:[(()=>{return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"h6\",{title:\"Alter current color transparency\",children:\"Opacity\"}),/*#__PURE__*/_jsx(\"input\",{style:{width:\"auto\",marginLeft:\"1em\",marginRight:\"1em\"},type:\"range\",min:0,max:1,step:\"any\",value:color.getAlpha(),onChange:e=>{transparencyColor(prefix,i,color,+e.target.value);}}),/*#__PURE__*/_jsxs(\"h6\",{title:\"Add all the colors\",children:[/*#__PURE__*/_jsx(CommandBar,{style:{float:'left',paddingRight:'8px'},children:/*#__PURE__*/_jsx(Btn,{icon:'add',size:'x-small',action:()=>addColor(prefix,color.analogous(7,30/1.5),i),theme:'dark',tip:'Add all the colors'})}),/*#__PURE__*/_jsx(\"span\",{children:\"Analogous\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"roww\",children:color.analogous(7,30/1.5).map((c,ii)=>ii===0?undefined:/*#__PURE__*/_jsx(\"button\",{style:style(c),onClick:e=>{addColor(prefix,c,i);},className:\"btn color-suggestion\",children:/*#__PURE__*/_jsx(\"i\",{style:style(c),className:\"bi bi-plus-lg\"})}))}),/*#__PURE__*/_jsxs(\"h6\",{title:\"Add all the colors\",children:[/*#__PURE__*/_jsx(CommandBar,{style:{float:'left',paddingRight:'8px'},children:/*#__PURE__*/_jsx(Btn,{icon:'add',size:'x-small',tip:'Add all the colors',theme:'dark',action:()=>addColor(prefix,[1/12,2/12,3/12,4/12,5/12,6/12].map(n=>color.clone().lighten(n*100)),i,false)})}),/*#__PURE__*/_jsx(\"span\",{children:\"Lighten\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"roww\",children:[1/12,2/12,3/12,4/12,5/12,6/12].map(n=>color.clone().lighten(n*100)).map((c,ii)=>/*#__PURE__*/_jsx(\"button\",{style:style(c),className:\"btn color-suggestion\",onClick:e=>{addColor(prefix,c,i);},children:/*#__PURE__*/_jsx(\"i\",{style:style(c),className:\"bi bi-plus-lg\"})}))}),/*#__PURE__*/_jsxs(\"h6\",{title:\"Add all the colors\",children:[/*#__PURE__*/_jsx(CommandBar,{style:{float:'left',paddingRight:'8px'},children:/*#__PURE__*/_jsx(Btn,{icon:'add',theme:'dark',tip:'Add all the colors',size:'x-small',action:()=>addColor(prefix,[6/12,5/12,4/12,3/12,2/12,1/12].map(n=>color.clone().darken(n*100)),i,false)})}),/*#__PURE__*/_jsx(\"span\",{children:\"Darken\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"roww\",children:[6/12,5/12,4/12,3/12,2/12,1/12].map(n=>color.clone().darken(n*100)).map((c,ii)=>/*#__PURE__*/_jsx(\"button\",{style:style(c),className:\"btn color-suggestion\",onClick:e=>{addColor(prefix,c,i);},children:/*#__PURE__*/_jsx(\"i\",{style:style(c),className:\"bi bi-plus-lg\"})}))}),/*#__PURE__*/_jsxs(\"h6\",{title:\"Add all the colors\",children:[/*#__PURE__*/_jsx(CommandBar,{style:{float:'left',paddingRight:'8px'},children:/*#__PURE__*/_jsx(Btn,{icon:'add',tip:'Add all the colors',theme:'dark',size:'x-small',action:()=>addColor(prefix,[color.complement(),tinycolor(invert(color))],i,false)})}),/*#__PURE__*/_jsx(\"span\",{children:\"Complementary / Opposite\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"roww\",children:[/*#__PURE__*/_jsx(\"button\",{style:style(color.complement()),className:\"btn color-suggestion\",onClick:e=>{addColor(prefix,color.complement(),i);},children:/*#__PURE__*/_jsx(\"i\",{style:style(color.complement()),className:\"bi bi-plus-lg\"})}),/*#__PURE__*/_jsx(\"button\",{style:style(color),className:\"btn color-suggestion\",onClick:e=>{addColor(prefix,tinycolor(invert(color)),i);},children:/*#__PURE__*/_jsx(\"i\",{style:style(color),className:\"bi bi-plus-lg\"})})]}),/*#__PURE__*/_jsxs(\"h6\",{title:\"Add all the colors\",children:[/*#__PURE__*/_jsx(CommandBar,{style:{float:'left',paddingRight:'8px'},children:/*#__PURE__*/_jsx(Btn,{icon:'add',tip:'Add all the colors',theme:'dark',size:'x-small',action:()=>addColor(prefix,color.splitcomplement(),i)})}),/*#__PURE__*/_jsx(\"span\",{children:\"Split Complementary\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"roww\",children:color.splitcomplement().map(c=>/*#__PURE__*/_jsx(\"button\",{style:{...style(c)},className:\"btn color-suggestion\",onClick:e=>{addColor(prefix,c,i);},children:/*#__PURE__*/_jsx(\"i\",{style:style(c),className:\"bi bi-plus-lg\"})}))}),/*#__PURE__*/_jsxs(\"h6\",{title:\"Add all the colors\",children:[/*#__PURE__*/_jsx(CommandBar,{style:{float:'left',paddingRight:'8px'},children:/*#__PURE__*/_jsx(Btn,{icon:'add',tip:'Add all the colors',theme:'dark',size:'x-small',action:()=>addColor(prefix,color.triad(),i)})}),/*#__PURE__*/_jsx(\"span\",{children:\"Triadic\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"roww\",children:color.triad().map(c=>/*#__PURE__*/_jsx(\"button\",{style:{...style(c)},className:\"btn color-suggestion\",onClick:e=>{addColor(prefix,c,i);},children:/*#__PURE__*/_jsx(\"i\",{style:style(c),className:\"bi bi-plus-lg\"})}))}),/*#__PURE__*/_jsxs(\"h6\",{title:\"Add all the colors\",children:[/*#__PURE__*/_jsx(CommandBar,{style:{float:'left',paddingRight:'8px'},children:/*#__PURE__*/_jsx(Btn,{icon:'add',tip:'Add all the colors',theme:'dark',size:'x-small',action:()=>addColor(prefix,color.tetrad(),i)})}),/*#__PURE__*/_jsx(\"span\",{children:\"Tetradic\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"roww\",children:color.tetrad().map(c=>/*#__PURE__*/_jsx(\"button\",{style:{...style(c)},className:\"btn color-suggestion\",onClick:e=>{addColor(prefix,c,i);},children:/*#__PURE__*/_jsx(\"i\",{style:style(c),className:\"bi bi-plus-lg\"})}))})]});})(),/*#__PURE__*/_jsxs(\"button\",{className:'btn btn-danger content delete-color mt-2 jj-delete',onClick:()=>removeColor(prefix,i),disabled:readOnly,children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi p-1 bi-trash-fill\"}),\" Delete\"]})]})},prefix+i))}),/*#__PURE__*/_jsx(\"div\",{className:\"suggestion-container\",children:suggestions.map((c,i)=>/*#__PURE__*/_jsx(\"label\",{className:\"p-1\",children:/*#__PURE__*/_jsxs(CommandBar,{style:{float:'right'},children:[/*#__PURE__*/_jsx(Btn,{icon:'add',tip:'Add color to palette',action:()=>addColor(prefix,c)}),/*#__PURE__*/_jsx(Btn,{icon:'delete',tip:'Remove color from palette',action:()=>{if(Array.isArray(palette[prefix].value)&&palette[prefix].value.length){removeColor(prefix,i);}else{removeControl(prefix);}}})]})}))})]})}));}),Object.entries(palettes.path).map((entry,index,entries)=>{let prefix=entry[0];let path=entry[1];return palettewrap(prefix,/*#__PURE__*/_jsxs(\"div\",{className:\"palette-row path\",title:\"todo: proper tooltip.\\nedgeHeadSize is in the \\\"Options\\\" tab and determines the position of the head.\\nBasic math operators are allowed, but the minus and plus must have spaces around them or they will be traated as unary operators.\\nx and y are variables local to this path used to scale his shape.\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"value hoverable\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"d-flex w-100\",children:/*#__PURE__*/_jsx(\"input\",{className:\"value w-100 my-auto\",placeholder:\"svg path [d]\",defaultValue:path.value,onBlur:e=>{setText(e,prefix);},disabled:readOnly,onKeyDown:e=>{if(e.key===Keystrokes.enter)setText(e,prefix);if(e.key===Keystrokes.escape)e.target.value=path.value;}},path.value)}),/*#__PURE__*/_jsxs(\"div\",{className:\"content d-flex w-100\",style:{position:'relative',backgroundColor:'whitesmoke'},children:[/*#__PURE__*/_jsx(\"input\",{className:\"spacer w-100\"}),/*#__PURE__*/_jsxs(\"label\",{className:\"mx-auto\",children:[\"x:\\xA0\",/*#__PURE__*/_jsx(\"input\",{className:\"x\",placeholder:\"x\",defaultValue:path.x,disabled:readOnly,onChange:e=>setGeneric(e,prefix,\"x\")})]}),/*#__PURE__*/_jsxs(\"label\",{className:\"mx-auto\",children:[\"y:\\xA0\",/*#__PURE__*/_jsx(\"input\",{className:\"y\",placeholder:\"y\",defaultValue:path.y,disabled:readOnly,onChange:e=>setGeneric(e,prefix,\"y\")})]})]})]}),/*#__PURE__*/_jsx(\"select\",{className:'d-flex',style:{width:'100px!important'},value:path.value,disabled:readOnly,onChange:e=>setText(e,prefix),children:[/*#__PURE__*/_jsx(\"option\",{style:{fontStyle:'italic',color:'gray'},value:\"\",children:\"Custom\"}),path.options.map(e=>{let k=e.k;let v=e.v;return/*#__PURE__*/_jsx(\"option\",{value:v,children:k});})]}),/*#__PURE__*/_jsxs(CommandBar,{style:{paddingRight:'4px',marginLeft:'auto'},children:[/*#__PURE__*/_jsx(Btn,{icon:'space'}),/*#__PURE__*/_jsx(Btn,{icon:\"delete\",action:e=>{removeControl(prefix);},tip:'Remove path'})]})]}));}),Object.entries(palettes.number).map((entry,index,entries)=>{let prefix=entry[0];let number=entry[1];return palettewrap(prefix,/*#__PURE__*/_jsxs(\"div\",{className:\"palette-row numeric\",children:[makeNumericInput(prefix,number,setNumber,setText,readOnly),/*#__PURE__*/_jsx(\"input\",{className:\"unit\",placeholder:\"unit\",value:number.unit,pattern:CSS_Units.pattern,disabled:readOnly,list:\"__jodel_CSS_units\",onChange:e=>{setUnit(e,prefix);}}),/*#__PURE__*/_jsxs(CommandBar,{style:{paddingRight:'4px',marginLeft:'auto'},children:[/*#__PURE__*/_jsx(Btn,{icon:'space'}),/*#__PURE__*/_jsx(Btn,{icon:\"delete\",action:e=>{removeControl(prefix);},tip:'Remove number'})]})]}));}),Object.entries(palettes.text).map((entry,index,entries)=>{let prefix=entry[0];let string=entry[1];return palettewrap(prefix,/*#__PURE__*/_jsxs(\"div\",{className:\"palette-row textual\",children:[/*#__PURE__*/_jsx(\"input\",{className:\"value\",placeholder:\"value\",defaultValue:string.value,onBlur:e=>{setText(e,prefix);},disabled:readOnly,onKeyDown:e=>{if(e.key===Keystrokes.enter)setText(e,prefix);if(e.key===Keystrokes.escape)e.target.value=string.value;}}),/*#__PURE__*/_jsxs(CommandBar,{style:{paddingRight:'4px',marginLeft:'auto'},children:[/*#__PURE__*/_jsx(Btn,{icon:'space'}),/*#__PURE__*/_jsx(Btn,{icon:\"delete\",action:e=>{removeControl(prefix);},tip:'Remove text'})]})]}));})]}),/*#__PURE__*/_jsx(AddPalette,{}),/*#__PURE__*/_jsx(HRule,{theme:'light',style:{display:'block',padding:'30px 0px!important'}}),/*#__PURE__*/_jsx(Input,{data:view,field:'cssIsGlobal',type:\"checkbox\",jsxLabel:/*#__PURE__*/_jsxs(\"div\",{style:{width:'100%',display:'block',float:'left'},children:[cssIsGlobal?/*#__PURE__*/_jsx(\"b\",{style:{color:'inherit'},children:\"Global\"}):/*#__PURE__*/_jsx(\"b\",{style:{color:'inherit'},children:\"Local\"}),' CSS & LESS Editor ',cssIsGlobal?'(Use with caution)':'']})}),vcss.indexOf('//')>=0&&/*#__PURE__*/_jsxs(\"b\",{children:[/*#__PURE__*/_jsx(\"span\",{style:{color:'red'},children:\"Warning:\"}),\" Inline comments // are not supported by our compiler.\",/*#__PURE__*/_jsx(\"br\",{}),\"Please replace them with /* block comments */\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"monaco-editor-wrapper\",style:{minHeight:'20px',height:\"\".concat(expand?'30lvh':'10lvh'),transition:'height 0.3s',resize:'vertical',overflow:'hidden',display:'flex',flexDirection:'column'},onFocus:()=>setExpand(true),onBlur:()=>{setExpand(false);blur();},children:/*#__PURE__*/_jsx(Editor,{className:'mx-1',options:{fontSize:12,scrollbar:{vertical:'hidden',horizontalScrollbarSize:5},minimap:{enabled:false},readOnly:readOnly},defaultLanguage:'less',value:vcss,onChange:change})}),false&&/*#__PURE__*/_jsx(\"div\",{className:\"debug\",children:/*#__PURE__*/_jsx(\"div\",{style:{whiteSpace:'pre'},children:view.compiled_css})})]});}function mapStateToProps(state,ownProps){const view=LViewElement.fromPointer(ownProps.viewID);return{view};}function mapDispatchToProps(dispatch){const ret={};return ret;}export const PaletteDataConnected=connect(mapStateToProps,mapDispatchToProps)(PaletteDataComponent);export const PaletteData=function(props){let children=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];return/*#__PURE__*/_jsx(PaletteDataConnected,{...props,children});};export default PaletteData;","map":{"version":3,"names":["React","useState","useRef","useEffect","connect","useStateIfMounted","tinycolor","Editor","EdgeHead","Input","Keystrokes","Log","LViewElement","U","CSS_Units","Color","Btn","CommandBar","HRule","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","makeNumericInput","prefix","number","setNumber","setText","readOnly","min","max","step","undefined","unit","roundedValue0","Math","round","value","roundedValue","children","className","placeholder","type","disabled","defaultValue","onBlur","e","onMouseUp","onKeyDown","key","enter","escape","target","PaletteDataComponent","props","view","readonly","palette","tmp","css","setCss","expand","setExpand","change","blur","useClickOutside","ref","onClickOutside","handleClickOutside","event","current","contains","document","addEventListener","removeEventListener","AddPalette","open","setOpen","menuRef","onClick","style","color","addControl","i","prefix0","exDevv","Object","values","filter","o","length","Array","isArray","agglabel","extendlabel","extend","asslabel","reference","headdict","predefinedPaths","entries","map","k","v","x","y","options","setGeneric","val","setUnit","changePrefix","oldPrefix","newPrefix","replaceAll","removeControl","addColor","colors","index","arguments","skipFirst","lastAdded","rgba","toRgb","console","log","splice","push","setColor","hex","alpha","oldColor","setAlpha","a","transparencyColor","oldcolor","removeColor","c","cssIsGlobal","dropDownButton","addcss","ret","background","toRgbString","invert","transformGrays","r","g","b","abs","backgroundColor","palettes","paletteSplit","palettewrap","node","maxHeight","borderRadius","vcss","keys","sort","lines","split","name","position","zIndex","entry","paletteobj","suggestions","data","field","canDelete","getter","toHexString","setter","newVal","inputStyle","opacity","getAlpha","childrenn","tabIndex","preventDefault","stopPropagation","title","width","marginLeft","marginRight","onChange","float","paddingRight","icon","size","action","analogous","theme","tip","ii","n","clone","lighten","darken","complement","splitcomplement","triad","tetrad","path","fontStyle","pattern","list","text","string","display","padding","jsxLabel","indexOf","minHeight","height","concat","transition","resize","overflow","flexDirection","onFocus","fontSize","scrollbar","vertical","horizontalScrollbarSize","minimap","enabled","defaultLanguage","whiteSpace","compiled_css","mapStateToProps","state","ownProps","fromPointer","viewID","mapDispatchToProps","dispatch","PaletteDataConnected","PaletteData"],"sources":["C:/0Programmi/Dev/projects/frontend/jjodel/src/components/editors/views/data/PaletteData.tsx"],"sourcesContent":["/* Viewpoints > Style */\r\n\r\nimport React, {Dispatch, ReactElement, ReactNode, Ref, RefObject, SyntheticEvent, useState, useRef, useEffect} from 'react';\r\nimport {connect} from \"react-redux\";\r\nimport {useStateIfMounted} from \"use-state-if-mounted\";\r\nimport tinycolor, {Instance} from \"tinycolor2\";\r\nimport Editor from \"@monaco-editor/react\";\r\nimport DropDownButton from \"smart-webcomponents-react/dropdownbutton\";\r\nimport 'smart-webcomponents-react/source/styles/smart.default.css';\r\nimport type {Dictionary, GObject, Pointer,} from '../../../../joiner';\r\nimport {DState, DViewElement, EdgeHead, Input, Keystrokes, Log, LViewElement, U,} from '../../../../joiner';\r\nimport type {\r\n    NumberControl,\r\n    PaletteControl,\r\n    PaletteType,\r\n    PathControl,\r\n    StringControl\r\n} from '../../../../view/viewElement/view';\r\nimport {CSS_Units} from '../../../../view/viewElement/view';\r\nimport {Color} from '../../../forEndUser/Color';\r\n\r\nimport {Btn, CommandBar} from '../../../commandbar/CommandBar';\r\nimport {HRule} from '../../../widgets/Widgets';\r\n\r\n\r\nfunction makeNumericInput(prefix: string, number: NumberControl,\r\n                          setNumber: (e: React.FocusEvent<HTMLInputElement>, prefix: string) => void,\r\n                          setText: (e: React.FocusEvent<HTMLInputElement>, prefix: string) => void, readOnly: boolean) {\r\n    let min: number | undefined;\r\n    let max: number | undefined;\r\n    let step: number | undefined = undefined;\r\n    switch (number.unit) {\r\n        case '':\r\n        case 'px': min = 0; max = 300; break;\r\n        case 'pt': break; // 1pt = 1.33 px; 1px = 0.75pt\r\n        case 'cm':\r\n        case 'mm': min = 0; max = 200; break; // 1mm = 3.7px\r\n        case 'ch':\r\n        case 'ex':\r\n        case 'em':\r\n        case 'rem':\r\n        case 'in': // 1in = 96px\r\n        case 'pc': // 2px = 0.125 picas; 18.75pc = 300px\r\n        case 'fr': min=0; max=20; step = 0.5; break;\r\n        case \"%\": case \"vh\": case \"vw\": case \"vmax\": case \"vmin\":\r\n            min = 0;\r\n            max = 100;\r\n            break;\r\n    }\r\n    let roundedValue0 = Math.round(((number.value || 0) - (typeof step === \"number\" ? number.value % step : number.value % 0.1))*10000)/10000; // % works on decimals right.\r\n    let roundedValue = typeof step === \"number\" ? Math.round(((number.value || 0)  * (1/step))) * step : Math.round(number.value*100)/100; // % works on decimals right.\r\n    return <>\r\n        <input className={\"value\"} placeholder={\"value\"} type={\"range\"} disabled={readOnly}\r\n            key={\"s\"+number.value} defaultValue={number.value}\r\n            min={min}\r\n            max={max}\r\n            step={\"any\"}\r\n            onBlur={e => {setNumber(e as any, prefix)}}\r\n            onMouseUp={e => { setNumber(e as any, prefix); }} />\r\n        <input className={\"spinner\"} placeholder={\"value\"} type={\"number\"} disabled={readOnly}\r\n            key={roundedValue} defaultValue={roundedValue} data-dv={roundedValue} data-dv2={number.value}\r\n            step={step}\r\n            onBlur={e => {setNumber(e as any, prefix)}}\r\n            onKeyDown={e => {\r\n               if (e.key === Keystrokes.enter) setNumber(e as any, prefix);\r\n               if (e.key === Keystrokes.escape) (e.target as any).value = '' + number.value; }} />\r\n    </>\r\n}\r\n\r\n\r\n\r\n// delete button <button className=\"btn btn-danger ms-1\"><i className=\"p-1 bi bi-trash3-fill\"/></button>\r\nfunction PaletteDataComponent(props: AllProps) {\r\n    const view = props.view;\r\n    const readOnly = props.readonly;\r\n    let palette: Readonly<PaletteType> = {...view.palette};\r\n    let tmp: PaletteType = undefined as any;\r\n    const [css, setCss] = useStateIfMounted(view.css);\r\n\r\n    const [expand, setExpand] = useStateIfMounted(false);\r\n\r\n    const change = (value: string|undefined) => { if(value !== undefined) setCss(value); } // save in local state for frequent changes.\r\n    const blur = () => view.css = css; // confirm in redux state for final state\r\n\r\n    /* *** alfonso *** */\r\n\r\n\r\n    function useClickOutside(ref: any, onClickOutside: any) {\r\n        useEffect(() => {\r\n            function handleClickOutside(event: Event) {\r\n                if (ref.current && !ref.current.contains(event.target)) {\r\n                    onClickOutside();\r\n                }\r\n            }\r\n\r\n          // Bind\r\n\r\n          // @ts-ignore\r\n            document.addEventListener(\"mousedown\", handleClickOutside);\r\n          return () => {\r\n            // dispose\r\n            // @ts-ignore\r\n            document.removeEventListener(\"mousedown\", handleClickOutside);\r\n          };\r\n        }, [ref, onClickOutside]);\r\n    }\r\n\r\n    const AddPalette = () => {\r\n        const [open,setOpen] = useState(false);\r\n        const menuRef = useRef(null);\r\n\r\n        useClickOutside(menuRef, () => {\r\n            setOpen(false);\r\n        });\r\n\r\n\r\n        return (<>\r\n            {/* {open ?\r\n                <div className='palette-buttons'>\r\n                    <button onClick={()=>addControl('palette')} className='btn btn-success my-btn btn-color'>Add palette</button>\r\n                    <button onClick={()=> addControl('number')} className='btn btn-success my-btn btn-number'>Add number</button>\r\n                    <button onClick={()=>addControl('text')} className='btn btn-success my-btn btn-textual'>Add text</button>\r\n                    <button onClick={()=>addControl('path')}className='btn btn-success my-btn btn-path'>Add path</button>\r\n                </div>\r\n            :\r\n                <button onClick={() => setOpen(!open)} className='btn btn-success my-btn'>Add new</button>\r\n            }*/}\r\n\r\n            {!open ?\r\n                <div className={'add-palette-item'} onClick={() => {setOpen(true)}}>\r\n                    <i style={{color: 'white'}} className=\"bi bi-plus\"></i>\r\n                    <span>Add new</span>\r\n                </div>\r\n                :\r\n                <>\r\n                    <div className={'add-palette-item active'} onClick={() => {setOpen(false)}}>\r\n                        <i style={{color: 'white'}} className=\"bi bi-plus\"></i>\r\n                    </div>\r\n                    <button onClick={()=>addControl('palette')} className='btn btn-success my-btn btn-color'>Palette</button>\r\n                    <button onClick={()=> addControl('number')} className='btn btn-success my-btn btn-number'>Number</button>\r\n                    <button onClick={()=>addControl('text')} className='btn btn-success my-btn btn-textual'>Text</button>\r\n                    <button onClick={()=>addControl('path')}className='btn btn-success my-btn btn-path'>Path</button>\r\n\r\n                </>\r\n            }\r\n\r\n        </>);\r\n    };\r\n\r\n    /* *** */\r\n\r\n\r\n\r\n\r\n\r\n\r\n    const addControl = (type: 'palette' | 'number' | 'text' | 'path') => {\r\n        if (readOnly) return;\r\n        let i: number;\r\n        let prefix0: string;//= 'palette_' + i + '-';\r\n        switch (type){\r\n            default: Log.exDevv(\"unexpected case in addControl:\" + type); return;\r\n            case 'path':\r\n                i = Object.values(palette).filter( o => (o as PathControl).type === \"path\").length + 1;\r\n                prefix0 = 'path_';\r\n                break;\r\n            case 'text':\r\n                i = Object.values(palette).filter( o => (o as StringControl).type === \"text\").length + 1;\r\n                prefix0 = 'text_';\r\n                break;\r\n            case 'number':\r\n                i = Object.values(palette).filter( o => (o as NumberControl).type === \"number\").length + 1;\r\n                prefix0 = 'numeric_';\r\n                break;\r\n            case 'palette':\r\n                i = Object.values(palette).filter( o => Array.isArray(o as any)).length + 1;\r\n                prefix0 = 'palette_';\r\n                break;\r\n        }\r\n        let prefix: string;\r\n        while (true){\r\n            prefix = prefix0 + i++;\r\n            if (prefix in palette) continue;\r\n            break;\r\n        }\r\n        switch (type){\r\n            default: Log.exDevv(\"unexpected case in addControl:\" + type); return;\r\n            case 'path':\r\n                const agglabel = \"◇ Aggregation / Composition\";\r\n                const extendlabel = \"△ \"+EdgeHead.extend;\r\n                const asslabel = \"Λ \"+EdgeHead.reference;\r\n                let headdict: Dictionary<string, string> = {\r\n                    [asslabel]: 'M 0 0   L x y/2   L 0 y',\r\n                    [extendlabel]: 'M 0 0   L x y/2   L 0 y   Z',\r\n                    [agglabel]: 'M 0 y/2   L x/2 0   L x y/2   L x/2 y   Z',\r\n                };\r\n                let predefinedPaths: {k:string, v:string}[] = Object.entries(headdict).map((e)=>({k:e[0], v:e[1]}));\r\n\r\n                tmp = {...palette};\r\n                tmp[prefix] = {type: 'path', value: '', x:'edgeHeadSize.x', y:'edgeHeadSize.y', options: predefinedPaths};\r\n                break;\r\n            case 'text':\r\n                tmp = {...palette};\r\n                tmp[prefix] = {type: 'text', value: ''};\r\n                break;\r\n            case 'number':\r\n                tmp = {...palette};\r\n                tmp[prefix] = {type: 'number', value: 0, unit: 'px'};\r\n                break;\r\n            case 'palette':\r\n                tmp = {...palette};\r\n                tmp[prefix] = {type:'color', value:[]};\r\n                break;\r\n        }\r\n        view.palette = palette = tmp;\r\n    }\r\n\r\n\r\n\r\n\r\n    const setGeneric = (e: any, prefix: string, key: string) => {\r\n        const val: string = e.target.value;\r\n        if (readOnly || (palette[prefix] as any)[key] === val) return;\r\n        let tmp: Dictionary<string, StringControl> = {...palette} as any;\r\n        (tmp[prefix] as any)[key] = val;\r\n        view.palette = palette = tmp; }\r\n    const setText = (e: any, prefix: string) => {\r\n        const val: string = e.target.value;\r\n        if (readOnly || (palette[prefix] as StringControl).value === val) return;\r\n        let tmp: Dictionary<string, StringControl> = {...palette} as any;\r\n        tmp[prefix].value = val;\r\n        view.palette = palette = tmp; }\r\n    const setNumber = (e: any, prefix: string) => {\r\n        const val: number = +e.target.value || 0;\r\n        if (readOnly || (palette[prefix] as NumberControl).value === val) return;\r\n        let tmp: Dictionary<string, NumberControl> = {...palette} as any;\r\n        tmp[prefix].value = val;\r\n        view.palette = palette = tmp; }\r\n    const setUnit = (e: any, prefix: string) => {\r\n        const val: string = e.target.value === undefined ? 'px' : e.target.value;\r\n        if (readOnly || val === (palette[prefix] as NumberControl).unit) return;\r\n        let tmp: Dictionary<string, NumberControl> = {...palette} as any;\r\n        tmp[prefix].unit = val;\r\n        view.palette = palette = tmp; }\r\n    const changePrefix = (oldPrefix: string, newPrefix: string) => {\r\n        // @ts-ignore\r\n        newPrefix = newPrefix.replaceAll(/[^\\w\\-]/g,'-'); // /^[^a-zA-Z0-9_\\-]*$/, '-');\r\n        if (readOnly || palette[newPrefix]) return; // refuse to overwrite existing palette name (2 different palettes with same name)\r\n        tmp = {...palette};\r\n        tmp[newPrefix] = palette[oldPrefix];\r\n        delete tmp[oldPrefix];\r\n        view.palette = palette = tmp;\r\n    }\r\n    const removeControl = (prefix: string) => {\r\n        if (readOnly || !palette[prefix]) return;\r\n        tmp = {...palette};\r\n        delete tmp[prefix];\r\n        view.palette = palette = tmp;\r\n    }\r\n\r\n    const addColor = (prefix: string, colors: Instance[] | Instance, index: number = -1, skipFirst: boolean = true) => {\r\n        if (readOnly) return;\r\n        if (!Array.isArray(colors)) {\r\n            colors = [colors as Instance];\r\n            skipFirst = false;\r\n        }\r\n        let tmp: Dictionary<string, PaletteControl> = {...palette} as GObject;\r\n        let lastAdded: tinycolor.ColorFormats.RGBA = undefined as any;\r\n        for (let i = colors.length-1; i >= (skipFirst ? 1 : 0); i--) {\r\n            let color: Instance = colors[i];\r\n            let rgba = color.toRgb();\r\n            console.log(\"addingColor:\", {rgba, lastAdded, color});\r\n            if (rgba === lastAdded) continue;\r\n            lastAdded = rgba;\r\n            if (!tmp[prefix]) tmp[prefix] = {type:'color', value:[]};\r\n            else tmp[prefix] = {...tmp[prefix]};\r\n            tmp[prefix].value = [...tmp[prefix].value];\r\n            if (index >= 0) tmp[prefix].value.splice(index + 1, 0, rgba);\r\n            else tmp[prefix].value.push(rgba);\r\n        }\r\n        view.palette = palette = tmp;\r\n    }\r\n\r\n    const setColor = (prefix: string, index: number, hex?: string, alpha?: number) => {\r\n        let tmp: Dictionary<string, PaletteControl> = {...palette} as any;\r\n        if (readOnly || !tmp[prefix]) tmp[prefix] = {type:'color', value:[]};\r\n        else tmp[prefix] = {...tmp[prefix]};\r\n        let oldColor = tmp[prefix].value[index];\r\n        if (hex) {\r\n            let color = tinycolor(hex);\r\n            if (alpha !== undefined) color.setAlpha(alpha);\r\n            let rgba = color.toRgb();\r\n            if (oldColor && oldColor.a !== undefined) rgba.a = oldColor.a;\r\n            tmp[prefix].value[index] = oldColor = rgba;\r\n            view.palette = palette = tmp;\r\n        }\r\n        if (alpha !== undefined) tmp[prefix].value[index] = {...oldColor, a:alpha};\r\n    }\r\n    const transparencyColor = (prefix: string, index: number, color: tinycolor.Instance, alpha: number) => {\r\n        if (readOnly || !palette[prefix]) return;\r\n        let tmp: Dictionary<string, PaletteControl> = {...palette} as any;\r\n        if (!alpha && alpha !== 0) alpha = 1;\r\n        tmp[prefix] = {...tmp[prefix]};\r\n        tmp[prefix].value = [...tmp[prefix].value];\r\n        tmp[prefix].value[index] = {...tmp[prefix].value[index]};\r\n        tmp[prefix].value[index].a = alpha;\r\n        color.setAlpha(alpha);\r\n        console.log(\"set transparency\", {color, tinycolor, oldcolor: tmp[prefix].value[index]});\r\n        view.palette = palette = tmp;\r\n    }\r\n    const removeColor = (prefix: string, index: number) => {\r\n        if (readOnly || !palette[prefix]) return;\r\n\r\n        let tmp: Dictionary<string, PaletteControl> = {...palette} as any;\r\n        tmp[prefix].value = [...tmp[prefix].value];\r\n        tmp[prefix].value = tmp[prefix].value.filter((c, i) => i !== index);\r\n        view.palette = palette = tmp;\r\n    }\r\n\r\n    const cssIsGlobal = view.cssIsGlobal;\r\n    let a: DropDownButton;\r\n    let dropDownButton: RefObject<DropDownButton> = {current: null};\r\n    function addcss(color: Instance): GObject {\r\n        let ret: GObject = {};\r\n        ret.background = color.toRgbString();\r\n        // ret.opacity = color.getAlpha();\r\n        return ret;\r\n    }\r\n    function invert(color: Instance, transformGrays: number = 0.2): string {\r\n        transformGrays = transformGrays * 128;\r\n        let {r, g, b, a} = color.toRgb();\r\n        r = Math.abs(r-128) <= transformGrays ? (r >= 128 ? 0 : 255) : 255 - r;\r\n        g = Math.abs(g-128) <= transformGrays ? (g >= 128 ? 0 : 255) : 255 - g;\r\n        b = Math.abs(b-128) <= transformGrays ? (b >= 128 ? 0 : 255) : 255 - b;\r\n        if (a || a === 0) a = 255 - a;\r\n        return (tinycolor({r, g, b, a})).toRgbString();\r\n    }\r\n    function style(c: Instance): GObject{\r\n        return {backgroundColor: c.toRgbString(), color:invert(c)};\r\n    }\r\n\r\n    let palettes = U.paletteSplit(palette);\r\n    function palettewrap(prefix: string, node: ReactNode): ReactNode{\r\n        return (\r\n            <div className=\"palette-row-container\">\r\n                {/* <button className=\"btn btn-danger me-1\" onClick={()=>removeControl(prefix)} disabled={readOnly}><i className=\"p-1 bi bi-trash3-fill\"/></button>*/}\r\n\r\n                <input className={\"prefix\"}\r\n                    style={{maxHeight: 'var(--input-height)', borderRadius: 'var(--radius)'}}\r\n                    placeholder={\"variable name\"}\r\n                    defaultValue={prefix}\r\n                    onBlur={(e: any)=> changePrefix(prefix, e.target.value)}\r\n                    disabled={readOnly} />\r\n                {node}\r\n            </div>)\r\n    }\r\n    const vcss = view.css;\r\n\r\n    let colors = Object.keys(palettes.color).sort();\r\n    const lines = (Math.round(vcss.split(/\\r|\\r\\n|\\n/).length*1.8) < 5 ? 10 : Math.round(vcss.split(/\\r|\\r\\n|\\n/).length*1.8));\r\n\r\n    return(<section className={'p-3 style-tab'}>\r\n        <h1 className={'view'}>View: {props.view.name}</h1>\r\n        <div className={\"controls\"} style={{position:'relative', zIndex:2}}>\r\n\r\n            {colors.map((entry, index, entries)=>{\r\n                let prefix = entry;\r\n                let paletteobj: PaletteControl = palettes.color[prefix] as PaletteControl;\r\n                let colors: Instance[] = paletteobj.value.map(v=> tinycolor(v));\r\n                let suggestions = [tinycolor('#ffaaaa')]; // todo: compute according to current row \"colors\"\r\n                return palettewrap(prefix, <>\r\n                    <div className=\"palette-row\">\r\n\r\n                        <div className=\"color-container\" style={{maxHeight: 'var(--input-height)', borderRadius: 'var(--radius)'}}>{\r\n                            colors.map((color, i) => <Color key={prefix+i} readonly={readOnly}\r\n                                                            data={view} field={'palette'} canDelete={!readOnly}\r\n                                                            getter={()=>colors[i].toHexString()} setter={(newVal) => { setColor(prefix, i, newVal) }}\r\n                                                            style ={{background: 'white'}}\r\n                                                            inputStyle ={{opacity: color.getAlpha()}}\r\n                                                            childrenn={\r\n                                                                <div className={\"content suggestions\"} tabIndex={-1} style={{backgroundColor: \"inherit\"}} onClick={(e) => {e.preventDefault(); e.stopPropagation();}}>\r\n                                                                    {(()=>{ return <>\r\n                                                                        <h6 title={\"Alter current color transparency\"}>Opacity</h6>\r\n\r\n                                                                        <input style={{width: \"auto\", marginLeft:\"1em\", marginRight:\"1em\"}}\r\n                                                                            type={\"range\"} min={0} max={1} step={\"any\"}\r\n                                                                            value={color.getAlpha()}\r\n                                                                            onChange={(e: any)=>{ transparencyColor(prefix, i, color, +e.target.value) }} />\r\n\r\n                                                                        {/* Add all colors */}\r\n                                                                        <h6 title={\"Add all the colors\"}>\r\n                                                                            <CommandBar style={{float: 'left', paddingRight: '8px'}}>\r\n                                                                                <Btn icon={'add'} size={'x-small'}  action={()=>addColor(prefix, color.analogous(7, 30/1.5), i)} theme={'dark'} tip={'Add all the colors'}/>\r\n                                                                            </CommandBar>\r\n                                                                            <span>Analogous</span>\r\n                                                                        </h6>\r\n\r\n                                                                        <div className={\"roww\"}>\r\n                                                                            {color.analogous(7, 30/1.5).map((c,ii) => ii===0?undefined:\r\n                                                                                <button style={style(c)}\r\n                                                                                    onClick={(e)=>{addColor(prefix, c, i)}}\r\n                                                                                    className=\"btn color-suggestion\">\r\n                                                                                        <i style={style(c)} className=\"bi bi-plus-lg\"></i>\r\n                                                                                </button>\r\n                                                                            )}\r\n                                                                        </div>{/*\r\n                                    <h6 onClick={()=>addColor(prefix, color.monochromatic(7), i)} title={\"Add all the colors\"}>Monochromatic</h6>\r\n                                    <div className={\"roww\"}>\r\n                                        {color.monochromatic(7).map((c,ii) => ii===0?undefined: <button style={style(c)}\r\n                                                                                                        onClick={(e)=>{addColor(prefix, c, i)}} className=\"btn color-suggestion\">+</button>)}\r\n                                    </div>{/*[6/12, 5/12, 4/12, 3/12, 2/12, 1/12]*/}\r\n\r\n                                                                        {/* Add all colors */}\r\n                                                                        <h6 title={\"Add all the colors\"}>\r\n                                                                            <CommandBar style={{\r\n                                                                                float: 'left',\r\n                                                                                paddingRight: '8px'\r\n                                                                            }}>\r\n                                                                                <Btn icon={'add'} size={'x-small'}\r\n                                                                                     tip={'Add all the colors'}\r\n                                                                                     theme={'dark'}\r\n                                                                                     action={() => addColor(prefix, [1 / 12, 2 / 12, 3 / 12, 4 / 12, 5 / 12, 6 / 12].map(n => color.clone().lighten(n * 100)), i, false)}/>\r\n                                                                            </CommandBar>\r\n                                                                            <span>Lighten</span>\r\n\r\n                                                                        </h6>\r\n\r\n                                                                        <div className={\"roww\"}>\r\n                                                                            {[1/12, 2/12, 3/12, 4/12, 5/12, 6/12].map(n=>color.clone().lighten(n*100))\r\n                                                                                .map((c,ii) => <button style={style(c)} className=\"btn color-suggestion\"\r\n                                                                                                       onClick={(e)=>{addColor(prefix, c, i)}}><i style={style(c)} className=\"bi bi-plus-lg\"></i></button>)}\r\n                                                                        </div>\r\n\r\n                                                                        {/* Add all colors */}\r\n                                                                        <h6 title={\"Add all the colors\"}>\r\n                                                                            <CommandBar style={{\r\n                                                                                float: 'left',\r\n                                                                                paddingRight: '8px'\r\n                                                                            }}>\r\n                                                                                <Btn icon={'add'} theme={'dark'}\r\n                                                                                     tip={'Add all the colors'}\r\n                                                                                     size={'x-small'}\r\n                                                                                     action={() => addColor(prefix, [6 / 12, 5 / 12, 4 / 12, 3 / 12, 2 / 12, 1 / 12].map(n => color.clone().darken(n * 100)), i, false)}/>\r\n                                                                            </CommandBar>\r\n                                                                            <span>Darken</span>\r\n                                                                        </h6>\r\n\r\n                                                                        <div className={\"roww\"}>\r\n                                                                            {[6/12, 5/12, 4/12, 3/12, 2/12, 1/12].map(n=>color.clone().darken(n*100))\r\n                                                                                .map((c,ii) => <button style={style(c)} className=\"btn color-suggestion\"\r\n                                                                                                       onClick={(e)=>{addColor(prefix, c, i)}}><i style={style(c)} className=\"bi bi-plus-lg\"></i></button>)}\r\n                                                                        </div>\r\n\r\n                                                                        {/* Add all colors */}\r\n                                                                        <h6 title={\"Add all the colors\"}>\r\n                                                                            <CommandBar style={{\r\n                                                                                float: 'left',\r\n                                                                                paddingRight: '8px'\r\n                                                                            }}>\r\n                                                                                <Btn icon={'add'}\r\n                                                                                     tip={'Add all the colors'}\r\n                                                                                     theme={'dark'} size={'x-small'}\r\n                                                                                     action={() => addColor(prefix, [color.complement(), tinycolor(invert(color))], i, false)}/>\r\n                                                                            </CommandBar>\r\n                                                                            <span>Complementary / Opposite</span>\r\n                                                                        </h6>\r\n\r\n                                                                        <div className={\"roww\"}>\r\n                                                                            <button style={style(color.complement())} className=\"btn color-suggestion\"\r\n                                                                                    onClick={(e)=>{addColor(prefix, color.complement(), i)}}><i style={style(color.complement())} className=\"bi bi-plus-lg\"></i></button>\r\n                                                                            <button style={style(color)} className=\"btn color-suggestion\"\r\n                                                                                    onClick={(e)=>{addColor(prefix, tinycolor(invert(color)), i)}}><i style={style(color)} className=\"bi bi-plus-lg\"></i></button>\r\n                                                                        </div>\r\n\r\n                                                                        {/* Add all colors */}\r\n                                                                        <h6 title={\"Add all the colors\"}>\r\n                                                                            <CommandBar style={{\r\n                                                                                float: 'left',\r\n                                                                                paddingRight: '8px'\r\n                                                                            }}>\r\n                                                                                <Btn icon={'add'}\r\n                                                                                     tip={'Add all the colors'}\r\n                                                                                     theme={'dark'} size={'x-small'}\r\n                                                                                     action={() => addColor(prefix, color.splitcomplement(), i)}/>\r\n                                                                            </CommandBar>\r\n                                                                            <span>Split Complementary</span>\r\n                                                                        </h6>\r\n\r\n                                                                        <div className={\"roww\"}>\r\n                                                                            {color.splitcomplement().map((c) => <button style={{...style(c)}} className=\"btn color-suggestion\"\r\n                                                                                                                        onClick={(e)=>{addColor(prefix, c, i)}}><i style={style(c)} className=\"bi bi-plus-lg\"></i></button>)}\r\n                                                                        </div>\r\n\r\n                                                                        <h6 title={\"Add all the colors\"}>\r\n                                                                            <CommandBar style={{\r\n                                                                                float: 'left',\r\n                                                                                paddingRight: '8px'\r\n                                                                            }}>\r\n                                                                                <Btn icon={'add'}\r\n                                                                                     tip={'Add all the colors'}\r\n                                                                                     theme={'dark'} size={'x-small'}\r\n                                                                                     action={() => addColor(prefix, color.triad(), i)}/>\r\n                                                                            </CommandBar>\r\n                                                                            <span>Triadic</span>\r\n                                                                        </h6>\r\n\r\n                                                                        <div className={\"roww\"}>\r\n                                                                            {color.triad().map ( (c) => <button style={{...style(c)}} className=\"btn color-suggestion\"\r\n                                                                                                                onClick={(e)=>{addColor(prefix, c, i)}}><i style={style(c)} className=\"bi bi-plus-lg\"></i></button>)}\r\n                                                                        </div>\r\n\r\n                                                                        {/* Add all colors */}\r\n                                                                        <h6 title={\"Add all the colors\"}>\r\n                                                                            <CommandBar style={{\r\n                                                                                float: 'left',\r\n                                                                                paddingRight: '8px'\r\n                                                                            }}>\r\n                                                                                <Btn icon={'add'}\r\n                                                                                     tip={'Add all the colors'}\r\n                                                                                     theme={'dark'} size={'x-small'}\r\n                                                                                     action={() => addColor(prefix, color.tetrad(), i)}/>\r\n                                                                            </CommandBar>\r\n                                                                            <span>Tetradic</span>\r\n                                                                        </h6>\r\n                                                                        <div className={\"roww\"}>\r\n                                                                            {color.tetrad().map ( (c) => <button style={{...style(c)}} className=\"btn color-suggestion\"\r\n                                                                                                                 onClick={(e)=>{addColor(prefix, c, i)}}><i style={style(c)} className=\"bi bi-plus-lg\"></i></button>)}\r\n                                                                        </div>\r\n                                                                    </>})()}\r\n\r\n\r\n                                                                    <button\r\n                                                                        className={'btn btn-danger content delete-color mt-2 jj-delete'}\r\n                                                                        onClick={()=>removeColor(prefix, i)}\r\n                                                                        disabled={readOnly}\r\n                                                                    >\r\n                                                                        <i className=\"bi p-1 bi-trash-fill\"/> Delete\r\n                                                                    </button>\r\n                                                                </div>\r\n                                                            }\r\n                            />)\r\n                        }\r\n                        </div>\r\n                        <div className=\"suggestion-container\">{\r\n                            suggestions.map((c, i) => <label className=\"p-1\">\r\n\r\n                                {/* Palette */}\r\n                                <CommandBar style={{float: 'right'}}>\r\n                                    <Btn icon={'add'} tip={'Add color to palette'} action={() => addColor(prefix, c)} />\r\n                                    <Btn icon={'delete'} tip={'Remove color from palette'} action={() => {\r\n                                        if (Array.isArray(palette[prefix].value) && (palette[prefix].value as any).length) {\r\n                                            removeColor(prefix, i)\r\n                                        } else {\r\n                                            removeControl(prefix);\r\n                                        }\r\n                                    }}\r\n                                    />\r\n                                </CommandBar>\r\n\r\n                                {/* <button className=\"btn color-suggestion\" style={style(c)} onClick={()=>{addColor(prefix, c)}} disabled={readOnly}>+</button>*/}\r\n                            </label>)\r\n                        }</div>\r\n                    </div>\r\n                </>); })\r\n            }\r\n            {Object.entries(palettes.path).map((entry, index, entries)=>{\r\n                    let prefix = entry[0];\r\n                    let path: PathControl = entry[1] as any;\r\n                    return palettewrap(prefix,\r\n                        <div className=\"palette-row path\" title={\"todo: proper tooltip.\\nedgeHeadSize is in the \\\"Options\\\" tab and determines the position of the head.\\nBasic math operators are allowed, but the minus and plus must have spaces around them or they will be traated as unary operators.\\nx and y are variables local to this path used to scale his shape.\"}>\r\n                            <div className={\"value hoverable\"} >\r\n                                <div className={\"d-flex w-100\"}>\r\n                                    <input className={\"value w-100 my-auto\"} placeholder={\"svg path [d]\"} defaultValue={path.value} key={path.value} onBlur={e => {setText(e as any, prefix)}} disabled={readOnly}\r\n                                           onKeyDown={e => {\r\n                                               if (e.key === Keystrokes.enter) setText(e as any, prefix);\r\n                                               if (e.key === Keystrokes.escape) (e.target as any).value = path.value; }}\r\n                                    />\r\n                                </div>\r\n                                <div className={\"content d-flex w-100\"} style={{position: 'relative', backgroundColor: 'whitesmoke'}}>\r\n                                    <input className={\"spacer w-100\"}/>\r\n                                    <label className={\"mx-auto\"}>x:&nbsp;<input className=\"x\" placeholder={\"x\"} defaultValue={path.x} disabled={readOnly} onChange={(e)=>setGeneric(e, prefix, \"x\")}/></label>\r\n                                    <label className={\"mx-auto\"}>y:&nbsp;<input className=\"y\" placeholder={\"y\"} defaultValue={path.y} disabled={readOnly} onChange={(e)=>setGeneric(e, prefix, \"y\")}/></label>\r\n                                </div>\r\n                            </div>\r\n                            <select className={'d-flex'} style={{width: '100px!important'}} value={path.value} disabled={readOnly} onChange={(e)=>setText(e as any, prefix)}>\r\n                                {[<option style={{fontStyle:'italic', color:'gray'}} value={\"\"}>Custom</option>, path.options.map((e)=>{\r\n                                let k = e.k;\r\n                                let v = e.v;\r\n                                return <option value={v}>{k}</option>\r\n                            })]}</select>\r\n\r\n                            {/* Path */}\r\n                            <CommandBar  style={{paddingRight: '4px', marginLeft: 'auto'}}>\r\n                                <Btn icon={'space'} />\r\n                                <Btn icon={\"delete\"} action={(e) => {removeControl(prefix)}} tip={'Remove path'}/>\r\n                            </CommandBar>\r\n\r\n                        </div>)\r\n                }\r\n            )}\r\n            {Object.entries(palettes.number).map((entry, index, entries)=>{\r\n                    let prefix = entry[0];\r\n                    let number: NumberControl = entry[1] as any;\r\n                    return palettewrap(prefix,\r\n                        <div className=\"palette-row numeric\">\r\n                            {makeNumericInput(prefix, number, setNumber, setText, readOnly)}\r\n                            <input className={\"unit\"} placeholder={\"unit\"} value={number.unit} pattern={CSS_Units.pattern} disabled={readOnly}\r\n                                   list={\"__jodel_CSS_units\"} onChange={e => {setUnit(e as any, prefix)}} />\r\n\r\n                            {/* Numeric */}\r\n                            <CommandBar  style={{paddingRight: '4px', marginLeft: 'auto'}}>\r\n                                <Btn icon={'space'} />\r\n                                <Btn icon={\"delete\"} action={(e) => {removeControl(prefix)}} tip={'Remove number'}/>\r\n                            </CommandBar>\r\n                        </div>)\r\n                }\r\n            )}\r\n            {Object.entries(palettes.text).map((entry, index, entries)=>{\r\n                    let prefix = entry[0];\r\n                    let string: StringControl = entry[1] as any;\r\n                    return palettewrap(prefix,\r\n                        <div className={\"palette-row textual\"}>\r\n                            <input className={\"value\"} placeholder={\"value\"} defaultValue={string.value} onBlur={e => {setText(e as any, prefix)}} disabled={readOnly}\r\n                                   onKeyDown={e => {\r\n                                       if (e.key === Keystrokes.enter) setText(e as any, prefix);\r\n                                       if (e.key === Keystrokes.escape) (e.target as any).value = string.value; }} />\r\n\r\n                            {/* Text */}\r\n                            <CommandBar  style={{paddingRight: '4px', marginLeft: 'auto'}}>\r\n                                <Btn icon={'space'} />\r\n                                <Btn icon={\"delete\"} action={(e) => {removeControl(prefix)}} tip={'Remove text'}/>\r\n                            </CommandBar>\r\n                        </div>)\r\n                }\r\n            )}\r\n        </div>\r\n\r\n\r\n        <AddPalette />\r\n\r\n\r\n        {/* <div className={\"w-100\"} style={{display: 'grid', gridTemplateColumns: 'repeat(10, 1fr)', position: 'relative', zIndex:1}}\r\n             onMouseEnter={(e)=>{ dropDownButton.current?.open()}}\r\n             onMouseLeave={(e)=>{ dropDownButton.current?.close()}}\r\n        >\r\n            <button className=\"btn btn-success\" style={{flexBasis:0, flexGrow:9, gridArea: '1 / 1 / 1 / 1', zIndex: 2, minWidth: 'calc(1000% - var(--smart-editor-addon-width))'}} onClick={()=>addControl('palette')}>+ Palette</button>\r\n            <DropDownButton ref={dropDownButton} style={{flexBasis:0, flexGrow:1, minWidth:0, gridArea: '1 / 1 / 1 / 11', zIndex:1, transform: 'scaleX(-1)'}}>\r\n                <div onClick={(e)=> dropDownButton.current?.close()} style={{transform: 'scaleX(-1)'}}>\r\n                    <button className={\"w-100 btn btn-outline-success\"} style={{height: 'var(--smart-editor-height)'}}\r\n                            onClick={()=>addControl('number')}>+ Number</button>\r\n                    <button className={\"w-100 btn btn-outline-success\"} style={{height: 'var(--smart-editor-height)'}}\r\n                            onClick={()=>addControl('text')}>+ Text</button>\r\n                    <button className={\"w-100 btn btn-outline-success\"} style={{height: 'var(--smart-editor-height)'}}\r\n                            onClick={()=>addControl('path')}>+ Path</button>\r\n                </div>\r\n            </DropDownButton>\r\n            </div>*/}\r\n\r\n        <HRule theme={'light'} style={{display: 'block', padding: '30px 0px!important'}}/>\r\n\r\n        <Input data={view} field={'cssIsGlobal'} type={\"checkbox\"}  jsxLabel={\r\n            <div style={{width:'100%', display:'block', float: 'left'}}>\r\n                {cssIsGlobal ? <b style={{color: 'inherit'}}>Global</b> : <b style={{color: 'inherit'}}>Local</b>}\r\n                {' CSS & LESS Editor '}\r\n                {cssIsGlobal ? '(Use with caution)' : ''}\r\n            </div>\r\n        } />\r\n\r\n        {/* <CommandBar style={{paddingTop: '10px', float: 'right'}}>\r\n            {expand ?\r\n                <Btn icon={'shrink'} action={(e) => {setExpand(false)}} tip={'Minimize editor'}/>\r\n                :\r\n                <Btn icon={'expand'} action={(e) => {setExpand(true)}} tip={'Enlarge editor'}/>\r\n            }\r\n        </CommandBar>*/}\r\n\r\n        {/* ****** */}\r\n\r\n        {/*<label className={'ms-1 mb-1'}>{view.cssIsGlobal ? 'Global' : 'Local'} CSS Editor</label>*/}\r\n        {vcss.indexOf('//') >= 0 && <b><span style={{color:'red'}}>Warning:</span> Inline comments // are not supported by our compiler.<br/>\r\n            Please replace them with /* block comments */</b>}\r\n\r\n            <div className={\"monaco-editor-wrapper\"} style={{\r\n                minHeight: '20px',\r\n                height:`${expand ? '30lvh' : '10lvh'}`,\r\n                transition: 'height 0.3s',\r\n                resize: 'vertical', overflow:'hidden',\r\n                display: 'flex',\r\n                flexDirection: 'column'\r\n            }}\r\n            onFocus={() => setExpand(true)}\r\n            onBlur={() => {setExpand(false);blur()}}>\r\n            <Editor className={'mx-1'}\r\n                    options={{fontSize: 12, scrollbar: {vertical: 'hidden', horizontalScrollbarSize: 5}, minimap: {enabled: false}, readOnly: readOnly}}\r\n                    defaultLanguage={'less'} value={vcss} onChange={change}/>\r\n        </div>\r\n        {false && <div className={\"debug\"}><div style={{whiteSpace:'pre'}}>{view.compiled_css}</div></div>}\r\n        {/*<textarea>\r\n            '[data-viewid=\"'+view.id+'\"]{\\n' +\r\n            Object.entries(palette).flatMap((entry, index, entries)=>{\r\n                let prefix = entry[0];\r\n                let colors = entry[1];\r\n                return colors.map((color, i)=> \"\\t--\" + prefix + i + \": \" + color + \";\\n\");\r\n            }).join('')+'\\n' + (cssISGlobal ? '}\\n' : '\\n') +\r\n            '/ *** custom css area *** /\\n' + view.css + (!cssISGlobal ? '}\\n' : '\\n')\r\n            view.css\r\n        </textarea>*/}\r\n        {\r\n            // todo: if row have only 1 color can be accessed both as palette prefix-1 or as palett prefix without number, so i can name colors.\r\n        }\r\n\r\n    </section>);\r\n}\r\n\r\ninterface OwnProps {viewID: Pointer<DViewElement, 1, 1, LViewElement>, readonly: boolean}\r\ninterface StateProps {view: LViewElement}\r\ninterface DispatchProps { }\r\ntype AllProps = OwnProps & StateProps & DispatchProps;\r\n\r\n\r\nfunction mapStateToProps(state: DState, ownProps: OwnProps): StateProps {\r\n    const view = LViewElement.fromPointer(ownProps.viewID);\r\n    return {view};\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch<any>): DispatchProps {\r\n    const ret: DispatchProps = {};\r\n    return ret;\r\n}\r\n\r\n\r\nexport const PaletteDataConnected = connect<StateProps, DispatchProps, OwnProps, DState>(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(PaletteDataComponent);\r\n\r\nexport const PaletteData = (props: OwnProps, children: (string | React.Component)[] = []): ReactElement => {\r\n    return <PaletteDataConnected {...{...props, children}} />;\r\n}\r\nexport default PaletteData;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}