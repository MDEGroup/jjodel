{"ast":null,"code":"import{Defaults,U}from'../../joiner';import{LPointerTargetable}from'../../joiner';import React from'react';import{connect}from'react-redux';import{useStateIfMounted}from'use-state-if-mounted';import'./inputselect.scss';import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";function SelectorComponent(props){const data=props.data;const[showTooltip,setShowTooltip]=useStateIfMounted(false);if(!data)return/*#__PURE__*/_jsx(_Fragment,{});let d=data.__raw||data;let l=LPointerTargetable.fromD(data);let gdata=data;const field=props.field;const readOnly=props.readonly!==undefined?props.readonly:!props.debugmode&&Defaults.check(data.id);const value=d[field];const label=props.label;const jsxLabel=props.jsxLabel;let tooltip=props.tooltip===true?gdata['__info_of__'+field]?gdata['__info_of__'+field].txt:'':props.tooltip;tooltip=tooltip||'';let css='';//'my-auto select ';\n// css += (jsxLabel) ? 'ms-1' : 'ms-auto';\ncss+=props.hidden?' hidden-input':'';/* @ts-ignore */const setter=id=>{l[field].value=id;};/* @ts-ignore */const getter=()=>l[field].value;//l.$type.__raw.values[0];\nfunction SelectorChange(evt){if(readOnly)return;const newValue=evt.target.value;const oldValue=getter();setter(newValue);}// \nfunction getOptions(){return/*#__PURE__*/_jsx(_Fragment,{children:l[field].type.allInstances.map(cl=>/*#__PURE__*/_jsx(_Fragment,{children:typeof l[field].value==='undefined'?/*#__PURE__*/_jsx(\"option\",{value:cl.id,children:cl.name}):/*#__PURE__*/_jsx(_Fragment,{children:l[field].value.id===cl.id?/*#__PURE__*/_jsx(\"option\",{value:cl.id,selected:true,children:cl.name}):/*#__PURE__*/_jsx(\"option\",{value:cl.id,children:cl.name})})}))});}const otherprops={...props};delete otherprops.data;delete otherprops.getter;delete otherprops.setter;delete otherprops.jsxLabel;delete otherprops.primitives;delete otherprops.returns;delete otherprops.hidden;let cursor;if(tooltip)cursor='help';else if(readOnly)cursor='not-allowed';else cursor='pointer';let inputStyle=props.inputStyle||{};if(!inputStyle.cursor&&cursor==='not-allowed'){inputStyle.cursor=cursor;}U.objectMergeInPlace(inputStyle,props.inputStyle||{},props.style||{});let className=[props.className,props.inputClassName,css].join(' ');let select=/*#__PURE__*/_jsx(\"select\",{...otherprops,className:className+' model-select',disabled:readOnly,style:props.inputStyle,value:value,onChange:SelectorChange,children:getOptions()});return select;}SelectorComponent.cname='SelectorComponent';function mapStateToProps(state,ownProps){const ret={};if(!ownProps.data)return ret;const pointer=typeof ownProps.data==='string'?ownProps.data:ownProps.data.id;ret.debugmode=state.debug;ret.data=LPointerTargetable.fromPointer(pointer);ret.primitives=LPointerTargetable.fromPointer(state.primitiveTypes);ret.returns=LPointerTargetable.fromPointer(state.returnTypes);return ret;}function mapDispatchToProps(dispatch){const ret={};return ret;}export const SelectorConnected=connect(mapStateToProps,mapDispatchToProps)(SelectorComponent);export const Selector=function(props){let children=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];return/*#__PURE__*/_jsx(SelectorConnected,{...props,children});};SelectorComponent.cname='SelectorComponent';SelectorConnected.cname='SelectorConnected';Selector.cname='Selector';export default Selector;","map":{"version":3,"names":["Defaults","U","LPointerTargetable","React","connect","useStateIfMounted","Fragment","_Fragment","jsx","_jsx","SelectorComponent","props","data","showTooltip","setShowTooltip","d","__raw","l","fromD","gdata","field","readOnly","readonly","undefined","debugmode","check","id","value","label","jsxLabel","tooltip","txt","css","hidden","setter","getter","SelectorChange","evt","newValue","target","oldValue","getOptions","children","type","allInstances","map","cl","name","selected","otherprops","primitives","returns","cursor","inputStyle","objectMergeInPlace","style","className","inputClassName","join","select","disabled","onChange","cname","mapStateToProps","state","ownProps","ret","pointer","debug","fromPointer","primitiveTypes","returnTypes","mapDispatchToProps","dispatch","SelectorConnected","Selector","arguments","length"],"sources":["C:/0Programmi/Dev/projects/frontend/jjodel/frontend/src/components/forEndUser/Selector.tsx"],"sourcesContent":["import {DPointerTargetable, LClass, LModel, Defaults, U, Input} from '../../joiner';\r\nimport {DState, GObject, LEnumerator, LPointerTargetable, Overlap, Pointer} from '../../joiner';\r\nimport React, {Dispatch, LegacyRef, ReactElement, ReactNode} from 'react';\r\nimport {connect} from 'react-redux';\r\nimport {useStateIfMounted} from 'use-state-if-mounted';\r\nimport './inputselect.scss';\r\n\r\n\r\nfunction SelectorComponent(props: AllProps) {\r\n    const data = props.data;\r\n    const [showTooltip, setShowTooltip] = useStateIfMounted(false);\r\n    if (!data) return(<></>);\r\n    let d: DPointerTargetable = data.__raw || data;\r\n    let l: LPointerTargetable = LPointerTargetable.fromD(data);\r\n    let gdata: GObject<LPointerTargetable> = data;\r\n    const field: (keyof LPointerTargetable & keyof DPointerTargetable) = props.field as any;\r\n    const readOnly = props.readonly !== undefined ? props.readonly : !props.debugmode && Defaults.check(data.id);\r\n    const value: string | Pointer = d[field] as string;\r\n    const label: string|undefined = props.label;\r\n    const jsxLabel: ReactNode|undefined = props.jsxLabel;\r\n    let tooltip: string|undefined = (props.tooltip === true) ? ((gdata['__info_of__' + field]) ? gdata['__info_of__' + field].txt: '') : props.tooltip;\r\n    tooltip = tooltip || '';\r\n    let css = '';//'my-auto select ';\r\n   // css += (jsxLabel) ? 'ms-1' : 'ms-auto';\r\n    css += (props.hidden) ? ' hidden-input' : '';\r\n\r\n    \r\n    /* @ts-ignore */\r\n    const setter = (id) => {l[field].value=id} \r\n    \r\n    /* @ts-ignore */\r\n\r\n    const getter = () => l[field].value;//l.$type.__raw.values[0];\r\n    \r\n\r\n    function SelectorChange(evt: React.ChangeEvent<HTMLSelectElement>) {\r\n        if (readOnly) return;\r\n\r\n        const newValue = evt.target.value; \r\n        const oldValue = getter(); \r\n        setter(newValue);\r\n    }\r\n\r\n    // \r\n\r\n    function getOptions(): any {\r\n\r\n        return (<>\r\n\r\n            {/*@ts-ignore*/}\r\n            {l[field].type.allInstances.map(cl =><>\r\n                {/*@ts-ignore*/}\r\n                {typeof(l[field].value) === 'undefined' ? \r\n                    <option value={cl.id}>{cl.name}</option> \r\n                    :\r\n                    <>\r\n                        {/*@ts-ignore*/}\r\n                        {l[field].value.id === cl.id ?\r\n                        <option value={cl.id} selected>{cl.name}</option> \r\n                        :\r\n                        <option value={cl.id}>{cl.name}</option>  \r\n                    }\r\n                    </>\r\n                }\r\n\r\n            </>)}\r\n        </>); \r\n    }\r\n\r\n    const otherprops: GObject = {...props};\r\n    delete otherprops.data;\r\n    delete otherprops.getter;\r\n    delete otherprops.setter;\r\n    delete otherprops.jsxLabel;\r\n    delete otherprops.primitives;\r\n    delete otherprops.returns;\r\n    delete otherprops.hidden;\r\n    let cursor: string;\r\n    if (tooltip) cursor = 'help';\r\n    else if (readOnly) cursor = 'not-allowed';\r\n    else cursor = 'pointer';\r\n    let inputStyle = props.inputStyle || {};\r\n    if (!inputStyle.cursor && cursor === 'not-allowed') { inputStyle.cursor = cursor; }\r\n    U.objectMergeInPlace(inputStyle, props.inputStyle || {}, props.style || {});\r\n    let className = [props.className, props.inputClassName, css].join(' ');\r\n\r\n\r\n    let select = (<select {...otherprops} className={className + ' model-select'} disabled={readOnly}\r\n            style={props.inputStyle}\r\n            value={value}\r\n            onChange={SelectorChange}>\r\n                {getOptions()}\r\n    </select>);\r\n\r\n\r\n    return select;\r\n}\r\n\r\nSelectorComponent.cname = 'SelectorComponent';\r\nexport interface SelectorOwnProps {\r\n    data?: DPointerTargetable | Pointer<DPointerTargetable, 1, 1, LPointerTargetable>;\r\n    field: string;\r\n    label?: string;\r\n    jsxLabel?: ReactNode;\r\n    tooltip?: boolean|string;\r\n    hidden?: boolean;\r\n    options?: JSX.Element;\r\n    key?: React.Key | null;\r\n    className?: string;\r\n    style?: GObject;\r\n    ref?: React.RefObject<HTMLElement> | LegacyRef<HTMLElement>;\r\n    readonly?: boolean;\r\n    inputClassName?: string;\r\n    inputStyle?: GObject;\r\n    // DANGER: use the data provided in parameters instead of using js closure, as the proxy accessed from using closure won't be updated in rerenders.\r\n    my_getter?: <T extends DPointerTargetable = any>(data: any | T | Pointer<T>, field: (string | number | symbol) | keyof T) => string;\r\n    // setter?: <T extends DPointerTargetable = any>(data: T | Pointer<T>, field: keyof T, selectedValue: string) => void;\r\n    // setter?: <T extends DPointerTargetable = any>(data: any | T | Pointer<T>, field: (string | number | symbol) | keyof T, selectedValue: string) => void;\r\n    my_setter?: (data: any, field: string, selectedValue: string) => void;\r\n\r\n}\r\ninterface StateProps {\r\n    debugmode: boolean,\r\n    data: LPointerTargetable;\r\n    primitives: LClass[];\r\n    returns: LClass[]; }\r\ninterface DispatchProps { }\r\n\r\ntype AllProps = Overlap<SelectorOwnProps, Overlap<StateProps, DispatchProps>>;\r\n\r\n\r\nfunction mapStateToProps(state: DState, ownProps: SelectorOwnProps): StateProps {\r\n    const ret: StateProps = {} as any;\r\n    if (!ownProps.data) return ret;\r\n    const pointer: Pointer = typeof ownProps.data === 'string' ? ownProps.data : ownProps.data.id;\r\n    ret.debugmode = state.debug;\r\n    ret.data = LPointerTargetable.fromPointer(pointer);\r\n    ret.primitives = LPointerTargetable.fromPointer(state.primitiveTypes);\r\n    ret.returns = LPointerTargetable.fromPointer(state.returnTypes);\r\n    return ret;\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch<any>): DispatchProps {\r\n    const ret: DispatchProps = {};\r\n    return ret;\r\n}\r\n\r\n\r\nexport const SelectorConnected = connect<StateProps, DispatchProps, SelectorOwnProps, DState>(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(SelectorComponent);\r\n\r\nexport const Selector = (props: SelectorOwnProps, children: (string | React.Component)[] = []): ReactElement => {\r\n    return <SelectorConnected {...{...props, children}} />;\r\n}\r\n\r\n\r\nSelectorComponent.cname = 'SelectorComponent';\r\nSelectorConnected.cname = 'SelectorConnected';\r\nSelector.cname = 'Selector';\r\nexport default Selector;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}